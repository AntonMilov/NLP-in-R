рис 2 конвергенция акула б   ихтиозавр   дельфин фу 11 кции находит подтверждение морфологии физиологии настоя 11 ice время физиология наука имеет множество направлений базирую щихся учении п павлова нервной системе объединяющей орга низм единое целое эмбриология греч embryon   зародыш   наука зародышевом развитии животных сравнительная эмбриология позволяет устано вить закономерности развитии зародышей разных животных понять взаимосвязь онтогенеза филогенеза пройденные исторические эта пы эволюционном развитии животных степени проявля ются современных видов эмбриональных стадиях развития 11 менно раннем периоде развития зародышей разных видов живот ных наблюдается наибольшее сходство такая закономерность сформулирована бэром закон зародышевого сходства сущность закона заключается эмбриональном периоде развития раньше других закладываются признаки типа которому принадлежит животное затем признаки класса позднее признаки отряда оформляются признаки вида эта закономерность повторения онто rci езе стадий филогенеза обобщена э геккелем форме биогене тического закона онтогенез краткое повторение филогенеза экология греч oiko   жилище местообитание изучает живот пых связи местом условиями жизни закономерности взаи мосвязях организмов средой обитания одной задач экологии яв л яется исследование приспособительных черт строении животных жизненных отправлениях поведении появляется новая наука   это логия греч sthos   характер нрав которая позволяет раскрыть многие закономерности жизнедеятельности сообществ животных взаимоотношения отдельных видов частности конкуренцию пара зитизм т п данные экологии этологии ценны разра 9 ботки теоретических проблем общебиологического характера несут весьма ценную информацию животноводовпрактиков охотове дов работников зоопарков заповедников т д зоогеография изучает закономерности географического распростра нения животных нашей планете исследования области зоогеогра фии экологии этологии создают предпосылки практическому ис пользованию полученных результатов обоснования мер ре конструкции фауны научного подхода разработке осуществлению проектов затрагивающих целые регионы страны строительство авто железнодорожных магистралей переброска рек т п палеонтология греч palaio   древний изучает вымерших жи вотных палеозоология растений палеоботаника восстанавливает окаменелостям облик вымерших животных растений кювье дал научное обоснование распределения окаменелостей слоям оса дочных пластов земли разного геологического возраста ковалев ский призывал палеонтологов констатировать различия фаунах разных эпох искать среди ископаемых остатков сходство животными смежных напластований филогенетика греч phylon   племя род genesi   происхожде ние занимается изучением исторических связей мире животных растений результате изучения родственных отношений животных построено родословное древо животного мира систематика греч systematiko   упорядоченный основе дан ных зоологических наук разрабатывает классификацию животных естественную систему животного мира отражающую родственные связи различных групп животных естественная система базируется организмы постоянно развиваются эта система призвана отра жать генеалогические связи организмов ибо объединения животных ту иную категорию основанием служит степень сходства отра жение родства одному виду относят животных наиболее близко род ственных объясняет морфологическое сходство свободно скрещивающихся собой получением плодовитого потомства имеющих общее географическое распространение видовые признаки стойкие отличаются исключительной консервативностью результате внутривидовой изменчивости образуются подвиды разновидности общеизвестны различия окраске опушенности размерах т п животных одного вида обитающих разных гео графических зонах особенно большая пластичность свойственна мол люскам насекомым особенности организма животных эволюция живой природы земле привела образованию животных растений важное различие ними заключается характере обмена веществ который обу словлен типом питания растения большинстве своем автотроф ные организмы животные правило гетеротрофные организмы темноте растения погибают животные способны жить большинство животных ведут активный образ жизни свободно пе ремещаясь пространстве совершая разнообразные движения 10 гас гения обычно неподвижны клетки животных имеют плотных неточных стенок построенных целлюлозных волокон содер жа вакуолей клеточным соком которые свойственны клеткам расте ши провести резкую границу животными растениями возможно особенно это трудно сделать низших форм сохра няющих черты общие двух царств природы одна кардинальных оощих черт животных растений   клеточное строение клетка клетка представляет собой основную структурыо функцио плльную единицу живых организмов теле многоклеточных живот пых клетки дифференцированы зависимости выполняемых ими функ ций обусловливает различия размерам также форме строению клетки организма взаимосвязаны взаимодейст вуй гг друг другом такая связь взаимодействие осуществляются i ижерхностную мембрану клетках протекают процессы обмена веществ типичная животная клетка содержит цитоплазму клеточное ядро ими ядра различные органоиды органеллы сама клетка огра ii ичена наружной мембраной которую называют плазматической мем раной плазмалеммой рис 3 рис 3 строение клетки эукариот   плазматическая мембрана 2   митохондрии 3   кариоплазма 4   ядерная оболоч ка 5   лизосома 6  цитоплазма 7  пиноцитозный пузырек 8  аппарат гольджи   центриоли 10   ядро 11   ядрышко 12   эндоплазматическая сеть 11 плазматическая мембрана представляет собой сложный белко липидный комплекс очень тонка защищает клетку внешних воздействий участвует обмене веществами клеткой окружающей средой цитоплазма   это сложная коллоидная система которой находят ся структурные образования такие митохондрии эндоплазматиче ская сеть аппарат гольджи рибосомы растворенные вещества митохондрии имеющие вид мелких удлиненных телец служат энергетическими центрами клетки регулирующими биохимические реакции превращения энергии эндоплазматическая сеть штэндоплазматическийретикулум пред ставляет собой систему тончайших трубочек пронизывающих ци топлазму клетки пузырьков тончайшим канальцам эндоплазма тической сети осуществляется внутриклеточный обмен веществ аппарат гольджи близок своему строению строению эндоплаз матической сети служит временного хранения продуктов внутри клеточного синтеза основном гормонов ферментов передачи эндоплазматическую сеть вовлечения обменные процессы организма рибосомы виде мельчайших зерен расположены основном верхности мембран эндоплазматической сети участвуют синтезе белков которые каналам сети транспортируются внутри клетки часто цитоплазме клеток животных имеются различные тончай шие нити волоконца которые служат опорным каркасом клеток нофибриллы могут сокращаться миофибриллы проводить нерв ные импульсы нейрофибриллы цитоплазме постоянно наблюдают временные включения виде капелек жира зерен глыбок резервных белков пигментов т д которые возникают исчезают процессе мена веществ лишь немногие специализированные клетки эритроциты млеко питающих имеют ядра ядра клеток разнообразны форме ве личине снаружи ядро ограничено двухслойной мембраной ядерной мембраной внутри которой находится кариоплазма ядерная мембрана пронизана порами которых сторону цитоплазмы кариоплазмы ходят небольшие тончайшие канальцы кариоплазме находятся хромо сомы ядрышко хромосомы являются носителями наследственной информации ткани организма животном организме клетки кроме половых находятся составе тканей ткани   это сложившиеся процессе фи логенеза многоклеточных организмов структуры образованные клет ками ткани входят состав органов участвуя выполняемых ими функциях многообразие функций тела животного отражено строе нии органов тканей различают четыре типа тканей нервную эпите лиальную соединительную мышечную нервная ткань воспринимает передает раздражения поступаю щие внешней внутренней среды организма раздражи мость   одно свойств характеризующих живую материю нервная 12 ii in i состоит нервных клеток нейронов клеток глии межкле hiiiioro вещества зависимости выполняемой функции нейроны пенится чувствительные двигательные каждый нейрон имеет     nil несколько отростков короткие разветвленные отростки пшлются двндритами длинный отросток называется нейритом in аксоном концевые разветвления аксона чувствительной клетки nix принимают раздражение называются рецепторами поиерхности тела внутренних органах рецептора возбуждение iii сдается аксону телу нейрона затем дендритам   ден чптам двигательного нейрона результате возникает соответствую м 11 реакция   двигательная секреторная т п эпителиальная ткань представляет собой пласты клеток плотно прилегающих друг другу соединенных межклеточными контакта ми эпителиальным пластом располагается слой межклеточного пещества называемого базальной мембраной эпителий бывает одно мойным клетки лежат ряд многослойным клетки располагаются несколько рядов эпителия характерна высокая   i обность регенерации поскольку клетки своего положе ния поверхности тела внутренней поверхности полых орга нон например пищевода быстро изнашиваются погибают должны  ч п заменены новыми кожный эпителий находится постоянном контакте внешней средой определяет специфику разных видов животных пример кожа рыб обильно снабжена слизистыми клетками насе комых эпителий пропитан хитиновым веществом защищающим тело 111 пысыхания вместе энтодермальный эпителий кишечника иожен слой клетками цилиндрической формы эпи i слий осуществляется избирательное всасывание переваренной пищи соединительная ткань относится системе тканей внутренней сре соединительной ткани характерно наличие большого количе ства межклеточного вещества сравнительно небольшого числа клеток кости межклеточное вещество плотное крови   жидкое соеди нительная ткань выполняет многообразные функции трофическую связанную питанием организма опорную защитную др зави симости выполняемых функций соединительную ткань делят i собственно соединительную ткань 2 жировую ткань 3 кровь  t хрящевую ткань 5 костную ткань 6 мезенхиму которую i тссматривать соединительную ткань зародыша состав крови входят жидкая часть плазма форменные эле менты   клетки крови форменные элементы животных разных ти пов существенно различаются позвоночных это эритроциты крас ные кровяные клетки лейкоциты белые кровяные клетки тромбо i   главным органом кроветворения является костный мозг особая роль принадлежит эритроцитам поглощающим кислород транспор тирующим тканям лейкоциты наиболее разнообразны позво i ючных форме выполняемым функциям среди которых важное место принадлежит нейтрализации ядов чужеродных тел 13 наряду кровеносной системой позвоночных имеется лимфатиче ская система представлена лимфатическими узлами лимфатиче скими сосудами лимфоциты циркулирующие лимфатической сис теме играют важную роль защитной функции организма ретикулярная ткань виде рыхлого скопления звездчатых клеток является основой селезенки наличие большого количества лимфоци тов способствует процессам фагоцитоза определяя защитные функ ции ткани рыхлая волокнистая соединительная ткань входит состав многих органов подкожной клетчатки плотная волокнистая соединитель ная ткань составляет основу связок эластиновые волокна нижнего слоя кожи коллагеновые волокна хрящевая ткань входит состав скелета позвоночных ряда беспо звоночных животных составляет основу ушных раковин образует межпозвоночные диски костной ткани сформированы кости ко стная ткань состоит клеток межклеточного вещества построенно го коллагеновых волокон аморфной массы пропитанной мине ральными солями костная ткань   это живая ткань находятся кровеносные сосуды нервы кости организме служат депо кальция фосфора других минеральных элементов мышечная ткань мышцы делятся гладкие поперечнополоса тые основу мышц составляют тончайшие мышечные волоконца   миофибриллы гладкие мышцы характеризуются плавностью сокра щения расслабления находятся внутренних органах попе речнополосатые мышцы способны совершать быстрые сокращения выносить большую нагрузку скорость сокращения колебаться значительных пределах поперечнополосатые мышцы обычно прикреплены костям наружного внутреннего скелета относятся мышцам произвольного сокращения тканей формируются различные органы многоклеточного жи вотного функционирование любого органа происходит тесном взаи модействии всеми другими органами свидетельствует целост ности организма самое наблюдается деятельности личных органелл одноклеточных животных особенно четко это прослеживается высших простейших   инфузорий каждый орган функционирует неразрывная часть единого организма особенности строения функционирования различных органов изучаются разделах систематики животных размножение   это свойство живых организмов воспроизводить се бе подобных особей животные размножаются бесполым половым путем бесполое размножение характерно основном низших жи вотных бесполом размножении материнской особи либо отде ляется часть тела либо вся материнская особь делится две большее число частей каждая часть дальнейшем развива ется самостоятельное животное существует несколько способов бес полого размножения деление почкование шизогония 14 размножении простым делением ма re р некая особь делится две одина ковые дочерние особи рис 4 одних простейших жгутиконосцы тело делится п продольном направлении других ин фузории   поперечном третьих обла гающих шарообразной изменчивой формой например амебы деление мо жет происходить любом направлении почковании теле материнского организма образуется вырост   почка ко горая постепенно приобретает форму строение взрослой особи отделения рис 4 бесполое размножение огпочковывания материнского орга одноклеточных животных низма новая дочерняя особь начинает   деление амебы б   почко мести самостоятельную поч вание инфузории сувойки   шизогония малярийного ковании многих видов кишечнополост плазмодия ных животных ведущих сидячий образ жизни результате неполного отделения дочернего организма почки материнского сохранения связи следним образуются колонии могут возникать целые корал ноиые  города    рифы ряда паразитических форм простейших наблюдается множествен i юе деление   шизогония случае ядро материнского организма многократно делится образуется многоядерный шизонт вокруг каж дого ядра внутри шизонта обособляется участок цитоплазмы шизонт распадается делится многочисленные мелкие дочерние особи   ме рашиты такое множественное деление позволяет паразиту очень ко роткий срок достичь высокой численности организме своего хозяина половое размножение свойственно всем типам животных множении половым путем новый организм развивается зиготы ко торая образуется результате слияния женской яйца мужской снермия половых клеток спермий   мужская гаплоидная половая клетка   обычно состоит головки шейки хвоста последний служит передвижения спермия жидкой вязкой среде рис 5 яйцеклетка   женская половая клетка   имеет округлую форму состоит цитоплазмы ядра своим размерам яйцеклетка пре восходит спермий некоторых животных наблюдается наружное оплодотворение т е женские мужские гаметы выделяются воду происходит слияние другим животным свойственно внутреннее оплодотворение спермии составе спермы вводятся половые пути самки исходит слияние яйцеклеткой имеют место случаи развития организмов неоплодотворенных яйцеклеток такое размножение называемое партеногенетическим девственным размножением часто встречается членистоногих 15 рис 5 различные формы спермиев животных   улитки б   медузы   рака г   круглого червя де   низших раков   жука начальные этапы развития многоклеточных животных развитие орга низма начинается делений дробления зиготы оплодотворенного яйца ряд клеток   бластомеров дробление бывает полным неполным обу словлено количеством желтка яйце полное дробление происходит яйце содержится мало желтка распределен цитоплазме отно сительно равномерно такие яйца называют гомолецитальными полном дроблении яйцо делится сначала 2 бластомера затем 4 8 16 32 т д результате такого полного дробления яйца образуется комо чек клеток   морула последующем центре морулы возникает лость морула превращается однослойный зародыш   бластулу рис 6 рис 6 типы дробления яйца   полное равномерное б  полное неравномерное   дискоидальное г   поверхностное 16 неполное дробление наблюдается яйцах большим количеством  ке нтк л типе дробления бластомеры распадается яйцо 1 ними та часть содержится ядро окруженное цитоплазмой   1новотельной плазмой например яйцах птиц рыб образовательная 11 i im расположена одном полюсов яйца виде диска развитии мродыша диск дробится ряд бластомеров которые располагаются 11 од 11 слой лежащий массе желтка яйцах насекомых образователь iinl плазма окружает желток находящийся центре яйца дробление i иг  нательной плазмы приводит возникновению бластулы внутри кото рой имеется первичная полость   бластоцель бластоцель ограничена бла е гомерами расположенными слой   бластодерма рис 7 следующий этап развития зародыша заключается превращении однослойного зародыша   бластулы   двухслойный   гаструлу ют процесс называется гаструляцией который разных животных протекает неодинаково шел процесс гаструляции рис 7 схема полного дробления яйца стадии гаструлы   равномерное дробление яйца голотурии 6   неравномерное дробление яйца лягуш ки   бластодерма 2   бластоцель 2 6407 17 рис 8 продольные поперечный разрезы различные эмбриональные стадии ланцетника   бластула б г   гаструла разных стадиях развития д е   образование мезо дермы хорды нервной системы   анимальный полюс 2   вегетативный полюс 3   гастральпая полость 4   гастропор 5   нервная трубка 6   нервнокишечный ка нал 7   невропор 8   складка мезодермы 9   целомические мешки 10   хорда 11   место будущего рта 12  место будущего заднего прохода 1314  мезодермальные карманы 15  эктодерма 16  энтодерма заканчивается образованием зародыша состоящего двух сло ев клеток эктодермы энтодермы эктодермой энтодермой остается небольшое пространство   остатки бластоцеля образовавшая ся кишечная полость гаструлы   гастроцель   последующем станет лостью кишечника взрослого животного отверстие гастроцеля   блас топор   большинства беспозвоночных животных сохраняется стано вится первичным ртом взрослой особи таких животных называют первичноротыми итак гаструла   это двухслойный зародыш ки шечной полостью открывающейся наружу первичным ртом группы животных иглокожие хордовые бластопор ста новится анальным отверстием зарастает рот образуется проти воположном конце тела таких животных называют вторичноротыми двухслойное строение тела характерно губок кишечнополост ных относящихся низшим многоклеточным организмам высоко организованных животных первым зародышевым листком эк тодермой вторым зародышевым листком энтодермой образуется средний третий зародышевый листок   мезодерма части хордовых мезодерма закладывается виде ряда парных пячиваний стенки кишечника зародыша рис 8 карманообраз ные выпячивания отшнуровываются кишки образуют мезодер мальные целомические мешки   сомиты каждом имеется полость которую называют вторичной полостью тела целомом стенки сомитов представляют собой мезодерму таким образом соми располагаются первичной полости тела эктодермой энто дермой разрастаясь сомиты вытесняют первичную полость тела ко гда перегородки сомитами рассасываются полости сомитов сливаются образуя вторичную полость тела остатки первичной лости сохраняются виде лакун каналов животные имеющие це лом называются вторичнополостными 18 первичнополостные животные имеют кровеносных сосудов функцию крови организме выполняет полостная жидкость омы вающая внутренние органы примитивных вторичнополостных животных моллюски членисто ногие первичная полость тела частично сливается целомом образуя сме шанную полость тела   миксоцель кровеносная система таких живот ных незамкнутая т е кровь движется сосудам лакунам процессе развития эмбриона зародышевых листков путем диф ференцировки образуются ткани органы формировании эпители альной ткани участвуют зародышевых листка эктодерма дает начало наружным покровам производным кожные железы воло сы перья чешуя когти наружному скелету беспозвоночных живот ных эпителию переднего заднего отделов пищеварительной систе нервной системе органам чувств мочевым протокам висцераль ному скелету наружным жабрам энтодермы образуются средний пищеварительный отдел кишеч ника железы печень поджелудочная железа др хорда пла вательный пузырь внутренние жабры рыб легкие высших животных мезодерма дает начало скелету иглокожих позвоночных живот ных мышцам соединительной ткани числе крови части крове носной системы органам выделения половым органам симметрия тела животных большинства животных части тела расположены симметрично некоторых тело имеет неправильную форму лишенную симметрии различают типа симметрии ради альную двустороннюю рис 9 радиальная симметрия свойственна животным которых одинако вые части тела органы располагаются срединной продольной оси животного радиусам таким образом тело таких животных мож i ю разделить условно равные части обычно такая симметрия харак терна представителей водной фауны ведущих малоподвижный жизни медузы морские звезды др рис 9 типы симметрии   асимметричная амеба б   радиальная морская звезда двусторонняя реч пой рак 19 двусторонняя симметрия характеризуется тело животного разделено плоскостью две равные половины т е таких животных различить левую правую половины пе редний задний концы тела тип симметрии бывает относи тельным расположении многих внутренних органов достигнуть сердце приматов лежит левой части грудной клетки курнесушек яичник расположен левой части таза т п тип симметрии является важным систематическим признаком различ ных групп животных встречаются случаи возрастом животного меняется симметрия тела например плавающие личинки морских ежей обладают двусторонней симметрией взрослая особь   радиальной симбиоз паразитизм животном мире отношения животных обитающих разных условиях среды строятся прямом непосредст венном косвенном взаимном влиянии питание   основной фак тор который определяет взаимоотношения животных именно основе складываются пищевые связи животными растениями также разными видами животных характеру питания одни животные являются плотоядными другие   растительноядными тре тьи   всеядными животные делятся также монофагов полифагов монофаги пи таются растениями животными принадлежащими одному виду тля филлоксера питается соком виноградной лозы поли фагов пищей служат растения животные разных видов полевка обыкновенная поедает 100 видов растений многие животные ис пользуют пищу существенно ограниченный круг животных рас тений это называемые олигофаги например комары рода анофе лес питаются кровью крупных стадных млекопитающих процессе эволюции органического мира возникли различные формы тесного сожительства разных видов животных животных рас тений существуют формы такого сожительства комменсализм симбиоз паразитизм комменсализм   такая форма сожительства которой организм получает пользу другого причиняя вреда например многие инфузории поселяясь поверхности тела других животных облегчают добывание пищи получение кислорода т п простейшие живущие ротовой полости животных могут причинять вреда извлекать пользу симбиоз   форма сожительства оба организма получают вза имную пользу типичным примером симбиоза могут служить панцир ные инфузории живущие рубце жвачных животных питаясь бакте риями содержимого рубца сами затем становятся высокобелковой пищей хозяина 1 см 3 содержимого желудка насчитывают сколько сотен тысяч инфузорий рода entodinium паразитизм   это форма сожительства двух организмов кото ром паразит поселяется поверхности внутри организма хозяина питается частями тела продуктами пищеварения хозяина ружные паразиты называются эктопаразитами паразитирующие 20 ми гри организма хозяина   эндопаразитами паразитами хозяе м1ми могут растения животные отличие хищников паразиты существуя счет хозяина обычно убивают могут i иособствовать гибели подрывая здоровье правило пара ми размерам меньше своего хозяина организация i равнении организацией свободноживущих сородичей резко упро шена особенно это касается нервной системы органов движения иыхания обычно паразит хозяин принадлежат ным видам разным типам полцарствам животного мира паразитические животные произошли вероятно свободножив iiiих предков процессе постепенного длительного приспособления ши других организмах зачастую предками паразитов коммен салы симбионты которые постепенно переходили питанию исклю чительно счет хозяев огромная масса свободноживущих организмов оторые пищей попадали пищеварительный тракт животных поги i шли часть приспособившись жизни кишечнике i юрешла паразитическому образу жизни кишечного тракта парази i м могли попадать кровь лимфу различные органы ткани становясь постоянными обитателями организма хозяина некоторые эктопарази i ы проникая кожный покров тела хозяина могли превратиться 1допаразитов таким образом переход свободноживущих форм пара зитическому образу жизни мог осуществлен разными путями формы проявления паразитизма животном мире разнообразны иременный паразитизм характеризуется паразит вступает контакт хозяином принимает пищу кровососу щие насекомые комары слепни блохи постельный клоп др ос тальное время паразиты остаются свободноживущими постоянному паразитизму свойственно паразит проводит теле хозяина внутри стадиях своего развития пли строго определенной стадии развития например опас 11ейший паразит круглый червь трихинелла одной стадии развития iюкидает своего хозяина   крысу свинью человека др оводов личинки проходят свое развитие организме хозяина лошадь корова овца взрослые насекомые живут природе жизненный цикл многих постоянных паразитов протекает од ном двух трех хозяевах возбудитель малярии малярийный плазмодий обитает крови человека организме комара ленточный червь лентец широкий половозрелом состоянии живет кишечнике хищных животных человека личиночные стадии развития ходят организмах мелких ракообразных затем рыбы таким образом развитие паразита проходит сменой хозяев хозяин организ ме которого паразит достигает половой зрелости размножается поло вым путем называется дефинитивным окончательным хозяином хозяин организме которого паразит размножается беспо лым путем проходит стадии своего развития достигая половой зрелости называется промежуточным следовательно пораженный широким лентецом является дефинитивным хозяином ко 21 тором происходит половое размножение паразита мелкие ракообраз ные   промежуточным рыба   дополнительным обитая организме хозяина паразитические животные оказывают разносторонние обычно отрицательные воздействия питаясь счет организма хозяина паразит истощает выделяемые парази продукты обмена вызывают хозяина токсикозы механически вреждая ткани органы паразиты способствуют проникновению ор ганизм хозяина патогенных микроорганизмов пр паразиты могут разрушать ткани органы хозяина закупоривать воздухоносные пути просвет кишечника выводные протоки желез ослабленный паразита ми организм хозяина подвержен всевозможным инфекциям паразитарные заболевания возбудителями которых являются живот ные организмы называются инвазионными отличие инфекционных болеваний возбудителями которых служат вирусы бактерии грибы фауне нашей планеты описано 80 тыс видов паразитиче ских животных которых половина приходится перепончатокры лых насекомых   наездников втором месте численности находятся паразитические круглые плоские черви лишь третьем месте   па разитические простейшие среди хордовых паразитов очень мало паразиты локализуются системах органов животных преоб ладая пищеварительной растений животныепаразиты это ос новном нематоды локализуются также системах органов главным образом корневой системе организм хозяина паразита   это среда обитания внешняя среда также воздействует парази та изменения внутренней среды организма хозяина удиви тельную чувствительность состоянию организма демонстрируют эктопаразиты паразитическая моногенетическая трематода устка начинает свое развитие жабрах головастика развитие парази та хозяина   головастика   происходит синхронно головастик превращается лягушонка паразит переходит мочевой пузырь животного развитие головастика либо причине задерживается замедляется развитие многоустки распространению паразитов способствуют резервуарные хозяева попадая организм которых паразиты развиваются накапливают ся сохраняя жизнеспособность такие резервуарные хозяева вестны многих паразитов разных классов например установ лена роль земляных червей распространении аскарид черви заглаты вают яйца аскарид кишечнике яиц выходят личинки сохраняющие жизнеспособность года съедая такого дождевого чер вя свиньи другие животные заражаются аскаридами система животного мира животный мир отличается большим нообразием земле насчитывается около 2 млн видов создание сис темы животного мира является важнейшей задачей зоологии решени ем занимается одна отраслей науки   систематика таксоно мия которая разрабатывает теорию практику классификации определения животных систематики конечного результата   классификации   огромное разнообразие видов воспринималось 22 хаос недоступный пониманию естественная система живот ного мира строится основе всестороннего изучения животных позволяет выявить черты сходства различия ними доказать исторические связи установить степень родства основной таксономической единицей систематике является вид speci   реально существующая категория вид   это обособленная группа сходных особей обитающих определенном пространстве ареале свободно скрещивающихся собой дающих плодови тое потомство особи разных видов правило собой скре щиваются такое скрещивание произойдет полученное томство обычно способно дальнейшему размножению каждый вид населяет определенное пространство называемое обла стью распространения вида ареалом особи одного вида насе ляющие различные районы ареала находятся обычно неодинаковых условиях среды приводит возникновению изменчивости т е обретению этими особями своеобразных черт такие несколько отлич ные местные группы особей вида населяющие часть ареала называются подвидами отличие видов подвиды связаны друг другом переход ными формами обладающими признаками промежуточного характера большинства видов сельскохозяйственных животных выделяют породы выведенные человеком отличающиеся первую очередь продуктивностью также экстерьерными интерьерными показате лями например всем мире насчитывают около 400 официально регистрированных пород домашних собак современной систематике принято именовать различные виды жи вотных латинском латинизированном греческом языке де лает названия интернациональными впервые двойное бинарное название ввел великий шведский ученый линней xviii ответствии правилом бинарной номенклатуры каждому виду присваи вается название состоящее двух слов первое означает род второе   собственно вид например различные виды кошек составляют род feli отдельные виды рода будут называться двумя словами например кот лесной   feli silvestri кот степной   f libyca кот камы шовый   f chaus др названия вида животного обычно указы вается фамилия полностью сокращенно ученого впервые описав шего данный вид год это сделано например собака машняя an is familiari l 1758 данном случае l   это линней современной систематике животных используются следующие сономические группы таксоны близкие виды объединяются род genus близкие роды   семейство familia семейства   отряд ordo отряды   класс classi классы   тип phylum типы образуют цар ство regnum животных часто устанавливаются промежуточные катего рии   подрод родом видом подсемейство семейством родом подотряд отрядом семейством подкласс классом отрядом подтип типом классом кроме выде ляют надсемейства семейством подотрядом надотряд отрядом подклассом надкласс классом подтипом 23 высшая систематическая категория   это тип каждый тип харак теризуется определенным планом строения общим групп входящих состав общим происхождением тип подразделяется следующие основные категории тип  подтип  класс класс подкласс надотряд отряд  отряд  семейство семейство подсемейство род  род вид подвид царство животные animalia zoa подцарство одноклеточные простейшие protozoa тип саркомастигофоры sarcomastigophora тип апикомплексы apicomplexa тип миксоспоридии myxozoa тип микроспоридии microspora тип асцетоспоридии ascetospora тип лабиринтулы labyrinthomorpha тип инфузории ciliophora подцарство многоклеточные metazoa надраздел фагоцителлозои phagocytellozoa тип пластинчатые placozoa надраздел паразои parazoa тип губки porifera spongia надраздел эуметазои eumetazoa раздел лучистые radiata тип кишечнополостные coelenterata тип гребневики ctenophora тип мезозой mesozoa раздел двустороннесимметричные bilateria тип плоские черви plathelminth тип круглые черви nemathelminth тип немертины nemertini тип кольчатые черви annelida тип моллюски mollusca тип онихофоры onychophora тип членистоногие arthropoda тип погонофоры pogonophora тип щупальцевые tentaculata тип щетинкочелюстные chaetognatha тип иглокожие echinodermata тип полухордовые hemichordata тип хордовые chordata современная систематика выделяет большое число типов живот ных данном учебнике дается описание тех типов которые имеют важное значение либо познания эволюции животных либо практической точки зрения царство животные animalia делят полцарства простей шие одноклеточные protozoa многоклеточные metazoa 24 подцарство одноклеточные простейшие protozoa одноклеточным относят животных которых тело морфологиче ски соответствует одной клетке одновременно представляет само стоятельный организм всеми присущими живому существу функ циями известно значительное число представителей простейших разующих колонии нескольких многих клеток простейшие могут отнесены многоклеточным организмам поскольку каждая клетка колонии выполняет функции хотя ii некоторых случаях намечается разделение отдельных функций ме жду клетками колонии многоклеточном организме каждая клетка выполняет определенную функцию   двигательную нервную т п деление клеток многоклеточных животных приводит росту ор ганизма деление клетки простейших приводит увеличению численности т е деление простейших   это сути дела размноже ние этих организмов известно 39 тыс видов одноклеточных это мелкие организ минимальными размерами характеризуются простейшие веду щие паразитический образ жизни внутри клеток растений животных эндопаразиты   2 4 мкм тело простейших ограничено снару жи тончайшей мембраной плотной эластичной пеллику лой которой находятся цитоплазма ядро одно несколько цитоплазма представлена двумя слоями наружным светлым плот ным   эктоплазмой внутренним менее плотным многочисленны ми включениями   эндоплазмой эндоплазме сосредоточены ос новные органеллы клетки митохондрии рибосомы лизосомы аппа рат гольджи эндоплазматическая сеть пр простейших имеются специальные органеллы пищеварительные сократительные вакуоли опорные сократительные фибриллы простейшие тело которых ограничено мембраной имеют стоянной формы амебы ряда видов клеточная мембрана уплотня ется счет эктоплазмы становится плотной эластичной образуя называемую пелликулу случае животные имеют определен ную форму тела инфузории одновременно сохраняют достаточную гибкость часть одноклеточных имеет постоянную форму тела благо даря укреплению оболочки счет различных включений 25 функцию скелета простейших могут выполнять раковины фор мирующие наружный скелет специальные иглы капсулы фор мирующие внутренний скелет раковины образуются веществ деляемых эктоплазмой внутренний скелет возникает эндоплазме клетки основу скелетных образований составляют органические минеральные вещества cac0 3 si0 2 srs0 4 самый простой способ движения простейших имеющих посто янной формы тела   движение помощью ложноножек псевдо подий амебоидное движение псевдоподии   это выросты клетки которые перетекает цитоплазма сложное движение характерно простейших обладающих жгутиками ресничками строение жгутиков ресничек сходно жгутиков свойственно вращательное движение ресничек   гребной тип движения внутриклеточные паразиты правило имеют органелл обеспечивающих движение разнообразен тип питания простейших среди встречаются ав тотрофы которые способны фотосинтезу одноклеточные жгутико носцы большая часть простейших   гетеротрофы питающиеся готовыми органическими веществами одним простейшим свойствен голозойный способ питания путем проглатывания оформленных час тиц пищи другим   сапрофитный способ счет поглощения раство ренных органических соединений клетку простейшего поступают оформленные пищевые час тицы вокруг образуются пищеварительные вакуоли которых частицы перевариваются захват частиц клеткой получил название фагоцитоза сапрофитном способе питания пищеварительных ва куолей организме простейших образуется захват клеточной поверх ностью растворенных органических веществ называется пиноцитозом небольшое число простейших обладает смешанным миксотрофным типом питания одних условиях способны фотосинтезу других   питанию органическими веществами т е имея цитоплазме хлорофил ловые зерна могут образовывать пищеварительные вакуоли пресноводных простейших процессы осморегуляции выделения осуществляются помощью сократительных вакуолей паразитиче ских морских форм сократительные вакуоли отсутствуют среда которой обитают животные внутреннее содержимое изотоничны выделение продуктов обмена большинства простейших происходит поверхность клетки также сократительные вакуоли кислород поступает клетку путем диффузии клеточ ную мембрану цитоплазме большинства простейших находится одно реже несколько ядер которые регулируют обмен веществ размноже ние ядра одноклеточных имеют те структуры компоненты ядра клеток многоклеточных животных хотя характеризуются морфо логическим многообразием части многоядерных простейших ядра полняют различные функции репродуктивные вегетативные такое явление называют ядерным дуализмом инфузорий бесполом размножении деление ядра одноклеточных происходит типу митоза 26 непрямого деления позволяющего сохранять преемственность ряду клеточных поколений ядра простейших которым свойствен половой процесс делятся путем мейоза редукционного деления размножаются простейшие бесполым половым путями бесполое размножение происходит путем деления клетки две множество клеток половой процесс заключается образовании половых клеток   гамет женских   макрогамет мужских   микрогамет слияния результате образовавшаяся зигота дает начало новому дочернему ор гииизму инфузорий половой процесс происходит путем конъюга ции   слияния генеративных ядер двух особей половых клеток одноклеточных животных представлена рядом стадий кото рые чередуются определенной закономерностью период жизни ор ганизма двумя одинаковыми стадиями называется жизненным циклом данного вида обычно жизненный цикл начинается стадии зиготы соответствует оплодотворенной яйцеклетке многоклеточных животных затем следуют стадия бесполого размножения делением стадия образования половых клетокгамет которые сливаясь попар дают новую зиготу бесполом размножении жизненный цикл   это период деления деления половом размножении жизненный цикл   это период зиготы зиготы важнейшая биологическая особенность одноклеточных   образо пание цист инцистирование сохранения жизнеспособности неблагоприятных организма условиях животные округляются те бяи воду образуют плотную оболочку переходят состояние покоя t таком состоянии простейшие могут длительный период сохранять жизнеспособность пассивно перемещаться большие расстояния воздушными массами водой т п благоприятных условиях вновь перейти активному образу жизни одноклеточные животные приспособлены обитанию разнооб разных средах этих животных правило необходимо нали чие воды морские пресные водоемы влажные почвы однокле точные перешедшие паразитическому образу жизни растениях животных человеке подцарство protozoa делят семь типов которых наибольший интерес представляют следующие саркомастигофоры sarcomastigo phora апикомплексы apicomplexa миксоспоридии myxozoa микроспоридии microspora инфузории ciliophora тип саркомастигофоры sarcomastigophora саркомастигофорам относят свободноживущих паразитиче ских одноклеточных животных которые передвигаются помощью осо бых временных выростов цитоплазмы псевдоподий бичевидных выростов жгутиков некоторые одноклеточные могут перемещаться помощью псевдоподий помощью жгутиков большинству 27 видов одноклеточных свойственно бесполое размножение некоторых простейших свойствен половой процесс путем копуляции тип sarcomastigophora представлен двумя подтипами жгутиконос цы mastigophora саркодовые sarcodina жгутиконосцы видимо стоят ближе предковым группам простей ших разнообразнее типам питания органелл движения типам оболочек клеток т п первичности жгутиковых форм свидетельствует саркодовые которые размножаются половым путем проходят жгутиковую стадию гамет среди жгутиконосцев переходные формы одноклеточными растительными животными организмами подтип жгутиконосцы mastigophora жгутиконосцы обитают морских пресных водах почве ор ганизме растений животных среди опасные паразиты жи вотных человека насчитывают 8 тыс видов жгутиконосцев растительные животные жгутиконосцы являются важным звеном пищевых цепях водных экосистем некоторые жгутиконосцы находят ся симбиотических отношениях различными животными представители жгутиконосцев характеризуются наличием особых органелл   жгутиков которые служат передвижения число жгути ков колеблется 1248 нескольких тысяч жгутики име ются постоянно течение большей части жизненного цикла некото рых видов жгутиконосцев помимо жгутиков могут иметься временные постоянные ложноножки   псевдоподии признак сближает представителями подтипа саркодовые размеры форма тела жгутиконосцев разнообразны покрыты довольно плотной сложной строению оболочкой   пелликулой позволяет сохранять менее постоянную форму ци топлазма делится слоя эктоплазму эндоплазму видов спо собных образовывать псевдоподии тело покрыто тонкой эластичной мембраной растительных жгутиконосцев оболочка состоять клетчатки некоторых видов образуется панцирь разнообразной формы нередко несущий отростки переднего полюса тела отходят жгутики жгутиков несколько тысяч могут покрывать тело простейшего которых жгутиконосцев жгутик тянется вдоль тела соединяясь помощью тонкой цитоплазматической мембраны   ундулирующей мембраны эта мембрана обеспечивает поступательное движение стейшего вязкой среде которое ввинчивается среду нижняя часть жгутика погруженная эктоплазму называется базаль ным тельцем кинетосомой размножаются жгутиконосцы путем продольного деления клетки две дочерние некоторых представителей существует половой цесс образованием гамет последующей копуляцией 28 среди жгутиконосцев автотрофы которые способны фото синтезу гетеротрофы характеризующиеся животным типом питания миксотрофы сочетающие растительный животный спо собы питания гетеротрофным жгутиконосцам свойственно либо го лозойное анимальное питание путем заглатывания частиц органиче ской пищи либо сапрофитное   счет всасывания жидкой органиче ской пищи всей поверхностью тела жгутики служат движения помогают захваты вать пищевые частицы результате движения жгутика воде возника ет водоворот увлекающий мелкие пищевые частицы основанию жгу тика некоторых видов находится клеточный рот ведущий глот ку видов имеющих клеточного рта основания жгутика участок липкой цитоплазмы покрытый пелликулой которую пища попадает организм одноклеточного поступившая цитоплаз му пища заключается образовавшиеся пищеварительные вакуоли непереваренные остатки пищи выбрасываются тела простейшего внешнюю среду любом участке клетки класс растительные жгутиконосцы phytomastigophorea представителей класса характерен автотрофный мик сотрофный типы питания реже среди растительных жгутиконосцев встречаются виды гетеротрофным типом питания обитают жгу тиконосцы соленой пресной воде имеются хроматофоры держащие хлорофилл многие имеют светочувствительный глазок   стигму позволяющий выбирать наиболее освещенные участки водо ема оптимизации процессов фотосинтеза пресноводных форм имеется сократительная вакуоль встречаются колониальные формы колонии образуются неполном делении результате которого полностью отделившиеся друг друга особи остаются связанными друг другом колонии могут различаться форме шаровидные дре вовидные характеру развития монотомические палинтомиче ские колонии монотомическом развитии бесполого размножения путем деления дочерние клетки растут снова периодически делятся са мым увеличивая число особей колонии которая очередь перио дически делится пополам палингомическом развитии клетки колонии часть последовательно делятся стадий рос та увеличения объема результате образуется сразу несколько молодых колоний материнская колония затем распадается дочерние число которых соответствует числу клеток старой материнской колонии половой процесс распространен преимущественно растительных форм имеющих палинтомический тип колоний наиболее сходен половым процессом многоклеточных половой процесс колоний volvox рис 10 колонии немногие клетки дают начало муж ским микрогаметы женским макрогаметы гаметам среди воль воксовых встречаются раздельнополые виды колонии которых обра 29 г рис 10 растительные жгутиконосцы   жгутиконосец masligamoeba aspera шульце 1   жгутик 2   ядро 3   эндоплаз ма 4   сократительная вакуоль 5   эктоплазма 6   псевдоподии б   эвглена зеленая euglena viridi дофлейну 1   жгутик 2   резервуар сократительной вакуоли 3   сократительная вакуоль 4 хроматофоры 5  ядро 6  зерна парамила 7  глазок   вольвокс volvoxglob участок колонии половыми клетками кону г   vol vox aureus   образование дочерних колоний клейну 1   макрогаметы 2  микро гаметы 3   дочерние колонии зуются мужские женские гаметы гермаф родитные виды колонии которых одновременно развиваются мужские женские гаметы макрогаметы неподвижны микрогаме отыскивают сливаются ними оплодотворенная макрогаме та зигота дает начало новой колонии путем последовательных па линтомических делений растительным жгутиконосцам относятся хризомонады панцир ные жгутиконосцы эвгленовые вольвоксовые рис 10 раститель ные свободноживущие морские пресноводные жгутиконосцы входят состав планктона среди имеются симбионты коралловых поли пов паразитические виды пресноводные окрашенные жгутиконос цы массовом размножении вместе микроскопическими водорос лями могут вызывать  цветение  воды пресных водоемах вследствие возникают ночные заморы рыбы 30 класс животные жгутиконосцы zoomastigophorea всем животным жгутиконосцам свойствен гетеротрофный тип пи тания большая часть являются паразитами растений животных особенно опасны эндопаразиты животных человека относящиеся отряду кинетопластиды kinetoplastida плазме крови животных человека паразитируют различные виды трипаносом trypanosoma имеющих лентовидное тело одним реже двумя жгутиком рис 11 эктоплазме жгутик связан кинетопластом снаружи свободным концом направлен вдоль тела жгутиконосца срастаясь помо щью цитоплазматической ундулирующей мембраны переднем кон це жгутик остается свободным ряда форм трипаносомных жгутико носцев жгутик отходить середины клетки некоторых чинается переднем конце тела лейшманий жгутик отсутствует трипаносомы паразитируют основном крови спинномозговой жидкости животных человека вызывая тяжелейшие заболевания зываемые трипаносомозами тропической африке трипаносомы trypanosoma rhodesiens т brucei gambiens вызывают  сонную бо лезнь  человека это длительное тяжелое заболевание унесшее свы ше миллиона жизней начинается небольшой лихорадкой сопровож дается сонливостью постепенно приводит полному истощению ор ганизма человека лечения болезнь заканчивается смертью переносчиками возбудителей сонной болезни являются кровососу щие мухи цеце glossina palpali gl morsitan вместе кровью больного муха засасывает трипаносом которые размножаются кишечнике i акапливаются слюнных железах хоботке насекомого являющегося одновременно переносчиком вторым хозяином паразита укусе му хой цеце здорового человека трипаносомы вместе слюной попадают кровь природным резервуаром трипа носом являются антилопы другие живот ные страдающие этих жгутико носцев являющиеся носителями южной америке трипаносома т crusi вызывает людей болезнь чагаса перенос ч иком вторым хозяином возбудителя явля ются кровососущие клопы трипаносомы выделяются экскрементами клопа попа дая ранку коже человека могут заразить паразиты живут крови затем прони кают клетки внутренних органов множаются снова попадают кровь немало видов трипаносом вызы нающих тяжелые заболевания крупного рогатого скота верблюдов африке т рис 11 трипаносома 1 лро 2 б з л ь н ы е тель brucei поражает 1 рогатый скот вызывая бо ца 3  ундулирующая мем лезнь нагана переносчиком возбудителя брана   жгутик 31 являются мухи цеце южной азии африке кровососущие слепни переносят трипаносому т evansi   возбудителя болезни верблюдов т equiperdum вызывает случную болезнь лошадей заражение которых происходит случке паразиты поражают нервную систему живот ных случная болезнь встречается средиземноморье азии африке среди представителей kinetoplastida родичи трипаносом   лейшмании leishmania вызывающие лейшманиоз человека это внутриклеточные паразиты редуцированным жгутиковым аппара переносчиком лейшманий являются кровососущие москиты кишечнике которых паразит размножается проходит стадию жгу тиком ундулирующей мембраны укусе москитами кровь человека попадают лейшмании имеющие жгутики внедрения клетки печени селезенки паразиты утрачивают жгутик вид лейшманий   l donovani вызывает человека заболевание называемое висцеральным лейшманиозом калаазар распространенное средней азии ицции южной америке индокитае это заболевание ражает основном детей которых увеличиваются размерах печень се лезенка болезнь сопровождается лихорадкой истощением малокровием природным резервуаром паразита являются основном бродячие собаки средней азии закавказье l tropica вызывает восточную язву пендинку переносчиком вторым хозяином являются москиты рода phlebotomus желудке которых лейшмании размножаются образуя жгутиконосную форму местах укусов москитами образуются изъязв ления внутри лейкоцитов находящихся язве обнаруживается мно жество паразитов лишенных жгутика 1 2 года язвы зарубцовы ваются носителем кожного лейшманиоза могут различные гры зуны чаще большие песчанки висцеральный кожный лейшманиозы дают стойкий иммунитет кишечнике желчных протоках человека паразитирует лямблия lamblia intestinali вызывая болезнь лямблиоз тело паразита гру шевидной формы имеет несколько жгутиков вооружено присоской помощью которой лямблия прикрепляется слизистой кишечника попав толстый отдел кишечника лямблии отбрасывают жгутики инцистируются чаще дети заражается потребляя пи щу воду загрязненные цистами паразитов среди отряда трихомонадовые trichomonadida опасные пара зиты человека трихомонады имеют четыре шесть жгутиков кото рых является рулевым образующим ундулирующую мембрану trichomona homini вызывает хронические поносы т vaginali парази тирует мочеполовых путях вызывая трудноизлечимые заболевания интересны представители отряда многожгутиковые hypermastigi па обитающие кишечнике насекомых частности термитов этих жгутиконосцев жгутиков являются полезными симбион тами термитов многожгутиковых хозяева могут самостоятельно переваривать клетчатку жгутиконосцы вырабатывают фермент целлюлазу расщепляющую потребленную термитами клетчатку легко усвояемых углеводов 32 подтип саркодовые sarcodina представители саркодовых протяжении жизненного цикла большей части передвигаются помощью псевдоподий жгутиками саркодовые могут обладать лишь кратковременных стадиях разви тия это гаметы зооспоры основная масса саркодовых размножается бесполым путем делением две клетки множество клеток ловое размножение присуще немногим видам осуществляется путем слияния гамет большинство саркодовых   свободноживущие виды обитающие соленых водах часть живет пресных водоемах селяет почву участвуя почвообразовательных процессах немногие являются паразитами животных человека насчитывают около 10 тыс видов саркодовых 12 классов саркодовых выделить класса которым принадлежит основная масса представителей подтипа класс корненожки rhizopoda класс лучевики radiolaria класс солнеч ники heliozoa наиболее просто устроены представители голых амеб класс корне ножки   rhizopoda отр амебы   amoebina населяющие пресные водоемы почвы питаются мелкими простейшими однокле точными водорослями микроорганизмами гниющими остатками тончайшая мембрана покрывающая тело этих микроскопических жи вотных позволяет образовывать временные выросты   псевдопо дии своей форме напоминающие корни растений определило название класса помощью псевдоподий амебы медленно перетекают одного места другое обтекают мелкие пищевые час тицы одноклеточные водоросли бактерии др сторон те оказываются внутри цитоплазмы амебы образуются пищевари тельные вакуоли помощью пищеварительных ферментов пищевые частицы перевариваются внутри клеточное пищеварение жидкие продукты переваривания поступают эндоплазму непереваренные ос татки транспортируются поверх ности тела выбрасываются наружу мембрану клетки типичным представителем отряда является пресноводная амеба amoeba proteus рис 12 подобный способ захвата рис 12 амеба amoebaproteus захватываю щая пищу 1   захваченная псевдоподиями пищевая час тица 2   сократительная вакуоль 3   ядро 4   псевдоподии 5   эктоплазма 6   эндо плазма 7  пищеварительные вакуоли 3 6407 33 пищевых частиц помощью псевдоподий называют фагоцитозом наряду существует способ поступления жидких веществ те ло амебы   пиноцитоз внутрь цитоплазмы впячивается тонкий канал который засасывается капелька жидкости раство ренными органическими веществами образовавшаяся круг капельки вакуоль жидкостью отшнуровывается кана ла всасывания жидкости эта вакуоль прекращает свое суще ствование поддержания осмотического давления амеб особенно оби тающих пресных водах почве особый аппарат удаления лишков воды организма   сократительная вакуоль обычно сокра тительная вакуоль бывает одна реже две морских паразитических амеб сократительные вакуоли отсутствуют пульсируют очень ред ко помимо регулирования осмотического давления сократительные вакуоли участвуют процессах выделения продуктов обмена дыха ния обеспечивая организм кислородом окружающей воды амебам присуще бесполое размножение путем деления две клет ки несколько дочерних особей рис 13 неблагоприятных условиях амебы инцистируются выделяя вокруг тела плотную оболочку наступлении благоприятных условий среды цисты разрушаются амебы начинают вести активный образ жизни кишечнике позвоночных животных числе домашних живот ных человека обитает множество видов амеб принося вреда своим хо зяевам просто являясь квартирантами большая часть питается держимым кишечника числе бактериями entamoeba coli среди г рис 13 последовательные стадии бесполого размножения пресноводной корненожки eug lypha alveolata   корненожка делением б   образование цитоплазматической почки   деле ние ядра скелетные пластинки образуют новую раковину г   окончание деления одно ядер переместилось дочернюю особь 1   ядро 2  псевдоподии 34 iimi i тающих толстом кишечнике человека виды которые могут iiiiuti тяжелые заболевания например дизентерийная амеба е histoli i xhiiiio пищей служат бактерии раде случаев эта амеба мнникать слизистую оболочку кишечника питается размножа   н шшшая кровавый понос кишечный амебиаз симптомы заболева нии хожи симптомами дизентерии поэтому амебу называют дизен 1111и 11 м ой каловыми массами наружу выходит множество цист которые нишгимюе время остаются инвазионными сохраняют способность м п lino некоторые люди могут носителями дизентерийных амеб v пндставителей отрада раковинные амебы testacea тело заключено м ммшину образованную органическими рогоподобными веществами иммг1 немыми цитоплазмой зачастую такую раковину включены пес чиим1 другие посторонние частицы раковины имеют отверстие  устье н i м гиюго амебы вьщвигают псевдоподии раковинные голые амебы олимпом количестве населяют пресные водоемы сфагновые мхи почву учш туя процессах почвообразования благодаря своим микроскопиче i   размерам способны существовать тончайшем водном слое ок рулшощем частички почвы пересыхании почвы амебы инцистиру мhi виде цист могут переноситься ветром пылью значительные linn гоиния благоприятных условиях почвенные амебы быстро размно   i н делением надвое однадочерняя клетка остается материнской ра ¥ i пин 1с другая строит новую раковину увлажненных заболочен ных помпах наиболее многочисленны арцелла диффлюгия рис 14 ьолее сложно устроены обитатели морей отряда фораминиферы 1ihiiminifera которых раковина образуется веществ близких рис 15 форамииифера раковина сеть тончайших псевдоподий природе псевдохитину выделяемых эктоплазмой это самая многочис ленная разнообразная группа саркодовых встречающихся морях значительной глубине некоторых видов псевдохитиновые раковины инкрустированы песчинками других пропитаны углекислым кальцием рис 15 форма раковин разнообразна внутри имеют одну сколько сообщающихся камер которых находится тело корненожки кроме устья раковины имеется множество пор которые наружу выходят тончайшие нитевидные псевдоподии   ризоподии образующие   it  vi раковины сложную цитоплазматическую сеть помощью се m i прмсможки передвигаются питаются рис 16 пищей служат пц irpmi мелкие простейшие некоторые многоклеточные 1i п р д бесполым размножением фораминиферы размножаются ншииым путем сначала тело корненожки распадается множество нм1н1дых клеток которые покидают материнскую раковину растут niipa lyior вокруг новую раковину дочерние корненожки дают ипчнпо 1ругому поколению раковинных корненожек путем множест н деления образуют гаметы   мелкие клетки двумя жгутиками irpr i поры раковины одинаковые форме размерам гаметы выхо 14 1 н иоду попарно сливаются образуя зиготу которая дает начало   v поколению таким образом жизненном цикле фораминифер происходит чередование бесполого полового размножения 111ньшая часть фораминифер живет придонном слое морей океа нии нходя состав бентоса питаясь мелкими организмами немногие шин обладающие легкой раковиной входят состав планктона ii иерхних слоях морей живут саркодовые сложным внутренним   и1 класс радиолярии лучевики   radiolaria болынинст 11н i имеет округлой формы тело которого виде лучей отходят ммшочисленные тонкие псевдоподии рис 17 часто радиолярий im 17 радиолярия thalassophysapelagica центре видны крупное ядро центральная капсула 37 2 1 3 б рве 18 солнечник actinosphaerium eichhorni   общий вид 6   участок тела большом увеличении 1   эктоплазма 2   эндо плазма 3   пищевой комок 4   аксоподии 5   ядро цитоплазме находятся симбионты   водоросли снабжающие хозяина кислородом сами служащие пищей радиолярии размножаются простым делением путем образования мелких дочерних клеток зооспор известен также половой процесс класс солнечники heliozoa представлен морскими пресновод ными саркодовыми питающимися жгутиконосцами инфузориями коловратками захват пищи солнечников осуществляется спирально расположенными псевдоподиями виде лучей микротрубочками рис 18 некоторых солнечников имеется скелет пропитанный si0 2 множаются делением образуют зооспоры жгутиками тип апикомплексы apicomplexa тип насчитывает около 48 тыс видов исключительно паразитиче ских простейших среди которых паразитов животных человека основная масса этих простейших проходит особую фазу развития   спо ру которая служит перехода паразита одного хозяина другому ранее представителей типа объединяли другими паразити ческими группами простейших образующих споры миксоспоридия ми микроспоридиями которые настоящее время выделены само стоятельные типы апикомплексы отличаются свободноживущих простейших отсутствием органелл движения жгутики появляют ся стадии гамет жизненном цикле апикомплексов наблюдается чередование бес полого полового процессов хотя некоторых бесполое множение отсутствует бесполое размножение осуществляется путем 38 множественного деления   шизогонии результате образуются меротиты мерозоиты инфицируют здоровые клетки хозяина следующем новые поколения мерозоитов дают начало поколению ловых особей   гамонтов формирующих половые гаметы половой процесс протекает форме копуляции гамет которые оомыиинства апикомплексов различаются размерам т е образуются микро микрогаметы зигота одевается плотной оболочкой называ hvm ооцистой ооцисте начинается процесс спорогонии   образова ние множества спорозоитов которые находятся внутри спор покрытых олственной оболочкой образованием спорозоитов заканчивается ши ншшый цикл апикомплексов тпк м образом шизогония ведет увеличению числа паразитов тка мих хозяина спорогония способствует росту числа паразитов период расселения ввде ооцист спорами ооцисты споры покрьпы плот ными оболочками защищающими спорозоиты внешней среды жизненном цикле части споровиков происходит смена хозяев мсро юиты спорозоиты проникновения клетки хозяина имеют особый апикальный комплекс органелл переднем конце тела отсю дй i тзвание типа   апикомплексы представляющий собой упругую онириль которая проникает клетку хозяина растворения обо лочки клетки особым секретом синтезируемым паразитом тип апикомплексы делят класса перкинсеи perkinsea споровики sporozoea споровики характеризуются совершенным апикальным комплексом наличием отличие перкинсей полового процесса именно споровикам относится большинство опаснейших паразитов животных человека класс споровики sporozoea класс споровики включает отряда грегарины gregarinida кокцидии coccidia град грегарины насчитывает 500 видов   паразитов многих ore позвоночных животных основном насекомых кольчатых чер вей также водных моллюсков иглокожих паразитируют кишеч нике также полости тела гонадах тело кишечных грегарин дспено участка передний средний задний эпимерит прото мерит дейтомерит грегарины паразитирующие полости тела поповых органах обладают трехчленистостью тело червеобраз ной сферической формы грегарины   эндопаразиты характери tyiorch анаэробным бескислородным дыханием котором па рптикоген расщепляется выделением энергии используемой менных процессов тело грегарин одето плотной пелликулой питаются оипрофитно поглощая растворенные органические вещества всей верхностью клетки передней частью вооруженной крючочками паразит закрепляется стенке кишечника ядро находится задней части клетки длина ко торой достигать 16 мм длина самых мелких видов превышает 39 шизогония шизогония рис 19 схемы жизненных циклов споровиков   грегарины б   кокцидии   токсоплазмы г   малярийного плазмодия гм   га меты гц   гаметоциты з   зигота м   мерозоиты ооц   ооциста сз   сизигий сп   спорозоит спр   спора сп   спороциста ш   шизонт ц   цистозоит 15 мкм большинство грегарин размножаются половым путем лишь немногих представителей происходит смена полового бесполого поколений размножением грегарины паразитирующие кишечнике жукачернотелки рис 19 20 соединяются попарно це почку сизигий округляются покрываются общей плотной оболоч кой образуя цисту слияния грегарин внутри цисты исходит ядро каждой особи многократно делится каждой особи си 40 рис 20 схема развития грегарины i 1 пора спорозоитами 2   спорозоиты вышедшие споры 3   спорозоит внс нрикпцийся эпителиальную клетку 4 5   развитие спорозоита грегарине 6  эпи м1и117  протомерит 8   дейтомерит ии образуется множество гамет микрогаметы имеют жгутики i kmc i ii образовавшиеся разных особях одного сизигия попарно ко 11у пируют результате копуляции гамет образуется зигота которая ок  vие гея плотной оболочкой инцистируется превращаясь ооцисту in образом одной цисте заключено несколько ооцист цисты v ри которых находится множество ооцист выводятся тела хозя внешнюю среду это произойти смерти самого хо ти па дальнейшее развитие паразита происходит внешней среде присутствии кислорода внутри каждой ооцисты протекает процесс i пороюнии результате которого образуется восемь спорозоитов  i hi петы становятся инвазионными т е каждой цисте общей i н точкой находится множество инвазионных ооцист восемью споро н hi i ами каждая ооцисты заглатываются новым хозяином загрязнен ной пищей кишечнике хозяина спорозоиты покидают ооцисту вне i щ гея клетки кишечника развиваются затем разрывают мк1 вырастают взрослого паразита га ким образом особенность рассмотренного жизненного цикла i pci арины заключается внутри хозяина происходит половое размножение внешней среде   спорогония образова нием спорозоитов хозяин заражается потребляя пищу загрязненную цистами кишечнике нового хозяина оболочка цисты разрушается ще гноряются оболочки ооцист выходят спорозоиты отряд кокцидии coccidia отличие грегарин кокцидиеоб 1ппые основном внутриклеточные паразиты большинства происходит чередование полового бесполого размножения мак рш амета женская половая гамета яйцо образуется непосред i i пенно процессе роста гамонта гаметоцита деления мик 41 рогаметы образуются результате многочисленных делений гамон та образованием мелких мужских половых гамет спермиев наиболее опасны представители трех подотрядов эймериевые eimeriina кровяные споровики haemosporina пироплазмы piroplasmina кокцидии   внутриклеточные микроскопические паразиты имеющие овальную форму паразитирующие эпителиальных клет ках кишечника печени почек некоторых других органов позвоноч ных беспозвоночных животных кокцидий характерно правиль ное чередование полового бесполого размножения бесполое размно жение происходит форме множественного деления   шизогонии большинства кокцидий хозяин организме которого паразиты размножаются шизогонией спорогония протекает частично полностью внешней среде части кокцидий хозяина первом паразиты размножаются бесполым путем втором хозяине происхо дит половой процесс спорогония многие виды паразитических кокцидий рода eimeria приносят значительный ущерб животноводству паразитируя позвоноч ных животных кокцидии чаще поражают кроликов птиц разных видов рогатый скот наиболее подвержен заболеванию мо лодняк животных кокцидии паразитируют клетках кишечника зывают кровавый понос приводящий гибели большей части молод няка болезнь называется кокцидиозом особый ущерб наносит eimeria magna поражающая кроликов ор ганизм которых ооцисты паразита попадают загрязненными кормом водой рис 21 кишечнике кролика ооцист выходят спорозоиты которые внедряются клетки стенок кишечника этих клетках кок цидии растут размножаются бесполым путем посредством множест венного деления   шизогонии дочерние особи носят название меро зоитов мерозоиты пораженных клеток выходят просвет кишеч ника внедряются здоровые клетки растут снова размножаются шизогонией е magna развивается пять поколений мерозоитов следняя пятая генерация мерозоитов клетках кишечника преобра зуется гамонтов макрогамонты делятся дают начало макрогаме яйцам микрогамонты путем деления образуют множество вижных микрогамет двумя жгутиками спермии микрогаметы подвижны выходят просвет кишечника одна микрогамет никает макрогамете копулирует копуляции гамет разуется зигота зигота одевается прочной оболочкой превращается ооцисту которая выводится кишечника кролика испражнениями наружу внешней среде присутствии кислорода ооцисте проходит цесс спорогонии сначала образуется четыре споробласта которые крываются собственными оболочками превращаются споры ка ждой споре формируется спорозоита окончании спорого нии споры становятся инвазионными каждой инвазионной ооцисте содержится восемь спорозоитов такая ооциста попадает ки 42 v рве 21 жизненный цикл кокцидий рода eimeria i   мерное поколение шизогонии ii  второе поколение шизогонии iii третье поко мми  шиюгонии iv  гамогония v  спорогония 1   спорозоиты 2   одноядерный mwhit 3   многоядерный шизоит 4   образование мерозоитов 5   мерозоиты f   рашитие макрогамет 7   развитие микрогамет 8   ооциста 9 10   образование мпластов видно остаточное тело ii   образование спор 12  зрелая ооциста че ш ми спорами каждой которых имеется спорозоита 11114 кролика спорозоиты выходят споробластов ооцисты мячииаи новый цикл развития весь цикл развития паразита завер нмекси 7 8 сут происходит повторного заражения ор ivhhim кролика освобождается кокцидий именно поэтому важно прииимать меры исключению возможности повторной инвазии другого вида эймерии е stieda характерен цикл йитин организме кролика вид поражает клетки эпителия tttknit печени протекает несколько циклов бесполого размножения шмюгонией часто кролики одновременно поражаются двумя форма ми кокцидиоза   кишечным печеночным увеличивает тяжесть мболевания животных каждому сельскохозяйственному животному биойствен свой вид кокцидий кокцидиозом болеет ме 43 рис 22 токсоплазма   токсоплазмы возникшие результате продольного деления б   циклы развития токсоплазм разные способы заражения ими хозяев 1   кошкахозяин которой ходят шизогония стадии полового цикла 23 4   стадии развития ооцист каждой которых конечном счете развивается две споры четырьмя спорозоитами внутри 5 б   мышихозяева которых протекает дополнительное бесполое размножение 7  внутриутробное заражение мышей опасна кокцидия е tenella вызывающая опасное заболевание цы плят приводящее массовой гибели птицы болеют кокцидиозом те лята е ztimi е smithi карповые рыбы е carpelli примерно кокцидий жизненный цикл характерен токсоплазмы toxoplasma gondii вызывающей опасное заболева ние человека   токсоплазмоз однако жизненный цикл токсоплазмы усложнен сменой хозяев появлением некоторых особенностей множении рис 22 основным хозяином паразита являются кошки другие виды кошачьих кишечнике которых токсоплазмы растут размножаются сначала путем шизогонии половым путем образованием ооцист ооцисты испражнениями животного попадают внешнюю сре ду ооцистах происходит процесс спорогонии каждой образуют ся две споры четырьмя спорозоитами инвазионные ооцисты споро зоитами могут заглочены загрязненными пищей водой промежу точными хозяевами грызуны птицы кишечнике промежуточного хозяина ооцист спор выходят спорозоиты внедряются ткани проникают кровяное русло паразиты могут оседать любых тка нях числе мышцах размножаются бесполым путем это особая форма деления две дочерние особи образуются внут ри материнского организма возникают скопления паразитов ок руженные собственной общей оболочкой скопления токсоплазм промежуточном хозяине носят названия цист 44 поедании зараженной цистами мыши кишечнике кошки ток соплазмы выходят цист внедряются эпителиальные клетки ки i печника начинают новый жизненный цикл общении больной гоксоплазмозом кошкой также стать промежуточным хозяином особенно велика вероятность заражения детей играющих песочницах испражняются больные токсоплазмозом кошки человека токсоплазмоз протекает легкой тяжелой формах следнем случае возможен летальный исход таким образом особенностью токсоплазм является источ ником инвазии служат ооцисты ткани зараженного промежуточного хозяина содержащие цисты токсоплазм млекопи тающих токсоплазмы могут передаваться развивающемуся плоду плаценту это называемый врожденный токсоплазмоз данном случае плод обычно погибает подотряд кровяные споровики haemosporina представлен большой группой широко распространенных внутриклеточных паразитов кро ви часть жизненного цикла которых протекает эритроцитах млеко питающих птиц отличие кокцидий кровяных споровиков спорогония протекает внешней среде происходит организме кровососущих насекомых чаще комаров которые одно временно являются переносчиками паразитов этим паразитам носится возбудитель малярии являющийся бичом населения многих тропических субтропических стран человеке паразитируют четыре вида плазмодия род plasmodium жизненный цикл малярийного плазмодия plasmodium vivax типичен остальных видов заражается укусе комаром рода anophel который кровь человека вместе слюной вносит споро зоитов малярийного плазмодия рис 23 током крови спорозоиты достигают печени внедряются паренхимные клетки печени пре вращаются шизонтов дают первое поколение путем шизогонии вышедшие разрушенных клеток печени мерозоиты проникают кровь внедряются эритроциты снова делятся шизогонией вышедшие разрушенных эритроцитов мерозоиты образуется 10 20 мерозоитов одного шизонта снова внедряются здоровые эритроциты продолжительность одного этапа шизогонии специфична каж дого вида плазмодия pl malaria промежутки двумя последо вательными бесполыми размножениями составляют 72 ч поэтому болевание получило название 4дневной лихорадки наиболее широ ко распространенного вида pi vivax промежуток равен 48 ч это 3дневная лихорадка pi falciparum срок двумя размножениями шизогонией составляет около 48 ч промежутки двумя приступами лихорадки сокращаются 24 ч периода высокой пературы тела больного человека тропическая лихорадка вид плазмодия встречается лишь тропической африке   pl oval выход мерозоитов эритроцитов сопровождается приступами хорадки повышением температуры вместе мерозоитами 45 рис 23 жизненный цикл малярийного плазмодия рода plasmodium 1   спорозоит 23   рост шизоита агамонта 4   шизогония клетках печени 5   ме розоиты 67 8   шизогония эритроцитах 9 12   образование гамонтов микро макрогамонтов 13   образование макрогамет микрогамет 14   копуляция гамет 15   зигота оокинета 16 18   спорогония образование спороцисты спорозоита ми 19   накопление спорозоитов слюнных железах комара разрушенных эритроцитов кровь поступают продукты обмена пара зитов вызывающие интоксикацию человека нескольких циклов бесполого размножения шизогонией чинается подготовка половому процессу внедрившиеся эритроциты мерозоиты дают начало гамонтам шизонтам шизогонии образуются две группы гамонтов макрогамонты микрога монты дальнейшего развития гамонтов крови человека происхо дит становится носителем малярийного паразита комара напившегося крови больного малярией человека ки шечнике макрогамонта формируется женская макрогамета микрогамонта образуется четыре восемь мелких мужских микрога мет копуляции макро микрогамет образуется подвижная зи 46 i гп   оокинета оокинета внедряется стенку кишки комара внешней стороне полости тела комара оокинета преобразуется ооци i i v ооцисте происходит процесс спорогонии образованием множества i розоитов  500 особей стенки ооцисты разрушаются спорозоиты i ищают полость тела комара откуда проникают слюнные железы 1111 ротоки желез укусе человека комар слюной вводиг кровь че рп хоботок спорозоиты таким образом жизненном цикле малярийного плазмодия отсутствуют стадии развития протекающие внешней среде ому всем протяжении своего развития паразит имеет стадий ко i nil одевается защитными оболочками отличает кокцидий малярия широко распространена планете человека больного малярией наблюдается малокровие анемия интоксикация ор шиизма болезнь сопровождается приступами лихорадки кровяных i иоровиков мире погибло людей войнах пере носит мал ярию комары рола anophel основном a maculipenni ев ропе существует шесть видовдвойников малярийного комара кото рых ранее объединяли вид среди кровяных паразитов вызывающих тяжелые заболевания многих диких млекопитающих сельскохозяйственных животных г тдует отметить пироплазмы подотряд пироплазмы   piroplasmina li o микроскопические паразиты эритроцитов эритроцитах пиро иназмы размножаются бесполым путем образованием двух клеток паразиты разрушают гемоглобин который больныхжи иотных появляется моче этих паразитов протекает двух хозяевах млекопитающих содовых пастбищных клещах нападая больных пироплазмозом жиротных клещи вместе кровью получают клетки паразита кото рые размножаются теле клещей бесполым путем проникают тонные железы укусе кровососании клещи передают здоро imim млекопитающим пироплазм это заболевание широко распро странено многих странах пироплазмы пораженной самки клеща могут проникать яйца затем личинки те очередь пере шпот паразитов млекопитающим тип миксоспоридии myxozoa известно 870 видов миксоспоридий основном паразитов рыб малощетинковых червей конце своего жизненного цикла мик оепоридии образуют споры отличие споровиков споры мик осиоридий являются многоклеточными образованиями полярными капсулами каждой которых находится спиральная полярная нить кроме жизненный цикл миксоспоридий включает развитие пара iiit одноядерной фазы многоядерной многоядерная фаза заверша е ген образованием множества многоклеточных спор двуядерным аме шдным зародышем взрослым паразитам свойствен ядерный дуализм 47 миксоспоридий делят класса клас собственно миксоспо ридии myxosporea класс актиноспоридии actinosporea актино спорндни паразитируют малощетинковых червях характеризуются некоторыми особенностями строения спор миксоспоридии паразитируют преимущественно коже рыб тка невые паразиты результате рыб образуются желвакиопухоли этих опухолях находятся взрослые многоядерные плазмодии миксо споридий размеры паразитов колеблются микрометров двух сан тиметров ядра плазмодиев делятся вегетативные генеративные ядерный дуализм вегетативные ядра регулируют обменные процессы орга низме паразита генеративные ядра участвуют образовании спор формирование которых происходит внутри плазмодия вокруг каждо го генеративного ядра образуется обособленная генеративная клетка клетке ядро неоднократно делится образуется панспоробласт внутри панспоробласта формируются две споры споры миксоспоридий разнообразны форме являются многоклеточными образованиями полярными капсулами спора миксоспоридия myxobolus возбудителя шишечной болезни рыбыуса ча формируется шести клеток подтверждается наличием шести ядер рис 24 две клетки образуют две створки споры две другие   капсулы полярной нитью две оставшиеся   амебоидный зародыш больной рыбы споры попадают воду заглатываются рыбой кишечнике рыбы полярные капсулы выбрасываются нити вонзаются стенку кишки створки споры раскрываются амебоид ный двуядерный зародыш проникает эпителий кишки кровь кровяному руслу зародыши попадают кожу другие ткани органы рыбы сначала ядра зародыше сливаются зародыш ста рис 24 слизистые споровики   рыба пораженная споровиками б   споры 1   спора неразряженной капсулой 2   вид споры сбоку 3   спора разряженной капсулой 4   ядро амебоидного зароды ша 5   ядра клеток   образовательниц полярных капсул 6   стрекательная нить 7   ядра створок споры 8   амебоидный зародыш 48 i   лишенный цикл миксоспоридиев мухогоа i зародыш диплоидным i образование многоядерно м мидия вегетативными генера мцнимм ядрами 4   формирование н1 ннеративных клеток 5   мейоз    i ишании спор 6  сформиро pjnii mi пора двуядерным амебоидным mi 7   образование диплоид pit зародыше 8   выстрелива   1н цельных нитей споры liimiii шродыша теле рыбы пицц диплоидным затем яд 1й п ин гея зародыш превраща   многоядерный плазмодий   ниерным дуализмом   пни н плазмодии образуются i норм рис 25 миксоспоридии вызывают мйеюиую гибель многих рыб уплотненных   ги прудовых хозяйствах i той ущерб наносит форели миксоспоридия myxosoma cerebrali цирк пощая скелет рыбы заболевших мальков искривляется позво шик нарушается координация движений тип микроспоридии microspor 11 шестно около 800 видов микроспоридий которые являются внут ри неточными паразитами насекомых других беспозвоночных жи т м х очень немногие виды паразитируют позвоночных животных  i i дн самых мелких простейших организмов размеры состав нни 4 6 мкм шенный цикл микроспоридий также заканчивается образова н е м спор споры имеют иное строение споровиков ми 11 споридий микроспоридий спора является одноклеточным ш нжлнием котором имеется одно ядра одна ввернутая поляр iiih нить рис 26 микроспоридий отсутствует половой процесс ри 1множаются бесполым путем образуя цепочки клеток внутри пора i иной клетки хозяина n111 кроспоридия nosema api наносит серьезный ущерб пчеловодче i mi м хозяйствам пчелы заражаются заглатывая кормом споры плаз мшши кишечнике пчелы споры разбухают выстреливают свои иирные нити которые вонзаются стенку кишки насекомого спо 1407 49 ры каналу нити зародыш проникает внутрь кишечной клетки паразит размножается бесполым путем образуя цепочки клеток этих клеток затем формируются одноклеточные споры лярной нитью разрушения пора женной клетки споры попадают просвет кишки каловыми массами выводятся наружу больные нозематозом пчелы период зимовки пачкают соты калом од новременно загрязняя спорами поедании пчелами загрязненного спора ми меда происходит повторное зараже ние этих насекомых нозематозе блюдают большой отход пчел гибель се рис 26 спора микроспоридии мей 1   ядро 2   заряженная нить nosema bombyci патогенна гусени i тутового шелкопряда вызывая заболева ние пебрину самым нанося значительный ущерб шелководству микроспоридии которые являясь паразитами вредных насе комых используются биологической борьбе вредителями тип инфузории ресничные ciliophora инфузории отличаются наиболее сложной организацией среди од ноклеточных животных тело покрьгго пелликулой которая позво ляет иметь относительно постоянную форму пелликулой рас положена эктоплазма которой находятся многие органеллы чис ле базальные тельца ресничек рис 27 сократительные волоконца   мионемы защитные органеллы   трихоцисты раздражении инфу зории выбрасывают трихоцист множество упругих нитей которые поражают врага парализуя известно 75 тыс видов инфузорий населяющих моря пре сные водоемы входящих состав планктона бентоса детрита некото рые вицы обитают почве среди инфузорий хищных парази тических форм кишечнике жвачных животных обитают симбиотиче ские формы органеллами движения инфузорий служат многочисленные реснички подавляющее большинство этих животных облапает ресничками течение всей жизни реснички инфузорий своему строе нию сходны жгутиками ресничный аппарат весьма разнообразен особенно сложный ресничный аппарат расположен около рта вторым отличительным признаком представителей типа яв ляется присутствие теле двух ядер ядерный дуализм крупного ве гетативного ядра макронуклеуса значительно мелкого гене ративного ядра микронуклеуса 50 рис 27 инфузории 4 i усхлька б   трубач   брюхоресничная инфузория ползающая помощью утол щенных щетинок г   хищные инфузории колепсы напавшие другую инфузорию i нгрздний конец 2   пищеварительные вакуоли 3   микронуклеус 4   реснички i   точная глотка 6   удаленная порошицу непереваренная пища 7  сокра   икила  вакуоль 8 макронуклеус 9 трихоцисты 10 приводящие каналы сокра 1ии и1ной вакуоли мi югие инфузории обладают сложной системой пищеварения рас моможепный углублении тела перистоме рот цитостом окру  гн длинными ресничками помощью которых пищевые частички 1я1 пииются часто рот ведет глотку погруженную эндоплаз му i 1доплазме пищевые частицы окружаются пузырьками содержа 11ими пищеварительные ферменты результате образуются пищева рительные вакуоли пищеварительных вакуолях создается кислая аре последующих этапах переваривания пищи среда становится ночной аналогично процессам пищеварения высших живот ных непереваренные остатки пищи выбрасываются тела инфузо рии н определенном месте порошицу виды хищных инфу   й вооруженных ротовым хоботком помощью которого мныиают покровы своей жертвы большинство инфузорий питаются бактериями немногие поедают одноклеточные водоросли среди встречаются монофито ш1 хищные инфузории порой охотятся жертв которые разме рим хищниц это например инфузориятуфелька жертву поражают хоботком высасывают содержимое свободноживущие инфузории являются важным звеном пищевых цепях экосистем 51 пресноводных инфузорий имеются сократительные вакуоли полняющие функции осморегуляции выделения сократи тельные вакуоли усложнены несколькими приводящими каналами этих каналах накапливается избыток жидкости которая затем брасывается основной резервуар жидкость выталкивается пределы тела одноклеточного инфузории размножаются бесполым путем делясь надвое перечном направлении ядро делится помощью митоза ловой процесс виде конъюгации приводит увеличению числа особей конъюгации две размножающиеся особи соединяются парно соединением каждой особи разрушаются макронуклеусы микронуклеусы делятся мейотически образуя четыре гаплоидных ядра также разрушаются четвертое митотически делится ядра одно этих ядер остается клетке второе мигрирует другую особь такого обмена ядрами оставшееся клетке стационарное ядро сливается ядроммигрантом результате образуется диплоидное ядро затем конъюгирующие особи расходятся каждой особи расхождения диплоидного ядра формиру ется макронуклеус микронуклеус таким образом результате конъ югации каждой особи изменяется генотип классификации инфузорий качестве диагностических знаков используют особенности строения ротового аппарата структуру ресничного аппарата последний подход преобладает ин фузорий делят класса класс ресничные инфузории ciliata класс сосущие инфузории suctoria класс ресничные инфузории наиболее многочисленный представи тели класса покрыты ресничками протяжении стадий жизненного цикла среди представителей подкласса равноресничные инфузории holotricha характеризующихся равномерным располо жением теле ресничек равной длины свободноживущих пример инфузориятуфелька paramecium caudatum хищных питаю щихся своими собратьями паразитических форм среди последних следует отметить инфузорию балантидий balantidium coli которая встречается кишечнике свиней человека эта инфузория питается основном содержимым кишечника разрушать слизистую ки шечника вызывая заболевание   балантидиоз заражение происходит потреблении загрязненного цистами балантидия пищи воды природных водоемах прудовых хозяйствах занимающихся разведением рыб большой вред наносят паразитические инфузории например равноресничная инфузории ichthyophthirius внедряется кожу рыб начинает питаться клетками хозяина результате теле рыбы образуются многочисленные язвочки заболевание вести гибели рыб особенно молоди карпа жабрах коже часто па разитируют инфузории рода trichodina причиняя молоди рыб суще ственный вред большинства кругоресничных инфузорий подкласс кругорес ничные инфузории   peritricha реснички располагаются левоспи 52 рис 28 сидячие инфузории сувойки l j   деление сувойки 3   плавающая отделив  игн материнского организма клеткабро дкмхл 4  половой процесс риш вокруг предротовой ронки многие формы ведут прикреп ленный образ жизни сувойки vortfcella отр peritrichida имеют н н ы й сократимый стебелек мощью которого прикрепляются суос грату среди колониаль ные формы рис 28 спиральноресничных инфузорий подкласс спиральноресничные инфу зории   spirotricha полоса ресничек ведущих ко рту закручена впра ии среди этих одноклеточных особое место принадлежит инфузори мм живущим рубце жвачных животных отр entodiniomorpha т ло одето прочный панцирь многочисленными отростками рис 29 поэтому называют панцирными инфузориями питаются бактериями рубца способствуют расщеплению клетчатки кор ми взаимодействуя сложным образом целлюлозорасщепляющими оик гериями полезные симбионты участвуют перева риипнии пищи сами служат источником питания жвачных   потных 11ростейшие класса сосущие инфузории suctoria лишены ресни чек i in большей части жизненного цикла лишь ранних этапах пи гии дочерняя клетка   бродяжка имеет реснички рта околоротовой воронки инфузо рии шаровидным телом котором иидиально расположены щупальца рис 30 щупальца служат крепления субстрату кроме нплнются ловчим аппаратом поймав мелких инфузорий помощью липкого секрета суктории перекачива ют содержимое жертвы свое тело бесполом размножении ма ерииской клетки суктории отпочко пымнется дочерняя особь   бродяжка ги 24 инфузория желудка жвачного млекопи тающего i перепонки загоняющие пищу рот 2  кле follinit глотка 3   реснички 4   сократитель ные никуоли 53 рис 30 сосущая инфузория sphaerophrya высасы вающая щупальцами содержимое нескольких рес ничных инфузорий покрытая ресничками последующем теряет ресничный аппарат превра щается сукторию щупальцами следует отметить важную роль неко торых мелких видов инфузорий жгути коносцев амеб жизни почвы бакте рии числе азотфиксирующие служат основной пшцей простей ших однако поедают бактерий способствуют множению выделяя почву вещества стимулирующие процесс простейшие способствуют повышению плодородия почвы активно участвуют процессах биологической очистки водоемов имеется опыт искусственного разведения паразитических простей ших борьбы вредными насекомыми филогения экологическая радиация простейших мир живых существ делят надцарства безъядерные прокариоты procaryota ядерные эукариоты eucaryota клетки прокариот отличие клеток эукариот имеют оформленного ядра эукариот обычно делят царства расте ния vegetabilia planta грибы mycetalia fungi живот ные animalia zoa большинство растительных организмов   автотрофы самостоятельно синтезирующие органические вещест ва процессе фотосинтеза грибы хотя относятся гетеротроф ным организмам питаются растворенными органическими ве ществами животные являются гетеротрофами существующими счет потребления других организмов остатков различия типам питания этими царствами относительны имеется множество переходных форм особенно среди низших представителей простейших protozoa относят примитивным одноклеточным эукариотам признано эукариоты берут начало прокариот кос венным свидетельством единства служит сходство процессов синте белка клетке безъядерные организмы одними первых нашей планете часть способна существовать бескисло родной среде среди эукариотических животных клеточный уровень организации рассматривают примитивный это позволяет полагать стейшие земле появились первыми послужили началом слож 54 uttr форм   многоклеточным животным настоящее время простей существуют взаимодействии сложными организа ции многоклеточными организмами этому способствует бритсйшие процессе эволюции отлично приспособились разно лцмыным условиям жизни нашей планете полагают эукариоты произошли прокариот путем посте миного возникновения органелл мембраны клетки прокариот ниолюции эукариот видимому большую роль сыграл симбиоз яличных прокариот известных семи типов простейших четыре йлй представляют исключительно паразитические группы которые м1икли значительно позднее появления хозяев   высших рмотклеточных поэтому выяснении наиболее примитивной шумны среди простейших внимание уделяется таким типам свркомастигофоры инфузории i иi фузорий обычно относят самым высокоорганизованным одно ийгтчным животным представители чертами многоклеточно ти таким образом саркомастигофоры несут первичные емки имеющие сходство предками простейших саркомасти щфоры чрезвычайно неоднородны подтверждается особенностью ргпнизации подтипов саркодовые жгутиконосцы кольшинство исследователей придерживаются мнения пашера 1 914 жгутиковых следует относить древней группе общего одноклеточными растениями разнообразнее ти nm иитания аих органеллы движения имеются части прокариот предположить разнообразные способы питания жгути иопых могли стать основой последующего разделения авто фоп гетеротрофов следует отметить жгутики гамет ilozoa metazoa упрощенность отсутствие жгутиков пелликулы  ргннизации саркодовых отнести вторичным явлениям свя 1и переходом особому типу питания   фагоцитозу наличие жгу тиком гамет части саркодовых лишь свидетельствовать происхождении жгутиконосцев кроме последнее время показано некоторых амеб ростом происходит редукция жгути noh взрослых форм описано немало форм саркодовых обладающих иовидоподиями жгутиками одновременно таким образом предположить предками современных иго оа древние саркомастигофоры разными способами пита мим имеющие примитивные жгутики бесспорно apicomplexa ciliophora имеют родство жгу тиконосцами споровики могли упроститься связи переходом паразитическому образу жизни одновременно этим ус ложнился жизненный цикл который включает стадию гамет снаб женных жгутиками myxozoa microspora могли произойти древ саркодовых поскольку развитие начинается амебоидного иродыша гаметы жгутиками отсутствуют возможны вариан пнтономности эволюционного развития основе изложен ного выше материала представляется возможной филогенетическая 55 схема protozoa представленная рис 31 е 8 базе современных пред x ставлений обозначить ос w 10 новные пути экологической радиации одноклеточных вотных рис 32 центральном группой могли многочис ленные разнообразные предста вители саркомастигофор преобладанием жгутиковых форм господством водных форм следующем саркодовые утратили жгутики осуществили переход ползающему образу жизни пита нию путем фагоцитоза пиноцито примитивные бентосный образ жизни способ sarcomastigophora ствовал образованию защитных ра рис 31 филогения protozoa ковин разнообразной конструкции таких раковины корненожек фораминифер части саркодовых наружный скелет усложнился стал легким результате смогли перейти планктонному образу жизни радиолярии солнечники связи прогрессом клеточного строения возникают крупные лиэнергидные формы   инфузории активно передвигаются ве дут разнообразный образ жизни среди плавающие ползающие сидячие скважники позже возникают симбиотические затем пара зитические формы инфузорий последние поныне продолжают свое развитие усложняя совершенствуя отдельные этапы своего жизнен ного цикла многим простейшим основном обитающим пресных водо емах паразитирующим других организмах свойственно образова ние цист спор наступлении неблагоприятных условий высы хание вымерзание водоемов морских представителей инцисти рование является лишь исключением виде цист спор простейшие могут переноситься ветром птицами другими животными боль шие расстояния благодаря чему пресноводные простейшие встреча ются земной поверхности повсюду имеются условия су ществования пресноводные простейшие заселяют виды водоемов са мые мелкие лужи скопления воды образующиеся пазухах листьев растений множество болотах основном встречаются ра ковинные амебы составу фауны простейших относительно точно определить степень загрязнения водоема зависимости степени водоемы заселяют разные представители простейших состав меняется мере возрастания снижения степени загряз нения воды простейшие живут горячих источниках темпера 56 ш эндозообионты амебоидные эндофитобионты эндозообионты жгутиковые ресничные бентос эндозообионты планктон  лиобионть мовиннь1е интргаёентр5иййты элкoviqvitbl i           сидячйё            злиёионты                   эмфбйидиьье        j           рис 32 экологическая радиация простейших i i ушконосец 2   инфузория 3   радиолярия 4   раковинная амеба 5  форами ммфпш 6  амеба 7 сувойка 8  инфузория 9   лептомонас 10  кишечная амеба ii i различные паразитические простейшие i vniii поды 50 находят водоемах высоким уровнем емкости 25 наиболее разнообразен состав простейших морях океанах ю т огромных количествах толщу воды вместе одноклеточ ми водорослями простейшие служат кормом других животных him числе рыб китообразных раковинные саркодовые отмирая опускаются дно образуя мощнейшие донные отложения известняков подцарство многоклеточные животные metazoa многоклеточные характеризуются тело состоит множе ства клеток выполняющих организме разные функции отличие колониальных простейших теле многоклеточного организма клетки дифференцированы строению функциям утратили са мостоятельность являясь лишь частями сложного единого организма причине клетки многоклеточного животного приобретя различною рода специализацию способны независимому существованию жизненного цикла многоклеточных животных характерно сложное индивидуальное развитие   онтогенез процесс онтогенеза включает дробление зиготы множество бластомеров последующей дифференцировкой зародышевые листки зачатки органов витие рост образование взрослого организма увеличение размером тела многоклеточных отношению поверхности способствовало усложнению процессов обмена веществ очередь обеспе чило многоклеточным животным устойчивость жизненных процессов способствовало продлению жизни большинство ученых считают многоклеточные произошли protozoa пределах protozoa прослеживается тенденция перехода многоклеточности отдельных случаях protozoa наблюдается многоклеточность отдельных фаз развития миксоспоридии струк турные компоненты клеток protozoa идентичны таковым клеток metazoa важное значение решении вопроса происхождении мно гоклеточных многие исследователи приписывают колониальным стейшим например volvox которого имеются клетки двух типов   соматические половые 1874 г э геккель утверждал предком многоклеточных шаровидная колония какого простейшего процессе эволюции филогенеза счет впячивания одной половины шара мог ла возникнуть первичная кишечная полость первичный рот двухслойный организм плавал помощью жгутиков размножался половым путем впоследствии стал предком многоклеточных существует множество других теорий большая часть сходится одном отдаленными предками многоклеточных животных ко лониальные простейшие организмы 58 тип губки spongia ншчитмпают 5 тыс видов губок   наиболее примитивных milt мок неточных животных ведущих водный образ жизни преимуще нпенно морях океанах животные своим основанием непод нманп прикрепляются дну подводным предметам устьем мер i нем обращены кверху рис 33 форма тела губок разнообразна нмн могут иметь вид наростов веточек бокалов др это одиночные чище колониальные животные органы ткани слабо выраже ны нгрпнли система отсутствует тело построено многофункциональ ны   п г т межклеточного вещества губки двухслойные животные нчю состоит двух слоев клеток наружного дермального эктодер мн инурсннего   гастрального энтодерма гастральный слой высти нш1 инугреннюю парагастральную полость состоит называе   in ми  п шчковых клеток хоаноцитов имеющих жгутики м г жду дермальным гастральным слоями клеток имеется слой бес i      i vpnoro вещества мезоглеи котором разбросаны отдельные мм mi мезоглее формируется органический минеральный й i si2 скелет немногих представителей губок тело ос hmmt н mm ким минеральный скелет состоит мельчайших иглспикул hohipia юрмируются внутри особых скелетообразующих клеток   мроалнстов расположенных мезоглее роговой спонгиновый ске химическому составу близок шелку i loiiepxnoctb тела губок пронизана множеством пор которые миш поступает систему каналов камер движение воды обеспечива ем i ушки хоаноцитов каналов камер вода попадает централь ную иирагастральную полость откуда выводится наружу устье im ii тины строения губок различной сложностью системы каналов расположением жгутиковых камер л ш ш б сикон   лейкон 1   поры 2   жгутиковые камеры 3   устьестрел м м н   мно направление тока воды теле губки 59 специальные клетки пороциты способны сокращению могут открывать закрывать поры среди клеток находящихся мезоглее выделяются подвижные клетки амебоциты своим функциям универсальны выпол няют транспортную функцию выделяют вещество мезоглеи разуются половые клетки клетки других типов участвуют м бесполом размножении дают начало клеткам образующим скелет жи вотного переносят пищевые частицы хоаноцитов другим клеткам удаляют экскреты период размножения переносят спер мин мезоглее яйцеклеткам такие разнообразные функции амебо цитов характеризуют губок животных находящихся эволюци онной лестнице ниже прочих многоклеточных наиболее простой тип строения губок называют аскон рис 33 основном характерен одиночных форм молодых колониальных особей усложнение период индивидуального развития приводит воз никновению сложной формы   типу сикон дальнейшее усложне ние строения тела губок утолщается мезоглея образуются карманы ка меры покрытые слоем воротничковых клеток   хоаноцитов ведет са мому сложному типу   лейкон таким образом губок типа лейкон частично сикон парагастральная полость отличие типа аскон оказы вается выстланной клетками эктодермы ими выстланы приводящие отводящие лейкон каналы которые являются впячиваниями эктодер энтодермой выстланы лишь жгутиковые камеры число которых гу бок лейконового типа огромно   нескольких миллионов движение воды каналам тела губок обеспечивает организм ки слородом способствует удалению тела продуктов обмена водой тело губок попадают пищевые частицы мелкие водные животные растительные организмы гниющие остатки которые захватываются псевдоподиями хоаноцитов перевариваются цитоплазме часть захваченной пищи передается амебоцитам те переваривают транспортируют питательные вещества мезоглею таким образом губкам свойственно внутриклеточное пищеварение парагастральной полости пища переваривается эта полость служит лишь сбора эвакуации поступившей организм губки воды существенное значе ние питании губок имеет также поглощение растворенных органиче ских веществ осмотическим путем губкам свойственно бесполое половое размножение среди раздельнополые виды большинство губок   гермафродиты бесполое размножение осуществляется наружным почкованием образованием особых внутренних почек   геммул бесполое множение носит характер почкования полное отделение почки исходит редко основном одиночных форм обычно дочерние осо би сохраняют связь материнским организмом результате обра зуются разрастаются колонии границы отдельными особями могут исчезать вся колония сливается общую массу рис 34 геммулы виде групп клеток окруженных оболочками содержа щих запас питательных веществ образуются мезоглее образова 60 рис 34 различные виды губок   бадяга б   стеклянные губки представляют собой покоящиеся зимние почки например pr овод ная губка бадяга летом размножается обычным почкованием н половым путем осени мезоглее бадяги амебоциты образуют шаровидные геммулы зимой тело бадяги умирает распадается гем мулы остаются дне перезимовывают весной содержащаяся внут ри ггммул клеточная масса выползает прикрепляется субстрату ршиинается новую губку геммулы выполняют также функцию рас i рмгиин период весеннего разлива переносятся течени ем мри пересыхании водоемов геммулы могут переноситься ветром 11оловое размножение губок происходит путем образования мезо i нгг ит амебоцитов яйцеклеток спермиев спермин выносятся ш п канальцев водой парагастральной полости   внешнюю ирлу устье оскулюм током воды спермин попадают тело i уок меющей зрелые яйцеклетки проникают мезоглею сливают i н i ними те оплодотворение губок перекрестное ii материнском организме зиготы развивается личинка покры iiim ресничками личинка выходит наружу активно плавает перемеща мн  течением воды значительные расстояния затем опускается ммо прикрепляется субстрату превращается губку 61 наиболее разнообразны многочисленны губки тропических субтропических морей встречаются губки небольших глубинах предпочитая каменистое дно часто сожительствуют другими ор ганизмами вступая ними симбиотические отношения различного типа колониях губок обнаружить кольчатых червей ракооб разных иглокожих других животных губки часто селятся подвиж ных животных крабах брюхоногих моллюсках внутри клеток пре сноводных губок качестве симбионтов часто живут одноклеточные зеленые водоросли которые обеспечивают губок кислородом могут также служить губкам пищей россии встречается около 20 видов пресноводных губок которых большинство обитает озере байкал наиболее типична наших реках бадяга spongilla lacustri сверлящие губки род cliona селятся известковом субстрате   раковинах моллюсков колониях кораллов известняках живут свер лящие губки отверстиях которые делают растворяя известь осо бым секретом наружу выступают выросты тела устьями практическое значение губок основном сводится биологической фильтрации воды взвешенных минеральных органических веществ несмотря небольшие размеры нескольких миллиметров 15 м губки пропускают огромное количество воды одна губка ба дяга размером 5 7 см сутки профильтровывает около 3 л воды губок признаков примитивности организации отсут ствуют настоящие дифференцированные ткани органы клеточ ных элементов характерна высокая пластичность т п губки способ ны регенерации удалении отдельных участков тела происходит восстановление измельченную губку просеять сито образовавшаяся масса отдельных клеток групп способна вос становлению целого организма клетки кашицы активно двигаются собираются вместе последующем скопления клеток форми руется маленькая губка процесс формирования организма скопления клеток называют соматическим эмбриогенезом губки   древние организмы отделение губок ствола многокле точных произошло очень давно существует мнение губки могли произойти колониальных воротничковых жгутиконосцев независимо прочих многоклеточных менее обоснована гипотеза клеточные произошли общим стволом которого одними первых отделились губки вторая гипотеза представляется обоснованной ибо личинки губок сходны личинками планулами кишечнополостных тип кишечнополостные coelenterata общая характеристика тип объединяет 10 тыс видов прими тивных многоклеточных животных ведущих исключительно водный жизни обитающих основном морях часть ведут свобод ноплавающий образ жизни другие   сидячий прикрепленный дну 62 кишечнополостным свойственна радиальная симметрия свя зано образом жизни сидячих форм полюс тела обычно слу жит прикрепления субстрату другом имеется рот многие орга ны получают одинаковое развитие приводит радиальной симмет рии кишечнополостные   двухслойные животные формируются зародышевых листка   эктодерма энтодерма этими листками находится первичная полость тела заполненная мезоглеей которая одних представителей имеет вид пластинки других   это большая масса студенистого вещества простом случае тело кишечнополостных имеет вид открытого одном конце мешка кишечной гастральной полости которого стланной клетками энтодермы происходит переваривание пищи верстие служит кишечнополостных ртом оно окружено венцом щупалец помогающих захватывать пищевые частицы анальное верстие отсутствует непереваренные остатки пищи выбрасываются ротовое отверстие таким образом заключить просто устроенные кишечнополостные сводятся типичной гаструле схеме строения наиболее близки сидячие формы   полипы широко распространенные среди кишечнополостных свободноживущие фор имеют уплощенное тело это медузы которые активно пассивно течениями передвигаются водной среде тело медуз имеет вид зрачного студенистого зонтика рот расположенный посередине ниж стороны купола окруженный предротовыми лопастями ведет ишечную полость которой отходят радиальные каналы океаниче ские медузы достигают двух метров диаметре деление кишечнополостных полипы медузы чисто морфоло гическое поскольку вид кишечнополостных разных стадиях жизненного цикла иметь строение медузы полипа медузы   обычно одиночные свободноживущие животные полипы своем большинстве   колониальные формы начиная одиночный организм полип путем неполного почкования образу ет колонии насчитывающие тысячи особей кишечнополостных характерно наличие стрекательных клеток служащих добывания пищи защиты размножаются кишечнополостные бесполым почкованием повым путем многих форм наблюдается чередование поко лений бесполое поколение полипов сменяется половым поколением медуз строение жизненные отправления покровы кишечнополостных образованы однослойным эпителием эктодермального происхожде нии эпителии располагаются узкоспециализированные клеточные элементы это эпителиальномускульные клетки содержащие мио фибриллы которые обеспечивают укорочение тела полипа всей поверхности тела особенно густо щупальцах вокруг рта разбро саны чувствительные клетки выполняющие функции рецепторов мое принимающих сигналы внешней среды характерны покровах кишечнополостных стрекательные клетки основном расположен 63 ные щупальцах рис 35 внутри каж дой клетки имеется капсула спи рально закрученной полой нитью прикоснуться чувствительному волоску клетки стрекательная нить выворачива ется выбрасывается наружу вооружен ная шипиками нить вонзается тело жертвы удерживается ранке вводя ядовитый секрет парализую щий мелкую добычу крупных живот ных секрет вызывает ожоги стрека тельные клетки   одноразовое оружие месте сработавших клеток образуются рис 35 стрекательные клетки новые покровах кишечнополо гидры hydra olidacti стных имеются особые клетки которые   покоящемся состоянии б   выброшенной нитью могут превращаться стрекательные ловые чувствительные другие нервная система полипов представ лена нервным сплетением диффузного типа образованным звездчатыми нервными клетками соединенными своими отростками нервное сплетение лежит покровным эпите лием свободноживущих медуз нервная система сложнее это нервное кольцо располагающееся краю купола скопления нервных клеток вокруг глазков статоцистов органы чувств примитивны развиты медуз статоцисты глазки чувствительные клетки имеются покровах тела особенно щупальцах вокруг ротового отверстия мускулатура полипов форма тела меняется результате действия эпителиальномышечных клеток имеющих миофибриллы медуз движение обеспечивается специальными мышечными волокнами легающими мезоглее краям купола коралловых полипов дольные поперечные мышечные волокна находятся перегородках кишечной полости органы пищеварения гидр близких форм ротовое отверстие открывается непосредственно кишечную гастральную полость большинства видов рот ведет эктодермальную глотку затем кишечник коралловых полипов увеличения всасывающей верхности кишечную полость вдаются радиально расположенные продольные перегородки медуз кишечной полости внугрь купола отходят радиальные каналы впадающие кольцевой канал кишечная полость медуз продолжается полости щупалец кишечная полость кишечнополостных выстлана однослойным энтодермальным эпителием клетки которого имеют жгутики служа щие перемещения пищевых частиц особые железистые клет ки некоторые клетки эпителия образуют псевдоподии захватываю щие частицы пищи одновременно внутриклеточным пищеварением кишечнополостных частично происходит полостное переваривание 64 кишечной полости помощью пищеварительных ферментов выра батываемых железистыми клетками кишечного эпителия гидроид ных полипов существуют две фазы переваривания пищи сначала заглатывают крупный комок пищи целое животное которое начи нает перевариваться гастральной полости затем мелкие частицы лупереваренной пищи попадают внутрь эпителиальномускульных пи щеварительных клеток происходит внутриклеточное пищеваре ние непереваренные остатки выбрасываются рот наружу органы дыхания кишечнополостных отсутствуют газообмен осу ществляется покровы тела выделительная система продукты обмена вода диоксид углерода мочевина мочевая кислота аммиак др выделяются эпители альный слой эктодермы энтодермы размножение большинство кишечнополостных   раздельнополые животные гермафродиты гидроидных половые продукты образуются эктодерме остальных представителей образование происходит энтодерме оплодотворение одних видов наружное воде других   внутреннее теле женских особей проникают спермии обычно развитие происходит стадией личинки планулы покрытой ресничками позволяющими плануле плавать пресновод ных гидр развитие прямое тип кишечнополостные делят класса гидроидные hydro zoa сцифоидные медузы scyphozoa коралловые полипы anthozoa класс гидроидные hydrozoa низший класс кишечнополостных состоящий примерно 4 тыс видов гидроидные представлены разнообразными одиночными ко лониальными формами населяющими преимущественно моря океа ны имеются пресноводные представители отличие сцифоид ных медуз коралловых полипов полипы медузы которые принад лежат классу hydrozoa называются гидроидными гидроидных отсутствует глотка стенки кишечной полости имеют продольных перегородок половые продукты образуются эктодерме наиболее типичными пресных вод являются различные виды гидр hydra ведущие одиночный образ жизни полипа рис 36 это небольшие животные высотой 1 2 см расширенным основанием котором удерживаются субстрате ротовое отверстие окружено венчиком 6  12 щупалец широкое тело переходит стебель мезоглея имеет вид тонкой опорной пластинки которой разбросаны нервные эпителиальномускульные промежуточные клетки следних необходимости формируются половые стрекательные другие клетки нервная система гидры имеет диффузный характер хо тя вокруг рта подошве находятся небольшие скопления нервных клеток эпителиальномускульные клетки могут образовывать псевдо подии поэтому способны фагоцитозу 6407 65 рис 36 пресноводная гидра hydra olidacti   общий вид б   продольный разрез 7   тело 2   подошва 3   щупальца 4   рот 5  почки 6   кишечная полость 7  энтодерма 8  эктодерма 9  опорная пластинка   мезоглея 10   семенники 11   образование яйца обитают гидры пресных водоемах стоячей малоподвижной водой гидры могут медленно передвигаться счет скольжения дошвы субстрату  кувырканием  головной конец пита ются мелкими ракообразными инфузориями коловратками други ми планктонными животными улавливая добычу щупальцами воору женными стрекательными клетками размножаются гидроидные почкованием половым путем мерно середине тела гидры имеется пояс почкования дочерние ор ганизмы отпочковываются начинают самостоятельную тече ние лета осенью гидры размножаются половым путем верхности тела появляются особые выпуклости несколько семенников яичника каждом которых образуется одна яй цеклетка гидры раздельнополы гермафродиты последнем случае семенники теле гидры образуются выше яичников спермин выходят воду проникают яйцеклетку особи перекрестное оплодотворение гермафродитных форм достигается разным време нем созревания спермиев яйцеклеток сначала развитие зиготы исходит яичнике затем зародыш покрывается оболочками падает дно зимует таком состоянии зародыш переносить промер зание высыхание водоема весной перезимовавшего зародыша растает гидра таким образом пресноводных гидр развитие прямое 66 гидры способны регенерации части тела восстанавлива ется весь организм среди обитателей морских вод подавляющее большинство гидро идных являются колониальными формами сложным жизненным циклом рис 37 колонии образуются путем многократного неполно го почкования результате получается комплекс особей сидящих общем стволе побочных ветвях поэтому колония обычно напо минает бурые наросты мха кустик ветвях которого сидят дельные особи колонии   гидранты похожие строению гидру кишечные полости гидрантов сообщаются собой т е пища колонии распределяться всей колонии обеспечивает выживание устойчивости прочности счет выделений эктодер мального эпителия полипы образуют органическую оболочку   теку одевающую общий ствол отдельных гидрантов размножение гидроидных полипов включает чередование бесполо го поколения ведущего прикрепленный образ жизни полового коления   свободноплавающих гидроидных медуз гидромедуз са мих гидрантах колонии половые железы образуются периодически веточках колонии гидроидных полипов образуются особые почки б рис 37 гидроид obelia i колония слегка увеличено б   отдельная веточка колонии несколько схематизи романо часть особой колонии изображена разрезе 1   гидрант расправленном 1 гоянии 2   сократившийся гидрант 3   тека 4  почка 5  бластостиль развиваю щимися медузами 6  гидротека 7  гонотека участок теки одевающий бластостиль 67 дающие начало половым особям   мелким гидроидным медузам ме дузы отрываются материнской колонии свободно плавают гидроид ные медузы растут развиваются половые клетки медузы раздель нополы гидроидные медузы устроены значительно сложнее гидро идные полипы медуз имеется нервное кольцо статоцисты глазки т п медузы ведут хищный образ жизни захватывая убивая щупальцами мелких животных проглатывая переваривая желудке созре вания половые клетки выходят воду копулируют копуляции гамет образуются личинки планулы которые сво бодно плавают воде помощью многочисленных ресничек которое время планулы опускаются дно прикрепляются субстрату превращаются неподвижных полипов которые дают начало новым колониям класс сцифоидные медузы scyphozoa класс насчитывающий около 200 видов представлен крупными мелкими морскими медузами большая часть жизненного цикла проходит форме плавающих медуз немногие формы ведут прикреп ленный образ жизни фаза полипа кратковременна отсут ствовать тело сцифоидных медуз имеет форму зонта купола т п рис 38 строение нервной мускульной пищеварительной систем рис 38 сцифоидные медузы   медуза корнерот б схема строения аурелии 7   рот 2   ропалий 3   ротовые ло пасти 4  кольцевой канал 5  радиальные каналы б щупальца 7 половые железы 68 рис 39 схема развития сцифоидной медузы аурелии aurelia aurita   личинка планула 2   полип сцифистома 34   стадии почкования сцифистомы 5   отделение сцифистомы личинок эфир 6  молодая медузаэфира 7  взрослая медуза этих медуз сложное мезоглее купола имеются мышечные локна обеспечивающие сжатие купола сцифоидные медузы отлича ются большими размерами тела отсутствием специаль ного паруса тонкой мускулистой перепонки суживающей кромки ко локола играющего важную роль передвижении гидроидных медузок кишечная полость имеет радиальные складки радиальные каналы впадающие кольцевой канал центральной частью пищева рительного аппарата является желудок которого отходит большое число разветвленных канальцев выполняющих функции переноса пи тательных веществ теле медуз предротовые лопасти имеют многочисленные осязательные стре кательные клетки краю зонтика расположены скопления нервных клеток   ганглии органы чувств сосредоточены укороченных щу пальцах   ропалиях внутри ропалии находится статоцист бокам   глазка выполняющих светочувствительные функции щупальцах имеются обонятельные ямки   органы химического чувства большинстве своем медузы раздельнополы половые продукты разуются энтодерме половые железы находятся стенках желудка ловые клетки выходят рот воду происходит копуляция муж ских женских гамет оплодотворенных яиц развиваются микроско пических размеров личинки   планулы плавают помощью ресничек затем опускаются дно прикрепляются субстрату пре вращаются мелкие одиночные бокаловидной формы полипы   сцифи стомы мере роста сцифистомы теле появляются поперечные пе ретяжки деля полип ряд дисков   медуз эфиры каждая эфира деляется сцифистомы растет превращается свободноплавающую взрослую медузу таким образом развитие сцифоидных медуз пря мое происходит стадии планулы сцифистомы рис 39 69 класс коралловые полипы anthozoa класс включает одну древнейших групп морских животных   полипов которые превосходят гидроидных полипов размерам отличаются сложным строением это одиноч ные большей частью колониальные полипы одной особенно стей которых является отсутствие жизненном цикле стадии медузы рис 40 т е чередования поколений это наиболее круп ный класс кишечнополостных включающий 6 тыс видов оби тающих теплых тропических морях температурой воды ниже 20 ° глубинах 50 м ротовое отверстие коралловых полипов окружено венчиком щупа лец число которых одних полипов равно восьми восьмилучевые ко раллы других   шести шестилучевые кораллы пищевые частицы рот попадают сначала сплющенную боков эктодермальную глотку оттуда   развитую пере городками септами кишечную полость число перегородок либо восемь либо шесть кратно шести   числу щупалец глотке клетки длинными ресничками которые непрерывно гонят воду внутрь гастральной полости полипа откуда вода выводит ся наружу обеспечивается постоянная смена воды септы обра зованы мезоглеей выстланной энтодермой рис 41 нижней части полипа септы прикреплены стенке тела результате центральная часть гастральной полости желудок остается неразде ленной рис 40 ветка колонии красного коралла   полипы 2   кора ветки 3   осевой скелет 70 рис 41 схематическое изображение строения кораллового полипа alcyonium   щупальце 2 ротовое отверстие 3  глот ка 4   перегородки кишечной полости   сеп 5   мезентериальные нити 6   яйца колониальных полипов мощ ный скелет чаще представлен углекислыми солями реже   рого подобным веществом скелет наружным внутренним коралловые полипы размножа ются бесполым половым путем ведущие одиночный образ жизни актинии размножаются де лением колониальных видов блюдается почкование половые железы формируются перегород ках энтодермой мезоглеей спермин выходят ротовое нерстие наружу рот проникают гастральную полость жен ской особи происходит оплодотворение некоторых форм оп нодотворение наружное развитие происходит метаморфозом зиготы развивается плавающая личинка   планула которая прикреп ляется субстрату дает начало новому полипу актинии   одиночные шестилучевые яркоокрашенные полипы лишенные скелета рис 42 могут медленно передвигаться мощью мускулистой подошвы актинии очень чувствительны дражениям сильно сокращаются превращаясь небольшой комок это хищники питающиеся ракооб разными моллюсками другими крупными животными которых захватывают щупальцами па рализуя стрекательными нитями некоторые актинии живут сим биозе ракамиотшельниками селяясь раковинах рак служит актиний средством передвиже ния актинии пассивно защищают рака хищников тропиках распространены ри фообразующие мадрепоровые шес рис 42 актиния раковине занятой ра комотшельником 71 тилучевые кораллы характеризующиеся крупными размерами   4 м высотой это требовательные температуре воды солености около 35 солей животные очень чувствительны коралловые поли пы загрязнению воды коралловые рифы служат местом обитания мно гих морских организмов животные растения коралловых рифах разуют своеобразное сообщество биоценоз рифа клетках энтодермы коралловых полипов живут симбиотические одноклеточные водоросли   зооксантеллы кораллы снабжают водоросли диоксидом углерода пре доставляют укрьггие зооксантелл кораллы получают кислород продукты фотосинтеза которые поступают непосредственно клеток водорослей умирающие водоросли перевариваются цитоплазме поли пов такого сложного симбиоза коралловые полипы погибают рифы условно делят типа береговые барьерные атоллы береговые расположены непосредственно берегам островов ма териков барьерные рифы располагаются параллельно береговой нии некотором расстоянии атоллы   это кольцеобразные возвы шающиеся океаном коралловые острова озерцом внутри значение кишечнополостных мировом океане трудно переоце нить помощью осуществляется круговорот кальция биосфере очищают морскую воду органической взвеси являются звенья ми пищевых цепях т п кишечнополостные служат объектом мысла медузы япония китай кораллы украшений коллекций ювелирных изделий медицинских препаратов рис 43 экологическая радиация кишечнополостных 1   гидроидный полип 2  морской колониальный полип 3   гидромедуза 4   сифо нофора 5   плавающий полип 6  одиночный коралловый полип 7  колониальный коралловый полип 8   сидячая медуза 9  сцифоидная медуза 72 филогения кишечнополостных кишечнополостные   древняя группа примитивных животных счи тается далекими предками кишечнополостных двухслойные плавающие многоклеточные животные похожие планулу видимо первыми одиночные полипы полипов перегородок разви вались различные группы гидроидных коралловые полипы процессе эволюции дали широкий спектр полипоидных форм одиночных коло ниальных скелетом сохранили древний знак развития метагенеза основные пути морфоэкологической эво люции отражены схеме радиации жизненных форм рис 43 тип гребневики ctenophora гребневики   это морские животные характеризующиеся радиаль ной симметрией ведут одиночный свободноплавающий образ жизни реже встречаются ползающие сидячие формы известно около 120 видов гребневиков заселяющих моря питаются жи вотные обычно планктоном форма прозрачного нежного тела мешковидная грушевидная рис 44 вдоль тела тянутся восемь рядов тонких прозрачных греб ных пластинок образованных сросшимися ресничками пластинки рис 44 гребневики   плавающий гребневик bolinopsi б   ползающий гребневик coeloplana   схема строения гребневика 1   ряды гребных пластинок 2  щупальца 3   орган равновесия     рот 5 глотка б кишечная полость 7 кишечные каналы отходящие желудка   продольные кишечные каналы 9  влагалище щупальца 10  органы чувств 73 расщеплены наподобие гребешка бьют воде одном направлении позволяет гребневикам двигаться одном направлении   ротовым концом тела вперед многие гребневики имеют пару щупалец расположенными особыми клетками вырабатывающими лип кий секрет помощью этих щупалец гребневики захватывают разных животных которыми питаются рот расположенный оральном конце тела ведет глотку кото рая переходит короткий пищевод затем кишечную полость ки шечная полость имеет разветвленные каналы слепые отростки это двухслойные животные снаружи тело покрыто эктодермой кишеч ная полость каналы выстланы энтодермальным эпителием экто энтодермой лежит студенистая прозрачная мезоглея наличие мезоглее многочисленных клеточных элементов отсутствие стрека тельных клеток отличает гребневиков кишечнополостных гребневики   гермафродиты половые железы расположены стен ках пищеварительных каналов половые клетки выходят просвет ки шечных каналов оттуда рот наружу оплодотворение наружное развивающемся эмбрионе происходит образование зачаточного третьего зародышевого листка   мезодермы развитие метаморфоза тип плоские черви plathelminth общая характеристика большинство представителей типа имеют двустороннесимметричное тело такая симметрия впервые является группы животных тело обычно уплощено виде лис та вытянуто длину виде ленты плоских червей процессе онтогенеза формируются зародышевых листка эктодермой энтодермой развивается промежуточный третий зародышевый лис ток мезодерма насчитывают около 15 тыс видов плоских червей которых большинство являются наружными внутренними парази тами животных человека часть червей живут морях пресных водо емах почве совокупность кожного эпителия подстилающей мускулатуры образует кожномускульный мешок свободноживущих форм кожный эпителий имеет реснички кожей залегает несколько слоев мышц кольцевые диагональные продольные позволяет червям совер шать разнообразные движения паразитических червей тело покрыто тегументом   сложным цитоплазматическим образованием плоские черви имеют полости тела бесполостные поскольку простран ство внутренними органами стенкой тела заполнено рыхло расположенными клетками мезодермального происхождения   па ренхимой паренхиматозные черви промежутках клетками паренхимы циркулирует межтканевая жидкость паренхима выполня ет опорные функции накапливаются резервные питательные ве щества участвует процессах обмена веществ 74 пищеварительный канал примитивен обычно разветвлен пред ставлен двумя отделами эктодермальной глоткой передняя кишка энтодермальной средней кишкой которая заканчивается слепо зад кишки анального отверстия части паразитических форм кишечник отсутствует нервная система представлена парным мозговым ганглием отходя щими несколькими парами нервных стволов идущих назад единенных собой кольцевыми перемычками   комиссурами та ким образом плоских червей формируется центральный аппарат 11 ервной системы органы чувств наиболее развиты свободноживущих видов имеются глазки органы равновесия   статоцисты многочис ленные сенсиллы осязательные клетки органы химического чувства кровеносная дыхательная системы отсутствуют свободноживу щие плоские черви дышат кожу эндопаразитических форм характерно анаэробное дыхание плоских червей появляются органы выделения построенные типу протонефридиев виде системы разветвленных канальцев оканчиваю щихся паренхиме звездчатыми клетками пучком ресничек внутри реснички способствуют откачке конечных продуктов обмена парен химы магистральных канала затем специальные выделительные отверстия экскреторные поры выводу этих продуктов наружу плоские черви большинстве своем гермафродиты половая сис тема устроена сложно обеспечивает внутреннее оплодотворение высокую плодовитость развитие прямым метамор фозом эндопаразитам присущи сложные жизненные циклы чередо ванием обоеполого нескольких партеногенетических поколений типу плоских червей относят десять классов которых шесть   исключительно паразитические наиболее многочисленными являют ся четыре класса ресничные черви turbellaria дигенетические сальщики trematoda моногенетические сосальщики monogenea ленточные черви цестоды cestoda считается плоские черви произошли древних кишечнополо гпых которые перешли передвижению дну могли вести хищнический образ жизни сначала основой движения служили i сспички постепенно главенствующая роль перешла мускулатуре гена активный образ жизни позволил турбелляриям усложнить систе mii органов турбеллярий позднее произошли паразитические фор плоских червей класс ресничные черви turbellaria классу ресничных червей относится большая группа около t i тыс видов свободноживущих воде почве плоских червей гсио которых расчленено покрыто мерцательным ресничным мштелием турбеллярии   хищники переднем конце тела рес н ч н ы х червей имеется несколько примитивных глазков болыпин 75 рис 45 виды ресничных червей   молочная планария dendrocoelum lacteum 6   морская турбеллярия leptoplana   планария многоглазка polyco cornuta ства представителей рот расположен посередине тела брюшной стороне строение жизненные отправления длина тела колебаться долей миллиметра 35 см форма тела уплощена чрезвычайно нообразна морские турбеллярии ярко окрашены рис 45 покровы представлены ресничным однослойным эпителием рес нички способствуют передвижению мелких червей воде крупные представители ползают вытягивая сокращая изгибая тело кожном эпителии располагаются особые палочковидные образова ния   рабдиты выполняющие защитные функции выбрасываясь ружу окутывают врага рыхлой клейкой оболочкой покровах ресничных червей железистых клеток одни которых выделя ют слизь другие   ядовитые вещества молочная планария 76 крывает жертву своим телом убивает ядом который вырабатывают ядовитые железы находящиеся брюшной стороне тела червя нервная система разных представителей различна своей слож ности примитивных форм диффузного типа виды кото рых вдоль тела идет несколько нервных тяжей сложно органи зованных имеются ганглии продольными нервными тяжами органы чувств представлены примитивными глазками статоцистами осяза тельными клетками органы пищеварения большинства видов брюшной стороне средней части расположен рот ведущий глотку которая пячиваться наружу присасываться жертве высасывать содержи мое кишечник чаще ветвится две ветвей заканчиваю щихся слепо пища переваривается полости кишечника помощью фагоцитоза внутриклеточно клетках эпителия кишечной полости непереваренные остатки пищи выбрасываются наружу рот которых ресничных червей кишечник отсутствует пища переварива ется пищеварительных вакуолях клеток расположенных специаль обособленной пищеварительной паренхиме газообмен осуществляется путем диффузии кислорода воды покровы внутрь тела диоксида улерода   наружу выделительная система протонефридиального типа рис 46 дельная система органов впервые появляется ресничных червей многих морских червей органов выделения продукты обмена уда ляются тела покровы стенки кишечника органы размножения устроены сложно большая часть ресничных червей гермафродиты мужская половая система представлена множе рис 46 нервная система органы пищеварения выделения плана рии   пищеварительная нервная системы б   расположение глав ных канальцев выделительной системы   одна концевых клеток протонефридиальной сис темы   рот 2   глотка 3   пе редняя ветвь кишечника 45   шдние ветви кишечника 6   го ловной нервный узел 7 боковой нервный ствол 8  глазок 9  ка нальцы выделительной системы   выделительная пора 11    мер цательное пламя  12 ядро клетки 13  внутриклеточный каналец ством мелких семенников разбросанных паренхиме семенников отходят семявыносящие канальцы которые сливаясь образуют семяпровода семяпроводы формируют непарный семяизвергатель ный канал пронизывающий совокупительный орган расположенный половой клоаке сюда впадают женские половые протоки женская половая система представлена одним множеством яич ников яичников отходят яйцевода принимающие протоки жел точников сливающиеся канал   влагалище влагалище откры вается половую клоаку оплодотворенные яйцеклетки окружаются жел точными клетками вместе ними покрываются общей скорлупой благодаря разным срокам созревания половых продуктов самооп лодотворения этих червей происходит оплодотворение внутрен оплодотворенные яйца выводятся наружу либо разрывы сте нок тела либо рот либо специальные выводные протоки пресноводных форм развитие прямое морских видов развитие пре вращением яйца развивается планктонная личинка плавающая помощью ресничек толще воды интересна способность ресничных червей регенерации рас членении одного червя сотни частей каждой части восста новиться новая особь морях океанах обитают мелкие ресничные черви отрядов бес кишечные макростомиды многоветвистокишечные др среди пре сноводных представителей отечественной фауны отметить мо лочнобелую планарию многочисленные трехветвистокишечные тур беллярии населяют озеро байкал многие виды ресничных червей служат кормом рыб класс сосальщики trematoda общая характеристика известно 4 тыс видов сосальщиков многие которых являются широко распространенными опасными эндопаразитами животных человека тело сосальщиков расчлене имеет листовидную форму большинства присоски крепления телу хозяина кишечник двуветвистый заканчивается слепо большинство гермафродиты развитие происходит сменой хозяев взрослые формы живут позвоночных животных пора жая основном органы пищеварения виды обитающие лег ких кровеносной системе других органах связи сменой хозяев жизненном цикле сосальщиков получили одно название   digenea т е двойственное развитие строение жизненные отправления строение сосальщиков мно гом сходно строением ресничных червей теле обычно имеются две присоски отсюда другое название сосальщиков   двуустки одна окружает рот другая расположена брюшной стороне тела рис 47 брюшная присоска отсутствовать покровы представлены тегументом снаружи некоторых форм усеян ным шипиками способствующими фиксации паразита теле хозяина 78 рис 47 строение половой л пищева рительной б систем печеночного сальщика фасциолы   ротовая присоска 2   брюшная присоска 3   разветвленный кишеч ник левая правая ветви 4   копуля тивный орган 5  яичник 6  желточ ники 7   желточные протоки 8   се менники 9  семяпроводы 10  матка мускулатура представлена слоями мышечных волокон ко торые вместе тегументом обра зуют кожномускульный мешок двигаются трематоды медленно нервная система слагается парного головного ганглия отходящих парных нервных тяжей ганглия тяжей идут ответвления ко всем органам взрослых червей органы зрения отсутствуют покровах размещены осязательные другие нервные окончания органы пищеварения начинаются ротовым отверстием ведущим глотку которая совершать сосательные движения глоткой лежит пищевод который ветвится две ветви кишечника ветвистый кишечник имеет дополнительные боковые отростки облег чающие распределение продуктов пищеварения паренхиме червя анальное отверстие отсутствует пищеварение основном происходит полости кишечника вне клеточное наряду кишечным пищеварением наблюдается всасыва ние растворенных органических веществ покровы тела непере варенные остатки пищи выбрасываются ротовое отверстие дукты пищеварения транспортируются теле сосальщиков помощью межтканевой жидкости клеток паренхимы счет сокращения мус кулатуры тела органы дыхания отсутствуют эндопаразитических форм дыхание анаэробное процессы диссимиляции происходят типу брожения исключения паразиты живущие легких могут дышать че рез покровы своего тела органы выделения протонефридиального типа выделительных звездчатых клеток покрытых ресничками разбросанных паренхи ме отходят канальцы которые сливаются крупные выдели тельные каналы вся выделительная система каналов открывается мочевой пузырь конечные продукты обмена веществ выбра сываются выделительное отверстие заднем конце тела органы размножения устроены сложно трематоды гермафроди лишь немногие виды кровяных сосальщиков раздельнополы муж 79 ские половые органы представлены двумя семенниками отходящими семявыносящими протоками образующими семяизвергатель ный канал который заканчивается копулятивным органом   цирру сом см рис 47 находящимся половой клоаке женские половые органы представлены одним яичником кото рого начинается яйцевод впадающий оотип сюда впадают токи желез желточных тельца мелиса оотип окружен мелкими скорлуповыми железами оотипа начинается длинная извитая мат ка конец которой открывается женским половым отверстием рядом мужским половым отверстием сосальщикам свойственно перекре стное оплодотворение самооплодотворение возможно очень ред ко сперма помощью копулятивного органа вводится матку матку другого сосальщика матке спермии поступают семя приемник накапливаются мере необходимости спермии ступают оотип сюда выходят продукты придаточных желез яйце клетки яйцевода оплодотворения яйца покрываются желточны ми клетками затем прочной скорлуповой оболочкой оплодотворенные покрытые скорлупой яйца поступают матку выводятся наружу яй цо имеет крышечку открывающуюся выходе личинки развитие большинства сосальщиков протекает сложными пре вращениями сменой хозяев первые промежуточные хозяева   брюхоногие моллюски пресноводные наземные вторые промежуточные дополнительные хозяева   разные беспозвоночные позвоночные животные виды сосальщиков которые имеют трех промежуточных хозяев рис 48 наиболее опасны паразиты сельскохозяйственных животных человека следующие дигенетические сосальщики печеночный сосальщик fasciola hepatica фасциола печеночная имеет листовидное тело 5 см длиной см рис 47 переднем кон це тела расположено ротовое отверстие окруженное ротовой присос кой тегумент шипиками брюшной стороне тела имеется брюш ная присоска кишечник двуветвистый множеством отростков ветвистых семенника расположены середине тела ниже компактного ветвистого яичника бокам тела находятся желточники печеночный сосальщик паразитирует желчных протоках печени растительноядных всеядных животных поражать человека вызывая заболевание фасциолез питается сосальщик желчью силь поражаются овцы молочный скот которых пасут поймах рек заливных лугах т п нередко болезнь иметь летальный исход закупоривания двуустками желчных протоков невозмож ности оттока желчи печени желчных протоках паразиты копулируют возможно самооп лодотворение желчью оплодотворенные яйца покрытые скорлупо выми оболочками кишечный тракт калом хозяина попадают внешнюю среду сутки паразит отложить сотни тысяч яиц рис 49 80 рис 48 схемы жизненных циклов трематод   печеночный сосальщик 6   кошачья двуустка   ланцетовидный сосальщик i   кровяной сосальщик м   марита   яйцо мц   мирацидий сп   спороциста р   редия ц   церкарий мир   метацеркарий дальнейшего развития яйцо должно попасть воду 3 6 нед крышечка открывается яйца выходит микроскопическая личинка покрытая ресничками   мирацидий переднем конце ми рацидия имеются глазки рот ведущий кишечник свободно плавать мирацидии могут 2 сут питаются мирацидии попадут тело промежуточного хозяина погибают задней части тела мирацидия лежат партеногенетические яйца найдя проме жуточного хозяина пресноводный брюхоногий моллюск малый пру довик limnaea truncatula мирацидий помощью специальных желе зок расположенных около рта проникает моллюска превращается следующую стадию развития   спороцисту это половозрелая ста 6 6407 81 дефинитивные трава вода   основные источ wr экскременты ники заражения хозяев печень   главные адолескарий i источники зараже ния пром хоз мирацидий цекарий редия спороциста личинки личинки выхода внедрения v моллюска моллюска моллюск limnaea промежуточный хозяин рис 49 цикл развития печеночного сосальщика фасциолы fasciola hepatica дия которая способна размножению иными словами мирацидий является личинкой спороцисты спороциста лишена ресничек выделяет ткани хозяина пище варительные ферменты питается продуктами гидролиза тканей хо зяина поглощая продукты всей поверхностью тела внутри споро цисты путем дробления дифференцировки течение 3 4 нед пар теногенетических яиц развивается новое поколение личинок   редии редии выходят погибшей спороцисты разрывы стенок ре дии имеют вытянутое тело развитым пищеварительным аппаратом 82 11итаются редии тканями хозяина заглатывая рот теле ка ждой редии развивается следующее второе поколение партеногене тических редий редий второго поколения образуется новая парте иогенетическая форма личинок   церкарии церкарии вооружены двумя присосками имеют протонефридии зачаток половой системы длинный хвост двуветвистый кишечник развитие церкариев длится 6 нед церкарии выходят тела малого прудовика воду плавают прикрепляются водным прибрежным растениям затем покрываются плотной оболочкой инцистируются превращаясь последнюю стадию развития сосальщика   адолеска риев усиленное партеногенетическое размножение спороцист ре дий приводит выходу одного моллюска которого попал ми рацидий нескольких сотен особей церкариев адолескарии сохраняют жизнеспособность воде влажной среде многие месяцы долго живут сене заготовленном растений которых закрепились церкарии окончательные дефинитивные хозяева заражаются фасциолезом заглатывая адоле скариев прибрежной травой сеном водой зараженных водоемов кишечнике дефинитивного хозяина обо лочки адолескариев растворяются зародыш сосальщика брюшную полость че рез кровеносную систему проникает парен химу печени некоторое время   желчные протоки печени сосальщик жи вет нескольких лет весь цикл развития мирацидия поло возрелого состояния занимать 7 мес борьба фасциолезом сводится лечебным профилактическим мерам целью предупре дить попадание адолескариев организм сель скохозяйственных животных мелиорация па стбищ поение скота чистой водой специаль ных сооружений смена пастбищ т д ланцетовидный сосальщик dicrocoelium liinceatum ланцетовидная двуустка   большой червь около 1 см ланцетовидной формы распространен засушливых регионах рис 50 ланцетовидный страны имеет две присоски двуветвистый сальщик dicrocoelium кишечник боковых отростков яичник lanceatum семенники неветвящиеся рис 50 паразити 1   ротовая присоска 2   брюшная присоска 3   рует печени мелкого крупного рогатого глотка 4   ветви кишеч скота других травоядных млекопитающих ника 5 яичник 6 мат первым промежуточным хозяином лан ка 7 семяприемник 8  желточники 9 семенни i стовидного сосальщика служат разные виды ки 10   семяизвергатель сухопутных брюхоногих моллюсков кало ный канал 83 выми массами дефинитивного хозяина выходят яйца сосальщика ок руженные толстыми оболочками которые позволяют сохранять жиз неспособность течение нескольких месяцев яйцах находятся сфор мированные мирацидии моллюски заражаются поедая яйца кишечнике моллюсков мирацидии освобождаются яйцевых обо лочек проникают печень промежуточного хозяина мирацидии превращаются спороцисты которых партеногенетически развива ются дочерние спороцисты последние дают начало партеногенетиче ским церкариям сотни церкариев проникают легкие моллюска волакиваются слизью комочки пакеты церкарий таком виде брасываются дыхательное отверстие наружу вторым промежуточным хозяином являются разные виды муравьев муравьи могут поедать слизистые комочки церкариями стенку кишечника муравьев церкарии проникают полость тела насекомых превращаются метацеркариев хвоста окруженные оболочками скот заглатывая траву пораженными муравьями заражается сальщиком кишечнике скота муравьи перевариваются освободив шиеся метацеркарии желчный проток попадают печень дефи нитивного хозяина кошачий сосальщик opistorchisfelineus кошачья двуустка пара зитирует печени хищных млекопитающих человека зывая тяжелое заболевание   описторхоз строению размерам па разит напоминает ланцетовидного сосальщика кошачий сосальщик живет желчных протоках печени желчном пузыре подже лудочной железе первым промежуточным хозяином служит пресно водный брюхоногий моллюск битиния bithynia leachi котором мирацидий проходит те стадии цикла развития печеноч ный сосальщик мирацидий спороциста редии церкарии цер карии покинувшие первого промежуточного хозяина выходят воду затем активно внедряются тело рыб основном различных видов карповых превращаются метацеркариев хищники заражаются съедая рыбу пораженную метацеркариями заражение человека животных происходит поедании вяленой мороженой сырой рыбы инцистированной метацеркариями сильном заражении болезнь закончиться смертью человека простогонимусы виды рода prosthogonimus   небольшие сосальщики длиной 6 мм паразитируют черви яйцеводах птиц куриные ре гуси утки приводит образованию бесскорлупных яиц следующему прекращению яйцекладки промежуточными хозяевами яв ляются различные виды пресноводных моллюсков дополнительными хозяевами   личинки стрекоз яйца развиваются воде вышедшие мирацидии проникают тело моллюсков печени которых превра щаются спороцисты последние дают начало партеногенетическим цер кариям выйдя тела моллюсков церкарии водой попадают кишеч ник личинок стрекоз лишаются хвоста проникают разные час ти тела личинок превращаются метацеркариев поедая личинок взрослых стрекоз птицы заражаются простогонимусами 84 кровяные двуустки несколько видов ро schistosoma существенно отличаются других групп трематод длина тела 2 см раздельнополы самка размещается специальном желобе брюхе самца рис 51 паразитируют венах пищеварительной выделительной систем птиц млекопитаю щих человека оплодотворенные яйца мощью особого шипа проникают заднюю часть кишечника калом птиц пометом выносятся наружу воде яиц выходят мира нидии внедряются пресноводных брюхоно гих моллюсков моллюсках паразит проходит стадии спороцисты дочерней спороцисты перкария тела моллюска церкарии выходят воду кожу проникают дефинитивного хозяина вызывая тяжелое заболевание   шис р 51 кровяная двуустка тосомоз тропических странах шистосомозом schistosoma haematobium поражено около 900 млн г т нормального прохождения цик лобке широкого ла развития сосальщикам требуются весьма самца благоприятные условия наличие воды межуточных хозяев постоянное посе щение водоемов дефинитивными хозяевами т д однако виды отлично приспособившиеся паразитированию например сосаль щик leucochloridium paradoxum живет кишечнике насекомоядных певчих птиц теле промежуточного хозяина   наземной улитки съевшей яйца паразита мирацидии превращаются спороцисты спо роцисты разрастаются образуя большое число отростков распростра няющихся телу улитки некоторые отростки попадают щупальца улитки сильно раздуваются приобретают яркую окраску просвечи вающую сквозь тонкую кожицу улитки периодически сокращаются птицы склевывают щупальца похожие гусениц насекомых ражаясь таким образом сосальщиком класс моногенеи monogenea редким исключением моногенетические сосальщики являются эктопаразитами позвоночных рыб амфибий беспозвоночных мол люсков животных известно 25 тыс видов моногеней парази тируют жабрах коже рыб некоторые поражают мочевой пу зырь амфибий рептилий своей организации моногеней близки трематодам обладают мощными органами прикрепления хозяину это присоски крючья крючья которые распо ложены обособленном заднем отделе тела виде диска также мел кие присоски около рта выделяющие липкий секрет ротовая брюш 85 рис 52 моногенетические сосальщики   спайник парадоксальный diplozoon paradoxum б   лягушачья многоустка polystoma inlegerrimum   дактилогирус dactylogyrus vastat ная присоски моногеней отсутствуют рис 52 органов чувств отметить наличие покровах многочисленных чувствующих клеток переднем конце   глазков тело моногеней заключено кожномускульный мешок кишеч ник двуветвистый боковыми отростками мешковидный половые железы непарные парные выделительные каналы протонеф ридиальной системы открываются переднем конце тела парными отверстиями половой системе имеется влагалище которому сперма вводится оотип семяприемник матка открывается самостоятельным отверстием половую клоаку служит выведения оплодотворенных яиц размножаются моногеней исключительно половым путем некото рым видам свойствен партеногенез жизненный цикл смены хозяи развитие паразита проходит одном хозяине оплодотворенного яйца выходит свободноплавающая личинка ресничками глазками органами прикрепления заднем конце тела личинка напоминает планарию некоторые моногенетические сосальщики приносят вред рыбному хозяйству поражая рыб вызывая истощение например мелкие черви dactylogyrus vastat длиной 1 3 мм живут жабрах коже кар повых других рыб питаясь кровью яиц отложенных дактилоги русом вылупляются личинки которым затем прикрепиться жабрам рыб превращаются взрослых паразитов 86 карпах часто паразитирует живородящий вид моногеней   iyrodactylus elegan паразите партеногенетически развивается зародыш котором имеется зародыша последую щих поколений жабрах карповых рыб паразитирует спайник парадоксальный diplozoon paradoxum особенность паразита две гер мафродитные особи срастаются таким образом возможно перекрестное оплодотворение паразиты лягушек частности лягушачья многоустка кото i юй жизненный цикл усложнен тесно связан ростом развитием хо зяев   головастиков лягушек класс ленточные черви cestoda общая характеристика цестоды   эндопаразиты различных живот иых преимущественно позвоночных человека взрослые черви па разитируют тонком отделе кишечника дефинитивного хозяина чинки паразитов развиваются различных органах полостях тела промежуточного хозяина   беспозвоночных позвоночных живот ных известно 3 тыс видов цестод среди которых парази тов животных человека большинства представителей ленточных червей тело имеет вид i тоской ленты часто расчлененной множество члеников тело име ет головку   сколекс которая продолжается шейку шейкой сле дует тело червя   стробила стробила состоит множества скольких тысяч сотен бывает  четыре члеников   i лоттид реже встречаются цестоды нерасчлененным телом головка цестод имеет специальные органы прикрепления присоски крючья ботрии щелевидные углубления связи паразитическим образом жизни ленточных червей слабо развиты нервная система органы чувств редуцирована пищевари тельная система однако половая система достигает высокого уровня развития обеспечивая огромную плодовитость следовательно воз можность выживания паразитов строение жизненные отправ ления длина тела колеблется нескольких миллиметров 15 м головка сколекс имеет разное строение различных цестод рис 53 бычьего цепня ско рис 53 головки цепней лентецов   цепня вооруженного б   цепня вооруженного   лентеца широкого головка 2   шейка 3   присоски 4   хоботок крючьями 5   присасыва гсльные ямки   ботрии 87 леке имеет четыре присоски невооруженный цепень головка свиного цепня помимо четырех присосок вершине вооружена допол нительно венчиком хитиновых крючьев вооруженный цепень го ловка широкого лентеца имеет щелевидных углубления   ботрии которыми зажимают складку стенки кишки хозяина сложны органы прикрепления гвоздичника других цестод шейка цестод является зоной роста червя происходит отшнуровывание новых члеников которых состоит стробила толь ко немногих представителей ремнец гвоздичник тело подразде ляется членики заднем конце тела цестод находятся зрелые чле ники наполненные яйцами червя отрываются мере созрева ния увлекаются калом хозяина внешнюю среду таким образом цестод происходит постоянный прирост молодых члеников отрыв старых зрелых члеников число члеников разных цестод варь ировать широких пределах двух четырех нескольких тысяч передней части стробилы расположены незрелые членики которых развиты половые органы незрелыми следуют гермафродит ные членики развитой гермафродитной половой системой конец стробилы представлен зрелыми члениками маткой набитой яйцами покровы представляют собой тегумент который подстилают коль цевые продольные слои мускулатуры сравнению трематодами тегумент цестод выполняет многообразные функции защита действия пищеварительных ферментов кишечника хозяина путем нейтрализации всасывание питательных веществ кишечного содер жимого хозяина выработка выделение собственных ферментов т п тегумент имеет волоски ворсинки увеличивающие поверхность вса сывания пищи мускулатура представлена наружным кольцевым внутренним продольным слоями третий   диагональный слой ки шечнике хозяина ленточные черви совершают медленные движения такие движения совершают вышедшие наружу калом зрелые членики нервная система состоит скопления сколексе червя нервных клеток продольных парных тяжей идущих конца тела органы чувств выражены слабо органы дыхания пищеварения цестод отсутствуют органы выделения строению однотипны трематодами парен химе располагаются звездчатые клетки несущие реснички этих клеток отходят выносящие канальцы сливающиеся крупных делительных канала идущих бокам стробилы каждом членике каналы соединены поперечным протоком конечные продукты мена выводятся наружу каналы последнего членика помимо каждом членике имеются отверстия протонефридиев половая система цестод похожа половую систему трематод расчлененных цестод паренхиме расположен лишь комплект мужских женских половых органов рис 54 расчлененных цестод каждый гермафродитный членик имеет одному комплекту женских рис 54 схема строения половой системы ленточных червей ч   лентец открытой маткой б  цепень закрытой маткой   семенники 2   се мивыносящие каналы 3 4   семяпровод 5  совокупительный орган 6   сумка 7  мужское половое отверстие 8 яичники 9 яйцевод 10  желточник ii   оотип 12   тельце мелиса 13   семяприемник 14   влагалище 15   женское половое отвер i гие 16  матка 17  отверстие матки п одному комплекту мужских половых органов некоторых предста вителей   комплекта мужская половая система представлена множеством мелких семенников разбросанных паренхиме отходя щие семенников семявыносящие канальцы сливаются семяпро вод который заканчивается семяизвергательным каналом копуля гивным органом женская половая система состоит яйцевода оотипа матки вла галища семяприемника желточников тельца мелиса влагалище ссмяизвергательный каналы открываются половую клоаку одних лен точных червей матка открывается наружу специальным отверстием   рытая матка случае оплодотворенные яйца постоянно выходят тела червя вместе каловыми массами хозяина попадают внешнюю чаду других червей матка имеет выводного отверстия опло дотворенные яйца развивающиеся личинки могут выйти icjia дефинитивного хозяина вместе оторвавшимися стро билы зрелыми члениками ленточных червей происходит перекрестное оплодотворение происходить самооплодотворение последнем случае сперма вводиться влагалище собственного членика также любого другого гермафродитного членика стробилы оплодотворенные оотипе яйца окружаются желточными клетка ми скорлупой затем выводятся матку лентецов матка открыва 89 ется отверстием которое яйца выводятся наружу цепней матки замкнутые поэтому яйца постепенно накапливаются матка увеличивается размерах образует боковые ответвления мат ке одного членика накапливается нескольких тысяч яиц напол ненных яйцами члеников редуцируется половая система членики ста новятся зрелыми отрываются стробилы выводятся внеш нюю среду калом хозяина наружной среде яйца высвобождаются разрушенных члеников развитие цестод проходит сложным превращением теле де финитивного хозяина яйце формируется личинка   онкосфера воору женная шестью крючьями онкосферы служат заражения промежу точных хозяев теле которых развиваются последующие личи ночные стадии паразита одних ленточных червей развитие проходит двух хозяевах других   дефинитивном двух промежуточных попав кишечник промежуточного хозяина онкосфера выходит скорлупы проникает стенку кишки кровяное русло некоторых представителей личинка остается стенке кишечника развивается током крови онкосферы разносятся телу промежуточного хо зяина оседают различных органах тканях образуют новую ста дию личинки   финну строение финн цепней неодинаково разли чают типа финн цистицерк ценур эхинококк цистицерк виде небольшого округлого пузырька имеет одну впяченную внутрь головку будущего паразита рис 55 лентецов встречается примитивная фин   плероцеркоид имеющий лентовидную форму одну ввернутую головку ботриями ценур размером крупный орех внутри имеет нескольких сотен головок эхинококк отличается других финн крупными размерами сложным строением оболочкой пузыря имеется головок внутри пузыря находятся дочерние пузыри дающие внучатые пузыри несколькими головками таким образом эхинококк способен дать множество молодых паразитов окончательный хозяин заражается поедая органы промежуточного хозяина финнами кишечнике окончательного хозяина дейст вием кишечного сока головки финн выворачиваются черви закрепля ются стенке кишки начинают продуцировать молодые членики ленточные черви делятся подкласса которых пред ставлен подавляющим большинством этих паразитов   подкласс цес тоды cestoda остановимся лишь представителях двух отрядов   i епней лентецов представляющих наибольшую опасность жи вотноводства заболевания вызываемые цестодами называются цес тодозами отряд цепни cyclophyllidea представлен ленточными червями кодексе которых имеется четыре присоски многих видов допол нительно венчики крючьев матки закрытого типа онкосферы развиваются внешней среде лентецы матках зрелых члени ков половая клоака находится сбоку членика невооруженный бычий цепень taeniarhynchus saginatus достигает длину 8 12 м головке расположены четыре присоски хо ботка крючьями паразитирует кишечнике человека матке зрелого членика 100 тыс яиц матка сильно ветвлена   35 ответвлений каждой стороны рис 56 вышедшие калом человека зрелые членики могут передвигаться ii ромежуточный хозяин   крупный рогатый скот заражается прогла гывая яйца кормом водой кишечнике скота яиц выходят косферы которые вбуравливаются стенку кишечника проникают кровь онкосферы оседают мышцах внутренних органов образу ются финны типа цистицерк заразиться потребляя плохо проваренное недожаренное мясо пораженного скота заболевший худеет происходит интоксикация организма продуктами выделения цепня бычий цепень живет 18 лет произво дя период 11 млрд яиц вооруженный свиной цепень taenia solium свиной солитер немного уступает бычьему своим размерам   2 4 м дефинитив ным хозяином является головке помимо четырех присосок меется хоботок венчиком острых хитиновых крючьев матка зрелого членика имеет 8 12 ответвлений каждой стороны опреде л яет меньшее число зрелых яиц   50 тыс цикл развития i ого цепня сходен циклом развития бычьего цепня однако свиной солитер человека опасен труднее изгонять ки шечника прочно прикреплен стенке кишки главное промежуточным хозяином финны солитера развивают 91 рис 56 цепень невооруженный   внешний вид б   гермафродитный членик   зрелый членик 1   головка 2   шейка 3   стробила 4   двураздельный яичник 5   яйцевод 6   тельце мелиса 7 желточник 8  семяприемник 9   влагалище 10  половая клоака 11   устье мат ки 12  матка 13   копулятивный орган 14  семяпровод 5 семенники 16  канал выделительной системы 17  нервный тяж ся различных внутренних органах числе печени сердце моз ге привести смерти зрелые членики тела человека могут выходить целыми обрывка ми стробилы членики передвигаться субстрату могут промежу точным хозяином свинья кабан собаки кошки кролики зайцы медведь верблюд финны типа цистицерк концентрируются основном мышцах могут оседать сердце пе чени мозге глазах длительное время 6 лет сохраняя жизнеспо собность заражение происходит поедании непрожаренного проваренного мяса чаще свиного промежу точным хозяином кишечник попадут зрелые яйца случае финны образуются мышцах человека вызывая тяжелое забо левание взрослые черви живут кишечнике человека несколько лет овечий мозговик multicep multicep   червь небольших размеров длина доходит 80 см головка кроме четырех присосок вооруже хоботком двумя рядами крючьев дефинитивным хозяином явля ется собака дикие родичи зрелые членики калом собак попадают мо внешнюю среду яйца будут проглочены промежуточным хо ином овца коза также крупный рогатый скот реже свиньи верб пюды другие животные очень редко яиц выходят косферы которые внедряются стенки кишечника током крови разносятся организму овцы головном мозге животного онкосфе ра превращается ценур достигающий размеров куриного яйца раженная финной овца совершает круговые движения обычно i юражается одна половина мозга определило название болезни   нертячка овец среди больных овец наблюдается массовая гибель соба заражаются поедая мозг погибших вертячки овец взрослые черви живут 6 8 мес мониезии различные виды рода moniezia достигают 5 м длину головка червя имеет четыре присоски особенностью мониезии является каждом гермафродитном членике находит ся двойной комплект половых органов половые отверстия располо жены обеим сторонам членика дефинитивным хозяином паразита является мелкий крупный рогатый скот особенно тяжело переносят заболевание молодые животные промежуточными хозяевами служат некровососущие микроскопи ческие малые панцирные клещи населяющие почву клещи поедают онкосферы выпавшие разрушившихся члеников паразита онко сферы стенки кишечника клещей проникают полость тела превращаются мелкие финны типа цистицеркоид мельчайшая чинка одной головкой млекопитающие заражаются поедая тра пораженных клещей борьбе мониезией важен режим чередо вания выпаса скота пастбищах карликовый цепень hymenolepi папа соответствует своему названию длина около 1 см развитие червя происходит одном хозяине   че ловеке кишечнике человека паразитировать тысячи парази тов одновременно онкосфер попавших кишечник человека ворсинках развиваются мелкие финны   цистицеркоиды которые выпадают просвет кишечника закрепляются помощью присо сок крючьев стенках кишки превращаются половозрелых чер вей человека часто наблюдается самозаражение весь цикл развития цепня занимает 20 сут эхинококк echinococcus granulosus достигает длину около 5 мм рис 57 головка паразита имеет четыре присоски хоботок двумя рядами крючьев эхинококка характерно наличие трехчетырех члеников незрелый гермафродитный зрелый зрелый членик содержащий 800 яиц отрывается тела паразита выносит ся каловыми массами дефинитивного хозяина собаки волка шакала лисицы также других хищных животных внешнюю среду зрелые членики внешней среде некоторое время могут передвигаться числе шерсти хозяина место оторвавшегося зрелого членика оплодотворения занимает гермафродитный членик становясь зрелым промежуточным хозяином могут стать мелкий крупный рогатый скот свиньи лошади кролики грызуны другие млекопитающие 93 сосками хоботком вооруженным крючьями 2   незрелый членик 3   гермафродит ный членик 4   зрелый членик 5   кутикула 6   производящая оболочка 7 8 9 10   внутренние дочерние пузыри разных стадиях развития 1213 1415   наружные дочерние пузыри разных стадиях развития кроме семейства собачьих стать заболевание зывается эхинококкозом часты летальные исходы кишечнике промежуточного хозяина яйца выходит онкосфера попадая стенки кишечника кровяное русло онкосфера мигри рует всему организму оседая образуя финны типа эхинококк чаще печени реже легких мышцах мозге крупного рогатого скота масса финны достигать 50 кг внутри финны дочерних пузырей рассматривать бесполое размноже ние паразита ранних стадиях развития источником заражения человека могут стать собаки особенно пас тушьи свободном содержании поселках городах выпол зающие анального отверстия зрелые членики вызывают собак зуд животные чешутся разносят яйца шерсти взрослые черви живут кишечнике собак 6 мес эхинококк распространен местностях развитым животноводством последние годы участились случаи заражения человека альвеокок ком alveococcus multiloculari европейских странах дефинитивным хо зяином мелкого цепня похожего эхинококка обычно являются 94 лисицы собаки кошки промежуточным хозяином могут мыше видные грызуны которые заражаются яйцами альвеококка подбирая остатки нор лис жилищ человека могут встречаться зараженные кошки собаки также стать промежуточным хозяином заражаясь яйцами цепня собак кошек чаще финны образуют ся человека дыхательных путях вызывать удушье отряд лентецы pseudophyllidea представителей отряда го ловка имеет присосок крючьев органами прикрепления служат ботрии   щелевидные ямки помощью которых паразиты защемляют стенку кишки матка лентецов открывается наружу брюшной сто роне членика отверстием которое зрелые яйца могут выходить просвет кишечника дефинитивного хозяина отряд включает паразитических видов которых наиболее опасен широкий лентец diphyllobothrium latum червь живет кишечнике хищных животных достигая длины 8 10 м дефинитивным хозяином че ловек заражаются также дельфины тюлени вышедшие калом внешнюю среду зрелые яйца крышечкой должны попасть пре сную воду яиц воде выходит личинка покрытая ресничками   ко рацидий рис 58 личинку могут съесть веслоногие ракообразные   рис 58 лентец широкий diphyllobothrium latum   головка 6   цикл развития 95 циклопы диаптомусы кишечнике которых корацидия выходит сформировавшаяся личинка онкосфера шестью крючьями онко сфера внедряется полость тела первого промежуточного хозяина превращается покоящуюся фазу   процеркоид имеющий уд линенную форму диском заднем конце тела несущем крючья пораженного ракообразного проглотит рыба щука другие теле рыбы процеркоид внедряется внутренние органы мышцы превращается финнозную стадию   плероцеркоид плероцер коиды имеют червеобразное тело длиной 1 2 см одной ввернутой го ловкой переднем конце тела головка вооружена двумя ботриями дефинитивный хозяин заражается поедая сырую замороженную слабо просоленную рыбу заболевает дифиллоботриозом чаще потребляют больших количествах сырую рыбу основном виде строганины замороженной рыбы которой остают ся жизнеспособные плероцеркоиды цикле развития лентеца важны резервуарные хозяева хищные рыбы поедании щуками поражен ных плероцеркоидами рыб кишечнике щук паразиты переварива ются проникают ткани накапливаются различных органах лентецам относится червь имеющий нерасчлененное тело   ремнец сем ligulida длина паразита колеблется 7 200 см тело виде ленты которой комплекты половых органов многократно вторяются нерасчлененности тела рост ремнеца происходит обычным путем   зоны почкования это паразиты кишечника вод ных болотных птиц воде яиц ремнеца выходят плавающие чинки   корацидии заглатывают мелкие ракообразные циклопы диаптомусы которых корацидии превращаются процеркоиды рыбе второй промежуточный хозяин проглотившей такого ракооб разного процеркоиды становятся плероцеркоидами длиной 60 см водные болотные птицы заражаются ремнецом поедая рыбу пле роцеркоидами пораженные рыбы плавают верхних слоях воды могут глубоко погружаться воду поэтому становятся легкой добы чей птиц часто наблюдается массовая гибель рыб филогения плоских червей среди плоских червей ресничные черви ведут свободножи вущий образ жизни представители остальных классов являются специализированными паразитами связи этим проблема происхо ждения плоских червей ограничивается выяснением происхождения тур беллярий наиболее аргументированной считается гипотеза ивано ва которой предполагается турбеллярии произошли ацелопо добныхтурбеллярий эволюционном отношении наибольшее значение имеют прямокишечные турбеллярии предков которых могли изойти другие классы плоских червей переход плоских червей пара зитизму мог осуществляться симбиоз такие тен денции проявляются современных турбеллярий 96 моногеней могли произойти турбелляриеподобных предков квартирантетво жабрах плавниках рыб затем постепенно пе решли эктопаразитизму среди современных моногеней наблюдается 11среход эндопаразитизму например лягушачьей многоустки родст венные связи моногеней цестод доказаны русским ученым i е быховским эволюция трематод могла идти независимо мо i югеней цестод предположить первом этапе эволюции трематоды вели свободный образ жизни паразитизму перешли личинки вступившие симбиотические отношения моллюсками тип круглые первично полостные черви nemathelminth круглых червей часто называют первичнополостными червями имеют несегментированное тело первичной полостью запол нен ной полостной жидкостью кишечный канал разветвлен канчивается анальным отверстием известно 100 тыс видов руглых червей среди которых свободноживущих форм встре чающихся морях пресных водоемах почве практическое значе ние круглых червей велико почвенные виды участвуют почвообра зовательных процессах паразитические черви наносят огромный ущерб животноводству растениеводству среди круглых червей мно го паразитов которые встречаются практически многоклеточ ных животных многих растений первичная полость тела схизоцель образуется счет разрушения паренхимы заполняющей плоских червей промежутки внут ренними органами стенкой тела схизоцель соответствует бластоце лю   первичной полости зародыша главная функция схизоцеля   транспорт питательных веществ конечных продуктов обмена легче быстрее осуществляется полостной жидкости паренхи ме полости поддерживается высокий тургор полостной жидкости гидроскелет сочетании мускулатурой способствует движению нематод субстрате форма тела этих червей округлая поперечнике покровы пред ставлены кутикулой отличие брюхоресничных червей нематод сутствует ресничный эпителий остатки ресничного эпителия име ются представителей низших классов покровами распо лагается слой продольных мышц отдельные мышечные пучки ре ке могут кольцевые мышцы нервная система представлена око иотлоточным узлом отходящими продольными нервными тяжами органы дыхания отсутствуют кишечник состоит трех отделов переднего среднего заднего i отовое отверстие находится брюшной поверхности переднего кон па тела имеется анальное отверстие i 6407 97 выделительная система построена протонефридиальному типу мерцательных клеток виде особых кожных гиподермаль ных желез большая часть круглых червей раздельнополые встречаются гермафродитные формы часто выражен половой диморфизм размно жаются половым путем развитие прямое реже   метаморфо зом круглые черви способны регенерации тип круглые черви включает несколько классов которых наи больший интерес представляют класса класс собственно круглые черви нематоды nematoda класс скребни acanthocephala класс коловратки rotatoria сельского хозяйства наибольшее значение имеют представители класса нематод класс собственно круглые черви нематоды nematoda общая характеристика округлое тело длиной нескольких милли метров 1 м паразитическая нематода кашалота достигает длину 8 м сохраняет постоянную ширину покрыто плотной кутикулой свободноживущие виды населяют соленые пресные воды живут почве паразитов растений животных человека пара зитов растений описано 1 тыс видов среди паразитических форм большой интерес представляют те виды которые паразитируют вредных насекомых сорных растениях строение жизненные отправления несмотря большое экологи ческое разнообразие нематоды однообразны морфологически форма тела обычно веретенообразная нитевидная реже колбасовидная свободноживущие черви живут илистом грунте водоемов гуму совом горизонте почвы питаясь органикой паразитические формы обитая тканях растений теле животных поглощают органические вещества организма хозяина виды округлой формой тела переднем конце расположены рот органы осязания химического чув ства светочувствительные органы встречаются редко туловище закан чивается хвостовым отделом следующим анальным отверстием тело самцов оканчиваться бурсой   органом прикрепления телу самки спаривании половой диморфизм часто выражен покровы нематод образованы гиподермой покрытой кутикулой кутикула состоять четырех десяти слоев поверхность кольчатая гладкая химический состав кутикулы представлен сложном комплексом белков липопротеинов других веществ кути кула благодаря своему составу находится биологически активном стоянии устойчива действию пищеварительных ферментов хозяи хотя погибших червей кутикула легко переваривается кишечни ке животных вещества образующие кутикулу выделяются клетками гиподермы свободноживущих червей гиподерма представлена однослойным эпителием паразитических взрослых червей   протоплазматиче ской массой содержащей многочисленные ядра спинной брюш 98 рис 59 поперечный разрез тела самки аскариды ascari lumbricoid   кутикула 2   гиподерма 3   мышцы 4   спинной валик гиподермы нервным г гволом 5  брюшной нервный тяж б  боковые валики гиподермы каналами выде лительной системы 7  первичная полость тела 8  кишечник 9   яичники 10   яй цевод 11   матка ной сторонах также бокам гиподерма образует валикообразные утолщения тянущиеся вдоль тела первичная полость тела заполнена полостной жидкостью заклю чена кожномускульный мешок полости тела расположены внут ренние органы нервная система виде окологлоточного нервного кольца которое опоясывает пищевод отходящих двух продольных нервных тяжей спинного брюшного образована нервная система небольшим   i ислом нервных клеток большее развитие получили брюшные спин мые нервные тяжи соединенные комиссурами дающие ответвления различным органам рис 59 органы чувств развиты слабо пред ставлены осязательными обонятельными клетками мускулатура образована обычно полосами продольных мышечных волокон которые разделены бокам тела выростами валиками ги иодермы спинной брюшной сторонах   нервными стволами нежащими валиках гиподермы мышечные полосы образованы сло ем удлиненных клеток содержащих миофибриллы мускулатура 99 рис 60 схема организации фитонематод   самка б   самец 1   ротовая полость 2   пищевод 3   средний бульбус 4   зад ний бульбус дробильным аппаратом 5  нервное кольцо 6   кишечник 7  яич ник 8   яйцевод 9  матки передняя зад няя 10   семенник 11   зона созревания спермиев 12   семяпровод 13   семяизвер гательный канал 14   спикулы 15   рулек 16   крылья бурсы ребрами матод позволяет совершать однооб разные движения выражающиеся изгибами тела пищеварительная система пред ставлена передним ротовая полость глотка пищевод средним задним отделами рис 60 ротовое отверстие обычно прикрыто губами хищных форм рот вооружен хитиновыми зуб чиками фитофагов ротовой лости имеется стилет которым прокалывают ткани растений пище вод имеет одно несколько расши рений бульбусов мощной мускула турой передний отдел кишечника выстлан эктодермальным эпителием процессы переваривания пищи происходят средней части кишки стланной однослойным эпителием энтодермального происхождения зад няя кишка выстлана кутикулой заканчивается анальным отверстием органы дыхания свободноживущих нематод фитопаразитов га зообмен происходит покровы тела большинства паразитов жи вотных человека анаэробное дыхание органы выделения головном отделе нематод расположены однадве гигантские клетки гиподермы называемые шейными желе зами которые выполняют функции осморегуляции выделения леза имеет отростки канал внутри который открывается наружу многих нематод шейная железа представляет собой большую клетку двумя отростками которые тянутся вдоль тела боковых валиках ги подермы имеют внутри каналы каналы шейной железе слива ются открываются наружу порой брюшной стороне передней части нематоды функцию почек накопления выполняют однадве па ры фагоцитарных клеток лежащих около выделительных каналов органы размножения нематоды раздельнополы обычно вит половой диморфизм паразитических нематод самки крупнее самцов задний конец тела которых закручен части фитонематод самки созревании яиц сильно раздуваются приобретая округлую форму половые органы имеют трубчатое строение 100 мужские половые органы правило представлены непарной iрубкой самый тонкий конец которой является семенником средняя часть трубки   семяпровод наиболее толстый отдел   семяизвергатель 11 м й канал который открывается задний отдел кишечника анус самцов выполняет функцию клоаки совмещая роль ануса полового отверстия коло клоаки самцов расположены совокупительные спикулы женская половая система парная хотя представители непар ной женской половой системой нитевидные яичники постепенно пе реходят яйцеводы которые расширяются переходят толстые ка налы   две матки матки открываются непарное влагалище поступает сперма самца которое последующем наружу водятся оплодотворенные яйца влагалище открывается половым иерстием брюшной стороне передней трети тела особом перехва ге   пояске размножение половое редко   партеногенетиче i кое оплодотворение внутреннее большая часть нематод откладывают нйца живородящие виды развитие большей части видов прямое других   метаморфозом н сменой хозяев некоторых паразитических форм цикле разви тия имеется гермафродитное поколение личинки период роста развития линяют периодически сбрасывая кутикулу препятствую щую увеличению размеров последней линьки личинки превра щаются молодых половозрелых самок самцов точки зрения значения сельского хозяйства нематод условно разделить группы   свободноживущие водоемах почвах сапрофитные хищные формы питающиеся органическими остатками представителями мелкой почвенной фауны   паразиты растений обитающие тканях различных растений те чение всей жизни определенной стадии своего развития ® паразиты животных человека паразитических нематод условно разделить две экологи ческие группы геогельминты часть жизненного цикла которых прохо дит внешней среде биогельминты развитие которых проходит одном нескольких хозяевах выхода внешнюю среду свободноживущие круглые черви соленых пресных водах также почве обитает множество свободноживущих мелких круглых червей водные нематоды являются важным звеном цепях питания iюдныхживотных сельского хозяйства большой интерес представ ая ют нематоды населяющие почву предпочитают увлаж 11енные богатые органикой почвы благоприятных условиях обита ния 1 м2 верхнего почвенного слоя насчитать десятки миллио нов этих червей основная часть   постоянные обитатели почв значительное число находится почве определенной ста ции своего развития жизненного цикла почвенные нематоды питаются гниющими остатками растений других органических веществ хищные нематоды поедающие других мелких почвенных животных почвенные нематоды явля 101 ются участниками почвообразовательного процесса перерабатывая органику нематоды способствуют гумификации почв зная биологи ческие особенности почвенных нематод изучив закономерности жизненных циклов полеводы могут создавать благоприятные условия жизнедеятельности используя соответствующую технику сис тему обработки почв мелиорации внесения органических мине ральных удобрений т п зная особенности жизнедеятельности хищ ных нематод попытаться использовать борьбы вредны ми животными частности фитонематодами круглые черви   паразиты растений фитонематоды круглых червей паразитирующих растениях фитонематоды характерны небольшие размеры тела длина 01 12 мм ширина около 15 20 мкм имеющего цилиндрическую нитевидную веретено образную форму часто самки уплощены форме напоминают ме шок лимон тело состоит трех отделов головного собственно те ла хвостового ротовой полости нематод имеется колющий орган   стилет копье помощью нематода прокалывает ткани растений стилете находится канал который нематода впрыскивает секрет желез пищевода растение общим большинства фитонематод яв ляется частично внекишечное пищеварение секрете желез пищевода содержатся пищеварительные ферменты которые вызывают гидролиз высокомолекулярных соединений приготовленная полупереварен ная питательная смесь засасывается помощью стилета кишечник фитонематоды заканчивается процесс переваривания всасыва ния пищи средней части пищевода имеется расширение   бульбус помощью паразит всасывает соки растений рис 61 движении фитонематоды совершают медленные волнообраз ные движения неподвижные формы это   самки тип питания которых требует перемещения таких нематод мускулатура полно стью редуцирована подвижна лишь передняя часть тела нематоды могут передвигаться небольшие расстояния   пределах 30 см б рис 61 формы стилета копья фитонематод  г   стилеты д з   копья 102 существуют формы подвижные передвигающиеся расстоя ния 100 см фитонематоды раздельнополы характерен половой димор физм особенно сильно половой диморфизм выражен видов имею щих раздутых сидячих самок характеризующихся мешкообразной формой тела самцы имеют типичную нематод нитевидную форму способны передвигаться размножаются фитонематоды половым путем очень редко встреча ется гермафродитизм партеногенез размножение происходит яйцами виды которых наблюдается живорождение   личинки выходят яиц яичнике самки оплодотворение внутреннее самца имеются специальные выросты дна клоаки   спикулы значение   расширение вульвы совокуплении спермин фитоне матод совершают амебоидное движение лишены хвоста плодовитость фитонематод высока одна самка отложить сколько сотен яиц отдельных видов это число доходит несколь ких тысяч следует различать показателя плодовитости число яиц отложенных самкой число яиц развивающихся матке самки одновременно нематоды откладывают яйца соответствии своим образом жизни ткань растений яйцевой мешок субстрате внутрь галла вздутия месте повреждения паразитом яйца могут оставаться теле самки последнем случае тело представляет собой нечто вроде цисты механизм выхода личинки яйца весьма сложен конца ясен виды которых выход личинок стимулируется выделениями корней растенийхозяев других представителей выход личинок зави сит влажности температуры содержания кислорода т п ходом личинка яйце совершает быстрые движения разрывающие обо лочку яйца развитие личинок включает четыре личиночных возраста взрослую форму стадии четко разграничены линьками личинки первого возраста ряда видов проходят линьку яйце тип первой линьки называют закрытым денударным ха рактерен фитонематод сапробиотические нематоды первую линь ку проходят вне яйца   открытый тип конвелярный личинки первого возраста отличаются взрослых форм имаго основном значительно меньшими размерами также недоразвитыми половой пищеварительной системами зачаточная половая система появляется лишь личинок второго возраста затем мере роста развития личинок достигает своего окончательного развития началом линьки личинки перестают питаться процессе линьки вся кутикула сбрасывается одновременно формируется новая период развития нематод меняться соотношение полов неблагоприятных условиях внешней среды нетипичное растениехозя ин засуха нематодоустойчивые сорта развивается самцов число генераций нематод имеющих несколько поколений также висит условий среды прежде температуры влажности 103 онтогенез фитонематод обусловлен особенностями связи рас тениемхозяином одна группа фитонематодэктопаразитов питается проникая стилетом растение весь жизненный цикл проходит почве мигрируют лонгидоры триходоры др группы нематод полуэндопаразитов корней спиральные нема тоды часть жизненного цикла проходит почве мигрируют часть   корнях растений внедряются передним концом тела эндопаразитические формы фитонематод развиваются корнях растений могут свободно мигрировать корней почву обратно т е почва этих нематод является средой переживания пратиленхи онтогенез нематод эндопаразитов корней тиленхиды гетеродериды др проходит тканях растений выхода паразитов почву растения этих фитонематод являются постоянной средой обитания нематод поражающих надземные части растений особенностям онто генеза также условно разделить группы эктоэндопара зиты которые мигрируют растении почва этих нематод нужна второй группы эндопаразитических нематод стеблевые нематоды ко торые мигрируют тканях растений также группы галлообразо вателей ангвины онтогенез проходит одном локальном месте растения почва этих двух последних групп служит средой переживания систематика вредоносных фитонематод базируется различиях морфологии биологии особенностях экологии класс круглые черви nematoda подкласс сецерненты фазмидиевые secernentea отряд тиленхиды настоящие шишкоиглые немато ды tylenchida отряд афеленхиды aphelenchida подкласс аденофореи adenophorea отряд дорилаймиды dorylaimida небольшое число фитонематод относятся отряду афеленхиды нематоды повреждают надземные части растений завязи почки листья могут экто эндопаразитами рисовый афелен xoud aphelenchoid besseyi является полифагом наибольший вред приносит рисовым земляничным посадкам нематоды разного воз раста сохраняются пленкой рисовой зерновки послеуборочных остатках весной нематоды выходят почву отыскивают всходы риса земляничная нематода симбиозе бактерией corynebacteriumfascian вызывает заболевание земляники  цветная капуста  хризантемная нематода aphelenchoid ritzemabosi является эктопа разитом хризантем земляники крыжовника смородины томата ма лины других растений паразиты зимуют стеблях почве отраде дорилаймиды подкласса аденофореи имеется несколько видов нематод являющихся паразитами растений крупные нематоды семейства лонгидориды повреждают многие культуры овощные свеклу табак зерновые бобовые травы землянику древесные т д 104 основная масса червей пара лx зитирующих растениях фито нематод относится отряду 111ишкоиглые нематоды подклас са сецерненты подкласс входят также нематоды почвен ные сапробиотические хищные паразиты насекомых нематод семейства гетероде риды часто называют разнокожими нематодами самки гетеро дерид имеют шаровидное тело плотными часто окрашенными покровами самцы   вытянутое гонкое тело прозрачными покро вами нематод сильно развит сти лет самок парные яичники самцов семенника рис 62 цикл развития цистообразующих подсемейство гетеродерины нематод ji луу   личиночные стадии относится группе цистообра зующих нематод которых жизненном цикле обязательно наличие особых образований отмершего тела самки   цист цистах яйца инвазионные личинки течение нескольких лет сохраняют жизнеспо собность неблагоприятных условиях биологический цикл видов цистообразующих нематод одина ков рис 62 перезимовавших почве цист весной выходят личинки второго возраста поражают корни растений которые часто находят посредством хемотаксиса выделения корней растенияхозяина корнях личинки становятся неподвижными усиленно питаются линяют превращаются бутылковидных личинок третьего возраста следующей линьки превращаются сильно утолщенных чинок четвертого возраста принимающих шаро лимоно груше мешкообразную форму подвижен головной отдел чинок четвертого возраста развиваются самки самцы соотношении 11 неблагоприятных условиях развития доля самцов возрастает самцы оболочке личинки находятся свернутом состоянии сле разрыва шкурки самцы выходят разрыв корня растения поч ву тело самцов тонкое прозрачное позволяет обнаружить невооруженным глазом самки также разрывают ткани коры корня растения рыве находится задний конец тела головной отдел погружается ткань корня таким образом самки прикреплены корням крупное 1 х05 см белое тело легко обнаружить невооруженным глазом самцы находят самок оплодотворяют погиба ют хотя некоторых видов самец оплодотворить несколь ких самок самки некоторых видов вырабатывают половые аттрактан играющие важную роль привлечении самцов 105 оплодотворенные самки питаются начинают откладывать яйца число которых зависит наличия пищи других абиотических фак торов обычно составляет несколько сотен большая часть яиц оста ется теле самки самки некоторых видов откладывают наружу латинообразной массе яйцевом мешке нескольку яиц процесс яйцекладки завершен теле самки регене рируют внутренние органы покровы тела меняют цвет становясь коричневыми затвердевают самки превращаются цисты которые опадают почву зимуют цисты могут находиться почве долгие го ды сохраняя жизнеспособность яиц личинок цисту превращается самка вида дающего несколько генера ций вегетативный период часть личинок выходит сразу образования другая часть остается цистах несколько лет обеспечивает высокую выживаемость фитонематод цистообра зующие нематоды паразитируют внутри корней растений приво дит задержке роста развития растенийхозяев степень ущерба культуре обусловлена численностью паразита цистообразуюших фитонематод значительный вред приносят овсяная нематода heterodera avena люцерновая нематода н medica gini соевая нематода н glycin свекловичная нематода н schach tii картофельная нематода н rostochiensi некоторые другие овсяная нематода avena является представителем семейства разнокожих нематод heteroderida это вредитель злаковых культур прежде овса также пшеницы ячменя известны случаи растениямихозяевами служили пырей овсяница дикий овес расте ния пораженные овсяной нематодой отстают росте листья рано желтеют ущерб особенно велик засушливые годы гельминты задерживают поступление воды питательных веществ растение представители цистообразующих нематод овсяная немато обладает четким половым диморфизмом лимоновидные самки крыты беловатой слизистой оболочкой постепенно кутикула взрос лой самки темнеет самка превращается бурую цисту самцы имеют нитевидное прозрачное тело длиной 12 14 мм цикла развития овсяной нематоды характерно наличие одной генерации год весной цист нематод перезимовавших почве начинается выход личинок второго возраста внедряются корни проростков овса начинают питаться линьки самцы приобретают нитевидную форму самки становятся лимоновидными оплодотворенная самка начинает продуцировать яйца формиро вание цист происходит почве глубине 10 40 см цисты должны перезимовать активация личинок яйцах цисты становится возможной прохождения периода низких температур бороться овсяной нематодой путем использования севообо ротов возвратом посевов зерновых злаков ранее 4 года также выведением устойчивых нематодам сортов зерновых злаков картофельная нематода н rostochiensi паразитирует корнях клубнях картофеля является одним самых опасных вредителей кар 106 гофеля объект карантинных меро приятий европейской части рф паразит постепенно расселяется восток поражает растения семейства пасленовых   карто фель томат баклажан растения сильно угнетены листья рано жел теют завядают урожай сни жаться 80 самца тонкое прозрачное тело длиной 12 мм самки ша ровидной формы диаметром 1 мм мере старения покровы самки ок рашиваются коричневый цвет становясь черными самки живут корнях картофеля выглядят мелкими желтоватоко ричневыми шариками рис 63 са мок яйцевых мешков образуется одной цисте 1200 яиц личинки нематод выходят цист проникают корни всхо дов картофеля корнях образу рис 63 самки картофельной нематоды ются вздутия месяц расту heterodera rostochiensi щие личинки разрывают кору кор   циста б   самки корнях карто ня линяют последний стано феля вятся взрослыми червями самцы выходят почву поиска самок спаривания ними оплодотво ренных самок тело становится шаровидным полость заполняется яйцами выхода личинок цист необходимы оптимальные температура влажность наличие растенияхозяина выделения корней растенияхозяина стимулируют выход личинок новая генера ция личинок появляется 40 75 сут т е течение лета возможно развитие одной реже двух генераций фитогельминта борьбы картофельной нематодой профилактики заражения рекомендуется использовать противонематодный севооборот возвра щением восприимчивых культур ранее 3 4 года хорошие результаты дает выращивание нематодоустойчивых сортов картофеля свекловичная нематода н schachtii распространена повсюду осо бый вред приносит южных регионах выращивают сахарную свеклу лимоновидное тело самки окрашено темножелтый бурый цвет рис 64 размеры тела самок превышают 07 1мм длину 04 05 ммвширину самец нитевидным прозрачным телом диаметром 002 003 мм достигает длины 15 мм стилет мощный семенник свекловичная нематода паразитирует растениях семейств маре вых крестоцветных особый ущерб причиняет посевам сахарной 107 рис 64 свекловичная нематода terodera schachtii   корневая система свеклы врежденная нематодой б   самка нематоды 1   стилет 2   средний бульбус 3   вульва 4   яйца свеклы потери урожая могут достигать 60 одновре менном снижении 15 сахаристости недоста точного питания пораженные нематодой растения угнете ны листья желтеют засы хают посевы поражаются пятнами участках боль шим количеством цист поч ве наблюдаться полная гибель растений самки свекловичной матоды отличие овсяной картофельной могут откла дывать часть яиц яйцевые мешки благоприятных условиях давать несколько генераций течение вегетации свеклы развития одного поколения требуется около 4 5 нед развитие одной генерации свекловичной нематоды 18 ° занимает 57 сут 28 °   24 сут причине московской области две генерации винницкой   четыре самка формирует 100  150 яиц личинки которые находятся яйцах заключенных цисты могут сохранять жизнеспособность 9 лет выход личинок цист начинается температуре 10 ° выше оптимумом считается 18 28 радиус расселения личинок цис превышает 40 см выхода личинок необходимы ответствующие температура влажность почвы наличие расте нияхозяина секрет корней которого активирует нематод профилактики рекомендуют бороться сорными растениями семейств маревые крестоцветные соблюдать севооборот воз вращением повреждаемых культур ранее 5 лет использо вать нематодоустойчивые сорта свеклы применять севооборотах рас тения антагонисты фитонематоды вика клевер другие бобовые цикорий злаковые др представители рода мелойдогины семейства мелойдогиниды meloidogynida относятся галловым нематодам особенность галло вых нематод самки превращаются цисту биологи ческий цикл галловых нематод одинаков 108 находящиеся почве личинки второго возраста находят корни рас тенийхозяев внедряются располагаясь головным концом судам проводящих пучков корня задним концом коре корня матода выделяет особые вещества действием которых вокруг го ловной части фитогельминта образуются гигантские клетки содержимым этих клеток питаются паразиты личинки развиваются линяют проходя стадии личинок третьего четвертого возрастов затем превращаются самок самцов матод средняя часть тела сильно утолщается самцы выходят почву самки последней линьки сильно раздуваются самка разрывает кору корня растения задняя часть вульвой высовывается наружу становясь доступной оплодотворения головная часть самки оста ется погруженной корень самка продолжает питаться размножаются галловые нематоды партеногенетически общее число яиц достигает сотни откладка яиц происходит течение вегетационного периода растения тела самки яйца выходят виде яйцевого мешка мешки видны корнях невооружен ным глазом развитие яиц происходит мешке личинок второго воз раста которые уходят почву далее цикл повторяется теплицах юж ная галловая нематода дать семи поколений важной особенностью галловых нематод является образование гал лов галлы представляют собой гипертрофированную паренхиму коры корня которая образуется вокруг внедрившейся личинки виде взду тия размеры галлов могут варьировать 1 мм огромных разраста ний некоторые растения галлов образуют другая особенность гал ловых нематод   широкая пищевая специализация полифаги известно 70 видов галловых нематод нашей стране практиче ское значение имеют южная галловая нематода meloidogyn incognita северная галловая нематода м hapla северная галловая нема тода открытом грунте распространяется далеко север остальные виды встречаются южных регионах тепличных хозяйствах рис 65 среди представителей семейства тиленхиды tylenchida относя щихся настоящим шишкоиглым нематодам широко распро страненные вредители сельскохозяйственных культур самки самцы личинки тиленхид имеют червеобразное тело заостренными голов ным хвостовым концами стилет развит слабо самок большин стве случаев яичник пшеничная нематода anguina tritici поражает сорта пшеницы распространена южных регионах страны фитогельминтов пше ничная нематода является самым крупным видом длина половозрелых самок достигает 5 мм толщине 01 02 мм самцы мельче самок пшеничная нематода живет тканях надземных частей пшеницы типичным признаком повреждения является образование галлов вме сто нормального зерна рис 66 зрелые галлы напоминают форме размерам зерна пшеницы отличаются коричневой окраской шероховатостью внутри галла находится белая масса состоящая основном личинок нематод находящихся анабиозе 109 рис 65 галловая нематода 6саме г л л ы корнях огурца 1 стилет 2 бульбус 3 пишева 7яичлле3а нер вн ° е ° л ь ц 0 5 делительное отверстаеб г ш г ™ яйцевод 9 матка яйцами 10 половое отверстие 11 анус семяприемник 13 семяпровод 4   семяизвергательный канал 5 спикулы рис 66 пшеничная нематода   самка 6  молодое растение пшеницы зараженное нематодой   галлы г   здо ровый колос пшеницы д   колос пораженный нематодой жизненный цикл пшеничной нематоды приспособлен циклу вития растенияхозяина весной вместе галлами фитогельминты падают почву высеваемым зерном почве могут находиться гал лы которые осыпались поврежденных колосьев осенью внутри гал лов содержатся личинки второго возраста разбухании галлов действием почвенной влаги личинки выходят двигаются направ лению проросткам пшеницы далее 15 20 см материнского галла значительная часть личинок погибает достигшие проростков пшеницы личинки заползают пазухи листьев становятся эктопара зитами яровые посевы поражаются весной озимые могут повреж даться осенью период формирования колоса фитогельминты перебираются зачатки цветков злаков которых формируются галлы окон чательного формирования галла необходимо присутствие несколь ких самцов самок нематоды галле достигают половой зре лости копулируют самка откладывает 25 тыс яиц яиц являются личинки которые питаются ослизненной тканью галла одном галле обитать 17 тыс личинок галлы завершают свое развитие несколько позже зерен пшеницы это время личин ки заканчивают питаться впадают анабиоз взрослые особи гибают часть зрелых галлов выпадает колосьев уборки урожая большая часть высвобождается колосьев время обмолота пшеницы засоряя зерно состоянии анабиоза галле личинки могут сохранять жизнеспособность течение 25 лет пора 111 женные растения пшеницы отста ют росте стебель искривляется главная мера борьбы пше ничной нематодой   предпосев ная очистка зерна пшеницы ис пользование севооборотах очистки полей нематод чистых паров т п стеблевая нематода картофе ля ditylenchus destructor является представителем семейства стоящих шишкоиглых нематод tylenchida встречается всей территории рф нематода имеет небольшие размеры длина тела самок 07 14 мм самцов   07 13 мм стилет небольшой тонкий стеблевая нематода ражает основном картофель вызывает разрушение клубней типу сухой гнили рис 67 одна ко могут повреждаться также мор ковь горох томат некоторые сорные растения признаки пора жения виде небольших белова тых пятен видны срезания кожуры клубня картофеля пе рис 67 стеблевая нематода картофеля риод хранения пораженных клубнях появляются серые пят затем кожура сморщивается растрескивается открывая доступ гнилостным микроорганизмам итоге происходит разрушение клубней весь цикл развития стеблевой нематоды картофеля происходит внутри тканей растенияхозяина основной источник расселения фи тогельминта   поврежденный посадочный материал определяет меры профилактики борьбы этим фитогельминтом нематоды больного маточного клубня мере роста растения пе реходят столонам молодые клубни реже заселение молодых клуб происходит почвы стеблях клубнях паразиты размножают ся давая лето несколько поколений осенью основная масса нема тод остается клубнях часть мигрирует почву особое внимание следует уделять уборке послеуборочных остатков утилизации представителем семейства настоящих шишкоиглых нематод является стеблевая нематода луке чесноке ditylenchus dipsaci это многоядный фитогельминт которого насчитывают 20 экологических рас разли чающихся тому каких растениях расы паразитируют луковая 112 раса широко распространена нашей стране строению стеблевые матоды луке чесноке сходны стеблевой нематодой картофеля поврежденных луковиц репчатого лука рыхлые чешуи ткань бухает лукасевка боковой стороне поврежденной луковицы замет яркобелое пятно   очаг размножения фитогельминта заселенные растения отстают росте сильное поражение вызывает гибель посевов гибели растения нематоды уходят почву стеблевая нематода мо жет впадать анабиоз сохранять жизнеспособность течение 2 3 лет благоприятных условиях нематоды размножаются тканях расте ний непрерывно давая поколение поколением нижний порог ак тивности фитогельминта лежит пределах 7 9 уборки уро жая стеблевая нематода сохраняется послеуборочных остатках повре жденных растений реже почве лук хранят высоких температурах пораженные луковицы усыхают низких температурах загнивают основными источниками распростране ния луковой расы стеблевой нематоды являются луксевок почва определяет профилактику борьбу этим фитогельминтом нашей стране широко распространены другие расы стеблевой нематоды числе землянике d dipsaci которая своему строению идентична луковой расе пораженных растений видны вздутия стеблях черешках листьях утолщения происхо дит размножение фитогельминта становятся мягкими трухлявыми размножаются развиваются нематоды наземных ак тивно растущих частях выхода внешнюю среду зимует нема тода сердечках земляники реже листьях сезон дает четырехпяти поколений главной причиной распространения нема тоды является использование заселенной ею рассады земляники особенности экологии фитонематод жизненный цикл фитонематод связан растениями почвой взаимоотношения нематод окружаю щей внешней средой прежде растениями определяют целый ряд важных особенностей которыми обладают животные свиде тельствующих путях развития круглых червей типичных почвен ных форм узкоспециализированных вредителей растений осно ве взаимоотношения растением построена экологическая классифи кация нематод типичные сапробионты   нематоды живущие гниющей среде часть обитают мертвой древесине другие   разлагающихся корнях третьи   погибших зеленых растениях типичных сапробионтов ку тикула имеет повышенный коэффициент полупроницаемости пре пятствует проникновению вредных веществ тело нематод гнилост i юй среды следует учитывать сапробиотические процессы сопро вождаются постоянной сменой бактериальной флоры естественно ведет соответствующим изменениям видовом составе нематод нетипичные сапробионты этих нематод также характерно оби тание гнилостной среде могут заселять живую ткань расте ний проникая самостоятельно вслед патогенными орга ii измами таких нематод повысилась проницаемость кутикулы изме n 6407 113 нился характер движения замедлились процессы развития темпы размножения нематоды значительной степени зависят бактерий деятельности сами черви способны воздействовать хими ческим путем растительную ткань способны лишь поврежде нию растений измельчению тканей проглатыванию мелких частиц прикорневые нематоды обитают ризосфере связаны растением нематоды либо имеют стилет либо являются хищниками первые прокалывая стилетом ткани растения питаются главным образом соками вторые питаются животными организмами обитающими прикорневой части растений фитогельминты относятся настоящим вредителям растений характерны постоянное пребывание органах растений развитие пищеводе желез секрет которых способен разрушать ткани расте нияхозяина изменения происходят поврежден ном органе растении целом фитогельминты вооружены стилетом кутикула обладает наивысшими барьерными свойствами фитогельминты совместимы сапробиотической средой загнивании пораженного органа уступают место сапробиотическим организмам лишь некоторые фито гельминты могут существовать гниющих остатках питаясь види мому гифами грибов таким образом некроз ткани приводит пересе лению фитогельминта здоровые части растения почву воздействие нематод растения многие фитогельминты приспо собились жизни ограниченном круге растенийхозяев например стеблевая нематода картофеля живет тканях растений кото рые богаты углеводами фитогельминт вырабатывает большое количе ство амилолитических ферментов гидролизующих крахмал клубней сахаров отсюда разрушение клубня типу сухой гнили вследствие оттягивания воды поврежденной части клубня здоровую стеблевая нематода луке чесноке вызывает сильное набухание поврежденного участка луковицы роста активности пектиназы разрушающей чешуи галловые нематоды вызывают изменения процессах обмена ве ществ растения фитогельминты ведут неподвижный образ жизни корнях растений поэтому поврежденные корни разрушаются сильно видоизменяются вокруг переднего конца гельминта формируется группа гигантских многоядерных клеток паренхиме корня происходит усиленное разрастание ткани приводящее образо ванию галла нематода питается счет гигантских клеток которые паразит вводит стилет выделяет пищеварительные ферменты клет ка выделяя веществаингибиторы быстро тормозит действие гидро литических ферментов нематоды результате нематода получает часть пищи ткань растения остается живой фитогельминты приспособились жизни органах растенийхозяев патогенные фитогельминты могут лезными поражают сорнйе растения перспективе возможно использовать некоторые виды нематод борьбе сорняками 114 фитогельминты воздействуют растения растения могут оказывать существенное влияние вредителей известно пример выращивании растений пленочными укрытиями теплицах стекла значительно снижается ущерб галловых матод оказывается пленочное укрытие пропускает ульт рафиолетовых лучей которые способствуют усиленному синтезу рас тении ингибиторов подавляющих ферменты фитонематод почву растенияхозяев фитогельминтов опосредованно иоздействует комплекс абиотических биотических факторов абиотических факторов наибольшее влияние оказывают температура влажность механический состав почвы кислотность обеспечен ность кислородом насыщенность солями биотические факторы сложны многочисленны отношения нема тод микроорганизмами агробиоценозе внутривидовые отношения фитонематодами свободноживущими нематодами хищника ми паразитами отдельными видами фитонематод пищу г п отношения патогенными грибами бактериями естест венные враги нематод пр абиотические факторы климатические факторы числе пература влажность определяют географическое распространение нематод каждого вида характерны свои оптимальные предель ные температуры низкие высокие которых происходит витие широкое использование приемов выращивания растений крытом грунте позволило фитогельминтам продвинуться далеко се вер большинство видов цистообразующих нематод приспособлены температурам влажности средней полосы стеблевая нематода карто феля малой степени зависит влажности поэтому распространена картофелепроизводящих районах нематод которых почва является средой развития хранения активации личинок решающее значение имеет сочетание оптимальных показателей влажности температуры период массового заселения надземной части корней всходов инвазионными личинками нематод непрерывно развивающихся тканях растений хода внешнюю среду имеется пик численности паразита пература влажность оптимальны быстрого развития популяции большое значение нематод имеет механический состав почвы поскольку порам нематоды передвигаются поэтому большинст видов нематод обитают легких почвах биотические факторы наиболее изучены взаимосвязи нематод различными организмами почвенного биоценоза некоторые являются естественными врагами нематод другие грибы бактерии выступают компонентами сложных болезнях растений третьи ис пользуют нематод качестве переносчиков одного растения дру гому вирусы бактерии грибы естественными врагами нематод могут хищные нематоды клещи грибы вирусы бактерии последние вызывают болезни нема тод гибель почвенные грибы враги нематод имеются 115 почвах особенно почвах богатых органикой серьезный ущерб нематодам наносят хищные грибы   гифомицеты ловят своих жертв помощью клейких колец узлов спор способ пора жения хищными грибами простой споры кольца прорастают те ло жертвы гриб начинает питаться нематодой грибы поражаю щие яйца цистах нематод таких пораженных яйцах личинки поги бают грибы родов verticillium nematophtora поражающие самок цистообразующих нематод великобритании предлагают использо вать борьбы овсяной нематодой врагам нематод относятся амебы инфузории споровики тихо ходки членистоногие числе клещи хищные нематоды неблагоприятным условиям среды низкой температуре зимой сухости почвы отсутствию растенийхозяев нематоды приспособи лись разному самый распространенный способ   анабиоз сохра нение жизнеспособности неблагоприятных условиях состояние анабиоза большинства видов могут впадать личинки второго возрас та заключенные цисты галлы также личинки находящиеся растении последнем случае анабиоз менее продолжителен круглые черви   паразиты животных человека значительное число круглых червей являются паразитами различных сельскохозяйствен ных животных также большинства диких позвоночных гель минты вызывают опасные заболевания снижают продуктивность жи вотных причиняя существенный ущерб животноводству страны которые круглые черви паразитируют человека наиболее часто животных человека паразитируют нематоды группы геогельмин тов очень опасны человека биогельминты трихинелла спираль ная нитчатка банкрофта другие рассмотрим биологические особен ности наиболее распространенных нашей стране опасных парази тических видов нематод аскариды различные виды сем ascarida живут кишечнике мно гих диких домашних сельскохозяйственных млекопитающих сви ньи лошади птица кролики мелкий крупный рогатый скот собаки др также человека особенно часто детей особенностью аскарид является видовая специфичность каждому виду млекопитающего присущ свой вид аскариды рис 68 свиная ascarissuum человече ская ascari lumbricoid аскариды весьма близки многим призна кам редко заражается свиной аскаридой свинья   чело веческой одна самых крупных аскарид паразитирует тонком ки шечнике лошадей parascari equorum человека паразитирует аскарида длина которой достигает 20 см аскариды имеют веретенообразное тело длиной 20 40 см диа метре 3 5 мм развит половой диморфизм самки значи тельно крупнее самцов хвостовой отдел самцов загнут крючком пло довитость самок очень высокая   200 тыс яиц сутки оплодотворе ние внутреннее оплодотворенное яйцо одевается прочными оболочками которые защищают зародыш неблагоприятных условий внешней среды погруженные слабый раствор формалина 116 рис 68 аскарида лошадиная   внешний вид б   внутреннее строение 1   рот 2   пищевод 3   кишка 4   око логлоточное нервное кольцо 5  брюшной нервный тяж б   боковой валик гиподермы каналом выделительной системы 7  фагоцитарные клетки 8   яичники 9   яйце воды 10   матка   влагалище 12   анальное отверстие 13  семенник 14   семя провод 15  семяизвергательный канал яйца аскарид сохраняют жизнеспособность месяца вредно дей ствуют яйца ультрафиолетовые лучи дробление яйца начинается теле самки аскариды основное развитие личинки проходит внешней среде течение 8 30 сут определяется главным образом температурой среды внешнюю сре ду яйца попадают фекалиями хозяина окончания развития чинки яйцо становится инвазионным т е способным заражению хо зяина проглотив такое яйцо животное заболеть аскаридозом заражение происходит потреблении загрязненных яйцами аска 117 рис 69 схемы жизненных циклов нематод   паразитов человека   геогельминты смены хозяев миграцией личинок крови аскарида власоглав свайник б  геогельминты смены хозяев миграции личинок крови ост рица   геогельминты сменой хозяев ришта г   биогельминты смены хозяев трихинелла д   биогельминты сменой хозяев нитчатка банкрофта 1   яйцо 2   личинка 3   половозрелые особи рид корма воды также предметы ухода оборудование стилку т п рис 69 кишечнике хозяина яиц выходят микроскопические личинки которые внедряются стенки тонких кишок проникают кровяное русло током крови выносятся капилляры легочных пузырьков   ильвеол паразит растет это время возникнуть воспали тельный процесс легких кровотечение легких личинки че рез бронхи дыхательное горло откашливании хозяина попадают i лотку затем вместе кормом слюной подросшие личинки снова падают кишечник заканчивают свое развитие приступают множению развития личинок аскарид требуется около 2 3 мес миграция личинок кишечника легкие происходит видов аскарид гельминтов паразитирующих кур собак разные ви ды аскарид организме хозяина живут нескольких месяцев года массовом заражении аскариды могут вызвать закупорку ки шечника хозяина питаясь содержимым кишечника аскариды фиксируются просвете кишечника дугообразно изгибаясь упира ясь головным хвостовым концами тела стенку кишки противостоят перистальтическим движениям кишечнике тысячи гельминтов продукты жизнедеятельности аскарид ядовиты поэтому вызы вают интоксикацию организма хозяина аскаридам свойственно ана эробное дыхание котором высвобождение энергии сопровождает ся образованием вредных веществ валериановой масляной других органических кислот конечные продукты анаэробного обмена аска рид попадая кровь хозяина вызывают малокровие интоксикацию особенно опасны такие продукты молодняка животных чело века   детей личинки аскарид время миграции организме хозяина могут способствовать проникновению бактерий внутренние органы ас каридозы животных широко распространены особенно часты случаи заболевания лошадей свиней борьбе аскаридозами важное зна чение имеют меры профилактики чистота помещении правила ги гиены содержание животных кроликов птиц др сетчатых полах др особое внимание уделяют удалению навоза чистоте туалетов борьбе мухами   переносчиками яиц гельминтов установлена роль земляных червей распространении аскаридоза черви заглатывают яйца аскарид вместе растительными остатками почвой кишечнике червей яиц выходят личинки которые сохра няют червях жизнеспособность года поедая дождевых червей свиньи заражаются аскаридами подсосные поросята заражаются че рез вымя личинки аскарид могут сохраняться организме мух личин ках жуков других насекомых которые дождевые черви явля ются резервуарными хозяевами аскарид последние годы получены данные заглатывании челове ком инвазионных яиц свиной аскариды личинки могут выходить яиц мигрировать всему организму человека оседая различных 119 внутренних органах например мозге печени т п это вызывает человека тяжелое заболевание общую интоксикацию организма кишечнике кур паразитирует небольшая нематода внешне похо жая аскариду   аскаридия ascaridia galli самки нематоды достигают длину 11 см самцы меньше   7 см яйца аскаридии сле выхода пометом наружу становятся инвазионными 7 20е сут куры цыплята заражаются поедая загрязненный инвазионными яй цами корм кишечнике птицы личинки высвобождаются оболочек яиц затем внедряются стенки кишечника развиваются течение 16 20 сут выйдя снова просвет кишечника личинки достигают зре лости весь цикл развития длится 35 58 сут особенностью развития аскаридий является отсутствие цикле миграции телу хозяина аскаридиоз вызывает массовую гибель молодняка снижает яйце носкость взрослых кур резкому снижению заболеваемости аскаридио зом способствует содержание птицы клетках сетчатых полах острицы различные виды сем oxyurida паразитируют толстом отделе кишечника позвоночных человека это мелкие паразиты имеющие вздутие пищевода бульбус тонкий заостренный хвосто вой конец длина человеческой острицы enterobius vermiculari ставляет менее 2 см лошадиная острица oxyura equi дости гает 6  18 см счет своего длинного хвоста острицы equi вызывают болезнь оксиуроз лошадей мулов зебр паразитируют оксиуры большой ободочной кишке могут заселять слепую кишку тонкий отдел кишечника результате лошадей нарушается деятель ность пищеварительного тракта поражается кожа корня хвоста па разиты распространены повсеместно оплодотворения самки самцы погибают переполненные зрелыми яйцами самки вместе фекалиями спускаются анальному отверстию лошади выходят кишечника пассивно часть самок падают землю откладывают яйца поверхность испражнений часть задерживаются складках слизистой оболочки вокруг ануса кладывают яйца перианальной области корнем хвоста лошади самки откладывания яиц погибают клейкая слизистая масса которой находятся яйца образует сероватый налет перианальной области складках хвостом области промежности 2 3 сут яйца становят ся инвазионными движении хвоста лошади яйца попадают внешнюю среду загрязняя подстилку траву стены денника кормушки т п инвазионные яйца попадут кишечник лошади ходят микроскопические личинки развиваются взрослых гельмин тов чаще оксиурозу подвержен молодняк старые лошади больные животные испытывают сильный зуд области хвоста расчесывают места выступающие части денника способствуя осыпанию яиц человека чаще детей которые легко самозаражаются этим гельминтом толстой задней кишке паразитирует детская острица enterobius vermiculari это мелкие червяки длиной 5 10 мм белого цвета оплодотворенные самки выползают ночью прямой кишки 120 откладывают яйца кожу вокруг ануса 10 12 ч яйца ста новятся инвазионными самка откладывает около 11 тыс яиц яйца попадают белье постельные принадлежности пол т д сильного зуда области анального отверстия дети расчесывают это ме сто легко самозаражаются аутоинвазия нематода toxascari leonina сем ascarida взрослой стадии па разитирует молодняка старших возрастов взрослых домашних ди ких плотоядных животных вызывая заболевание токсаскаридоз это черви светложелтого цвета длиной 6 10 см самкии4 6 см самцы выделенные калом внешнюю среду яйца благоприятных условиях дозревают инвазионной стадии течение недели загло тивших зверей тонком отделе кишечника яиц выходят личинки внедряются стенку кишки линяют некоторое время чинки возвращаются просвет кишечника 3 4 нед достигают половой зрелости токсаскаридозом болеют новорожденные молодые щенки кроме щенков песца это болезнь взрослых плотоядных числе кошек собак молодых щенков паразитирует toxocara cani кошек   т mystax вызывая заболевание называемое токсокарозом токсокары отличие токсаскарид развивающихся прямым путем личиноч ной стадии мигрируют организму кишечник кровяное рус ло легкие трахея гортань кишечник течение месяца заражение плотоядных токсокарозом токсаскаридозом возможно прямым путем резервуарных хозяев которыми могут мыши другие грызуны личинки toxascari leonin гры зунов концентрируются стенках желудка кишечника песцов наблюдается внутриутробный путь заражения животных яйца токсокар токсаскарид очень устойчивы воздействиям благоприятных факторов среды обработке фекалий 5 ным рас твором фенола погибают 3 нед сильном зараже нии токсокары токсаскариды оказывают токсическое воздействие вызывая воспаление кишечника закупорку кишеч ника токсаскариды могут проникать желчные протоки печени токи поджелудочной железы желудок трахею токсокары опасны часть мигрирующих кровью личинок попадают личные органы ткани хозяина инкапсулируются долго сохра няя жизнеспособность хищники поедая животных инвазированных цистами токсокар заражаются ими токсокары которыми зара жаются дети играя песке детских площадках испражняются больные кошки стронгиляты ряд видов подотряда strongylata обширная разно образная группа круглых червей небольших размеров паразитирую щих толстом отделе кишечника разных позвоночных животных огромных количествах встречаются сельскохозяйственных животных числе лошадей других непарнокопытных именно сельскохозяйственные животные силу скученности содержания 121 ограниченности территорий пастбищ представляют паразитиче ских червей благоприятную среду заселения насчитывают около 45 видов нематод   возбудителей кишечных стронгилятозов лошадей относятся геогельминтам имеют сходное развитие внешней среде кишечные стронгилятозы   са мые распространенные повсеместно встречающиеся гельминтозы лошади самого раннего возраста поражаются этими болез нями интенсивность заселения паразитами нескольких сотен осо бей многих десятков тысяч зависит возраста условий содержа ния кормления животных часто стронгилятозы приносят сущест венный ущерб отставания росте летального исхода паразиты имеют небольшие размеры самцы достигают 05 45 см самки крупнее оплодотворенные самки продуцируют множество яиц которые фекалиями попадают внешнюю среду благоприят ных условиях среды 8 38 ° яйце формируется личинка которая выходит яйца развивается линяет достигая инвазионной стадии достаточной влажности личинки мигрируют горизонтально вер тикально почве стеблям растений лошади заражаются потреб ляя траву воду загрязненные инвазионными личинками заражение происходит теплое время года пастбище течение года утепленных конюшнях организме лошадей развитие различных стронгилят протекает одинаково некоторых видов деляфондии личинки совершают ми грацию кишечник кровеносные сосуды тромбы сосудах чинки развиваются кровяное русло стенка кишки просвет ки шечника других стронгилят strongylus equiti   самых крупных стронгилид лошадей самцы достигают длину 25 35 см самки   35 45 см личинки слизистую оболочку кишечника мигрируют поджелудочную железу развиваются течение 8 мес затем возвра щаются толстый кишечник весь срок развития составляет год пищеварительном тракте жвачных животных паразитирует боль шое число видов нематод подотряда strongylata паразиты относятся геогельминтам развитие внешней среде протекает кишечных стронгилят лошадей нематоды подотряда strongylata вызывают также стронгилятозы ор ганов дыхания сельскохозяйственных животных заболевание дик тиокаулез жвачных животных вызывают нематоды рода dictyocaulus это довольно крупные круглые черви нитевидным телом белого цве та паразитирующие легких крупного рогатого скота овец других млекопитающих представителей dictyocaulus viviparus вызы вает опасное заболевание дыхательных путей крупного рогатого ско та нематоды паразитируют бронхах трахее животных болеет основном молодняк крупного рогатого скота заболевание характери зуется развитием бронхита бронхопневмонии внешней среде личинки становятся инвазионными 4 10 сут выхода фекалиями организма хозяина личинки редко покидают фекалии распространению способствует гриб 122 pilobolus который раскрываясь разбрасывает личинок расстояние 3 м распространению личинок способствуют также паводковые ды ними личинки попадают водоемы особую опасность представ ляют мелкие лужи пастбищах телята проглотившие личинок травой водой заражаются диктиокаулезом стенку кишки личинки кровью мигрируют легкие завершают свое развитие легких половозрелые парази выбрасываются кишечник легких свиней паразитируют метастронгилиды семейства metastrongylida личинки которых живут дождевых червях поедая дождевых червей свиньи заражаются этими гельминтами которые па разитируют бронхах свиней поросят гибель достигать 30 среди биогельминтов наибольшую опасность представляет трихи нелла спиральная trichinella spirali жизненный цикл которой прохо дит полностью организме хозяина трихинеллы различают две ста дии кишечные трихинеллы мышечные трихинеллы хозяевами хинелл могут хищники парнокопытные числе свиньи насекомоядные ластоногие грызуны человека гель минты вызывают заболевание трихинеллез заражается ос новном свиней редко других частности диких животных требляя мясо пораженное мышечными трихинеллами рис70 мясе зараженных свиней рассеяны небольшие овальные капсулы каждой капсуле находится скрученная спираль микроскопическая трихинел ла длиной около 05 мм такое трихинеллезное мясо плохо термически работано съедено хозяином желудке действием желу дочного сока капсулы растворя ются молодые трихинеллы ходят попав тонкий дел кишечника трихинеллы растут 2 3 сут превраща ются половозрелых гельминтов самки достигают длину 3 4 мм самцы   15 мм черви внедряются ткань кишечника приступают размножению сле спаривания самцы погибают оплодотворенные самки крепляются головным отделом рис 70 трихинелла trichinella spirali ii самка самец б личинки инкапсу нированные мышцах свиньи 123 слизистой оболочке кишки самки живут около 2 мес это время ка ждая отрождает примерно 2 тыс личинок трихинеллам свойственно яй цеживорождение личинки проникают лимфатические сосуды стенки кишечника затем кровяное русло кровью личинки разносятся всему организму обычно попадают мышцы личинки активно дви гаясь внедряются волокна поперечнополосатой мускулатуры пи таются растут разрушая мышечные волокна затем трихинеллы закру чиваются спираль постепенно окружаются соединительнотканной капсулой примерно год стенках капсул откладываются соли уг лекислого кальция капсулы принимают белый цвет основной хозяин превращается промежуточного жизненный цикл трихинеллы бьггь иным сопротив ляемость организма хозяина снижается отродившиеся личинки трихинеллы внедряются ворсинки кишечника закончив свое развитие вновь возвращаются просвет кишечника достигают ловой зрелости это значительно увеличивает число паразитов ки шечнике продлевает срок кишечной инвазии также усиливает ражение мышц свиньи заражаются трихинеллезом поедая зараженных трихинел лой дохлых крыс свиные отходы боен крысы заражаются пи таясь тканями павших трихинеллеза других крыс свиными ходами попавшими свалку закопанными землю неболь шую глубину зараженные трихинеллами туши свиней уничтожают паразиты капсулах чрезвычайно устойчивы самым жестким режимам термической обработки мяса человека наиболее опасна мышечная стадия развития трихи неллы инкапсулирование личинок сопровождается болями мыш цах оседание трихинелл мышцах глаз вызвать слепоту ло кализация мозге   привести смертельному исходу наличие чинок трихинелл мясе свиней проверить домашних условиях помощью острой бритвы делают тонкий срез мышцы поместив двумя стеклами рассматривают лупу мясо заражено капсулы будут видны класс коловратки rotatoria этому классу относятся около 15 тыс видов круглых червей жи вущих основном пресных водоемах имеющих микроскопические размеры   004 2 мм реже встретить морях болотах мху некоторые виды паразитируют беспозвоночных некоторые являются симбионтами беспозвоночных однако подавляющее боль шинство этих животных   свободноживущие черви хотя среди встречаются представители ведущие прикрепленный образ жизни форма тела коловраток сильно варьирует большинства оно долговатое делится отдела головной мерцательным аппаратом туловищный содержащий внутренности задний ножной следний отдел отсутствовать совокупность двух венчиков ресни 124 рис 71 схема строения коловратки   вид спереди б   вид сбоку 1   го ионные чувствительные щупальца 2   коловращательный аппарат 3   рот 4   глотка жевательным аппаратом 5   слюнные железы 6   пищевод 7  лудочные железы 8   желудок 9   яич ник 10   протонефридий 11   задняя кишка 12 мочевой пузырь 13  отвер стие клоаки 14   цементные железы 15  ножной ганглий 16   пальцы ноги 7 клоака 18  спинные чувствительные щупальца 19  надглоточный ганглий чек образует коловращательный аппарат вызывающий водоворот который направляет мелкие час тицы ко рту коловратки рис 71 помощью ноги коловратки недущие прикрепленный образ жизни временно постоянно б прикрепляются субстрату ноге развиты мышцы кож i юмускульный мешок отсутствует пищеварительная система представлена ртом глоткой пищево дом объемистым желудком кишкой которая заканчивается аналь ным отверстием глотка имеет расширение   зоб снабженный хити новыми челюстями органы выделения протонефридиального типа крываются клоаку коловратки раздельнополы женская половая система состоит яичника желточника яйцевода открывающегося клоаку самцов имеется семенник семяпровод предстательные железы копулятивный орган острым стилетом которым самец прокалы вает покровы самки спермии попадают полость тела проника ют яичник оплодотворенные яйца покрываются скорлупой размножение происходит чередованием полового партеногене тического поколений последнем случае получаются ки нескольких партеногенетических поколений самки ют яйца гаплоидным набором хромосом таких яиц выходят карликовые самцы самки оплодотворенные самки откладывают покоящиеся яйца самцы обнаружены видов коловраток яиц сидячих форм выходит личинка ведущая свободноплаваю щий образ жизни коловратки многочисленны наших водоемах среди дон ные планктонные формы играющие существенную роль пищевых цепях водоемов являются очистителями водоемов поедая большое количество бактерий почвенные придонные коловратки 125 способны анабиозу перенося таким образом длительное время пере сыхания промораживания водоемов планктонных видов коловра ток устойчивостью обладают покоящиеся яйца класс скребни acanthocephala недавнего времени скребней выделяли самостоятельный тип близкий круглым червям последние исследования подтверждают общность круглыми червями хотя морфологически скребни очень своеобразные животные это исключительно паразитические черви насчитывающие около 500 видов обитающих взрослом состоянии кишечнике позвоноч ных личиночном   беспозвоночных животных рыб земновод ных развиваются сменой хозяев передний конец червеобразного тела превращен хоботок крючьями прикрепления стенке кишки хозяина тело покрыто нежной кутику лой выделяемой гиподермой гиподермой располагается слоя мускулатуры развит схизоцель пищеварительная система отсут ствует питание происходит покровы тела органы чувств развиты раздельнополы развит половой диморфизм развитие метаморфозом гигантский скребень macrocanthorhynchus hirudinaceus длиной 25 60 см паразитирует кишечнике свиней яйца попадают внешнюю среду дальнейшего развития яйца должны проглочены личин ками бронзовок майских жуков др личинки жуков взрослые жуки раженные личинками скребня съедаются свиньями выгульном держании сильное заражение свиней привести гибели животных известно скребней которые взрослом состоянии обитают кишечнике грызунов водоплавающих птиц рыб тюленей др рис 72 некоторых скребней число промежуточных хозяев достигать трех например скребней паразитирующих организме тюленей промежуточных хозяина   мелкие ракообразные рыба филогения первичнополостных червей считается первичнополосгные круглые черви ведут свое начало турбелляриеподобных предков разных классах круглых червей хранились признаки общие плоскими червями участки ресничного эпителия протонефридии участки паренхимы схизоцеле наиболее близки предкам современные коловратки брюхоресничные схема экологической радиации круглых червей представлена рис 73 тип немертины nemertini немертины   свободноживущие морские черви реже паразитиче ские пресноводные предками которых предположительно сво бодноживущие плоские черви известно около 750 видов немертин 126 рис 72 скребни   великан б   четковидный рис 73 экологическая радиация nemathelminth 1   брюхоресничный червь 2   коловратка 3   волосатик 4   яйцо 5   киноринха 6 приапулида 7  нематода водная 8  почвенные нематоды 910  паразитические нематоды обитающих преимущественно прибрежной зоне морей червеобраз ное тело 2 м покрыто мерцательным эпителием турбелля рий которым находятся кольцевые продольные слои мышц кожномускульный мешок переднем конце тела имеется вывора чивающийся хоботок зачастую вооруженный стилетом помощью немертины захватывают добычу которую затем отправляют щелевид ный рот расположенный вентральной стороны основания хоботка полость тела отсутствует промежутки органами заполнены паренхимой лишь влагалище хоботка выстлано целомическим эпите лием пищеварительная система состоит передней средней зад кишок анальное отверстие располагается заднем конце тела средняя кишка имеет боковые карманы немертин появляется развитая кровеносная система состоящая трех основных сосудов спинного двух боковых связанных собой кольцевыми сосудами сосудами кровеносной системы связа ны протонефридии выделительных канала открываются отвер стиями внешнюю среду двух пар ганглиев образующих мозг отходят боковых нерв ных ствола соединенных комиссурами имеются органы чувств это обонятельные ямки две пары глазков осязательные волоски т п немертины раздельнополы половая система примитивна сколько пар гонад короткие протоки оплодотворение наружное развитие метаморфозом стадию плавающей личинки покры той ресничным эпителием   пилидия тип немертин входит класс названием это активные хищники питающиеся мелкими животными   червями ракообраз ными моллюсками хоботок служит защиты нападения сокращении мускулатуры влагалища хоботок выворачивается наружу палец перчатки достигая значительной длины втянутом стоянии хоботок располагается влагалище петлеобразно невоору женных стилетом немертин жертва поражается ядовитым секретом выделяемым железами эпителия хоботка немертины   преимущественно придонные животные прибреж ных зон умеренных арктических вод паразитические формы живущие крабах моллюсках например северных морях типична немертина malacobdella паразитирующая мантийной полости дву створчатых моллюсков тканям моллюсков эта немертина прикреп ляется помощью присоски расположенной заднем конце тела тип кольчатые черви annelida общая характеристика кольчатые черви кольчецы   наибо лее высокоорганизованная группа червей усложненными сравне нию другими типами червей системами органов это двусторонне симметричные животные характеризующиеся наличием вторич 128 i юй полости тела целома метамерия кольчатых червей выража ется тело снаружи расчленено ряд однотипных сегментов каждом которых повторяются многие органы известно около 12 тыс видов кольчатых червей ведущих свободный образ жиз главным образом морях также пресных водоемах почве м ногие имеют важное значение служат кормом бес i юзвоночных позвоночных животных участвуют процессах почво образования служат объектом разведения используются медицин ских целях т д паразитических видов немного кольчецы активно участвуют деструкции органического вещества вовлекая самым высвободившиеся биогенные элементы круговороты особенно мно гообразны морские формы которые живут разных глубинах 10 км тип кольчатые черви включает класса многощетинковые черви polychaeta малощетинковые черви oligochaeta пиявки hirudinea строение жизненные отправления форма тела кольчатых червей тянутая слегка уплощенная длина червей колеблется нескольких миллиметров метра тело расчленено практически одинаковые сег менты гомономная сегментация имеющие вид соединенных тонкой кожицей колец обеспечивает гибкость подвижность червей мно гощетинковых морских червей каждом сегменте находятся особые парные выросты   параподии сегментах могут располагаться жабры большинства видов многощетинковых червей имеется диффе ренцированная головная лопасть снабженная глазами щупальцами рис 74 сегментированное тело заканчивается анальной лопастью указывалось ранее кольчатых червей характерна вто ричная полость тела целом выстланный эндотелием мезодермаль ного происхождения заполненный целомической жидкостью цело мическая жидкость выполняет роль внутренней среды организма функции гидроскелета находятся клетки фагоциты другие участвует переносе различных веществ защите организма це ломе поддерживается относительно постоянный биохимический ре жим целом разделен посегментно поперечными перегородками ка меры каждый сегмент имеет пару целомических мешков мно гих представителей этих перегородок первичная полость имеет собственных стенок наружной сто роны ограничивает кожномускульный мешок внутренней   стенка кишечника вторичная полость тела кольчецов окружена од нослойным эпителием прилегающим снаружи кожномускульному мешку внутри   кишечнику поэтому стенка кишечника становит ся двойной покровы кольчатых червей представлены однослойным эпителием одетым снаружи тонкой кутикулой кожа богата железами секрети рующими слизь которая облегчает передвижение кольчецов содержит половые аттрактанты ядовитые вещества т п морских представи телей секреты используются постройке домиков нервная система развита других червей представ лена парными спинными мозговыми ганглиями брюшной нервной 9 6407 129 рис 74 виды многощетинковых кольчатых червей   пескожил arenicola б   нереис nerei   филлодоце г   амфитрите amphitrit д   сабеллария sabellaria е   серпула serpula   морская мышь aphrodit 1   щу пальца 2   жабры 3   параподии цепочкой метамерно повторяющимися парными ганглиями каждом сегменте ганглиев отходят нервы различным органам нервная система типичных кольчатых червей развита значительно уст роена сложнее рис 75 появление головного мозга расположенного дорсально глоткой существенно отличает кольчатых червей плоских парные спинные доли мозга кольчецов разделены ний средний задний ганглии органы чувств почвенных червей представлены многочисленными чувствующими клетками кожном покрове морских многощетинковых 130 б рис 75 передняя часть тела дождевого червя   червь обнаженными спинным кольцевыми кровеносными сосудами б  пище илрительная система   нервная половая системы   связки глоткой стен кой тела 2   ротовая лопасть 3   кольцевые сосуды  сердца  4   спинной кровенос ный сосуд 5 глотка 6 пищевод 7 зоб 8 мускульный желудок 9 метанефридии 10   рот 11   надглоточный ганглий окологлоточное нервное кольцо 12  брюшная нервная цепочка 13  семенные мешки 14   семяпровод 15   яичник 16   воронка яйцевода 17   семяприемники 18   отверстие семяпровода 19  перегородки сегментами ix xv   сегменты тела червей развиты глаза щупальца кожа кольчецов чувствительна световым раздражителям некоторых форм имеются органы равновесия мускулатура входит состав развитого кожномускульного мешка снаружи лежат кольцевые мышечные волокна внутри дольные некоторых форм этими слоями мышечных волокон лежать третий слой диагональных мышечных волокон мощью черви могут изгибать тело разных направлениях укорачивать удлинять мускулы входят структуру части внутренних органов движению кольчецов способствуют особые датки щетинки параподии щетинки имеют хитиновую природу ии приводятся действие специальными пучками мышц пищеварительная система кишечник состоит трех отделов первый последний отделы выстланы эпителием эктодермального происхожде ния средний отдел энтодермального происхождения благодаря кро веносной системе процессы переваривания всасывания питательных ве ществ идут активно улучшает обеспечение органов тканей части видов средняя кишка имеет глубокое впячивание тифлозоль увеличивающее поверхность кишечника имеется рот анальное отвер    131 стие ротовое отверстие лежит брюшной стороне первого сегмента го ловной лопасти анальное отверстие расположено анальной лопасти органы дыхания морских части пресноводных видов представле ны тонкостенными выростами покровов   жабрами расположенны ми метамерно бокам сегментов тела параподиях многие кольча тые черви жабр имеют дышат покровы тела кровеносная система большинства видов замкнутая кровь движет ся сосудам изливаясь целом движение крови обеспечивают пульсирующие сосуды главным образом спинной опоясывающие пищевод кольцевые сосуды  сердца  кишечником расположен спинной сосуд которому кровь движется заднего конца тела пе реднему брюшному сосуду кровь движется обратном направле нии спинной брюшной сосуды посегментно соединены кольцевы ми сосудами опоясывающими кишечник кровь кольчецов состоит жидкой части   плазмы   содержащихся форменных элемен тов кроме плазме крови содержатся особые соединения погло щающие кислород органах дыхания переносящие тканям ор ганам червей части кольчецов плазме имеется дыхательный пиг мент   гемоглобин придающий крови алый цвет органами выделения служат посегментно расположенные метанеф ридии эктодермального происхождения обычно каждом сегменте имеется одна пара нефридиев каждая пара метанефридиев начинается одном сегменте воронками ресничками открытыми целом ко торых выделительные каналы продолжаются следующем сегменте открываются наружу парными отверстиями метанефридии   это органы выделения органы регулирования водного ба ланса организме червей каналах метанефридиев происходит кон центрация конечных продуктов обмена аммиак превращается моче вую кислоту освободившаяся вода снова поступает целомическую жидкость это особенно важно почвенных наземных кольчецов рис 76 помимо метанефридиев стенках целома разбросаны спе циальные хлорагогенные клетки которые поглощают целомиче ской жидкости конечные продукты обмена таких клеток стенках средней кишки нагруженные конечными продуктами обмена хлорагогенные клетки могут выводиться метанефридии наружу рис 76 строение метанефридия кольчецов   метанефридий пламенными клетками б   типичный метанефридий 1   воронка 2   пламенные клетки 3  наружное отверстие 4   канал органа 5   кровеносные суды разветвляющиеся стенках канала 132 размножение основная масса кольчецов размножается половым путем могут размножаться почкованием делением кольчатые черви   раздельнополые животные гермафро дитов развитие проходит метаморфоза метаморфозом класс многощетинковые черви polychaeta общая характеристика это главная наиболее древняя богатая около 8 тыс видов группа кольчатых червей которая дала начало дру гим классам типа представителей класса бокам сег ментов тела имеются параподии снабженные многочисленными ще тинками передние сегменты полихет сливаются образуют головной отдел котором расположены рот органы чувств это раздельнополые жи вотные развитие происходит метаморфозом строение жизненные отправления полихеты могут очень мел кими могут достигать довольно внушительных размеров   1 м головной лопасти имеется пара чувствующих щупи ков которые сидячих форм превратились крону щупальцевидных придатков головной лопасти расположена пара осязательных щу палец   антенн форма тела вытянутая туловище состоит разного числа сегментов   5 800 рис 77 голова параподия многощетинкового кольчатого червя нереис   голова 1   щупальца 2   глаза 3   параподии б   параподия 1   спинной усик 2   спинная лопасть 3   брюшная лопасть 4   брюшной усик 5  щетинки б опор ные щетинки 133 передвигаются полихеты помощью параподий рис 77 образо ванных основной нерасчлененной частью двумя лопастями спинной брюшной основания спинной брюшной лопастей каждой пара подии отходит тонкому усику выполняющему обонятельные ося зательные функции параподии соединены телом червя подвижно действуют типу простого рычага каждой лопасти пучок уп ругих тонких щетинок кроме толще основной части имеется пара опорных щетинок толстых длинных помощью парапо дий черви ползают дну водоемов плавающих форм параподии полняют функцию плавников некоторых полихет параподии час тично полностью редуцированы роющие виды виды живущие домиках покровы полихет живущих дне водоемов представлены хоро шо развитой кутикулой активно плавающих форм живущих доми ках зарывающихся грунт кутикула тонкая органы чувств хоро шо развиты голове однадве пары глаз осязательные усики обоня тельные ямки щупальца примитивных форм эпителий местами ресничным органы дыхания дышат полихеты жабрами поверхностью тела большинства функцию дыхания берут участки параподий кровеносная система представлена спинным брюшным сосудами также кольцевыми сосудами кровеносная система замкнута движе ние крови телу обеспечивается сокращениями главным образом спинного сосуда кровь окрашена красный цвет размножение основная масса многощетинковых червей   раздель нополые животные половой диморфизм развит встречается пар теногенез также размножение делением поперек большинство кладывают яйца живородящие виды некоторые полихеты множаются почкованием результате могут образовываться временные разветвленные колонии развитие прямое метамор фозом большинства представителей яиц выходят микроскопиче ские плавающие личинки   трохофоры несегментированное те ло рядами ресничек первичная полость тела очень немногие полихеты живут пресных водах мало парази тических форм большинство многощетинковых червей обитают дне морей океанов реже живут толще воды многие виды слу жат кормом рыб многих других обитателей вод численность определяет биологическую продуктивность водоемов служит одним критериев определения потенциальных запасов промысловых рыб представителей полихет интересны черви живущие мелково дье   нереиды nerei улучшения кормовой базы рыб нашей стране успешно проведена акклиматизация нереид nerei diversicolor каспийском море завезли азовского щетинковый червь пескожил arenicola marina множестве заселяет песчаные отмели живя заиленном песке питаясь органикой добно дождевому червю пропускает грунт свой пищевари тельный тракт 134 тихоокеанского многощетинкового червя пололо eunic viridi п период размножения сегменты задней части тела заполняются поло выми продуктами затем части тела отрываются всплывают верхность океана яйца спермин выходят разрывов сегментов ду происходит оплодотворение зигот образуются плавающие личинки которые развиваются взрослых червей опускаются дно класс малощетинковые черви oligochaeta общая характеристика этому классу принадлежат многие водные почвенные формы числе дождевые черви известно 5 тыс видов малощетинковых червей которых морских водах встречается очень небольшое число малощетинковых червей параподий бокам тела имеются небольшие пучки щетинок щетинок передних задних сегментах дождевых червей ка ждом сегменте имеется четыре пары щетинок головной отдел обо соблен большинства щупалец гермафродиты развитие прямое строение жизненные отправления цилиндрическое сильно тянутое тело малощетинковых червей состоит похожих друг друга сегментов число которых колебаться 5 600 переднем конце расположено ротовое отверстие заднем   анальное некото рые тропические виды могут достигать 2 м покровах червей расположено желез выделяющих слизь каждый сегмент несет пучки щетинок почвенных червей щетинки участвуют передвижении вторичной полости тела целоме нахо дится целомическая жидкость содержащая отдельные клетки мно гих видов целом разделен посегментно камеры нервная система представлена окологлоточным кольцом надгло точным нервным узлом подглоточным ганглием брюшной нервной цепочкой глаза щупальца большинства видов отсутствуют органы чувств представлены чувствующими щетинками статоцистами обо нятельными ямками органы пищеварения развиты предназначены пропус кания больших объемов органики почвенных массах донного грунта ротовой полости пища попадает мускулистую глотку пищевод оттуда зоб мускульный желудок кишечник ор ганы пищеварения лежат вдоль тела изгибов стенках пищевода имеются пары известковых желез секреты которых нейтрализуют гуминовые кислоты пище червей средней кишке дорсально распо ложена внутренняя продольная складка   тифлозоль увеличивающая поверхность кишечника кровеносная система замкнутая главные сосуды   брюшной спинной покровах малощетинковых червей имеется густая сеть ка пилляров которых обогащенная кислородом кровь собирается суд лежащий брюшной нервной цепочкой таким образом ма лощетинковых червей редким исключением дыхательная система отсутствует отличие полихет малощетинковых червей кольцевые 135 сосуды области пищевода пульсируют называются  сердцами  кровь содержит гемоглобин который растворен плазме крови млекопитающих гемоглобин ходится эритроцитах половая система малощетинковые черви гермафродиты которым свойствен перекрестное оплодотворение оп ределяет сложность строения половой сис темы тело этих червей слегка уплощено состоит 50 250 внешне сходных сег ментов области 32 37го головной лопасти сегментов имеется скопление од ноклеточных железок образующих коль цевидное утолщение   поясок рис 78 клетки выделяют слизь образова ния яйцевого кокона белковую жидкость питания зародышей в10ми11м сегментах тела дождевого червя располагается паре семенников см рис 75 которые прикрыты тремя па рами семенных мешков семенных меш ках созревают накапливаются спермии семенных мешков спермии поступают мерцательные воронки семяпроводов се мяпроводы сливаются попарно левой правой сторонам тела образуют дольных канала открывающиеся брюш рис 78 дождевой червь ной стороне двумя отверстиями 15м 1   женское половое отвер сегменте тела стие 2   мужское половое верстие 3   поясок женская половая система образована па рой мелких яичников расположенных 13м сегменте яичников отходят ко ротких яйцевода воронками которые открываются брюшной стороне 14го сегмента двумя половыми отверстиями 13м сегменте яичники воронки яйцеводов прикрываются яйцевыми мешками помимо женской половой системе относятся две пары семяприемников распо ложенные 9м 10м сегментах открывающиеся брюшной стороне двумя парами отверстий спаривание дождевых червей сводится обмену спермой пери од размножения сначала особи становятся самцами поскольку развиты семенники время спаривания червя дви гаются головными концами друг другу соприкасаются брюшными сторонами поясок каждого червя располагается уровне се мяприемников происходит обмен спермой черви расхо дятся затем каждого пояске представляющем собой желе зистое утолщение кожи нескольких определенных сегментов образу 136 ется муфта эта муфта сокращениями мускулатуры тела сдвигается головному концу червя муфта проходит мимо 14го сегмента откладываются яйца 9 10го сегментов туда попадают спер мин происходит перекрестное оплодотворение муфта сбра сывается головную часть червя края смыкаются стано вится яйцевым коконом котором происходит развитие зародышей кокон дождевых червей форме напоминает лимон желтобурого цвета диаметр кокона составляет около 4 5 мм яиц развивающихся коконе выходит сформировавшийся чер вячок низших олигохет коконе несколько яиц выс ших правило одно яйцо несколько бывает редко помимо поло вого размножения олигохет встречается бесполое размножение те ло червя поперечно делится две части недостающие части регенерируют дождевых червей выражена способность ре генерации причем легко восстанавливается задний конец тела голов ной отдел восстанавливается редко дождевые черви ведут активную полезную почвы деятель ность ходы способствуют аэрации почвы проникает вода черви разрыхляют почву удобряют остатками своей жизнедеятель ности богатыми гумусными кислотами благоприятных условиях 1 м2 площади луга обитают 50 100 дождевых червей существуют около 200 видов дождевых червей мелкие менее 1 см беловатые кольчатые черви семейства энхитреид enchytreida чаще встре чаются почве виды обитающие пресных водоемах почвен ных энхитреид насчитывают около 400 видов плотность энхитреид почве составлять 150 тыс 1 м 2 легко разводить искусст венных условиях качестве корма рыб питаются черви орга ническими остатками множество олигохет живет дне водоемов питаясь органикой некоторых видов водных малощетинковых червей наблюдается поч кование случае образуются сложные цепи почкующихся осо бей водные малощетинковые черви служат кормом обитателей доемов наземные   многих наземных обитателей числе множества позвоночных дождевые черви биогумус дождевой червь ведет ночной образ жизни рыхлом грунте делает норки уплотняя землю плотном грунте червь вынужден делать норки путем выедания почвы часть пропущенную пищеварительный тракт червь выбрасывает нару жу разыскивая пищу червь заднюю часть тела держит норке найдя пищу растительные остатки затаскивает норку затем поедает черви выносят сухости ибо испытывают кислородное голодание проточной богатой кислородом воде могут жить несколько дней идея промышленного культивирования дождевых червей принад лежит американскому врачу баррету который 1947 г опубликовал результаты своих опытов 1975 г италии создана промышлен ная технология сша работают тысячи специализированных производств переработке навоза биогумус помощью червей био 137 гумус переработанный дождевыми червями другими организмами подстилочный навоз   высокоценное органическое удобрение поглощая вместе почвой огромное количество распадающихся растительных остатков микробов грибов водорослей простейших нематод других почвенных организмов дождевые черви переварива ют выделяют копролитами копрос   испражнение литое   ка мень большое количество собственной кишечной микрофлоры фер ментов витаминов других биологически активных веществ биоло гически активные вещества обладают антимикробными свойствами препятствующими развитию патогенной болезнетворной микрофло ры гнилостных процессов выделению зловонных газов обеззаражи вающими почву придающими приятный запах земли процессе переваривания растительных остатков пищеваритель ном тракте червей формируются гумусные вещества которые отлича ются химическому составу гумуса образующегося почве участии микроорганизмов кишечнике червей развиваются процессы полимеризации низкомолекулярных продуктов распада орга нических веществ формируются молекулы гуминовых кислот фуль вокислот последние неблагоприятны меньше ценнее гу мус кислоты образуют металлами соли   гуматы фульваты гуматы лития калия натрия растворимы легко вымываются дой представляют собой наиболее ценную часть гумуса которая легко доступна растений гуматы кальция магния кремния тяже лых металлов нерастворимы составляют ту часть гумуса которую мож назвать  консервами  почвенного плодородия накапливались черноземах весь послеледниковый период гуматы могут растворять ся влиянием ферментов корневой системы растений лишь таких количествах которые удовлетворяют потребности соли вержены гидролизу оказывают большое влияние создание ценной прочной пористой структуры подверженной влиянию эрозии следует отметить гуматы тяжелых металлов устойчи гидролизу ферментами корневой системы растений практически усваиваются ими это одно главных свойств гумуса   связывание почве тяжелых металлов предохранение живого земле ток сического действия числе действия тяжелых радионуклидов почве гумуса сильнее выражено это свойство этому пищевая продукция выращенная высокогумусных почвах является экологически безопасной животных человека деятельность дождевых червей замедляет вымывание почвы вижных питательных элементов закрепляет тяжелые металлы пре пятствует развитию водной ветровой эрозии копролитах червей ес тественных популяций содержится 11 15 гумуса расчете сухое вещество естественных местах обитания плотность популяции дож девых червей варьирует 100 600 особей 1 м 2 летний период популяция 50 червей пахотном слое почвы 1 м2 прокла дывает 1 км ходов выделяет поверхность копролиты слоем около 3 мм остается толще почвы каждый червь пропуска 138 ст пищеварительный тракт сутки столько почвы сколько весит средняя масса червя почвенном слое около 05 г средней полосе активная деятельность червей продолжается 200 дней 11ериод следовательно каждый червь пропустит около 100 г субстрата т е 1 га приходится 50 т переработанной почвы особенно важным условием жизни червей является достаточная влажность субстрата влажность почвы ниже 30 35 тормозит витие влажности 20 22 погибают течение недели мак симальную массу наибольшее число коконов получают 70 85 влажности субстрата столько воды содержится теле червя кислой среде рн 5 сильно щелочной рн 9 черви гибают течение недели оптимум дождевых червей   нейтраль ная среда рн около 7 велика потребность червей азоте богатой азотом почве численность растет почему навозе пастбище концентрация растворимых солей 05 смертельна такие соли углекислый кальций углекислое железо сер нокислый алюминий хлористое железо безвредны больших количествах итак оптимальными развития дождевых червей ус ловиями являются следующие температура 15 22 ° влажность   6 0 7 5 рн 7376 дождевые черви живут верхних слоях почвы уходят ниж ние слои спячку тех пор пока земля промерзнет глубину 5 6 см появится снежный покров длительной оттепели чер ви могут выползать снег обычно 5 ° черви перестают пи таться освобождают кишечник уползают нижние слои почвы оцепеневают просыпаются воздействием вешних вод теп лого воздуха проникающих норки дождевые черви очень плодовиты откладка коконов происходит весны начала лета затем осенью ноября лето червь откла дывает 18 24 кокона каждом которых 1 24 яйца 2 3 нед яиц вылупляются молодые особи которые прошествии 7 12 нед сами способны размножаться благоприятные условия жизни ускоряют половое созревание молодых червей взрослые черви могут жить 10 15 лет длина достигает десятков сантимет ров масса   10 г молодые черви достижении половой зрело сти весят 1 г крупные черви являются самой ценной частью попу ляции несовершенной технологии обработки почвы именно эта часть дождевых червей погибает пахотном слое калифорнийский червь выведен 1959 г сша червь личается своих диких сородичей обладает способностью множаться наземных культиваторах всяких построек теплиц калифорнийский червь теплом климате дает 16 18кратное воспро изводство цикл культивирования открытым небом 512кратное условиях закрытых теплиц дикие сородичи дают лишь 4 6кратное воспроизводство калифорнийский червь стал предметом экспор таимпорта вместе технологией культивирования 139 нашей стране первые работы культивированию калифорний ского червя начались лишь 1984 г руководством м игонина разработаны звенья технологического процесса производства биогумуса помощью калифорнийского червя также самым главным использованием местных дождевых навозных чер вей переработки 1 т компостированного навоза получают 05 т гумусного удобрения 50 ной влажности 6 10 кг живых червей класс пиявки hirudinea общая характеристика пиявкам свойственно своеобразное кольча тое строение тело уплощено имеет четко выраженного голов ного отдела наружная кольчатость пиявок соответствует крупной внутренней сегментации тела сегментация тела однородная гомономная каждому истинному сегменту соответствует 3 5 ружных колец тело пиявок состоит 30 33 сегментов это придает большую гибкость позволяет вести активный образ жизни ще тинки теле отсутствуют большинства представителей класса имеются присоски передняя задняя передняя присоска окружает рот анальное отверстие находится задней присоской известно около 400 видов пиявок живущих основном пресных водоемах являющихся эктопаразитами беспозвоночных позвоноч ных животных большинство пиявок питаются кровью разных живот ных своих жертвах остаются недолго основном паразиты ведут свободный образ жизни пиявок которые сосут кровь являются хищниками сухопутные виды распространенные тропиках тропических лесах живут древесные почвенные пиявки нападающие теплокровных животных человека фауне нашей страны встречается 50 видов пресноводных пиявок строение жизненные отправления строение пиявок отвечает полу паразитическому образу жизни который ведут рис 79 покровы представлены плотной кутикулой лежит богатый железистыми клетками однослойный эпителий образующий кутику лу основания эпителиального слоя разбросаны пигментные клетки придающие пиявкам соответствующую окраску мускулатура развита очень кожномускульный мешок состоит трех слоев мышечных волокон полость тела частично реду цирована представлена системой лакун заполненных паренхимой плотные покровы паренхима защищают тело высыхания позволя ют пиявкам длительное время пребывать суше совершая миграции нервная система пиявок имеется брюшная нервная цепочка гла примитивны покровах располагаются чувствую щие клетки нервные окончания дышат пиявки покровы тела некоторых видов имеют ся жабры пищеварительная система приспособлена образу жизни пиявок паразитов ротовой полости части видов имеются 140 рис 79 виды пиявок б  медицинская пиявка hirudo те dkinali спинной брюшной сто роны   клепсина г   ложнокон ская пиявка д   рыбья пиявка piscicola geomelra челюсти множеством зуб чиков челюстные пиявки других пиявок хоботок помощью которого черви вне дряются покровы своих жертв хоботные пиявки глотка пия вок выполняет функции сосу щего аппарата который крываются протоки слюнных желез кровососущих пиявок медицинская пиявка слюне содержится белковое вещество препятствующее свертыванию крови кишечнике червей   гирудин передняя кишка име ет карманообразные боковые выросты позволяющие сделать значительный запас крови ме дицинская пиявка делает запас 2 3 мес жизни поскольку кровь долго сохраняется действием гирудина све жем виде процессы перева ривания происходят энто дермальном среднем отделе кишечника который пре вращается объемистый лудок карманами органы выделения   метанефридии кровеносная система развита низших пиявок частично хоботных челюстных пиявок кровеносная система редуцируется роль выполняет лакунарная система цел омического происхождения половая система пиявки гермафродиты размножаются ловым путем весной около водоемов сырых местах оплодотворение внутреннее перекрестное пиявок малощетинковых червей 9 11м сегментах находятся поясок железы выделяющие слизи стые муфты образования коконов коконы похожие мелкие луди пиявки откладывают землю развитие прямое коконе длит ся около 5 нед живут пиявки 20 лет 141 подкласс настоящие пиявки euchirudinea делится отряда хоботные rhynchobdellea бесхоботные arhynchobdellea хобот ные пиявки паразитируют рыбах птицах лягушках моллюсках ракообразных бесхоботные пиявки паразитируют позво ночных животных являются хищниками хоботка имеются развитые челюсти наиболее часто встречаются боль шая малая ложноконские пиявки улитковая пиявка южных регио нах   медицинская пиявка закавказье   конская пиявка природе пиявки чаще нападают больных ослабленных животных конская пиявка причинить вред лошадям скоту время допоя естественных водоемов пиявки проникают носоглотку гортань могут вызвать кровопотери удушье медицинская пиявка нападает животных человека птичьи рыбьи пиявки массовом заселении могут вызывать ги бель рыб рыбоводческих хозяйствах водоплавающей птицы держании водоемах филогения экологическая радиация кольчатых червей разных классах кольчатых червей признаки которые свиде тельствуют родстве аннелид низшими червями первичная полость тела протонефридии части кольчатых червей личинок реснич ный тип движения т п современных аннелид наиболее близки гипотетическим предкам некоторые архианнелиды раннем этапе эволюции раньше обособились других аннелид позднее обособились полихеты полихет переходе пресноводному наземному образу жиз сформировались малощетинковые черви переходе активно му кровососанию хищному образу жизни обособился класс пиявок переход пресные воды сушу пиявок олигохет сопровождался переходом прямому развитию экологическая радиация кольчатых червей отражена рис 80 тип моллюски mollusca общая характеристика моллюски мягкотелые   вторичнопо лостные животные несегментированным телом большинстве слу чаев заключенным раковину известно 113 тыс видов моллю сков живущих морских пресных водах суше большинство вод ных моллюсков   обитатели дна это животные ведущие начало кольчатых червей тело моллюсков состоит трех отделов головы туло вища ноги важнейшей особенностью является наличие мантии   складки кожи свешивающейся спины разнообразными многочис ленными железами которые вырабатывают секреты используемые построении раковины телом мантией образуется мантийная 142 эпифитобиос гидробиос геобиос оющи1 море пресные воды почва е планктон  интерстициалц бентос плавающие сидячие   формы рис 80 морфоэкологияеская эволюция кольчатых червей близких типов   погонофора б   сипункулида   бонелия г   олигохета д   полихета е   архи иннелида   пиявка морская з   полихета   олигохета   пиявка л   пещерная полихета м   дождевой червь   древесная пиявка полость которой расположены жабры легкие   сухопутных форм некоторые органы чувств моллюски имеют тонкие мягкие покровы богатые слизистыми железами тип моллюски включает подтипа боконервные раковинные несколько классов которых наиболее распространены представ ляют интерес класса двустворчатые моллюски bivalvia брюхо ногие моллюски gastropoda головоногие моллюски cephalopoda относящиеся подтипу раковинные conchifera строение жизненные отправления размеры форма тела моллю сков весьма разнообразны связано особенностями сред оби тания части моллюсков тело имеет двустороннюю симметрию многих заключенных спиральную раковину тело асимметрично ббльшая часть внутренних органов расположена туловище голове находятся органы чувств внутри заключены крупные головные нерв ные узлы многих моллюсков голова обособлена тела нога слу жит передвижения животного большинства моллюсков имеется известковая раковина образую щаяся счет выделений мантии раковина выполняет защитные функции прикрепляются мускулы некоторые органы ракови 143 иметь вид колпачка некоторых моллюсков образована двух створок соединенных зубчатым замком связкой других раковина спирально закручена представлена несколькими щитка ми ряде случаев подвергаться редукции раковина состоит трех слоев наружного построенного органического вещества конхиолина среднего сложенного известковых образований внутреннего образованного тонким слоем перламутра полость тела моллюсков смешанная   миксоцель образо вана остатками первичной полости сильно редуцированным цело мом миксоцель заполнен паренхимой которой расположены внут ренние органы вторичная полость тела сведена лишь околосердеч ной сумке полости которой находятся половые органы покровы тела моллюсков слизистые образованы однослойным эпителием который некоторых местах имеет ресничный характер эпителий сухопутных моллюсков имеет множество желез увлажняю щих покровы способствующих кожному дыханию скольжению ги субстрату нервная система напоминает нервную систему кольчатых червей представлена несколькими парами нервных узлов расположен ных разных частях тела моллюсков связанных нервными тяжами примитивных моллюсков нервная система напоминает нервную сис тему плоских червей большинство представителей имеют глаза кото рые головоногих моллюсков отличаются сложностью строения мягкотелых органы осязания органы химического чувства рав новесия статоцисты мускулатура слагается гладких мышечных волокон обуслов ливает замедленное движение тела ведущих активный образ жизни головоногих моллюсков поперечнополосатые мышцы особенно развитые ноге органы дыхания большинства водных видов представлены жабра ми расположенными мантийной полости сами жабры   это видоиз мененные участки мантии жабры имеют вид лепестков расположен ных оси жабры сухопутные вторичноводные формы дышат легкими которые также образованы участками мантии снабжены большим количеством кровеносных сосудов кровеносная система незамкнутая околосердечной сумке цело ме расположено сердце имеющее желудочек одно несколько предсердий желудочка отходят артерии разносящие кровь всему телу кровь изливается систему лакун полости тела отсюда кровь сасывается венозные сосуды поступает жабры легкое окисленная кровь возвращается сердце сосудам органы пищеварения представлены ротовым отверстием глоткой пищеводом которого пища попадает желудок большинства видов характерно наличие глотке аппарата размельчения пищи   терки нередко могут развиты хитиновые челюсти желудком начинается кишечник который впадает проток печени кишечник оканчивается анальным отверстием 144 рис 81 личинки двустворчатых моллюсков   трохофора морского моллюскапарусника б   глохидий беззубок перловиц 1   нояса ресничек 2   рот 3   кишка 4   анальное отверстие 5   протонефридий 6   теменная пластинка 7  зачаток раковины 8   зачаток мезодермы 9   мышцы 10   реснички 11   личиночная раковина 12  мускулзамыкатель 13  зубцы зубчиками 14   чувствительные щетинки 15   железа выделяющая прикрепительные нити органы выделения   почки представляют собой видоизмененные метанефридии каналец каждой почки начинается воронкой околосер дечной сумке другим концом открывается мантийную полость органы размножения находятся цел оме протоки половых желез ткрываются либо мантийную полость либо протоки почек большинство моллюсков раздельнополы оплодотворение яйце клеток осуществляется мантийной полости внутри материнского организма развитие моллюсков происходит метаморфозом пего живущие воде моллюски откладывают яйца воду сухопут ные формы   почву поверхность живородящие виды низших форм яйца развивается трохофорная личинка болыпин ства моллюсков яйца выходит личинка парусник имеющая пучок ресничек парус лопастями несущими реснички парус служит движения личинки рис 81 участи морских большинства пресно водных сухопутных моллюсков развитие прямое класс брюхоногие моллюски gastropoda общая характеристика брюхоногих моллюсков улиток нога имеет широкую подошву такая нога используется этими моллюсками ползания наличии раковины последняя спирально завита придает телу моллюска асимметричную форму голова имеет однудве пары щупалец многих развиты глаза дышат брюхоногие моллюски жабрами легкими первично брюхоногие моллюски   обитатели моря некоторые процессе эволюции приспосо бились жизни пресных водоемах суше имеются пресноводные i 6407 145 моллюски прудовики катушки которые вторично перешли водно му образу жизни живя воде дышат кислородом воздуха немно гие ведут паразитический образ жизни размеры улиток варьи руют нескольких миллиметров нескольких десятков сантиметров это самый многочисленный разнообразный класс моллюсков вестно 90 тыс видов брюхоногих моллюсков питающихся гнию щими остатками растительной животной пищей многие вре дители растений некоторые являются промежуточными хозяевами па разитических плоских червей класс брюхоногих моллюсков делится подкласса передне жаберные prosobranchia заднежаберные opisthobranchia легоч ные pulmonata строение жизненные отправления обычно тело улиток имеет нообразную форму голова обособлена туловища которое образует кверху вырост виде внутренностного мешка закрученного спирально однадве пары щупалец голове несут осязательные функции способны втягиваться развиты глаза которые мо гут расположены вершинах щупалец органы химического чувства равновесия   статоцисты расположенные ноге передви гаются брюхоногие моллюски скольжением счет волнообразных гибов широкой плоской подошвы ноги представляющей мускули стый брюшной вырост цельные обычно спирально закрученные раковины имеют разно образные форму расцветку части плавающих брюхоногих ракови рецуцирована той иной степени назем ных слизней ведущих сумеречный ночной образ жизни раковине размещено туловище моллюска опасности раковину втягивается тело раковина состоит наружного тонкого органи ческого слоя которым расположен минеральный слой известко вой природы углекислая известь извлекается моллюсками воды пищи вещество раковины выделяется известковыми железами мантии некоторых моллюсков раковина имеет третий слой   внутренний перламутровый эмалевый разной окраски мантий ная полость расположена нижних витках раковины мантийную лость открываются анальное отверстие мочеточники проток половых органов водных видов мантийной полости расположены жабры наземных вторичноводных моллюсков мантийная полость стала легким которое открывается наружу специальным дыхательным отверстием органы пищеварения брюхоногие моллюски питаются раститель ной пищей детритом являются хищниками ротовое отверстие расположено нижней стороне головы ведет глотку которая имеет роговые челюсти мускулистый валик   язык теркой радулой имеющей вид пластинки мелкими зубчиками помощью мол люск отделяет частицы пищи субстрата глотку впадают протоки слюнныхжелез некоторых хищных форм слюне содержится серная кислота помощью которой моллюски растворяют раковины пан 146 цири своих жертв   других моллюсков иглокожих ядозубых мол люсков вырабатывается яд который вводят особыми зубами тело жертвы поедают глотки пища попадает пищевод желудок который открываются протоки печени секрет печени характеризуется амилолитической активностью печень способна вса сiiiвать часть питательных веществ откладываются резервные пиды гликоген низших моллюсков печени происходит внутри клеточное пищеварение желудка пищевая масса поступает кишечник сначала среднюю затем заднюю кишку органы дыхания   жабры легкие жабрами дышат морские часть пресноводных видов наземные вторичноводные вынуждены периодически подниматься набирать воздух мантию относятся легочным моллюскам легкие моллюсков   это видоизмененная ман тийная полость стенки которой пронизаны сетью кровеносных сосу дов воздух поступает легкое особое дыхальце которое гружен™ моллюска воду закрывается моллюсков имеется кож ное дыхание кровеносная система незамкнутая образуют сердце находящееся околосердечной сумке сосуды лакуны кровь обычно бесцветна содержит амебоциты околосердечную сумку открываются воронки двух почек мочеточники выводят мочу мантийную полость сбоку анального отверстия органы размножения большинство морских брюхоногих моллю сков раздельнополы наземные многие пресноводные   гермафро диты половые железы непарные оплодотворение яйцеклеток осуще пишется материнском организме часто оплодотворенные яйца ок ружаются оболочками студенистыми коконами соединяются кладки гермафродитов половая система устроена сложно ви ноградной улитки имеется гермафродитная железа вырабатывающая яйцеклетки спермии спаривание сводится обмену спермой добно дождевым червям которая поступает семяприемники особи поэтому оплодотворение перекрестное развитие протекает стадии личинки прямое метаморфозом реже блюдается живорождение брюхоногие моллюски участвуют круговороте веществ водоемах суше потребляя органические остатки перерабатывая мно гие моллюски служат кормом водных позвоночных морские тру бачи являются источником черного розового жемчуга высоко ценя щегося мировом рынке морях океанах моллюски живут разных глубинах сухопутные виды легко переносят разные климатические условия обусловлено способностью впадать спячку   зимнюю севере летнюю зимнюю южные регионы улитка заползает почву втя гивается целиком раковину заклеивает вход некоторых брюхоногих моллюсков используют пищу явля тся объектом промысла черном море обитает моллюск морское блю дечко   patella встречающаяся нашей стране виноградная улитка ш 147 рис 82 представители наземных брюхоногих моллюсков   слизень оранжевожелтый б   виноградная улитка 1   раковина 2 голова двумя парами щупалец 3   нога 4   дыхательное отверстие 5   половое отверстие 6   глаза helixpomatia относится числу вредителей виноградной лозы ряде стран этих улиток употребляют пищу специально разводят многочисленные многоядные слизни наносят вред различным рас тениям поедая листья ягоды клубни тело слизней вытянуто шено раковины правда некоторых видов кожей имеются остатки раковины особый ущерб наносят полевым кормовым культурам левой слизень agriolimax agresti крупный окаймленный слизень arion circumscriptus другие рис 82 обычно это ночные животные днем прячущиеся укрытиях слизни   гермафродиты дают лет ний период несколько кладок 9 50 яиц каждой зимуют стадии яйца взрослой особи продолжительность жизни слизней   3 лет наземные пресноводные брюхоногие моллюски являются проме жуточными хозяевами плоских паразитических червей   сосальщи ков это малый прудовик limnaea truncatula обыкновенный прудовик l stagnali битиния bithynia leachi хелицелла helicella candidula многие другие рис 83 роль этих брюхоногих моллюсков весьма вели г д рис 83 раковины различных пресноводных брюхоногих моллюсков   прудовик обыкновенный eimnaea stagnali б   катушка обыкновенная planorbi corneus   малый прудовик limnaea truncatula г   лужанка живородящая д   бити ния bithynia leachi 148 эпигеобионты планктон   эпибентобионты   интрабентобионты рис 84 экологическая радиация брюхоногих моллюсков ка распространении гельминтных заболеваний мягкоте лые весьма многочисленны природе например малый прудовик жи вет водоемах начиная маленьких луж кончая крупными доемами достигает численности нескольких миллионов гектар моллюск зимует зарываясь грунт дна водоемов ловины могут поражены личинками фасциол моллюски служат косвенным индикатором загрязнения водоемов филогения брюхоногих моллюсков считают предками брюхо ногих моллюсков небольшие примитивные гастроподы ракови виде колпачка процессе эволюции увеличивались размеры моллюсков раковина спирально закручивалась легочные заднежа берные моллюски представляют наиболее продвинутые ветви эволю ции экологическое разнообразие гастропод превосходит экологиче ское разнообразие других классов моллюсков рис 84 процессе эволюции происходило совершенствование специали зации ползающих дну также образование роющих видов рако виной виде буравчика множеством оборотов спирали особый ин терес представляет кораллобионтная группа моллюсков приспособив шихся жизни коралловых полипах плавающему образу жизни 149 перешли киленогие крылоногие моллюски независимо друг друга перешли жизни суше часть гребенчатожаберных легочных ко торых развитие стало протекать метаморфоза легочные представи тели расселились всем географическим зонам заняли ярусы биоценозов некоторые сухопутные легочные моллюски вторично пе решли водному образу жизни класс двустворчатые моллюски bivalvia общая характеристика это моллюски имеющие двустворчатую ра ковину прикрывающую тело боков головаунихне обособлена нога клиновидной формы ведущих неподвижный образ жизни нога часто подвергается редукции жабры виде пластин второе название класса пластинчатожаберные находятся мантийной полости обеих сторон ноги рис 85 описанных 20 тыс видов двустворчатых моллю сков большая часть обитает морях меньшая часть живет пресных водах это малоподвижные неподвижные животные дна водоемов питаются пассивно   счет захватывания частиц пищи поступаю щих током воды мантийную полость относятся группе биофильт раторов развитие прямое превращением строение жизненные отправления двустороннесимметричное тело этих животных состоит туловища ноги имеющей клиновидную форму помощью ноги моллюски передвигаются высовывают ногу раковины зарывают грунт дна водоема затем подтягивают тело неподвижных видов нога разной степени редуцирована покровы богаты различными железами вырабатывающими слизь кислоту разрушения известковых скал материал прикрепления субстрату ряд других веществ мантия виде двух складок свеши вается боков тела телом мантией образуется мантийная лость которой расположены жабры нога открываются задняя кишка мочевые половые протоки мантийную полость вода поступает жаберный сифон омы вает жабры удаляется выводной клоакальный сифон движе ние воды обеспечивают реснички мерцательного эпителия который покрывает мантию жабры сифоны вода приносит мантийную лость пищевые частицы кислород 4 5 рис 86 анатомия беззубки   клоакальный сифон 2  анальное отверстие 3 задний мускулзамыкатель 4  поч ки 5 задняя кишка 6  мочеточник 7 предсердие 8  желудочек сердца р ворон ка нефридия почки 10   отверстие мочеточника 11   половое отверстие 12  аорта 11   желудок 14   печень 15   передний мускулзамыкатель створок 16   рот 17  створка раковины 18   мантия 19   висцеральный нервный узел 20   жаберный сифон 21   жабры 22   половая железа 23   кишка 24   ножной нервный узел 25   головной нервный узел 26  нога две створки раковины соединены вершине эластичной связкой лигаментом замком расположенными верхнему краю ство рок большинства двустворчатых моллюсков створки имеют одинако вые размеры форму неподвижных форм могут различаться живого моллюска створки раковины способны раскрываться замы каться захлопывание закрытие створок обеспечивают мускулы мыкатели связывающие обе створки сокращении створки крываются расслаблении открываются счет рогового эластич ного лигамента который действует пружина нарастание раковинных створок происходит наружному краю счет секретов желез наружного эпителия мантии зимой моллюски 11 рактически растут поэтому створках образуются две годичные полосы летняя зимняя которым легко определить возраст мол люска раковина имеет слоя органический фарфоровидный углекислого кальция перламутровый нервная система состоит трех пар нервных ганглиев располо женных глоткой ноге задней части туловища рис 86 свя занных комиссурами органы чувств развиты слабо покровах бросаны чувствующие клетки жабрах хеморецепторы ноге расположены органы равновесия   статоцисты некоторых видов краям мантии разбросаны многочисленные глазки головные щупаль ца глаза отсутствуют 151 щ органы пищеварения основанием ноги переднем конце тела расположено ротовое отверстие бокам которого имеются две лопа сти мерцательным эпителием реснички которого гонят пищевые частички ко рту жабрах ротовых лопастях имеются органы вкуса ресничные желобки которым частички пищи транспортируются рот короткий пищевод пища попадает небольшой желудок открываются протоки печени глотка терка слюнные железы редукции головы двустворчатых моллюсков отсутствуют желудка пища поступает кишку которая образует несколько петель затем околосердечную сумку желудочек сердца прохо дит назад открывается анальным отверстием выводной клоакаль ный сифон откуда током воды экскременты выбрасываются наружу кровеносная система представлена сердцем одним желудочком дву мя предсердиями сердце лежит спинной стороне околосердечной сумке желудочка берут начало мощных сосуда передняя задняя аорты лакун полости тела венозная кровь направляется приносящие жаберные сосуды окисленная артериальная кровь жабер вынося щим сосудам возвращается сердце часть крови проходит почки ми нуя жабры освобождается конечных продуктов обмена вливается выносящие жаберные сосуды которые впадают предсердие органы выделения представлены двумя почками которые лежат сердцем каждая почка начинается выстланной мерцательным эпите лием воронкой околосердечной сумке мочеточники открываются мантийную полость органы размножения большинство двустворчатых моллюсков дельнополы половые железы парные протоки открываются мантийную полость оплодотворение яйцеклеток наружное мужские половые клетки мантийной полости самцов наружу попадают выводной сифон пресноводных форм оплодотворение происходит мантийной полости самки жаберный сифон током воды заносятся спермии такое оплодотворение возможно тесном засе лении моллюсков развитие большого числа видов происходит метаморфозом морских представителей личинка парусник похожа личинку коль чатых червей прозрачное тело округлой формы диском покрытым поясками ресничек   парус пресноводных моллюсков беззубки перловицы личинки глохи дии имеют двустворчатую раковину зубцами краям см рис 81 яйца откладываются жабры развиваются глохидии глохидии появляются осенью зиму остаются мантийной полости мате ринского организма покидают глохидии мантийную полость весной током воды клоакальный сифон закрепляются жабрах рыб ткани рыб обрастают глохидиев которые превращаются эктопарази тов питаясь соками рыбыхозяина 2 3 мес молодые моллюски покидают хозяина опускаются дно начинают самостоятельную эктопаразитизм глохидиев рыбах обеспечивает расселение моллюсков водоемах 152 рис 87 представители двустворчатых моллюсков п устрицы ostrea куске дерева б   мидия mytilus eduli прикрепленная субстрату i юмощью нитей биссуса   жемчужница pteriina г   корабельный червь teredo navali пластинчатожаберные моллюски являются очень эффективными естественными биофильтраторами воды например высокой пиотности заселения мидии живущие 1 м 2 поверхности дна пускают 250 т воды многих двустворчатых моллюсков используют пищу устрицы гребешки мидии др рис 87 устрицы сем ostreida ведут непод нижный образ жизни морских водах имеют асимметричную ракови большой выпуклой створкой соприкасаются субстратом разуя огромные скопления мелководьях многих странах мясо устриц характеризующееся высокой питательной ценностью широко используют пищу прибрежных странах эффективно развивается промышленное разведение устриц 153 гребешки семейства pectinida имеют красивые крупные ракови ны радиальными ребрами моллюски передвигаются резко хлопывая створки раковины выбрасывая воду создает реактивную тягу гребешков добывают дальнем востоке рф ис пользуют пищевых целей ведутся работы искусственному ведению гребешков мидий сем mytilida мидии mytilus eduli прикрепляются субстрату помощью осо бых нитей черном море мидии встречаются значительных количе ствах часто используют кормления сельскохозяйственных жи вотных этих целей используются двустворчатые моллюски зубки anodonta перловицы unio отряда unionida живущие пресных водоемах страны раковины имеют две оди наковые створки моллюски передвигаются помощью ноги двустворчатые моллюски дающие жемчуг это морские жемчужницы pinctada pteria подотряд pteriina речная жемчужница margaritifera margaritifera которая встречается северных реках озерах страны морских жемчужниц разводят специальных хозяйствах некоторые представители двустворчатых моллюсков причиняют ущерб народному хозяйству дрейссена dreissena polymorpha нарушать работу шлюзов других гидротехнических сооружений ска пливаясь больших количествах корабельное точило teredo navali   моллюск имеющий червеобразную форму сверлит древеси подводных сооружений нанося значительные повреждения испокон веков люди использовали двустворчатых моллюсков пи щу кормления животных однако 1962 г мировая быча моллюсков достигла максимального значения  17 млн т ресур сы стали иссякать это стимулировало развитие марикультуры дву створчатых моллюсков марикультура   искусственное разведение морских животных настоящее время многие страны добились огромных успехов япония франция сша др японии путем выращивания жемчужниц ежегодно получают 100 тыс жемчужин ведутся такие работы нашей стране двустворчатые моллюски выполняют очистительные функции водоемах поглощают накашивают своем теле тяжелые метал лы очищают воду химических загрязнений среднем мол люск пропускает 1 ч около 1 л воды перловицы беззубки являются действующими биофильтраторами отношении представ ляют большую ценность источник мяса филогения двустворчатых моллюсков наиболее примитивны своей организации первичножаберные двустворчатые моллюски ко торые берут начало древних первичножаберных предков даль нейшем процессе эволюции переходе неподвижному образу жизни моллюсков редуцировалась нога перегородчатожаберных редуцировались жабры функции дыхания перешли наджаберным полостям предков двустворчатых раковина видимо цельной субстрате заставила моллюсков защитить свое тело бокам эко 154 древоточцы рис 88 экологическая радиация двустворчатых моллюсков логическая радиация рис 88 брюхоногих моллюсков свидетельствует центральную группу представляют донные формы ко торых путем специализации отделились роющие древо камнеточ цы неподвижные формы чрезвычайно разнообразны некоторые дву створчатые моллюски приобрели подвижность гребешки класс головоногие моллюски cephalopoda общая характеристика этому классу принадлежит около 700 ви дов крупных моллюсков живущих исключительно морях отличаю щихся наиболее сложной организацией совершенных приспособ лений жизни морской стихии сложности поведения головоногих моллюсков часто называют  приматами моря  среди беспозвоночных животных обычно это свободноплавающие подвижные хищники предпочитающие воды теплых морей океанов среди мало пол зающих видов размеры колеблются нескольких сантиметров 18 м гигантские кальмары тело отчетливо подразделяется голову туловище нога пре вращена щупальца руки которые вторично сместились голову окружают ротовое отверстие отсюда название   головоногие другая часть ноги преобразовалась воронку лежащую входа ман тийную полость брюшной стороне тела примитивных форм раковина наружная высших представителей внутренняя частично полностью редуцирована 155 рис 89 различные головоногие   глубоководный плавающий осьминог amphitretuspelagicus б  осьминог benthoc topusprofundorum   планктонный кальмар doratopsi sagilta г   глубоководный пе лагический кальмар светящимися органами lycoteuthi diadema д   планктонный кальмарчик cranchia scabra е   донный осьминог cirrothauma murrayi   пелагиче ский кальмар loligo eduli строение жизненные отправления моллюски обитающие толще воды имеют тело торпедовидной формы кальмары бентосных форм тело мешкообразной формы осьминоги других универсаль ных видов тело уплощено каракатицы планктонных форм тело сту денистое медузоидной формы узким шаровид ным высших головоногих моллюсков ротовое отверстие окружено восемью десятью щупальцами восемь щупалец представителей отряда octopoda постепенно сужаются концу стороне обращен ной ко рту расположены многочисленные дисковидные соски которыми моллюски могут прочно присасываться субстрату жертве видов отряда decapoda помимо таких восьми щупалец име ется гораздо длинные ловчие щупальца расширен ные конце рис 89 бокам головы расположены крупных сложных строению глаза примитивных форм число гладких чер веобразных щупалец достигать нескольких десятков туловище сторон одето мантией спине образует кровы тела брюшной стороне   мантийную полость сообщаю щуюся внешней средой щелевидным отверстием это отверстие мо жет закрываться изолировать мантийную полость внешней среды закрывается оно помощью особых  застежеккнопок   кноп ками  брюшной стороне щели выступает воронка виде мус кулистой трубки расширенный конец воронки открывается мантий ную полость узкий   наружу воронка производное ноги служит особого реактивного движения мантийная щель закрыта мыкателями помощью многочисленных мышц мантия прижимается туловищу вода мантийной полости силой выталкивается воронку толкая моллюска обратную сторону реактивная тяга ронка изгибаться разные стороны позволяет моллюску ме нять направление движения роль дополнительного руля выполняют щупальца плавники виде складки кожи ритмические сокращения мантии выталкивания воды позволяют моллюску плавать интенсивно омывать жабры водой мантийную полость брюшной стороне головоногих моллюсков открываются половые мочевыводящие протоки также анальное нерстие рис 90 современных головоногих раковина сильно редуцирована растает боковыми складками мантии становясь внутренней некото рых представителей каракатица sepia раковина виде известковой пластинки залегает покровами спинной стороне туловища кальмара loligo раковины остается лишь скрытый покрова ми спинной роговой листок некоторых видов раковина остается лишь самок исчезает вовсе покровы представлены однослойным эпителием слоем соедини тельной ткани головоногие моллюски способны быстрой резкой смене своей окраски обусловливается наличием соеди нительнотканном слое кожи многочисленных пигментных клеток   хроматофоров механизм смены окраски контролируется нервной сис 157 рис 90 каракатица sepia officinali вскрытой мантийной полостью вид брюшной стороны 1   руки присосками 2   ловчая ру ка 3 рот 4  отверстие воронки 5  воронка 6   хрящевые ямки кнопок 7  анальное отверстие 8  почечные сосочки 9   непарный половой сосо чек 10 жабры 11   плавник 12  ния отреза мантии 13   отогнутая ман тия 14   хрящевые бугорки кнопок 15  мантийный звездчатый ганглий темой получающей информа цию зрительным нервам нервная система головоно гих моллюсков устроена наи сложно нервные ганг лии образуют крупное около глоточное скопление   мозг заключенный хрящевую капсулу соответствует выполняемой функции черепу позвоночных заднего отдела ганглиозной массы отходят крупных мантийных нерва органы чувств развиты обонятельные ямки глазами ладающие высокой чувствительностью пара статоцистов внутри хряще вой головной капсулы крупные сложно устроенные глаза способные аккомодации глаза своему строению напоминают глаза млекопи тающих пример конвергенции беспозвоночными позвоночны ми животными глазное яблоко сверху покрыто роговицей имеющей отверстие переднюю камеру глаза радужная оболочка образует отвер стие   зрачок который свет попадает хрусталик аккомодация глаза происходит счет удаления хрусталика сетчатки приближе ния млекопитающих аккомодация осуществляется путем измене ния кривизны хрусталика глаза окружены хрящевой капсулой коже имеются особые органы свечения строению напоминающие глаза органы пищеварения также сложно устроены несут черты специали зации питанию животной пищей ротовое отверстие лежащее центре венца щупалец ведет мускулистую глотку которой находится язык теркой глотке расположены две толстые роговые челюсти загнутые виде крючка напоминающие клюв попугая глотку открываются токи однойдвух пар слюнных желез секрет которых обладает амилоли тической протеолитической активностью содержать яды голо воногие моллюски питаются полужидкой пищей поскольку узкий пищевод который проходит мозг моллюска пища сначала разгрызается роговыми челюстями затем обильно смачивается слюной перетирается теркой длинный пищевод иметь расширение   зоб 158 пищевода пища попадает мускулистый энтодермальный желу док имеющий слепой мешковидный отросток желудка отходит тонкая кишка переходящая заднюю кишку оканчивающуюся аналь ным отверстием мантийную полость желудок впадают протоки пе чени секрет которой имеет весь набор пищеварительных ферментов i сть поджелудочная железа виде небольших придатков протоках печени заднюю кишку анальным отверстием открывается проток чернильного мешка котором образуется черная жидкость выбрасы вая чернильную жидкость анальное отверстие затем мантийной полости воронку наружу моллюски окружают темным облаком позволяет скрыться врагов питаются го иовоногие моллюски основном рыбой крабами двустворчатыми моллюсками схватывая щупальцами убивая челюстями ядом органы дыхания   жабры расположенные мантийной полости симметрично бокам туловища обмен воды осуществляется сокраще нием мантийных мышц работой воронки которую вода вытал кивается наружу числу жабр головоногие моллюски делятся две труппы четырехжаберные tetrabranchia идвужаберные dibranchia кровеносная система представлена сердцем одним желудочком двумя четырьмя предсердиями числу жабр кровь движется счет сокращений сердца также счет пульсации участков сосудов т переднего заднего концов желудочка сердца отходят головная мнутренностная аорты капилляры вен артерий коже мышцах пе реходят друг друга лишь некоторых местах сохраняются лакунарные пространства таким образом кровеносная система замкнутая ровь воздухе голубеет поскольку содержит гемоцианин богатое ме ныо соединение соответствующее физиологическим функциям гемо глобину позвоночных выделительная система состоит двух четырех почек берущих начало отверстиями целоме околосердечной сумке конечные дукты обмена поступают жаберных вен околосердечной сумки иыделяются мантийную полость рядом анальным отверстием половая система головоногие моллюски   раздельнополые жи иотные которых часто выражен половой диморфизм поло иые железы протоки непарные половые продукты накапливаются целоме выводятся половые протоки спермин склеиваются t нерматофоры   пакеты плотной оболочкой оплодотворение обычно происходит мантийной полости самки роль копулятивного органа играет одно щупалец которое самцов отличается наличием особого ложкообразного придатка помощью   щупальца самец вводит сперматофоры мантийную полость ки развитие зародышей протекает внутри яиц которые самка киадывает дне некоторых головоногих проявляется забота томстве самка аргонавта вынашивает яйца выводковой камере ось миноги охраняют кладку яиц 159 современные головоногие относятся двум подклассам подкласс наутилиды nautiloidea подкласс колеоидеи coleoidea головоногие моллюски отличаются крупными размерами скольких сантиметров нескольких метров удалось обнаружить 10метровое щупальце головоногого моллюска живут моллюски толь ко морях ведут разнообразный образ жизни большинство относят ся пелагическим животным живущим толще воды донных видов часть осьминогов щупальцами перепонка придающая те лу моллюска вид диска лежащего дне головоногие   хищники нападающие ракообразных рыб которых схватывают щупаль цами убивают челюстями ядом слюнных желез многие головоногие являются объектом промысла кальмаров ка ракатиц осьминогов использует пищу поскольку мясо обладает высокой пищевой ценностью мировой улов головоногих достигает 16 млрд т год наутилиды включают лишь отряд nautilida которому отно сится несколько видов обитающих тропических областях океа нов наутилиды характеризуются многими примитивными чертами наружная многокамерная раковина многочисленные присосок щупальца проявление метамерии т п наутилус плавает реактивным способом является объектом промысла красивой раковины подкласс колеоидеи coleoidea включает около 650 видов жестко кожих моллюсков лишенных раковины сросшаяся воронка щупальца вооружены присосками кроме две жабры две почки предсердия характерным представителем отряда являются каракатицы sepia имеющие десять щупалец которых ловчие обитают вблизи дна ведут активный плавающий образ жизни отряду кальмары teuthida относятся многие промысловые виды todarod loligo др сохраняется рудиментарная рако вина виде роговой пластинки кожей кальмары имеют десять щу палец это торпедовидные обитатели толщи океанских вод следов раковины наиболее эволюционно прогрессивных го ловоногих моллюсков   представителей отряда восьминогие octopo da восемь щупалец одно которых самцов превращено ловое большинство осьминогов обитают придонном слое воды сре ди осьминогов представители имеющие выводковую камеру аргонавт филогения головоногих моллюсков самые древние представители головоногих   наутилиды раковины которых обнаруживают иско паемых кембрийских отложениях считается головоногие изошли древних ползающих раковинных моллюсков процессе эволюции сформировалась группа головоногих моллюсков лишенных раковины новым реактивным типом движения сложной нервной системой сложными органами чувств примитивных раковинных бентопелагических форм определи лось несколько путей экологической специализации рис 91 проис 160 рис 91 экологическая радиация головоногих моллюсков ходит переход бентонектонным формам которых раковина стано вится внутренней функция плавательного аппарата ослабевает развивается новая модель движителя   воронка дали чало безраковинным моллюскам которые образуют бентонектонные каракатицы осьминоги нектонные кальмары осьминоги карака тицы бентосные планктонные зонтикообразные осьминоги па лочковидные кальмары формы тип членистоногие arthropoda общая характеристика это наиболее распространенная процве тающая группа животных обладающих членистыми конечностями сегментированным телом насчитывают 15 млн видов членисто ногих населяющих моря океаны пресные водоемы поверхность суши почву воздушную среду среди паразитов членистоногие освоили способы движения среди имеются плавающие рою щие ползающие бегающие летающие прыгающие реже малоподвиж ные неподвижные формы чрезвычайно разнообразен спектр пита ния обычной животной растительной пищи самых труднопе реваримых объектов   древесины рога воска волоса пера т п 11 6407 161 членистоногие   двустороннесимметричные животные сегмен тированным телом членистыми конечностями присуща гетеро номность сегментации различное строение сегментов разных участ ках тела тело покрыто прочной хитиновой кутикулой которая полняет функции наружного скелета защищает организм внешней среды теле членистоногих отсутствует мерцательный эпителий лость тела смешанная образована счет слияния первичной вторичной полостей тела дышат членистоногие жабрами легкими помощью трахей кровеносная система незамкнутая органы выделе ния представлены метанефридиями мальпигиевыми сосудами большинство членистоногих   свободноживущие животные среди экто эндопаразиты растений животных хищных форм численность членистоногих достигать огромных разме ров 1 м2 почвы обитать 1 млн клещей ногохвосток 1 м 3 морской воды численность веслоногих ракообразных достигает 30 тыс особей трудно определить число особей стаях саранчи парящих воздухе тучах гнуса биологическое хозяйственное значе ние членистоногих переоценить   настолько оно велико членистоногие активно участвуют биологическом круговороте биоэнергетических процессах биосфере многие водные представи тели являются биофильтраторами почвенные формы   постоянные участники почвообразовательных процессов среди членистоногих объектов промысла промышленного разведения постоянно вовлекаются сельскохозяйственное производство новые виды насе комых пчелы шмели наездники осы хищные формы паразитиче ские виды др среди членистоногих опасные вредители лесов сельскохозяйственных культур паразиты переносчики заболеваний животных человека тип членистоногие подразделяют четыре подтипа которых наибольший интерес представляют подтипа жабродышащие branchiata хелицеровые chelicerata трахейные tracheata строение жизненные отправления форма тела членистоногих чрез вычайно разнообразна тело состоит сегментов следующих друг другом каждый сегмент покрыт четырьмя склеритами твердыми хи тиновыми пластинками спинная пластинка   тергит брюшная пла стинка   стернит две боковые пластинки склеритами распо ложены мягкие сочленовные мембраны придающие подвижность ка ждому сегменту некоторых представителей сегменты сходны большинства видов различны позволяет выделить отделы тела голову грудь брюшко головной отдел состоит акрона четырех сегментов некоторых представителей сегменты тела сливаются расчлененные головогрудь брюшко клещей сегментация тела выражена имеют нерасчлененное тело правило каждый сегмент тела членистоногих несет паре членистых конечностей определило название типа конечности подвижно соединяются телом помощью суставов состоят скольких члеников образуя многоколенный рычаг способный слвж 162 ным движениям отдельных сегментах отделах тела конеч ности могут атрофированы превращены различные органы   ротовые яйцеклады копулятивные др покровы главная особенность членистоногих   наличие хитино вой кутикулы которая образуется счет выделения наружного покро ва   гиподермы кутикула прочна эластична защищает тело члени стоногих внешних воздействий служит наружным скелетом предо храняет организм высыхания высших раков кутикула пропитана солями кальция кремния железа состав входят белковые жиро подобные воскоподобные дубильные другие вещества особенно характерен кутикулы полисахарид хитин молекуле которого личие других углеводов содержатся атомы азота своему строе нию хитин напоминает клетчатку инкрустирующую клетки растений свидетельствовать родстве растительного животного царств особенно важна роль хитиновой кутикулы работе стей опоры всей мышечной системы хитиновая кутикула препятствует увеличению размеров тела этому рост членистоногих сопровождается линькой животное растет пока новая кутикула затвердеет мускулатура мускулатура представлена отдельными мышечными пучками   мышцами кожномускульного мешка большинства чле нистоногих мышцы прикреплены наружному покрову мускула тура внутренних органов представлена гладкими мышечными волокна ми остальная мускулатура имеет поперечнополосатую структуру отличает членистоногих червей имеющих гладкую мускулатуру строение мускулатуры членистоногих является примером конверген ции позвоночными животными относительная сила мышц члени стоногих значительно выше млекопитающих мышцам члени стоногих свойственна весьма высокая частота сокращений крыловые мышцы насекомых полость тела   смешанная миксоцель появление членистых ко нечностей поперечнополосатой мускулатуры позволило многим членистоногим вести активный образ жизни каждый членик ноги любой сегмент приводится движение определенными мышцами ра боту которых контролирует нервная система нервная система многом идентична нервной системе кольчатых червей глоткой головном отделе расположены парные надгло точные ганглии образующие развитый мозг имеются около глоточное нервное кольцо брюшная нервная цепочка слиянии ряда сегментов тела соответственно происходит слияние нервных уз лов брюшной цепочки узлы брюшной нервной цепочки членистоно гих выполняют разные функции этих животных происходит дифференцировка тела разные отделы этим членистоногие отлича ются кольчатых червей которых функции узлов нервной це почки одинаковы членистоногих характерно сложные поведение ориентация пространстве привело развитию высокоспециализированных н 163 органов чувств многих членистоногих наблюдается сложное инстинктивное ведение высшие членистоногие способ ны быстрому образованию новых услов ных рефлексов особенно сложные формы поведения взаимоотношения присущи общественным насекомым большинства представителей члени стоногих имеются простые сложные глаза одновременно те другие простые глаза имеют форму бокала устье которого закрыто хрусталиком дно бока ла выстлано светочувствительными клет ками которых отходит зрительный нерв свет хрусталик направляется светочувствительный слой клеток рис 92 схема строения сложные глаза состоят множества сложного глаза членистоно глазков   омматидиев имеющих кониче гого 1   роговица 2   хрусталь скую цилиндрическую форму рис 92 ный конус 3   светочувст наружная часть омматидиев представлена вительные элементы глаза прозрачной роговицей прозрачная часть 4   пигментированные слойки омматидия хитиновой кутикулы роговицей рас ми 5   зрительный нерв положен конусовидный прозрачный хру сталик который луч света направля ется лежащие ниже светочувствительные клетки омматидии отделе ны друг друга пигментными клетками которые позволяют различать форму цвета предметов каждый омматидий воспринима ет лишь часть предмета нервные клетки воспринимают те лучи которые падают перпендикулярно поверхности омматидия этому изображение предмета сложном глазу составляется отдельных частей мозаика отсюда название такого зрения   мозаичное некоторых раков сложные глаза расположены особых стебельках развиты членистоногих органы равновесия слуха осязания обоняния высших членистоногих обоняние достигает совершенства органы пищеварения ротовое отверстие находится головном деле вооружено видоизмененными конечностями   ротовыми час тями позволяющими добывать удерживать размельчать переваривать заглатывать пищу строение форма ротовых частей чрезвычайно разнообразны пищеварительная система имеет отдела переднем отделе обособлены глотка пищевод также жевательный желудок покрытые кутикулой среднем отделе происходят процессы перевари вания всасывания пищи роль пищеварительных желез выполняют печень особые пилорические придатки задний отдел достигает значительной длины заканчивается анальным отверстием передний задний отделы имеют эктодермальное происхождение выстланы изнутри хитиновой кутикулой предохраняющей внутреннюю поверх ность кишечника травмирования жесткими остатками пищи 164 органы дыхания основной массы водных обитателей   жабры роль наружных покровов газообмене правило незначительна снижение роли наружных покровов дыхании объясняется наличием плотной хитиновой кутикулы которую проникновение кислоро ограничено просто невозможно кутикула уплотнена питана минеральными солями достаточной проницаемости кутикулы потребность кислороде ведущих активный образ жизни членистоногих большинстве случаев удовлетворена счет дыхания покровы тела это возможно лишь больших размерам членистоногих которых очень тонкая кутикула относительно большая площадь поверхности тела сухопутных некоторых водных членистоногих органами дыха ния служат легкие трахеи легкие представляют собой тонкостен ные мешки внутри которых имеются многочисленные тонкие листоч ки покровы этих листочков происходит газообмен трахеи имеют вид ветвящихся трубочек которые открываются внешнюю среду специальными отверстиями   дыхальцами рис 93 спадаться дыхании позволяют упругие спиральные хитиновые нити конечные разветвления трахей лишены этих нитей проникают ткани органы членистоногих снабжая кислородом воздуха толь ко части членистоногих дыхание осуществляется покровы тела кровеносная система членистоногих незамкнутая обусловлено наличием смешанной полости тела активизация жизнедеятельности требует ускорения транспорта питательных веществ способствует рис 93 трахеи насекомых ii участок трахеи б   микроскопическое строение трахеи 165 появлению специального органа   сердца развивающегося части спинного сосуда сердце расположено спинной стороне животного сердце сокращается очень часто   ста сокращений минуту обеспечивает быстрый оборот крови гемолимфы сердца гемолим фа выталкивается артерии синусы миксоцеля омывает внутренние органы обратно сердцу гемолимфа проходит лаку нам откуда засасывается специальные отверстия   остии   крывающимися клапанами которые имеются стенках сердца гемо лимфа   жидкость частично соответствующая крови частично цело мической жидкости выполняющая функции крови некоторых членистоногих кровеносная система отсутствует представлена одним сердцем трахейнодышащих функции крови ог раничиваются доставкой всосавшихся кишечнике питательных ве ществ цвет крови чаще желтоватый красным го лубым др крови содержатся различные клетки органы выделения ракообразных выделительные функции выпол няют видоизмененные метанефридии   почки расположенные го ловном отделе насекомых многоножек органами выделения явля ются мальпигиевы сосуды   тонкие слепые отростки кишечника че рез стенки мальпигиевых сосудов происходит удаление конечных продуктов обмена излишков воды паукообразных имеются мета нефридии мальпигиевы сосуды многих членистоногих существенную роль обмене веществ иг рает жировое тело оно представляет собой скопление крупных клеток плазме которых образуются капли жира энергетического резерва жировое тело участвует процессах выделения этих клетках скапливаются кристаллы мочевой кислоты некоторых членистоногих специальные клетки поглощающие продукты распада веществ   нефроциты органы размножения большинство членистоногих   раздельнопо лые животные лишь часть паразитических сидячих форм усоногие раки являются гермафродитами размножаются животные половым путем часто наблюдается чередование полового партено генетического размножения многим видам характерен половой ди морфизм половая система самцов представлена парными семенника ми двумя семяпроводами также разнообразными образованиями передачи спермы самкам самцов предстательная железа секретирующая жидкость активации разжижения спермы половая система самок включает парные яичники яйцеводы парное влагалище семяприемник большинстве случаев членисто ногие развиваются метаморфозом некоторых развитие прямое прямом развитии яйца выходит молодая особь сходная родитель скими метаморфозе зародыш проходит личиночную стадию чинки обычно отличаются взрослых особей морфологиче ски образу жизни рост развитие членистоногих связаны периодическими линька ми хитиновая кутикула образования быстро затвердевает 166 поэтому увеличение размеров тела происходить сбрасывания старой кутикулы затвердевания новой иными сло вами рост членистоногих происходит периодически тесно связан периодичностью линьки началом линьки кутикулой те лом членистоногих образуется жидкость которая растворяет часть ста рой кутикулы эндокутикула часть нерастворившейся кутикулы эк токутикула лопается сбрасывается животным членистоногие пе риод линьки становятся беззащитными поэтому питаются прячутся укромных местах подтип жабродышащие branchiata обширного подтипа жабродышащих водных членистоногих настоящее время сохранился класс   ракообразные считывающий 40 тыс видов класс ракообразные crustacea общая характеристика основная масса ракообразных   обитатели соленых пресных водоемов лишь немногие живут влажных мес тах суше мокрицы тело ракообразных делится голову грудь брюшко часто голова грудь сливаясь образуют головогрудь го лове имеются две пары усиков антеннулы   придатки акрона антен ны   видоизмененные конечности первого сегмента головного отдела выполняющие функции обоняния осязания голове располагают ся пары челюстей членистые конечности двуветвистые кроме первой пары антеннул водные ракообразные дышат жабрами многие ракообразные ведут донный пелагический образ жизни ак тивно ползают дну плавают толще воды встречаются крепленные формы жизни суше приспособились мокри цы тропиках   почвенные бокоплавы наземные формы крабов паразиты беспозвоночных рыб планктонные ракообразные являясь фитофагами служат важней шим звеном пищевых цепях водных экосистем составляя основу пищи промысловых рыб ракообразные   самая многочисленная группа биофильтраторов воды являются важным объектом промысла строение жизненные отправления размеры форма тела чрезвычай разнообразны долей миллиметра обитатели толщи воды метра донные формы голова ракообразных образована результате слия ния акрона четырех передних сегментов голове две пары усиков пары челюстей верхние челюсти мандибулы две нижние челюсти   максиллы представляют собой видоизмененные конечности сегменты груди обычно сливаются друг другом головой разуя головогрудь высших раков голову грудь сверху бокам крывает хитиновый щит   карапакс защищающий жабры рис 9495 167 рис 96 конечности самца речного рака 1   первая пара усиков 2   вторая пара усиков 3   жвалы верхние челюсти 45  первая вторая па ры нижних челюстей 6 8   ногочелюсти 9 13   хо дильные ноги 14 19   брюшные конечности рис 97 вскрытая самка речного рака 1   сложный глаз 2   желудок 3   печень 466   кровеносные сосуды 5   сердце 7   жабры 8   яичник 9  брюшная нервная цепочка 10   мышцы брюшка 11   первая пара усиков 12   вторая пара усиков 13   задняя кишка рис 95 схема организации ракообразных 2  мозг 3   желудок 4  голова 5   печень б  сердце 7  почка 8  губа 9  рот 10   мандибулы 11 12  максиллы 13   эпиподит 14 15   экзоподит эндоподит 16   гонада 17  брюшная нервная цепочка 18   антеннула 19   антенна каждый сегмент груди несет паре членистых конечностей разли чающихся форме строению зависимости функций сегменты брюшка обычно сливаются высших раков каждый сегмент несет паре ножек низших раков брюшке ножек ьрюшко заканчивается анальной лопастью   тельсоном крабов брюшной отдел редуцирован конечности ракообразных выполняют самые разные функции рис 96 служат опорой хождении используются плавания захвата измельчения пищи защиты спаривании т п ноги имеют основную непарную часть протоподит две ветви наружная   экзоподит внутренняя   эндоподит такая двуветвистая форма конечностей ракообразных сходна двулопастной формой параподий многощетинковых кольчатых червей ноги ра кообразных состоят ряда члеников обеспечивает высокую вижность этих животных двуветвистые конечности покрытые щетинками характеризуются большой поверхностью поэтому удобны использования качест ве весел крупных раков ветви задней пары ног превратились две широкие пластинки которые вместе широким последним члеником брюшка действуют загребании воды брюшком покровы наружным скелетом служит хитиновая кутикула которая высших раков пропитывается карбонатом кальция превращается прочный панцирь низших раков кутикула тонкая прозрачная ку тикула состоит двух слоев внутреннего   эндокутикулы наружно го   эктокутикулы эктокутикула пропитана дубильными веществами обладает высокой прочностью эндокутикула время линьки растворя ется всасывается гиподермой эктокутикула целиком сбрасывается состав хитиновой кутикулы входят разнообразные пигменты нервная система представлена парным надглоточным узлом   го ловным мозгом окологлоточным нервным кольцом брюшной нерв ной цепочкой низших форм виде лестницы нервных 169 рис 94 речной рак   спинной стороны б   брюшной стороны 1   рострум 2  головогрудной щит 3   края щита покрывающие жабры 4   головогрудь 5  брюшко 6  хвостовой плавник 7  мужское половое отверстие 8  женское половое отверстие конечности сегменты i   антеннула ii   антенна ix xiii   ходильные ноги xiv xix   сегмен брюшка злов отходят периферические нервы органы чувств развиты простые сложные глаза две пары антенн органы равновесия глу боководных сидячих паразитических видов глаза могут отсутство вать органы осязания виде чувствительных щетинок разбросаны всему телу особенно усиках первой паре антенн средоточены хеморецепторы находятся статоцисты пищеварительная система эктодермальная передняя кишка пред ставлена пищеводом переходящим желудок который выстлан хити ном рис 97 некоторых высших раков желудок состоит двух делов жевательного пилорического жевательном отделе происхо дит измельчение пищи помощи трех выступов   зубов стенки 11 илорического отдела желудка имеют складки щетинками проце живания мелкоизмельченной жидкой фракций пищи переварива ние всасывание измельченной пищи происходит относительно ко роткой энтодермальной кишке открываются протоки печени секрет которой выполняет функции сока поджелудочной железы зад няя кишка прямая выстлана кутикулой открывается наружу аналь ным отверстием мелкие раки ведущие планктонный образ жизни захватывают час тицы пищи помощью усиков ротовых конечностей грудных ножек создающих ток воды дафнии задние грудные ножки бьют 300 1 мин обеспечивая постоянное поступление пищи рот ракообразных ротовые конечности выполняют разнообразные функции раков развиты верхние челюсти   жвалы имеющие зазубренный край перетирания пищи две пары нижних челюстей также принимают участие механической переработке пи щи пары ногочелюстей расположенные сегментах груди удер жи вают добычу подносят ко рту большие раки захватывают добы чу первой парой ходильных ног вооруженных мощными клешнями органы дыхания большинство ракообразных дышат кожными жаб рами которые представляют собой придатки грудных конечностей меют вид тонких выростов основания ножек высших раков жабры образуются ногах стенке тела жаберных полостях i юд хитиновым щитом   карапаксом движение воды около жабр исходит счет движения ног основания которых находятся также тех ножек которые имеют жабр сухопутных мокриц брюшных ножках находятся глубокие ветвящиеся впячивания   псев дотрахеи которых происходит газообмен требующий повышенной влажности воздуха 90 мелкие низшие раки дышат поверхно i i ю тела сухопутным крабам также необходима высокая влажность воздуха кровеносная система высших раков кровеносная система пред ставлена мешковидным вытянутым вдоль спинной стороны тела сердцем имеющим отверстия остии которые полости тела засасывается кровь гемолимфа сердца артериям кровь вылива ется лакуны миксоцеля тела полости тела гемолимфа отдает кислород тканям насыщается диоксидом углерода частично кровь 171 отдает конечные продукты обмена почкам крови ракообразных держится гемоцианин гемоглобин связывающие кислород лости тела венозная кровь собирается систему венозных сосудов жаберным приносящим сосудам поступает систему капилляров жабрах кровь освобождается диоксида углерода насыщается кислородом выносящим жаберным сосудам кровь поступает пе рикардиальный синус окружающий сердце некоторых раков кровеносная система представлена серд цем кровь перемещается счет работы мышц тела счет дви жения кишечника мелких раков кровеносная система полностью редуцироваться органы выделения головном отделе располагается две пары почек   видоизмененных сложно устроенных метанефридиев выводные протоки первой пары почек открываются основания второй пары ан тенн ангеннальные железы второй пары почек   основания второй пары нижних челюстей   максилл максиллярные железы каждая поч ка состоит мешочка выделительного канальца который расширяясь образовывать мочевой пузырь большинства ракообразных име ется лишь одна двух пар почек   антеннальные максиллярные органы размножения большинство ракообразных раздельнополы встречается половой диморфизм немногих сидячих форм парази тов наблюдается гермафродитизм развитие метаморфозом разной степени сложности реже развитие протекает стадии личинки низших раков яиц выходит личинка науплиус рис 98 имеющая пары ног глаз высших морских раков яиц выходит рис 98 личинки раков   науплиус 123  конечности 4   простой глаз 5   орган выделения 6   кишеч ник б   зоеа 1   сложный глаз 2 5   конечности 6   зачатки брюшных ног 7  брюшко   последняя пара конечностей 172 чинка зоеа имеющая большее число сегментов следовательно конеч ностей глаза кутикула личинок зоеа имеет шипики увеличиваю щие поверхность облегчающие личинкам плавание толще воды самок имеются семяприемники некоторые самцы образу ют сперматофоры которые приклеивают телу самок вводят половые пути самок речного рака женские половые отверстия крываются шестом грудном сегменте основания третьей пары хо дильных ног мужские половые отверстия расположены восьмом грудном сегменте основания пятой пары ходильных ног самцов две пары первых брюшных ножек превращены копулятивные трубочки помощью которых самцы вводят сперму половые отверстия самок класс ракообразных делят пять подклассов которых будут рассмотрены жаброногие branchiopoda максиллоподы maxil lopoda высшие раки malacostraca подкласс жаброногие branchiopoda подклассу жаброногие принадлежит 400 видов самых примитивных мелких обитателей мо рей пресных водоемов которых голова срастается грудными сегментами отсутствуют конечности брюшке жаброногих име ются сложные глаза двуветвистые листовидные грудные ножки тельсон заканчивается вилочкой выделительные железы максилляр ные основания ножек расположены жаберные лепестки жаброногие дышат покровы тела развитие происходит мета морфозом яйца вылупляется личинка науплиус которая превраща ется взрослую особь развитие бывает прямым наиболее типичными представителями жаброногих являются личные виды дафний daphnia подотряда ветвистоусые раки cladocera отряда листоногие phyllopoda огромном количестве селяющие пресные водоемы рис 99 тело дафний мешкообразной формы заключено карапакс напоминающий форме двустворча тую тонкую хитиновую раковину створки карапакса приоткрыты брюшной стороны голове имеется фасеточный глаз две па ры антенн которых первая пара антеннулы небольших размеров вторая пара очень крупных антенн имеет двуветвистое строение нимает участие плавании взмахи антенн дают скачкообразные дви жения ветвистоусых называют водяными блохами грудной отдел представлен четырьмя шестью сегментами несу щими паре коротких листовидных ножек основания которых рас положены жаберные лепестки также ряды щетинок вода движется внутри створок раковины действием ножек омывает жабры пи щевые частицы увлекаемые током воды отфильтровываются щетин ками ног отправляются рот наиболее распространена обыкновенная дафния daphnia pulex течение летнего периода дафнии размножаются партеногенетиче ски давая потомстве самок последние также дают партено генетические поколения самок т д неоплодотворенные яйца откла дываются выводковую камеру выходят молодые рачки осе нью наступлении холодов самки откладывают порцию неоплодо 173 рис 99 ветвистоусые раки   различные виды ветвистоусых раков б   дафния daphnia 1   антеннулы 2   двуветвистые антенны 3   простой глаз 4   сложный глаз 5   выделительная железа 6   сердце 7   грудные ножки 8   брюшко 9   выводковая камера творенных яиц которых развиваются самцы самки некоторое время откладывают камеру вторую порцию неопло дотворенных яиц которые претерпевают деление получают гаплоид ный набор хромосом яйца оплодотворяются молодыми самцами выводковой камере покрываются плотной оболочкой образуя эфип пий каждом одному яйца эфиппии зимуют весной снова появляются самки которые дают новое поколение партеногене тических самок таким образом дафний происходит чередование партеногенетических полового поколений т е жизненный цикл протекает типу гетерогонии 174 подкласс максиллоподы maxillopoda представители подклас са максиллоподы имеют упрощенную организацию образуется головогрудь дышат поверхностью тела большинства сердца сосудов мандибулы массивные максиллы представляют цедиль ный аппарат брюшных ножек мелкие рачки стройным удли ненным телом циклопы cyclop диаптомусы diaptomus отряда веслоногие copepoda движутся вперед помощью двуветвистых грудных ножек которые уплощены снабжены щетинками голове расположены развитая первая пара одноветвистых антеннул пара ко ротких антенн рис 100 брюшко заканчивается вилочкой циклопы диаптомусы заселяют большом количестве разнооб разные водоемы служат кормом рыб других обитателей водо емов размножаются ракообразные половым путем опло дотворенные яйца самки склеивают яйцевых мешка которые прикрепляют нижней стороне первого брюшного сегмента развитие происходит стадией науплиуса известно около 18 тыс видов веслоногих живущих морях пре сных водоемах морском планктоне наиболее многочисленны кала нусы calanus служат кормом рыб китов среди циклопов фильтраторов фитофагов хищников яйца циклопов очень ус тойчивы неблагоприятным условиям среды среди веслоногих ракообразных эктопаразиты рыб некоторые являются промежуточны ми хозяевами плоских червей рис 100 свободноживущие веслоногие ракообразные циклоп 6   диаптомус кантокамптус 1   непарный глаз 2   первая пара ан тенн 3   головогрудь 4  свободные сегменты груди 5  брюшко 6 яйцевые мешки 7  вилочка брюшка 8  кишечник 175 рис 101 усоногие раки   морская уточка вскрытой ракови ной б  морской желудь внешний вид 1   тело рака 2   конечности 3   раковина представители отрада карпоеды branchiura специализированы эктопаразиты рыб известно около 60 видов карпоедов числе пре сноводная карповая вошь argulus foliaceus которой две пары антенн превращены крючки прикрепления хозяину мандибулы образова хоботок максиллы   присоски нападают карпоеды рыб нося вред рыбоводческим хозяйствам паразитируют лягушках морских водах подкласса максиллопод обитают ракообразные ведущие взрослом состоянии сидячий паразитический образ жизни привело упрощению организации морские желуди морские уточки рис 101 отряда усоногие раки cirripedia заселя ют больших количествах подводные скалы сооружения это гер мафродитные животные личинки науплиусы сначала обладают подвижностью затем прикрепляются головным отделом субстрату претерпевают сложные превращения становясь взрослой особью оде той раковину подвижными створками удлиненные грудные ножки служат передвижения воды раковине способствуя дыханию процеживанию пищевых частиц наиболее многочисленны мо рях морские желуди balanus морские уточки lepa обрастают суда подводные сооружения 176 подкласс высшие раки malacostraca этому классу принадлежат ракообразные средних крупных размеров населяющие морские пре сные водоемы некоторые приспособились жизни суше тело ха рактеризуется постоянством сегментарного состава состоит акрона четырех головных сегментов восьми грудных шестисеми брюшных сегментов часто головные грудные сегменты сливаются образуя голо вогрудь конечности имеются сегментах числе брюш ных развитие происходит превращения стадией зоеа низ ших раков развитие происходит стадией науплиуса личинка зоеа личие науплиуса имеет удлиненное расчлененное тело рост раков сопровождается линьками речной рак первый год жизни линяет около десяти течение второго года жизни число линек снижается пяти третий год жизни происходит две линьки последую щем самцы линяют дважды самки   лишь год практически рост раков прекращается 5 годам живут 20 лет 26 тыс видов высших раков наибольший интерес представляют отряда равноногие разноногие десятиногие раки отряд равноногие раки isopoda отряде 45 тыс видов небольших раков уплощенным телом передний грудной сегмент сливается го ловным отделом глаза фасеточные карапакса сегменты груди брюшка несут паре коротких ножек ходильные грудные ножки од новетвистые одинакового строения определило название  равноногие  брюшные ножки двуветвистые выполняют дыхатель 11 ую функцию отряду равноногих относятся водяные ослики обиль заселяющие морские пресные водоемы рис 102 среди равноно гих встречаются формы приспособившиеся жизни суше разные виды мокриц живут влажных местах могут приносить вред пар никовых тепличных хозяйствах среди равноногих эктопара зиты рыб равноногие основном являются сапрофагами отряд разноногие раки amphipoda представители разноногих ра ков бокоплавов насчитывают около 45 тыс видов особенно обитает морях реже встречаются пресных водах суше разноногих раков обнаружено строение сходно строением равноногих голове расположены сидячие фасеточные глаза сегменти рованный грудной отдел карапакса одноветвистые грудные ножки днако бокоплавов отличия тело сплющено боков грудные нож ки различаются строению     ноногие  первые две пары ножек выполняют хватательные функ ции вооружены клешнями ос тальные пять пар грудных ножек служат ползания плавания грудные ножки имеют основа рис 102 равноногие раки ч   мокрица б   водяной ослик 12 6407 177 рис 103 десятиногие раки   креветка pandalus boreali б   ракотшельник pagurus bernhardus   краб c maena г   камчатский краб paralithod camtschatica ния жаберный аппарат поэтому сердце бокоплавов находится гру ди равноногих раков оно лежит брюшном отделе большинство бокоплавов   придонные ракообразные которые пи таются органическими остатками пелагические планктонные формы служат кормом рыб вновь созданные водохрани лища озера бокоплавов заселяют укрепления кормовой базы встречаются среди паразиты китовые вши сем cyamida мас се живут кожных покровах китов вызывая изъязвления китовые вши плавают заселяют китов переползая одного другого отряд десятиногие раки decapoda относятся наиболее крупные высокоорганизованные ракообразные рис 103 заселяю 178 щие основном моря реже пресные воды сухопутные формы насчитывают 85 тыс видов которых сегменты головы груди слиты головогрудь прикрытую боков сверху головогрудным хитиновым щитом   карапаксом хитин щита пропитан известью восьми пар грудных конечностей передние участвуют захвате пищи это называемые ногочелюсти остальные пять пар   ходильные ноги помощью раки передвигаются часто передняя пара ходильных ног канчивается мощными клешнями брюшко представлено шестью сег ментами каждый которых несет паре ног жабры располагаются грудных ногах теле основания ног карапакс закрывает тело боков образуя жаберные крышки брюшке имеется хвостовой плавник образованный следним сегментом тела широкими лопастями ножек предпоследне го сегмента некоторых десятиногих раков брюшко редуцировано развитие прямое метаморфозом отряд десятиногих раков подразделяется подотряда подот ряд плавающие раки natantia подотряд ползающие раки reptan tia зачастую десятиногих раков делят группы длиннохвостые мягкохвостые короткохвостые подотряд плавающие раки natantia включает наиболее прими тивную группу десятиногих раков ведущих плавающий образ жизни типичными представителями плавающих раков являются разнообраз ные креветки pandalus crangon др тело сплющено боков брюшко длинное несет плавательные ножки грудные ножки тонкие клешней помощью креветки плавают дышат захватывают пищу креветки являются объектом промысла сами служат кор мом морских обитателей особенно рыб подотряд ползающие раки reptantia   это прогрессивная группа десятиногих раков основном ведущих хищнический образ жизни хватывая добычу клешнями брюшные ножки выполняют плава тельной функции развиты слабо части раков брюшко существенно редуцировано крабы представителей подотряда явно выра женная тенденция передвижению ползанием способность плаванию существенно снижается подотряд подразделяется делы лангусты palinura омары astacura крабы branchyura шельники крабоиды anomura омаров лангустов брюшко мускулистое длинное могут плавать отшельников брюшко асимметрично недоразвито раки прячут пустые раковины мол люсков подгибают крабов брюшко редуцировано шельники крабы плавать могут среди ползающих раков ценных промысловых видов лан густ palinurus омар homarus крабоид камчатский краб paralithod camtschatica крабы cancer callinect речной рак astacus промы сел десятиногих раков широко развит ежегодная мировая добыча ближается 1 млн т речные раки обитают пресных водоемах медленным течением чистой водой ведут ночной сумеречный образ жизни питаясь дон 179 литоральные эпибионть планктон эпибионты подвижные эктопаразиты эпибионты сидячие эндопаразиты эпифитобионты бентос   г интрдёионтьг   роющие   рис 104 экологическая радиация ракообразных 1   креветка 2  циклоп 3  жабромог 4   дафния 5   краб 6  щитень 7 бокоплав 8 равноногий рак 9  креветка 10  равноногий рак 11   морские желуди 2 морские уточки 13 десятиногий рак 14   роющая мокрица 15   карповая вошь 16  саккулина ными животными падалью самки вынашивают оплодотворенную икру прикрепляя ножкам брюшка речные раки морские раки являются объектами промысла речного рака разводят специализи рованных хозяйствах филогения ракообразных ракообразные являются древней группой членистоногих животных предполагается каждый подкласс рако образных имеет собственную линию развития общих предков гипотетические предки обладали целым комплексом исходных знаков которые проявляются наиболее примитивных форм совре менных раков каждый современных подклассов имеет призна ки жаброногов branchiopoda голова неслитная брюшная нервная цепочка лестничного типа сердце трубчатое представителей maxil lopoda примитивны двуветвистые головные конечности   антенны челюсти которыми пользуются передвижении класс ostracoda своем эволюционном развитии утратил примитивные признаки современные представители практиче ски лишены таким образом подклассы ракообразных представляют ков древней предковой группы crustacea эволюция ракообразных привела образованию различных жизненных форм занявших разно образные экологические ниши рис 104 исходным типом видимо мелкие пелагобентосные формы которые вели плавающий жизни этих форм специализация шла нескольких направле ниях планктон нектон бентос часть представителей приспособилась паразитизму некоторые группы вышли сушу положительные температуры высокая влажность позволили вести активный образ жизни существенной перестройки органов дыхания подтип хелицеровые chelicerata хелицеровые   это особая ветвь членистоногих своим морфо логическим характеристикам обособленная других подтипов считывают около 63 тыс видов современных хелицеровых   обитате лей суши представленных основном паукообразными среди пауко образных встречаются вторичноводные виды паразиты растений животных многих характерно выделение паутинных нитей осо бых паутинных желез паутина помогает паукообразным защите врагов добыче пищи расселении т п рис 105 строение мечехвоста   вид спинной стороны б   вид брюшной стороны   жаберная ножка 1   го ловогрудной щит 2  рот 3   сложные глаза 4  ходильные ноги 5   хилярий 6  жа берная крышка 7  брюшной отдел 8  мечевидный отросток 9   жаброносные нож ки 10  хелидеры 11   жаберный придаток 12   членистая ножка 181 наиболее часто хелицеровых сливаются сегменты головы груди образуя головогрудь это сильнее выражено клещей антенны усики отсутствуют глаза простые одной восьми пар функции усиков челюстей выполняют первые две пары членистых придатков хелицеры педипальпы имеется четыре пары ходильных ног брюшке обычно конечностей части сухопутных видов видо изменены половые придатки органы дыхания паутинные бо родавки подтип хелицеровые включает класса мечехвосты xiphosura паукообразные arachnida мечехвосты представлены пятью ныне живущими видами рис 105 хотя древности это большая широко распростра ненная группа водных животных мечехвосты имеют уплощенную го ловогрудь закрытую панцирем широкое слитное брюшко которое заканчивается мечевидным отростком ведут бентосный роющий жизни класс паукообразные arachnida строение жизненные отправления форма тела паукообразных весьма разнообразна тело состоит головогруди брюшка брюшко сегментированное реже слитное число сегментов достигает 12 канчивается брюшко тельсоном сильно расчлененных паукообраз ных скорпионы сольпуги тело вытянутое мере слияния сегментов тело укорачивается становится округлым характерно боль шинства клещей размеры тела колеблются долей миллиметра 20 см некоторые виды пауков конечности одноветвистые голо вогруди располагаются хелицеры педипальпы четыре пары ходиль ных ног первом сегменте головогруди имеются хелицеры виде клешневидных придатков рис 106 дало соответствующее звание подтипу хелицеры выполняют функции размельчения пищи вторая пара конечностей   педипальпы   служат захвата удержа ния добычи некоторых паукообразных выполняют функции антенн брюшной отдел большинства хелицеровых конечностей имеет ходильные ноги зачастую длинные бывают двуветви стыми заканчиваются коготками приспособлены бегу паразитических видов ноги видоизменяются атрофи руются паразитических клещей могут лишь две передние пары ног клещей железниц ноги короткие зачаточные покровы тонкие хитиновые часто имеют многочисленные волоски мелких клещей характерны тонкие покровы позволяющие осуще ствлять газообмен сухопутных паукообразных сверху экзокутикулы имеется тонкий слой эпикутикулы состав которой входят воскопо добные вещества хитина слой защищает тело высыхания целом кутикула паукообразных бывает толстой лишь вторичноводных представителей кутикула превращается панцирь панцирных клещей кутикула также утолщается производным наруж 182 рис 106 пауккрестовик   схема внутреннего строения 1   хелицеры ядовитой железой внутри 2   сосатель ный желудок 3   слепые отростки кишечника 4   сердце 5   яичник 6   яйцевод 7   паутинные железы 8 легкое 9  отверстие сердца 10  печень 11   мальпигиевы сосуды б   хелицеры педипальпы 12   когтевидный членик хелицер 13   основной членик хелицер 14   педипальпы 15   челюстная лопасть 16   нижняя губа пого покрова относятся ядовитые железы основания хелицер пауков ядовитая игла скорпионов также паутинные железы пауков нервная система типична членистоногих головной мозг окологлоточное кольцо брюшная нервная цепочка пауков клещей узлы груди брюшка слиты единый нервный узел органы зрения виты слабо представлены одной шестью парами простых глаз центральных глаза пауков способны различать форму i вет предметов органы обоняния осязания представлены отдельными сенсиллами скоплениями особое развитие получили органы ося зания большинство паукообразных ночные хищники зрение играть жизни такую роль дневных представителей пищеварительная система имеет особенности связанные характе ром питания паукообразные имеют две пары ротовых конечностей хелицеры   челюсти педипальпы   ногощупальца хелицеры состо ит основного членика острого загнутого крючка который пауки вонзают тело жертвы см рис 106 педипальпы состоят основного членика которым соединен членистый щупик хищных пауков хе 183 лидеры педипальпы служат раздавливания размельчения пищи пауков педипальпы подобны ротовым щупальцам которых сосре доточены осязательные обонятельные сенсиллы скорпионов щупик педипальп заканчивается клешней помо щью которой схватывают удерживают добычу многие паукооб разные впрыскивают тело жертвы пищеварительный сок затем сасывают полупереваренное содержимое внекишечное пищеваре ние представителей которые питаются жидкой пищей соки расте ний кровь животных передний отдел пищеварительного тракта представлен мускулистой глоткой пищеводом сосательным желуд ком служащими всасывания пищи передний отдел открываются протоки небольших слюнных желез процессы переваривания вса сывания питательных веществ происходят средней кишке выстлан ной железистым эпителием энтодермального происхождения сред няя кишка образует слепые выросты увеличивающие внутреннюю верхность объем кишечной полости многих паукообразных сред нюю кишку открываются протоки печени которая имеет вид парных железистых выростов кишечника печень выполняет роль пищеварительной железы функцию всасывания переваренной пищи печени происходит полостное частично внутриклеточное пищеварение паукообразные могут длительное время питаться поскольку миксоцеле имеется жировое тело запасом питательных веществ кровеносная система представлена лежащим спинной стороне те ла мускулистым сердцем отходящими сосудами которые идут различным органам обратный ток крови осуществляется лаку нам клещей часть кровеносных сосудов редуцирована отсут ствует сердце паукообразных имеющих легочные мешки крове носная система развита трахейнодышащих органы дыхания одних паукообразных это легочные мешки других   трахеи третьих   легочные мешки трахеи одновременно большинство пауков водных хелицеровых органы дыхания пред ставлены жабрами некоторых мелких форм газообмен осуществля ется покровы тела легочные мешки расположены передней части брюшка открываются наружу специальными отверстиями   дыхальцами легочных мешках кровь течет параллельно располо женных тонких листовидных складках которые происходит га зообмен щелевидные пространства складками проникает воз дух отдающий кислород гемолимфу сосудов которые пронизывают листовидные складки легочных мешков трахеи   наиболее распространенные органы дыхания паукооб разных   начинаются отверстиями стигмами покровах брюш ка стигм глубь тела расходятся трахеи виде ветвящихся трубочек трахеи легкие паукообразных возникли независимо друг друга ле гочные мешки древние органы трахеи органы выделения представлены коксальными железами почками которые открываются выделительными отверстиями основания 184 третьей пятой пары ходильных ног т е почки хелицеровых вполне гомологичны почкам ракообразных поскольку последних расположены других сегментах тела многих сухопутных хелицеровых характерны особые органы выделения   мальпигиевы сосуды это особые выросты задней части средней кишки которые извлекают крови продукты распада отво дят среднюю кишку виде однойдвух пар слепых трубочек небольшого диаметра способствуют рациональному расходованию ды организме впадают среднюю кишку происходит всасывание излишков воды органы размножения паукообразные   раздельнополые животные выражен половой диморфизм самцы мельче самок пар ные яичники самок расположены брюшке яйцеводы сливаются единый проток который открывается передней части брюшка са мок нередко развиваются семяприемники самцов семенники лежат брюшке семяпроводы сливаются открываются одним отверстием нижней части брюшка оплодотворение сухопутных форм наруж новнутреннее помощью сперматофоров внутреннее водных форм хелицеровых оплодотворение наружное самцы лжескорпионов многих клещей оставляют сперматофоры почве самки захваты вают наружными половыми органами самцы могут помощью хе лицер сами переносить сперматофоры половые отверстия самок некоторых представителей имеются копулятивные органы случае сперматофоры самцов образуются большинство паукообразных откладывают яйца некоторых блюдается живорождение чаще развитие происходит мета морфоза сопровождается ростом неоднократными линьками клещей наблюдается партеногенетическое размножение развитие происходит стадией личинки класс паукообразных подразделяется множество отрядов ко торых будут рассмотрены наиболее интересные сельскохозяйст венных работников отряды скорпионы scorpion ложноскорпио ны pseudoscorpion сольпуги фаланги solifuga сенокосцы opilion паую aranei отряда клещей acariform paras form opiliocarina отряд скорпионы scorpion это наиболее древние происхож дению паукообразные длина тела тропических видов дости гать 18 см скорпионов характерна наибольшая расчлененность те ла головогрудью следует 6сегментное переднебрюшье 6сегмент ное заднебрюшье рис 107 дышат скорпионы легочными мешками тельсон образует вздутие ядовитой иглой вершине которой крываются протоки ядовитых желез крупные педипальпы вооружены клешнями жертву скорпион захватывает клешнями педипальп пере гибает брюшко спину вперед вонзает иглу добычу четыре па ры ходильных ног заканчиваются парой коготков известно около 600 видов скорпионов обитающих странах теп лым климатом это ночные хищники днем скрываются расще 185 рис 107 скорпион   видео спинной стороны 1   головогрудь 2   хелицеры 3   педипальпы 4  ноги 5  конечный членик брюшка 6  жало 7  передний отдел брюшка 8  задний отдел брюшка viii xix   сегменты брюшка б  виде брюшной стороны 9   анальное верстие 10   легочная щель 11   гребенчатые органы 12   половые крышечки линах норках самки рождают детенышей первое время носят спине укусы болезненны обычно опасны человека закав казье обитает пестрый скорпион buthus eupeus отряд ложноскорпионы pseudoscorpion это мелкие 1 7 мм паукообразные имеющие клешневидные педипальпы поэтому напо минающие скорпионов рис 108 брюшко разделено передне заднебрюшье дышат ложноскорпионы помощью трахей хелице рах открываются протоки паутинных желез живут ложноскорпионы лесной подстилке камнями корой пней жилище человека пи таются мелкими клещами самцы откладывают сперматофоры кото рые захватываются самками семяприемники яйца самка откладыва 186 ет выводковую камеру расположенную брюшной стороне тела вышедшие яиц личинки остаются подвешенными камере пита ются желтком который выделяет самка первой линьки моло дые покидают мать известно около 13 тыс видов ложноскорпионов жилищах челове ка часто встречается книжный ложноскорпион chelif cancroid пи тающийся мелкими насекомыми клещами которые вредят книгам отряд сольпуги фаланги solifuga это крупные сильно рас члененные обитатели степных пустынных районов насчитывающие около 600 видов головогрудь сольпуг неслитная состоит головно го отдела трех свободных сегментов которых последний недораз вит см рис 108 брюшко состоит десяти сегментов педипальпы рис 108 различные паукообразные   сольпуга galeod araneoid б   хвостатый телифон thelyphonus caudatus   книж ный лжескорпион chelif cancroid г   обыкновенный сенокосец phalangium opilio 1   каракурт latrodectus tredecimguttatus 187 похожи ходильные ноги участвуют передвижении выполняют чувствующие функции дышат помощью трахей паутинных бородавок сольпуги питаются насекомыми числе вредными саранча ядовиты ведут ночной образ жизни кавказе обитает фаланга galeod araneoid имеющая длину 5 см самка откладывает яйца норку проявляет заботу потомстве самец откладывает сперматофоры отряд сенокосцы opilion включает 3 тыс видов широко рас пространенных членистоногих внешне похожих пауков сенокосцы отличаются пауков отсутствием перетяжки головогрудью брюшком членистостью брюшного отдела котором десять сегментов клешневидными крючковидными пауков хелицерами см рис 108 тело сенокосцев покоится очень длинных тонких ногах сенокосцы повсеместно обитают поверхности почвы трещи нах коры деревьев стенах строений т п питаясь ночью мелкими секомыми дышат помощью трахей способны аутотомии оторван ная хищником нога продолжая двигаться отвлекает нападающего спасает своего хозяина оторванная конечность восстанавливается своей форме напоминает косу дало повод назвать ряд сенокосцы активно охотятся поскольку образуют паутину наиболее распространен обыкновенный сенокосец phalangium opilio встречающийся разных природных ландшафтах тело бурого цве та 9 мм длиной ноги достигают 5 см отряд пауки aranei самый представительный отряд включа ет 27 тыс видов тело четко подразделяется слитную голо вогрудь нерасчлененное брюшко рис 109 головогруди располо жены одна шесть пар глаз чаще четыре пары головогрудью брюшком заметна перетяжка виде узкого стебелька которая образована седьмым члеником головогруди хелицеры состоят двух члеников которых конечный имеет вид изогнутого острого коготка основании хелицер находится ядовитая железа секрет которой протокам выходит острие коготков прокалывая покровы жертвы пауки вводят ранку яд педипальпы пауков имеют вид членистых щупалец самцов конеч ный членик педипальп имеет резервуар копулятивным аппаратом пе риод размножения самец наполняет резервуары спермой полового отверстия расположенного брюшке спаривании самец вводит копулятивный аппарат семяприемник самки оставляет сперму четыре пары ходильных ног зачастую заканчиваются коготками помощью которых пауки натягивают паутину паутинные бородавки расположены нижней стороне брюшка паутины пауки строят се бе жилище ею обволакивают яйца образуя яйцевой кокон маленькие паучки выделяют тонкую паутинку виде нити помощью которой разносятся ветром далекие расстояния паутина используется ловли добычи помощью паутинных гамаков самцы заполняют спермой свои семенные капсулы резервуары педипальпах паутинные железы выделяют клейкое тянущееся вещество которое затвердевает воздухе пауков имеется несколько типов паутинных 188 рис 109 представители отряда пауки   пауккрестовик araneus diadematus 1   головогрудь 2   хелицеры 3   педипальпы 4   ходильные ноги 5   брюшко б   тарантул lycosa singoriensi   каракурт самка гнезде яйцевых коконов г   паукптицеед poecilotheria regali желез разного назначения протоки бородавках открываются трубочками конусами паукакрестовика бородавках насчитыва ют 560 трубочек 20 конусов множество выделяемых тончай ших паутинок склеиваются одну общую паутинную нить паутинные иити предназначены разных целей изготовления ловчих сетей стройки яйцевого кокона жилого дома т п связи этим пауков существует несколько различных типов паутины сухая влажная клей кая гофрированная основания поперечин ловчих сетей т п большинства пауков имеется пара легких пара трахей подотряд двулегочные некоторых тропических пауков две пары легочных мешков нашей стране обитает около 15 тыс видов пауков 189 рис 110 морфология клеща hyalomma самец дорсальной вентральной сторон   средняя бороздка 2   глаза 3   латеральные бороздки 4  лапка 5  присоски коготки 6   пальпы 7   футляр хелицер 8   хоботок 9   основание хоботка 10   членики пальп б г 12   передняя лапка 13   голень 14   бедро 15   вертлуг 16  половое отверстие 17   половые бороздки 18  анальное отверстие относящихся двулегочным паукообразным наиболее часто встреча ются паукикрестовики araneus которых легко узнать крестооб разному рисунку верхней стороне брюшка см рис 109 засе ляют леса кустарники приусадебные участки постройки ветвях паукикрестовики сооружают большие радиальные сети нити кото рых покрыты клейкой массой захватывающей попавших сети насе комых домовые пауки tegenaria селятся обычно жилых производствен ных помещениях натягивая горизонтальные паутинные сети помо щью которых ловят мух других насекомых особую группу образуют пауки преследующие жертву обыч ным представителем юге страны степных районах является таран тул lycosa singoriensi живет тарантул отвесных норках вырытых почве выстланных паутиной это самый крупный паук отечествен ной фауны   3 см длиной см рис 109 укус тарантула вызывает человека болезненный отек представляет серьезной опасности человека весьма опасен паук каракурт latrodectus tredecimgut tatus которого встретить степных районах кавказа повол жья это средних размеров около 15 см паук черного цвета красны ми пятнышками верхней поверхности брюшка рис 110 каракур обитают норках поверхности почвы расстилают ловчую 190 паутину обычная добыча каракуртов   прямокрылые числе са ранчовые яд паука опасен лошадей человека овцы свиньи укусов страдают самка крупнее самца обычно спарива ния съедает позволило звать каракурта  черной вдовой  ка откладывает яйца группами шаровидные паутинные коконы рас положенные земли пауков очень ярусах биоценозов суши хищ ники участвуют пищевых цепях числе регуляции чис ленности самых разных насекомых образ жизни пауков весьма разнооб разен бродяжки сидячие тенетные растягивающие ловчие сети др клещи acarina это групповое название объединяет отряда класса паукообразных классификация клещей разработана недоста точно скудности сведений филогении неравномерной изу ченности отдельных групп появления большого числа вновь откры тых видов т д многие исследователи оснований считают классе паукообразные следует выделить подкласса пауки агапеа клещи acari других подклассов клещи отличаются слабой выраженностью полным отсутствием сегментации брюшно го отдела тела постэмбриональное развитие клещей отличие дру гих паукообразных проходит метаморфозом личинка имеет па ры ног общая характеристика клещей приспособленности различным местам обитания клещи приближаются насекомым живут мхах лишайниках лесной подстилке почвенном слое могут составлять 95 фауны членистоногих клещи живут водоемах горячих источниках вулканов заселили многие органы ткани растений разнообразны отношения растениями животны ми многие растительноядные клещи наносят серьезный вред сельско хозяйственному производству потери урожая достигают 20 30 те пличных хозяйствах паутинного клеща вредящего овощным культурам повреждения наносимые грушевым галловым клещом приводят потери 90 урожая земляничный клещ снижает сбор ягод 40 70 большой ущерб наносит зернопродуктам группа амбарных клещей часть клещей является паразитами животных человека покровы клещей покровы членистоногих состоят ку тикулы гиподермы подстилающей базальной перепонки тело которых клещей покрыто сверху мощным панциревидным щитом панцирные клещи кровососущих иксодовых клещей покровы сла бо склеротизированы позволяет самкам сильно растягиваться время сосания крови производным наружных покровов относятся щетинки щитки железы нервная система характерной особенностью клещей является центральная нервная система представляет собой единую цель ную массу нервной ткани окружающую пищевод плотным кольцом   мозгом клещей обнаружены чувствующие органы связанные ме ханическим химическим гигротермическим чувствами зрением основу органов чувств составляют сенсиллы состоящие щетинок 191 пор т д клещей простые глаза правило две пары предста вители большого числа видов лишены глаз пищеварительная система передняя кишка подразделяется мус кулистую глотку пищевод который впадает среднюю кишку час ти клещей пищевод образует расширение   зоб средняя кишка часто называемая желудком многих видов связана слепыми отростками которые особенно развиты кровососущих клещей насчи тывается семи пар значительно превышают размером саму среднюю кишку небольшие отростки имеют сапрофаги сложно устроена средняя кишка питающихся соком растений клещей обладающих системой разделения пищи фракции задний отдел кишечника состоит тонкой толстой кишок которыми впадают кишечник мальпигиевы сосуды очень короткая прямая кишка выстлана хитином заканчивается анальным отверстием отдельных клещей характерно внекишечное пищеварение ротовые части представлены хелицерами педипальпами могут образовывать типа ротовых аппаратов грызущий колющесосу щий ротовой аппарат грызущего типа характерен клещей питаю щихся твердой растительной пищей переходом питанию жидкой пищей ротовые части становятся тонкими теряют зубцы образуя сти леты парные стилеты виде двух желобков составляют трубку кото рая выдвигается вперед погружается ткань растения строение ног большинство клещей имеют четыре пары ног чинки   пары ног встречаются виды редукцией части ног ноги состоят шести члеников тазика вертлуга бедра колена голени лапки отдельные членики сливаются образованием четырех пятичлениковой конечности лапка иметь различные способления передвижения пару коготков многих видов соски эмподий расположенные коготками липкий секрет удержания субстрате паутинные выделения т д водных кле щей ноги превращаются плавательные могут задние   прыга тельные могут приспособления удержания волосах перьях ит п см рис 110 кровеносная система лакунного типа большинства видов отсутст вуют сосуды сердце кровь бесцветная органы дыхания крупные клещи дышат помощью трахей мелкие формы дышат покровы тела дыхальца   стигмы   парные одной четырех пар органы выделения   мальпигиевы сосуды коксальные железы органы размножения клещи раздельнополы часто наблюдается половой диморфизм многим признакам числе размерам тела половое отверстие обычно находится уровне задней пары ног брюшной стороне тела самки самца оно зачастую прикрыто спе циальными щитками клапанами покрытыми сенсорными щетин ками сперматофоры вводятся половое отверстие самок помощью хелицер самца некоторых клещей самцы прикрепляют сперматофо ры субстрату панцирных клещей имеется длинный яйцеклад 192 большинство клещей откладывают яйца немногих отме чено живорождение ряда панцирных клещей характерно посмерт ное живорождение случае самка погибает отложив яиц развиваются внутри тела вылупившиеся личинки защищен ные неблагоприятных условий панцирем матери питаются тка нями затем выходят наружу клещей встречается партеногенез течение онтогенеза клещи проходят четыре фазы яйца личинки нимфы взрослого клеща имаго окончании эмбриогенеза чинка выходит яйца некоторых видов яйце происходит эм бриональная линька зародыша вышедшая личинка отличается взрослого клеща меньшим числом щетинок меньшими размерами сутствием полового отверстия последней пары ног личинки хищных паразитических видов питаются живут счет запасов желтка закончившая развитие личинка впадает состояние покоя линяет превращается нимфу нимфа имеет четыре пары ног теле появляются зачатки гени талий увеличивается число щетинок фаза нимфы включать одного трех возрастов нимфа первого протонимфа нимфа второ го дейтонимфа третьего тритонимфа возраста переход одного возраста сопровождается периодом покоя линькой наступлении неблагоприятных условий нимфа первого возрас та переходит особую стадию гипопуса гипопусы значительно отлича ются обычных нимфальных фаз клещей лишены действующего ротового аппарата сильно редуцируется пищеварительный аппа рат существуют счет резервов тела гипопусы бывают подвиж ные расселительные покоящиеся рис 111 подвижные гипопусы сохраняют развитые ноги покровы уплот няются тело уплощается передвигаются активно пассивно прикре пляясь различным животным помощью присосок других способлений покоящихся гипопусов характерна сильная редукция ног муч ной клещ полная утрата волосатый домовый клещ состоя нии покоя могут находиться месяцами устойчивы дейст вию фунгицидов благоприятных условиях гипопус линяет превра щается нимфу которая стадии покоя линьки превращается взрослого клеща многих клещей которых развит половой диморфизм самцы развиваются быстрее самок поэтому моменту последней линьки самки самцы достигают половой зрелости вскоре сбрасывания самкой личиночной шкурки происходит спаривание 2 3 сут самки начинают откладку яиц жизненные циклы клещей разнообразны зависят многих фак торов виды паутинных клещей которые течение года могут дать 20 поколений северных ареалах развитие одной генерации ик содовых клещей требуется 4 лет жизненном цикле клещей могут неблагоприятные периоды i случае процессы жизнедеятельности клещей резко замедля ii 6407 193 рис 111 гипопусы амбарных клещей   подвижный гипопус мучного клеща спинной стороны б   брюшной стороны   присасы вательный диск 1   генитальное отверстие 2 аналь ное отверстие 3   основные присоски 4   передние присоски 5   вспомогательные присоски г   покоя щийся гипопус мучного клеща д   покоящийся гипо пус обыкновенного волосатого клеща ются переходят состояние диапаузы отличие обычного коя оцепенения диапауза находится сложных взаимоотношениях внешней средой именно взаимоотношения обеспечивают синхронность развития организма клещей фенологией питающих растений климатическими условиями среды диапауза зимней летней некоторые виды клещей ведут хищнический образ жизни питаясь другими клещами мелкими насекомыми поражая клещейвредите лей паразитов сельскохозяйственных растений хищные формы клещей приносят существенную пользу могут использованы биологиче ской борьбе вредными членистоногими многие почвенные клещи яв ляясь сапрофагами участвуют почвообразовательных процессах отряд клещисенокосцы opiliocarina включает небольшую группу примитивных клещей сохранившейся сегментацией тела послед сегмента головогруди свободные брюшко восьми сегментов две пары глаз четыре пары стигм хелицеры клешневидные ме жду ними расположен теркообразный орган первая пара ног специа лизирована основном сенсорные органы размеры тела сенокос цев достигают 1 мм живут скрытно обитая камнями почвенном слое хозяйственное значение неопределенно отряд акариформные клещи acariform это наиболее крупный отряд объединяющий разнообразные морфологическим экологи ческим особенностям формы насчитывающий 15 тыс видов наряду микроскопическими мелкими паразитическими видами ме 01 мм длины встречаются свободноживущие хищники достигаю щие длину 10 мм примитивные формы дышат покровы тела эволюционно прогрессивных форм дыхание осуществляется помо щью трахей размножение сперматофорами развитие анаморфозом состав отряда входят подотряда краснотелковые trombidiform саркоптоидные sarcoptiform включающие множество семейств подотряд краснотелковые trombidiform включает се мейств свободноживущих сухопутных водных клещей имеются сре ди паразиты хелицеры колющие одна пара дыхалец располо жена передней части тела растительноядных клещей существенный вред растениям чиняют паутинные клещи сем tetranychida это мелкие клещики 03 05 мм разнообразной окраски большинство видов выделяют паутину дало название семейству слоем паутины нижней стороне листьев растений клещи образуют колонии яиц выходят личинки которые проходят стадии нимфы первого второго возрас тов затем становятся взрослыми клещами весь цикл развития длится 12 28 сут клещи питаются соком растений который высасывают листьев особенно большой вред приносят тепличных парниковых хозяйствах рис 112 серьезными вредителями являются обыкновен ный паутинный tetranychus urtica koch садовый паутинный schizo tetranychus ond другие клещи семейства эриофиид eriophyida имеют червеобразное кольчатое тело длиной 015 03 мм фазах развития ха рактерны две пары передних ног часто среди бывает ти па самок первичные которые весь вегетационный период дают сколько поколений вторичные которые зимуют весной отклады вают яйца которых развиваются первичные самки самцы наиболее серьезный урон растениям наносят следующие виды клещей смородин ный почковый eriophy ribi westw побеговый сливовый aceria phloeocopt nal ржавый клещ томатов a lycopersici mas др представитель краснотелковых клещей acarapi woodi ren сем scutacarida паразитирует трахейной системе пчел вызывая тяже лое заболевание акарапидоз которое приводит гибели пчелиных семей н д е м е й т р н т е л ы е л е щ trombea включает достаточно большое число видов клещейкровососов i юсящих существенный вред животным человеку железничные кле щи demodicida паразитируют волосяных сумках вызывая заболе 13 195 вание   железницу животных человека см рис 112 сильном поражении 1 см 2 кожи овец насчитывали 25 тыс особей клещей пораженных местах шерсть выпадает дерме кожи образуются пу зырьки подотряд саркоптоидные sarcoptiform включает клещей имею щих грызущий ротовой аппарат среди большого числа семейств сле дует выделить панцирных клещей oribatei   участников почвообра зовательных процессов среди которых виды являющиеся проме жуточными хозяевами паразитических ленточных червей важное хозяйственное значение имеют представители сем мучные клещи acarida это небольшие амбарные клещи 02 08 мм овальным полупрозрачным телом наружные покровы мягкие глад кие распространены повсеместно живут опавших листьях скирдах сена соломы зернохранилищах складах гнездах птиц т д вреждают зернофураж муку сухофрукты многое другое имеющее органическую природу клещи сильно загрязняют продукты испражнениями большой вред приносят мучной клещ acarus siro l см рис 112 темноногий клещ aleuroglyphus ovatus troup другие семейству волосатые клещи glycyphagida относятся неболь шие клещи 04 06 мм длинными опушенными щетинками распо ложенными спине живут складских помещениях домах вреждают семена масличных культур сухофрукты кожевенное сырье перьевые изделия пораженное насекомыми зерно широко распро странен обыкновенный волосатый клещ glycyphagus destructor sehrnk бурый хлебный gohieria fusca oud другие клещи отряд паразитиформные parasitiform включает мелких круп ных клещей 02 7 мм большинства видов ротовой аппарат колю щесосущего типа свободноживущие формы паразитиче ские виды вредители продовольствия семейство иксодовые пастбищные клещи ixodida относя щиеся подотряду заднедыхальцевые metastigmata представлено наиболее крупными клещами которых длина тела насасывания крови достигает 30 мм размеры голодной нимфы 2 3 мм это эктопа разиты основном теплокровных животных многие виды нападают человека рис 113 одной корове одновременно обнаружить около тысячи клещей которые высасывают 5 л крови клещи вызы вают болезненное состояние животных снижение продуктивно сти название  пастбищные  клещи получили самки кладывают яйца непосредственно почву взрослые клещи ведут скрытный образ жизни взбираясь листья стебли растений лишь нападения хозяина отдельные виды ик содовых клещей могут голодать стадии личинки нимфы 2 лет взрослые   года время кровососания клещи поглощают крови особенно присуще самкам результате масса объем тела увеличиваются масса самцов возрастает 15 2 раза самок  100 большинство видов период развития взрослом состоя нии имеют разных хозяев биологическому признаку различают од 197 рис 113 представители клещей подотряда ixodid   ixod ricinus б   haemaphysali punctata   boophilus calcaratus г   dermacentor da ghestanicus д   rhipicephalus tyranicus 1   самец 2   самка двух треххозяинных клещей однохозяинные клещи стадии своего развития проходят одном хозяине личинки boophilus calcaratus нападают крупных животных насыщения кровью линяют оставаясь хозяине превращаются нимфу фы питаются превращаются хозяине имаго лишь фазе сытых половозрелых особей клещи самопроизвольно отпадают сво единственного хозяина откладывают почве яйца двуххозяинных клещей теплокровное животное нападают чинки отпадают сытые нимфы нимфы почве линяют превращаются имаго которые нападают второго хозяина сыщения кровью становятся половозрелыми клещами треххозяинный тип питания большинство ixod заключается клещи нападают животных каждой фазе развития каждый отпадая линяя внешней среде половозрелый клещ должен сосаться крови лишь созревают половые продукты насасывание кровью сопровождается самок быстрым витием яичников позволяет обеспечивать высокую плодовитость клещи спариваются самки откладывают яйца число ко 199 ч сть i материалы обязательного чтения г л 1 обработка ошибок прежде изучать функции предлагаемые microsoft window посмотрим устроена обработка ошибок вызываете функцию window проверяет переданные параметры затем пытается выполнить работу передали недопустимый параметр данную операцию выполнить причине воз вращает значение свидетельствующее ошибке таблице 11 показаны типы дан ных возвращаемых значений большинства функций window тип данных значение свидетельствующее ошибке void функция выполняется успешно таких функций window очень мало bool вызов функции заканчивается неудачно возвращается 0 ос тальных случаях возвращаемое значение отлично 0 пытай тесь проверять соответствие true fals handl вызов функции заканчивается неудачно обычно возвраща ется null остальных случаях handl идентифицирует объект которым можете манипулировать будьте осторожны некоторые функции возвращают handl значением invalidhandl valu равным  1 документации platform sdk каждой функ ции четко указывается именно возвращает ошибке   null invalidhandlevalu pvoid вызов функции заканчивается неудачно возвращается null остальных случаях pvoid сообщает адрес блока данных памяти long dword это значение    крепкий орешек  функции которые сообщают значения какихлибо счетчиков обычно возвращают long dword причине функция сумела сосчитать хотели обычно возвращает 0  1 зависит конкретной функции используете одну таких функций проверьте документации platform sdk каким именно значением уведомляет ошибке таблица 11 стандартные типы значений возвращаемых функциями window возникновении ошибки должны разобраться почему вызов данной фун кции оказался неудачен каждой ошибкой закреплен свой код   32битное число функция window обнаружив ошибку механизм локальной памяти потока сопоставляет соответствующий код ошибки вызывающим потоком локальная па мять потока рассматривается главе 21 это позволяет потокам работать независи мо друг друга вмешиваясь чужие ошибки функция вернет управле ние возвращаемое значение указывать произошла ошиб ка именно   узнаете вызвав функцию getlasterror dword getlasterror 2 г л 1 обработка ошибок просто возвращает 32битный код ошибки данного потока код ошибки нужно обменять внятное список кодов ошибок определенных microsoft содержится заголовочном файле winerrorh приведу небольшую часть представляли похож messageid errorsuccess messagetext the oper complet success defin errorsuccess 0l defin noerror 0l dderror defin seceok hresult0x00000000l messageid errorinvalidfunct messagetext incorrect function defin errorinvalidfunct 1l dderror messageid errorfilenotfound messagetext the system cannot find the file specifi defin errorfilenotfound 2l messageid errorpathnotfound messagetext the system cannot find the path specifi defin errorpathnotfound 3l messageid errortoomanyopenfil messagetext the system cannot open the file defin errortoomanyopenfil 4l см след стр 3 часть i материалы обязательного чтения messageid erroraccessdeni messagetext access is deni defin erroraccessdeni 5l видите каждой ошибкой связаны идентификатор сообщения использовать исходном коде сравнения значением возвращаемым getlast error текст сообщения описание ошибки нормальном языке номер вместо использовать индентификатор учтите показал лишь крошечную часть файла winerrorh самом деле нем 21 000 строк функцию getlasterror нужно вызывать сразу неудачного вызова функции window иначе код ошибки потерян getlasterror возвращает последнюю ошибку возникшую потоке поток вызывает другую функцию window проходит успешно код пос ледней ошибки перезаписывается используется индикатор благо получного вызова функции лишь несколько функций window нарушают это правило изменяют код последней ошибки однако документации platform sdk утверждается обратное якобы успешного выполнения api функции обычно изменяют код последней ошибки многие функции window 98 самом деле реализованы 16разрядном коде унаследованном операционной системы window 31 нем меха низма сообщающего ошибках некую функцию наподобие getlast error microsoft стала  исправлять  16разрядный код window 98 держки обработки ошибок практике это означает многие win32фун кции window 98 устанавливают код последней ошибки неудачно го завершения просто возвращают значение которое свидетельствует ошибке поэтому удастся определить причину ошибки некоторые функции window завершаются успешно разным причи нам например попытка создать объект ядра  событие  определенным именем мо жет успешна либо действительно создали либо объект нужно знать причину успеха возврата информации microsoft предпочла использовать механизм установки кода последней ошибки успешном выполнении некоторых функций можете вызы вать getlasterror получать дополнительную информацию числу таких функций относится например createev других функциях см platform sdk взгляд особенно полезно отслеживать код последней ошибки процессе отладки кстати отладчик microsoft visual studio 60 позволяет настраивать окно watch оно показывало код описание последней ошибки теку щем потоке выбрать какую строку окне watch ввести  errhr  посмотрите рис 11 видите вызвал функцию createfil вернула значение invalidhandlevalu  1 типа handl свидетельствующее удалось открыть заданный файл окно watch показывает нам код последней ошибки который вернула функция getlasterror вызвал 4 г л 1 обработка ошибок равный 0x00000002 описание  the system cannot find the file specified   система найти указанный файл  именно эта строка определена заголовочном файле winerrorh ошибки кодом 2 рис 11 используя  errhr  окне watch среды visual studio 60 можете просматривать код последней ошибки текущем потоке visual studio поставляется небольшая утилита error lookup которая позволяет получать описание ошибки коду приложение обнаруживает какую ошибку правило сообщает пользователю выводя экран описание window специ альная функция которая  конвертирует  код ошибки описание   formatmessag dword formatmessag dword dwflag lpcvoid psourc dword dwmessageid dword dwlanguageid ptstr pszbuffer dword nsize valist argument formatmessag   весьма богатая своим возможностям функция именно желательно применять формировании строк показываемых пользователю дело позволяет легко работать множеством языков formatmessag определяет язык выбран системе качестве основного параметр зада ется апплет region set control panel возвращает текст соответству ющем языке разумеется сначала должны перевести строки нужные языки встроить ресурс свой exe dllмодуль зато функция автома тически выбирать требуемый язык программапример errorshow приведенная кон 5 часть i материалы обязательного чтения це главы демонстрирует вызывать функцию получения текстового опи сания ошибки коду определенному microsoft время времени спрашивает составит microsoft полный список кодов ошибок возможных каждой функции window ответ увы скажу такого списка   слишком сложно составлять поддерживать новых новых версий системы проблема подобным списком вызываете одну apiфункцию обратиться та   третьей т д любая этих функций завершиться неудачно самым разным причинам функция высо кого уровня сама справляется ошибкой одной вызванных ею функций ко нечном счете выполняет хотели общем создания такого спис ка microsoft пришлось проследить цепочки вызовов каждой функции очень трудно появлением новой версии системы цепочки нужно пересмат ривать заново можете это сделать  кэй показал функции window сообщают ошибках microsoft позволяет использовать механизм собственных функциях допустим пишете функ цию которой будут обращаться другие программы вызов функции либо причине завершиться неудачно нужно сообщать ошибках целью просто устанавливаете код последней ошибки потоке возвраща ете значение fals invalidhandlevalu null другое подхо дящее вашем случае установить код последней ошибки потоке вызы ваете setlasterror void setlasterrordword dwerrcod передаете нужное 32битное число стараюсь использовать коды опреде ленные winerrorh   условии подходят те ошибки которых могут сообщать мои функции считаете кодов winerrorh го дится ошибки возможной вашей функции определите свой код представ ляет собой 32битное значение которое разбито поля показанные следующей таблице биты 31 30 29 28 27 16 15 0 содержимое код степени кем определен зарезерви код код  тяжести    microsoft рован подсистемы исключения sever facil пользователем code значение 0 успех 0 microsoft должен определяется определяет 1 информация 1 пользователь 0 microsoft ся microsoft 2 предупреждение пользо 3 ошибка вателем подробнее этих полях рассказываю главе 24 данный момент единствен ное важное поле   бит 29 microsoft обещает коды ошибок генери руемые функциями будут содержать 0 бите определяете собствен ный код ошибки запишите сюда 1 гарантия ваш код ошибки войдет конфликт кодом определенным microsoft   будущем 6 г л 1 обработка ошибок программапример errorshow эта программа  01 errorshowexe  см листинг рис 12 демонстрирует полу чить текстовое описание ошибки коду файлы исходного кода ресурсов граммы находятся каталоге 01errorshow компактдиске прилагаемом книге программа errorshow основном предназначена увидели работают окно watch отладчика утилита error lookup запуска errorshow крывается следующее окно поле error ввести любой код ошибки щелкнете кнопку look up внизу прокручиваемом окне появится текст описанием данной ошибки единствен ная интересная особенность программы заключается обращается функции formatmessag использую функцию получаем код ошибки dword dwerror getdlgiteminthwnd idcerrorcod null fals hlocal hlocal null буфер строки описанием ошибки получаем текстовое описание ошибки bool fok formatmessag formatmessagefromsystem formatmessageallocatebuff null dwerror makelangidlangenglish sublangenglishus lptstr hlocal 0 null m if hlocal null setdlgitemtexthwnd idcerrortext pctstr locallockhloc localfreehloc els setdlgitemtexthwnd idcerrortext texterror number not found первая строка считывает код ошибки текстового поля далее создаю экземп ляр описателя handl блока памяти инициализирую значением null функ ция formatmessag сама выделяет нужный блок памяти возвращает нам описа тель вызывая formatmessag передаю флаг formatmessagefromsystem сообщает функции нужна строка соответствующая коду ошибки определен ному системе кроме передаю флаг formatmessageallocatebuff функция выделила соответствующий блок памяти хранения текста описа тель блока возвращен переменной hlocal третий параметр указывает код интересующей ошибки четвертый   язык котором хотим увидеть описание выполнение formatmessag заканчивается успешно описание ошибки поме щается блок памяти копирую прокручиваемое окно расположенное нижней части окна программы вызов formatmessag оказывается неудачным 7 часть i материалы обязательного чтения пытаюсь найти код сообщения модуле netmsgdll выяснить связана ошибка сетью используя описатель netmsgdll вновь вызываю formatmessag дело каждого dll exeмодуля собственный набор кодов оши бок который включается модуль помощью messag compil mcex это позволяет делать утилита error lookup свое диалоговое окно modul errorshowcpp модуль errorshowcpp автор copyright c 2000 джеффри рихтер jeffrey richter includ cmnhdrh см приложение a includ windowsxh includ tcharh includ resourceh defin esmpokecodeandlookup wmuser 100 const tchar gszappnam texterror show bool dlgoninitdialoghwnd hwnd hwnd hwndfocus lparam lparam chsetdlgiconshwnd idierrorshow принимаем коды ошибок состоящие 5 цифр editlimittextgetdlgitemhwnd idcerrorcod 5 проверяем передан код ошибки командную строку sendmessagehwnd esmpokecodeandlookup lparam 0 returntru void dlgoncommandhwnd hwnd int id hwnd hwndctl uint codenotifi switch id case idcancel enddialoghwnd id break case idcalwaysontop setwindowposhwnd isdlgbuttoncheckedhwnd idcalwaysontop hwndtopmost hwndnotopmost 0 0 0 0 swpnomov swpnosiz break рис 12 программапример errorshow 8 г л 1 обработка ошибок рис 12 продолжение case idcerrorcod enablewindowgetdlgitemhwnd idok editgettextlengthhwndctl 0 break case idok получаем код ошибки dword dwerror getdlgiteminthwnd idcerrorcod null fals hlocal hlocal null буфер строки описанием ошибки получаем текстовое описание ошибки bool fok formatmessag formatmessagefromsystem formatmessageallocatebuff null dwerror makelangidlangenglish sublangenglishus ptstr hlocal 0 null if fok связана ошибка сетью hmodul hdll loadlibraryextextnetmsgdl null dontresolvedllrefer if hdll null formatmessag formatmessagefromhmodul formatmessagefromsystem formatmessageallocatebuff hdll dwerror makelangidlangenglish sublangenglishus ptstr hlocal 0 null freelibraryhdl if hlocal null setdlgitemtexthwnd idcerrortext pctstr locallockhloc localfreehloc els setdlgitemtexthwnd idcerrortext texterror number not found break intptr winapi dlgprochwnd hwnd uint umsg wparam wparam lparam lparam switch umsg chhandledlgmsghwnd wminitdialog dlgoninitdialog chhandledlgmsghwnd wmcommand dlgoncommand case esmpokecodeandlookup setdlgiteminthwnd idcerrorcod uint wparam fals forwardwmcommandhwnd idok getdlgitemhwnd idok bnclick см след стр 9 часть i материалы обязательного чтения рис 12 продолжение postmessag setforegroundwindowhwnd break returnfals int winapi twinmainhinst hinstex hinstanc ptstr pszcmdline int hwnd hwnd findwindowtext32770 texterror show if iswindowhwnd экземпляр выполняется активизируем посылаем новый номер sendmessagehwnd esmpokecodeandlookup ttoipszcmdlin 0 els dialogboxparamhinstex makeintresourceidderrorshow null dlgproc ttoipszcmdlin return0 конец файла 10 г л 2 unicod microsoft window становится популярнее нам разработчикам ориентироваться международные рынки раньше считалось нормальным ло кализованные версии программных продуктов выходят спустя полгода явления сша расширение поддержки операционной системе множества са мых разных языков упрощает выпуск программ рассчитанных международные рынки самым сокращает задержки началом дистрибуции window средства помогающие разработчикам локализовать свои приложения программа получает специфичную конкретной страны информацию региональные стандарты вызывая различные функции window узнает предпоч тения пользователя анализируя параметры заданные control panel кроме window поддерживает массу всевозможных шрифтов решил переместить главу начало книги вопрос поддержке unicod стал одним основных разработке любого приложения проблемы связанные unicod обсуждаются каждой главе программыпримеры моей книге  готовы unicode  пишет программы microsoft window 2000 microsoft window ce просто обязан использовать unicod точка разрабатываете приложения microsoft window 98 выбор главе поговорим применении unicod window 98 наборы символов настоящей проблемой локализации операции различными набо рами символов годами кодируя текстовые строки последовательности однобай товых символов нулем конце большинство программистов этому привыкло это стало второй натурой вызываемая нами функция strlen возвра щает количество символов заканчивающемся нулем массиве однобайтовых симво лов существуют такие языки системы письменности классический пример   японские иероглифы которых столько знаков одного байта позволяющего кодировать 256 символов просто недостаточно поддержки подобных языков созданы двухбайтовые наборы символов doublebyt charact set dbcs одно двухбайтовые наборы символов двухбайтовом наборе символ представляется либо одним либо двумя байтами японской каны значение первого байта находится 0x81 0x9f 0xe0 0xfc проверить значение следующего байта строке оп ределить полный символ работа двухбайтовыми наборами символов   просто кош мар программиста часть состоит одного байта часть   двух 11 часть i материалы обязательного чтения простой вызов функции strlen дает количества символов строке   воз вращает число байтов ansiбиблиотеке c функций работающих двух байтовыми наборами символов аналогичную библиотеку visual c включено множество функций типа mbslen способных оперировать строками мультибай товых одно двухбайтовых символов работы dbcsстроками window предусмотрен целый набор вспомогатель ных функций функция описание ptstr charnext pctstr pszcurrentchar возвращает адрес следующего символа строке ptstr charprev pctstr pszstart возвращает адрес предыдущего символа pctstr pszcurrentchar строке bool isdbcsleadbyt byte btestchar возвращает true данный байт   первый dbcsсимволе функции charnext charprev позволяют  перемещаться  двухбайтовой строке единовременно 1 символ вперед назад isdbcsleadbyt возвращает true переданный байт   первый двухбайтовом символе хотя функции несколько облегчают работу dbcsстроками необходимость ином подходе очевидна перейдем unicod unicod набор  широких  символов unicod   стандарт первоначально разработанный appl xerox 1988 г 1991 г создан консорциум совершенствования внедрения unicod вошли компании appl compaq hewlettpackard ibm microsoft oracl silicon graphic sybas unisi xerox полный список компаний   членов консорциума см wwwunicodeorg эта группа компаний наблюдает соблюдением стандарта uni code описание которого найдете книге the unicod standard издательства addisonwesley электронный вариант получить wwwuni codeorg строки unicod просты логичны символы представлены 16битны ми значениями 2 байта каждый особых байтов указывающих является следующий байт   частью символа новым символом это зна чит прохождение строке реализуется простым увеличением уменьшением значения указателя функции charnext charprev isdbcsleadbyt нужны каждый символ   16битное число unicod позволяет кодировать 65 536 символов достаточно работы любым языком разительное отли чие 256 знаков доступных однобайтовом наборе настоящее время кодовые позиции1 определены арабского китайского гре ческого еврейского латинского английского алфавитов также кириллицы русского японской каны корейского хангыль некоторых других алфавитов кро ме набор символов включено большое количество знаков препинания мате матических технических символов стрелок диакритических других знаков вместе занимают около 35 000 кодовых позиций оставляя простор будущих расширений 65 536 символов разбиты отдельные группы некоторые группы также включенные символы показаны таблице 1 кодовая позиция code point   позиция знака наборе символов 12 глава 2 unicod 16битный код символы 16битный код символы 0000 007f ascii 0300 036f общие диакритические 0080 00ff символы latin1 0400 04ff кириллица 0100 017f европейские латинские 0530 058f армянский 0180 01ff расширенные латинские 0590 05ff еврейский 0250 02af стандартные фонетические 0600 06ff арабский 02b0 02ff модифицированные литеры 0900 097f деванагари около 29 000 кодовых позиций пока заняты зарезервированы будущее примерно 6 000 позиций оставлено специально программистов усмот рение почему unicod разрабатывая приложение определенно должны использовать преимущества uni code пока собираетесь локализовать программный продукт разра ботка прицелом unicod упростит задачу будущем unicod также позволяет 쐽 легко обмениваться данными разных языках 쐽 распространять единственный двоичный exe dllфайл поддерживаю щий языки 쐽 увеличить эффективность приложений поговорим позже window 2000 unicod window 2000   операционная система целиком полностью построенная uni code базовые функции создания окон вывода текста операций строками т д ожидают передачи unicodeстрок функции window передается ansiстрока сначала преобразуется unicod лишь передается опера ционной системе ждете результата функции виде ansiстроки операци онная система преобразует строку   возвратом приложение   unicod ansi преобразования протекают скрытно тратят ся лишнее время лишняя память например функция createwindowex вызываемая ansiстроками имени клас са заголовка окна должна выделив дополнительные блоки памяти стандартной куче вашего процесса преобразовать строки unicod сохранив результат выделенных блоках памяти вызвать unicodeверсию createwindowex функций заполняющих строками выделенные буферы системе   прежде программа сможет обрабатывать   нужно преобразовать строки unicod ansi ваше приложение потребует памяти работать медленнее поэтому гораздо эффективнее разрабатывать программу самого начала ориенти руясь unicod window 98 unicod window 98   новая операционная система  16разрядное наслед ство  которое рассчитано unicod введение поддержки unicod win dow 98 слишком трудоемкой задачей разработке операцион ной системы отказались причине вся внутренняя обработка строк window 98 предшественниц построена применении ansi 13 часть i материалы обязательного чтения window 98 допускает работу приложениями обрабатывающими сим волы строки unicod хотя вызов функций window заметно усложняет ся например обращаясь createwindowex передаете ansiстроки вызов проходит очень быстро   требуется выделения буферов преобразования строк вызова createwindowex unicodeстроками придется самому выде лять буферы явно вызывать функции преобразующие строки unicod ansi ращаться createwindowex снова вызывать функции преобразующие строки   ansi unicod освобождать временные буферы window 98 работать unicod столь удобно window 2000 подробнее преобразова ниях строк window 98 расскажу конце главы хотя большинство unicodeфункций window 98 делает некоторые реализованы 쐽 enumresourcelanguagesw 쐽 gettextextentpoint32w 쐽 enumresourcenamesw 쐽 gettextextentpointw 쐽 enumresourcetypesw 쐽 lstrlenw 쐽 exttextoutw 쐽 messageboxexw 쐽 findresourcew 쐽 messageboxw 쐽 findresourceexw 쐽 textoutw 쐽 getcharwidthw 쐽 widechartomultibyt 쐽 getcommandlinew 쐽 multibytetowidechar сожалению многие этих функций window 98 работают рук вон плохо одни поддерживают определенные шрифты другие повреждают область динами чески распределяемой памяти кучу третьи нарушают работу принтерных драйве ров т д этими функциями придется здорово потрудиться отладке граммы это значит сможете устранить проблемы window ce unicod операционная система window ce создана небольших вычислительных уст ройств   бездисковых малым объемом памяти вполне могли подумать microsoft систему нужно сделать предельно компактной качестве  родного  набора символов выберет ansi microsoft поступила дальновиднее зная вычислительные устройства window ce будут продаваться всему миру решили сократить затраты разработку программ упростив локализацию этому window ce полностью поддерживает unicod увеличивать ядро window ce microsoft вообще отказалась поддерж ки ansiфункций window пишете window ce просто обя заны разбираться unicod использовать частях своей программы чью пользу счет тех ведет счет борьбе unicod против ansi решил сделать краткий обзор  история unicod microsoft  쐽 window 2000 поддерживает unicod ansi   можете использовать лю бой стандарт 쐽 window 98 поддерживает ansi   обязаны программировать рас чете ansi 14 глава 2 unicod 쐽 window ce поддерживает unicod   обязаны программировать расчете unicod несмотря microsoft пытается облегчить написание программ способ ных работать трех платформах различия unicod ansi равно создают проблемы ними сталкивался поймите неправиль microsoft твердо поддерживает unicod поэтому настоятельно рекомендую переходить именно стандарт имейте виду ждут трудности преодоление которых потребуется время посоветовал применять unicod работаете window 98 преобразовывать строки ansi лишь обойтись увы одна маленькая проблема которой должны знать   com unicod com microsoft переносила com 16разрядной window платформу win32 ру ководство компании решило методы comинтерфейсов работающие строками должны принимать unicod это удачное решение com обычно используется компоненты могли общаться друг дру гом unicod позволяет легко локализовать строки разрабатываете программу window 2000 window ce используете com выбора просто применяя unicod частях граммы гораздо проще обращаться операционной системе com объектам пишете window 98 используете com попадаете затруд нительное положение com требует строк unicod большинство функций опера ционной системы   строк ansi это просто кошмар работал несколькими такими проектами приходилось писать прорву кода гонять строки одного формата писать программу использованием unicod microsoft разработала window api меньше влиять ваш код самом деле появилась возможность создать единственный файл исходным кодом компилируемый применением unicod   достаточно определить макроса unicod unicod которые отвечают нужные изме нения unicod библиотека c использования unicodeстрок введены некоторые новые типы данных стан дартный заголовочный файл stringh модифицирован нем определен wchart   тип данных unicodeсимвола typedef unsign short wchart хотите скажем создать буфер хранения unicodeстроки длиной 99 символов нулевым символом конце поставьте оператор wchart szbuffer100 создает массив ста 16битных значений стандартные функции библиотеки c работы строками вроде strcpi strchr strcat оперируют ansiстроками   способны корректно обрабатывать unicodeстроки поэто 15 часть i материалы обязательного чтения му ansi c имеется дополнительный набор функций рис 21 приведен список строковых функций ansi c эквивалентных unicodeфункций char strcatchar const char wchart wcscatwchart const wchart char strchrconst char int wchart wcschrconst wchart wchart int strcmpconst char const char int wcscmpconst wchart const wchart char strcpychar const char wchart wcscpywchart const wchart sizet strlenconst char sizet wcslenconst wchart рис 21 строковые функции ansi c unicodeаналоги обратите внимание имена новых функций начинаются wcs   это абб ревиатура wide charact set набор широких символов таким образом имена uni codeфункций образуются простой заменой префикса str соответствующих ansiфун кций wcs очень важный момент котором многие забывают заключается библиотека c предоставляемая microsoft отвечает стандарту ansi требует библиотека c поддерживала символы строки unicod это значит можете вызывать функции c работы unicodeсимволами строками работе window 98 иными словами функции wcscat wcslen wcstok т д прекрасно работают window 98 беспокоиться нужно функции операционной системы код содержащий явные вызовы str wcsфункций просто компилировать использованием ansi unicod реализовать возможность компи ляции  двойного назначения  замените своей программе заголовочный файл stringh tcharh помогает создавать универсальный исходный код способный задей ствовать ansi unicod   это единственное нужен файл tcharh состоит макросов заменяющих явные вызовы str wcsфункций компиляции исходного кода определяете unicod макросы ссылаются wcs функции отсутствие   strфункции например tcharh макрос tcscpi включили заголовочный файл unicod определен tcscpi раскрывается ansiфункцию strcpi unicod определен   unicodeфункцию wcscpi файле tcharh определены уни версальные макросы стандартных строковых функций c использова нии этих макросов вместо конкретных имен ansi unicodeфункций ваш код компилировать расчете unicod ansi сожалению это файле tcharh дополнительные макросы объявить символьный массив  универсального назначения  ansiunicod применяется тип данных tchar unicod определен tchar объявляется typedef wchart tchar unicod определен 16 глава 2 unicod typedef char tchar используя тип данных объявить строку символов tchar szstring100 также определять указатели строки tchar szerror error правда операторе одна проблема умолчанию компилятор microsoft c транслирует строки состоящие символов ansi unicod итоге оператор нормально компилируется unicod определен ином случае дает ошибку компилятор сгенерировал unicod ansiстроку оператор переписать tchar szerror lerror заглавная буква l строковым литералом указывает компилятору обрабатывать unicodeстроку размещая строку области данных програм компилятор вставит всеми символами нулевые байты возникает другая проблема   программа компилируется unicod определен следова тельно нужен макрос способный избирательно ставить l строковым литера лом работу выполняет макрос text также содержащийся tcharh uni code определен text определяется defin textx l x ином случае text определяется следующим образом defin textx x используя макрос перепишем злополучный оператор корректно компилировать независимо определен unicod tchar szerror texterror макрос text применяется символьных литералов например верить является первый символ строки заглавной буквой j if szerror0 textj первый символ j m els первый символ   j m типы данных определенные window unicod заголовочных файлах window определены следующие типы данных тип данных описание wchar unicodeсимвол pwstr указатель unicodeстроку pcwstr указатель строковую константу unicod типы данных относятся исключительно символам строкам кодировке unicod заголовочных файлах window определены также универсальные ansi 17 часть i материалы обязательного чтения unicod типы данных ptstr pctstr указывающие   зависимости опре делен компиляции макрос unicod   ansi unicodeстроку кстати имя макроса unicod предваряется знаком подчеркива ния дело макрос unicod используется заголовочных файлах библио теки c макрос unicod   заголовочных файлах window компиляции мо дулей исходного кода обычно приходится определять оба макроса unicod ansiфункции window существует две функции createwindowex одна принимает строки unicod другая   ansi действительности прототипы этих функций отличаются hwnd winapi createwindowexw dword dwexstyl pcwstr pclassnam pcwstr pwindownam dword dwstyle int x int y int nwidth int nheight hwnd hwndparent hmenu hmenu hinstanc hinstanc pvoid pparam hwnd winapi createwindowexa dword dwexstyl pcstr pclassnam pcstr pwindownam dword dwstyle int x int y int nwidth int nheight hwnd hwndparent hmenu hmenu hinstanc hinstanc pvoid pparam createwindowexw   это unicodeверсия буква w конце имени функции   абб ревиатура слова wide широкий символы unicod занимают 16 битов каждый поэтому называют широкими символами wide charact буква a конце имени createwindowexa указывает данная версия функции принимает ansiстроки обычно createwindowexw createwindowexa напрямую вызывают ращаются createwindowex   макросу определенному файле winuserh ifdef unicod defin createwindowex createwindowexw els defin createwindowex createwindowexa endif unicod 18 глава 2 unicod именно версия createwindowex вызвана зависит определен unicod период компиляции перенося 16разрядное windowsприложение платформу win32 вероятно станете определять unicod вызовы createwindowex будут преобразованы вызовы createwindowexa   ansiверсии фун кции перенос приложения упростится 16разрядная window работает толь ко ansiверсией createwindowex window 2000 функция createwindowexa   просто шлюз транслятор который выделяет память преобразования строк ansi unicod вызывает creat windowexw передавая преобразованные строки createwindowexw вернет управление createwindowexa освободит буферы передаст описатель окна разрабатывая dll которую будут использовать другие программисты предус матривайте две версии каждой функции   ansi unicod ansi версии просто выделяйте память преобразуйте строки вызывайте unicodeверсию той функции процесс продемонстрирую позже window 98 основную работу выполняет createwindowexa операцион ной системе предусмотрены точки входа функций window принимающих unicodeстроки функции транслируют ansi просто сообщают ошиб ке последующий вызов getlasterror дает errorcallnotimpl должным образом действуют ansiверсии функций ваше приложение работать window 98 скомпилированном коде присутствуют вызовы  широкосимволь ных  функций некоторые функции window api например winexec openfil существуют совместимости 16разрядными программами избегать заменить вызовы winexec openfil вызовами createprocess createfil соответ ственно старые функции просто обращаются новым самая серьез ная проблема ними принимают строки unicod   вызо ве должны передавать строки ansi стороны window 2000 новых пока устаревших функций обязательно ansi unicod версия строковые функции window window предлагает внушительный набор функций работающих строками похожи строковые функции библиотеки c например strcpi wcscpi однако функции window являются частью операционной системы многие компонен используют именно аналоги библиотеки c советую отдать предпоч тение функциям операционной системы это немного повысит быстродействие ва шего приложения дело часто обращаются такие тяжеловесные цессы оболочка операционной системы explorerex скорее функ ции будут загружены память запуска вашего приложения данные функции доступны window 2000 window 98 сможете вызы вать ранних версиях window установите internet explor версии 40 выше классической схеме именования функций операционных системах име состоят символов нижнего верхнего регистра выглядят strcat strchr strcmp strcpi т д использования этих функций включите программу заголо вочный файл shlwapih кроме каждая строковая функция существует двух версиях   ansi unicod например strcata strcatw поскольку это функции операционной системы имена автоматически преобра зуются нужную форму исходном тексте вашей программы сборкой определен unicod 19 часть i материалы обязательного чтения создание программ способных использовать ansi unicod неплохая мысль   заранее подготовить свое приложение unicod пока планируете работать кодировкой главное нужно 쐽 привыкайте тому текстовые строки   это массивы символов мас сивы байтов значений типа char 쐽 используйте универсальные типы данных вроде tchar ptstr тек стовых символов строк 쐽 используйте явные типы данных вроде byte pbyte байтов указате лей байты буферов данных 쐽 применяйте макрос text определения символьных строковых литералов 쐽 предусмотрите возможность глобальных замен например pstr ptstr 쐽 модифицируйте логику строковой арифметики например функции обычно принимают размер буфера символах байтах это значит вместо sizeofszbuff должны передавать sizeofszbuff sizeoftchar блок памяти строки известной длины выделяется байтах симво лах т е вместо mallocncharact нужно использовать mallocncharact sizeoftchar перечислил это запомнить труднее   ошибетесь компилятор выдаст никаких предупреждений разрабатывая программыпримеры первого издания книги сначала написал компилировались использованием ansi дойдя главы конце понял unicod решил написать приме ры которые показывали легко создавать программы компилируемые менением unicod ansi конце концов преобразовал программыприме ры компилировать расчете любой этих стандартов конверсия программ заняла примерно 4 часа   неплохо особенно учесть опыта деле window набор функций работы unicodeстроками функции перечислены ниже функция описание lstrcat выполняет конкатенацию строк lstrcmp сравнивает две строки учетом регистра букв lstrcmpi сравнивает две строки учета регистра букв lstrcpi копирует строку участок памяти lstrlen возвращает длину строки символах реализованы макросы вызывающие либо unicod либо ansiверсию функции зависимости определен unicod компиляции исходного модуля например unicod определен lstrcat раскрывается lstrcata опре делен   lstrcatw строковые функции lstrcmp lstrcmpi ведут аналоги библио теки c strcmp strcmpi wcscmp wcscmpi которые просто сравнивают кодовые зиции символах строк игнорируя фактические символы сравнивают числовое значение каждого символа первой строки числовым значением символа второй 20 глава 2 unicod строки lstrcmp lstrcmpi реализованы вызовы windowsфункции compar string int comparestr lcid lcid dword fdwstyle pcwstr pstring1 int cch1 pcwstr pstring2 int cch2 сравнивает две unicodeстроки первый параметр задает называемый идентификатор локализации local id lcid   32битное значение определяющее конкретный язык помощью идентификатора comparestr сравнивает стро ки учетом значения конкретных символов данном языке действует осмысленнее функции библиотеки c любая функций семейства lstrcmp вызывает comparestr первом па раметре передается результат вызова windowsфункции getthreadlocal lcid getthreadlocal возвращает упомянутый идентификатор который назначается потоку мо мент создания второй параметр функции comparestr указывает флаги модифицирующие ме тод сравнения строк допустимые флаги перечислены следующей таблице флаг действие normignorecas различия регистре букв игнорируются normignorekanatyp различия знаками хираганы катаканы игнорируются normignorenonspac знаки отличные пробелов игнорируются normignoresymbol символы отличные алфавитноцифровых игнорируются normignorewidth разница одно двухбайтовым представлением одного символа игнорируется sortstringsort знаки препинания обрабатываются символы личные алфавитноцифровых вызывая comparestr функция lstrcmp передает параметре fdwstyle нуль lstrcmpi   флаг normignorecas остальные четыре параметра определяют две строки длину cch1 равен  1 функция считает строка pstring1 заверша ется нулевым символом автоматически вычисляет длину относится параметрам cch2 pstring2 многие функции cбиблиотеки unicodeстроками толком работают tolow toupper неправильно преобразуют регистр букв знаками ударения этому unicodeстрок использовать соответствующие windowsфункции тому корректно работают ansiстроками первые две функции ptstr charlowerptstr pszstring ptstr charupperptstr pszstring преобразуют либо отдельный символ либо целую строку нулевым символом кон це преобразовать строку просто передайте адрес преобразуя дельный символ должны передать 21 часть i материалы обязательного чтения tchar clowercasechr charlowerptstr szstring0 приведение типа отдельного символа ptstr вызывает обнуление старших 16 битов передаваемого значения младшие 16 битов помещается символ обнаружив старшие 16 битов значения равны 0 функция  поймет  хотите преобразовать строку отдельный символ возвращаемое 32битное зна чение содержит результат преобразования младших 16 битах следующие две функции аналогичны двум предыдущим исключением преобразуют символы содержащиеся буфере который требуется завершать нулевым символом dword charlowerbuff ptstr pszstring dword cchstring dword charupperbuff ptstr pszstring dword cchstring прочие функции библиотеки c например isalpha islow isupp возвращают значение которое сообщает является данный символ буквой также строчная прописная window api подобные функции учитывают язык выбранный пользователем control panel bool ischaralphatchar ch bool ischaralphanumerictchar ch bool ischarlowertchar ch bool ischaruppertchar ch последняя группа функций библиотеки c которых хотел рассказать   printf компиляции unicod определен ожидают передачи сим вольных строковых параметров unicod ином случае   ansi microsoft ввела семейство функций printf своей cбиблиотеки дополнительные типы полей часть которых поддерживается ansi c позволяют легко срав нивать смешивать символы строки разной кодировкой также расширена функ ция wsprintf операционной системы несколько примеров обратите внимание использование буквы s верхнем нижнем регистре char sza100 строковый буфер ansi wchar szw100 строковый буфер unicod обычный вызов sprintf строки ansi sprintfsza s ansi str преобразуем строку unicod ansi sprintfsza s lunicod str обычный вызов swprintf строки unicod swprintfszw ls lunicod str преобразуем строку ansi unicod swprintfszw ls ansi str 22 глава 2 unicod ресурсы компилятор ресурсов генерирует двоичное представление ресурсов используе мых вашей программой строки ресурсах таблицы строк шаблоны диалоговых окон меню др записываются unicod программе определяется макрос unicod window 98 window 2000 сами проводят нужные преобразова ния например компиляции исходного модуля unicod определен зов loadstr самом деле приводит вызову loadstringa которая читает строку ресурсов преобразует ansi затем вашей программе возвращается ansiпред ставление строки текстовые файлы текстовых файлов кодировке unicod пока очень мало одном текстовом фай ле поставляемом операционными системами другими программными продук тами microsoft используется unicod думаю однако эта тенденция изменит ся будущем   пусть отдаленном например программа notepad window 2000 позволяет создавать открывать unicod ansiфайлы посмотрите диалоговое окно save as рис 22 обратите внимание предлагаемые форма текстовых файлов рис 22 диалоговое окно save as программы notepad window 2000 многим приложениям которые открывают обрабатывают текстовые файлы пример компиляторам удобнее открытия файла определить содержит символы ansi unicod помочь функция istextunicod dword istextunicodeconst pvoid pvbuffer int cb pint presult проблема текстовыми файлами существует четких строгих пра вил относительно содержимого это крайне затрудняет определение содер жит файл символы ansi unicod поэтому istextunicod применяет набор ста тистических детерминистских методов сделать взвешенное пред положение содержимом буфера поскольку алхимии точной науки гарантий получите неверные результаты istextunicod первый параметр pvbuffer указывает буфер подлежащий проверке используется указатель типа void поскольку неизвестно кодировке данный массив символов 23 часть i материалы обязательного чтения параметр cb определяет число байтов буфере который указывает pvbuffer содержимое буфера известно cb   счетчик именно байтов символов заметьте вовсе обязательно задавать длину буфера байтов проанализирует функция шансов получить правильный результат параметр presult   это адрес целочисленной переменной которую иници ализировать вызовом функции значение сообщает какие тесты должна вести istextunicod presult равен null функция istextunicod делает провер ки подробнее см документацию platform sdk функция возвращает true считает буфер содержит текст unicod fals   ином случае возвращает именно булево значение хотя прото типе указано dword целочисленную переменную которую указывает presult запрошены лишь определенные тесты функция возвратом управ ления устанавливает биты соответствии результатами этих тестов window 98 функция istextunicod сути реализована просто возвра щает fals последующий вызов getlasterror дает код ошибки errorcal notimpl применение функции istextunicod иллюстрирует программапример filerev см главу 17 перекодировка строк unicod ansi обратно windowsфункция multibytetowidechar преобразует мультибайтовые символы строки  широкобайтовые  int multibytetowidechar uint ucodepag dword dwflag pcstr pmultibytestr int cchmultibyt pwstr pwidecharstr int cchwidechar параметр ucodepag задает номер кодовой страницы связанной мультибайто вой строкой параметр dwflag влияет преобразование букв диакритическими знаками обычно флаги используются dwflag равен 0 параметр pmultibytestr указывает преобразуемую строку cchmultibyt определяет длину байтах фун кция самостоятельно определяет длину строки cchmultibyt равен  1 unicodeверсия строки полученная результате преобразования записывается буфер адресу указанному pwidecharstr максимальный размер буфера символах задается параметре cchwidechar равен 0 функция преобразует просто возвращает размер буфера необходимого сохранения ре зультата преобразования обычно конверсия мультибайтовой строки unicod эквивалент проходит 1 вызывают multibytetowidechar передавая null параметре pwidecharstr 0 параметре cchwidechar 2 выделяют блок памяти достаточный сохранения преобразованной стро ки размер получают предыдущего вызова multibytetowidechar 24 глава 2 unicod 3 снова вызывают multibytetowidechar передавая адрес выделенно го буфера параметре pwidecharstr размер буфера полученный пер вом обращении функции   параметре cchwidechar 4 работают полученной строкой 5 освобождают блок памяти занятый unicodeстрокой обратное преобразование выполняет функция widechartomultibyt int widechartomultibyt uint ucodepag dword dwflag pcwstr pwidecharstr int cchwidechar pstr pmultibytestr int cchmultibyt pcstr pdefaultchar pbool pfuseddefaultchar очень похожа multibytetowidechar ucodepag определяет кодовую страницу строки   результата преобразования дополнительный контроль процессом преобразования дает параметр dwflag флаги влияют символы диакритическими знаками символы которые система преобразовать уровень контроля обычно нужен dwflag приравнивается 0 параметр pwidecharstr указывает адрес преобразуемой строки cchwidechar дает длину символах функция сама определяет длину исходной строки cchwidechar равен  1 мультибайтовый вариант строки полученный результате преобразования запи сывается буфер который указывает pmultibytestr параметр cchmultibyt опреде ляет максимальный размер буфера байтах передав нулевое значение cchmulti byte заставите функцию сообщить размер буфера требуемого записи резуль тата обычно конверсия широкобайтовой строки мультибайтовую проходит той последовательности обратном преобразовании очевидно заметили widechartomultibyt принимает параметра боль ше multibytetowidechar это pdefaultchar pfuseddefaultchar функция widechar tomultibyt использует встречает широкий символ представленный кодовой странице которую ссылается ucodepag преобразование возможно функция берет символ который указывает pdefaultchar па раметр равен null обычно бывает функция использует системный символ умолчанию таким символом обычно служит знак вопроса операциях именами файлов очень опасно поскольку является символом подстановки параметр pfuseddefaultchar указывает переменную типа bool которую функ ция устанавливает true символ широкосимвольной строки преобразован свой мультибайтовый эквивалент символы преобразова ны успешно функция устанавливает переменную fals обычно передаете null параметре подробнее функции применение описаны документации platform sdk две функции позволяют легко создавать ansi unicodeверсии других фун кций работающих строками например dll содержащая функцию которая переставляет символы строки обратном порядке unicodeверсию функции написать следующим образом 25 часть i материалы обязательного чтения bool stringreversewpwstr pwidecharstr получаем указатель последний символ строке pwstr pendofstr pwidecharstr wcslenpwidecharstr 1 wchart cchart повторяем пока дойдем середины строки while pwidecharstr pendofstr записываем символ временную переменную cchart pwidecharstr помещаем последний символ место первого pwidecharstr pendofstr копируем символ временной переменной место последнего символа pendofstr cchart продвигаемся 1 символ вправо pwidecharstr продвигаемся 1 символ влево pendofstr строка обращена сообщаем успешном завершении returntru ansiверсию функции написать вообще ничем нималась просто преобразовывала ansiстроку unicod передавала функцию stringreversew конвертировала обращенную строку снова ansi функция должна выглядеть примерно bool stringreverseapstr pmultibytestr pwstr pwidecharstr int nlenofwidecharstr bool fok fals вычисляем количество символов необходимых хранения широкосимвольной версии строки nlenofwidecharstr multibytetowidecharcpacp 0 pmultibytestr 1 null 0 выделяем память стандартной кучи процесса достаточную хранения широкосимвольной строки забудьте multibytetowidechar возвращает количество символов байтов поэтому должны умножить это число размер широкого символа pwidecharstr heapallocgetprocessheap 0 nlenofwidecharstr sizeofwchar if pwidecharstr null returnfok 26 глава 2 unicod преобразуем мультибайтовую строку широкосимвольную multibytetowidecharcpacp 0 pmultibytestr 1 pwidecharstr nlenofwidecharstr вызываем широкосимвольную версию функции выполнения настоящей работы fok stringreversewpwidecharstr if fok преобразуем широкосимвольную строку обратно мультибайтовую widechartomultibytecpacp 0 pwidecharstr 1 pmultibytestr strlenpmultibytestr null null освобождаем память выделенную широкобайтовую строку heapfreegetprocessheap 0 pwidecharstr returnfok заголовочном файле поставляемом вместе dll прототипы этих функций такими bool stringreversew pwstr pwidecharstr bool stringreversea pstr pmultibytestr ifdef unicod defin stringrevers stringreversew els defin stringrevers stringreversea endif unicod 27 г л 3 объекты ядра изучение window api начнем объектов ядра описателей handl эта глава посвящена сравнительно абстрактным концепциям т е углубляясь спе цифику тех иных объектов ядра рассмотрим общие свойства предпочел начать конкретного четкого понимания объектов ядра стать настоящим профессионалом области разработки win dowsпрограмм объекты используются системой нашими приложениями управления множеством самых разных ресурсов процессами потоками файлами т д концепции представленные будут встречаться протяжении всей книги однако прекрасно понимаю часть материалов уляжется голове тех пор пока приступите работе объектами ядра используя реальные функции чтении последующих глав книги наверное будете время времени воз вращаться главе такое объект ядра создание открытие прочие операции объектами ядра станут разра ботчика windowsприложений повседневной рутиной система позволяет создавать оперировать несколькими типами таких объектов числе маркерами досту па access token object файлами file object проекциями файлов filemap object портами завершения вводавывода io complet port object заданиями job object почтовыми ящиками mailslot object мьютексами mutex object ка налами pipe object процессами process object семафорами semaphor object потоками thread object ожидаемыми таймерами waitabl timer object объек создаются windowsфункциями например createfilemap заставляет систему сформировать объект  проекция файла  каждый объект ядра   самом деле сто блок памяти выделенный ядром доступный блок представляет собой структуру данных элементах которой содержится информация объекте некоторые элементы дескриптор защиты счетчик числа пользователей др сутствуют объектах бо льшая часть специфична объектов конкрет ного типа например объекта  процесс  идентификатор базовый приоритет код завершения объекта  файл    смещение байтах режим разделения режим открытия поскольку структуры объектов ядра доступны ядру приложение самостоятельно найти структуры памяти напрямую модифицировать держимое такое ограничение microsoft ввела намеренно одна программа нарушила целостность структур объектов ядра это ограничение позволяет microsoft вводить убирать изменять элементы структур нарушая работы ка кихлибо приложений вопрос можем напрямую модифицировать структуры наши приложения оперируют объектами ядра ответ window 28 глава 3 объекты ядра предусмотрен набор функций обрабатывающих структуры объектов ядра строго определенным правилам получаем доступ объектам ядра фун кции вызываете функцию создающую объект ядра возвращает описа тель идентифицирующий созданный объект описатель следует рассматривать  непрозрачное  значение которое использовано любым потоком ваше го процесса описатель передаете windowsфункциям сообщая системе объект ядра интересует описателях поговорим позже главе большей надежности операционной системы microsoft сделала значения описателей зависели конкретного процесса поэтому переда дите такое значение помощью какоголибо механизма межпроцессной связи току другого процесса любой вызов процесса значением описателя полу ченного вашем процессе даст ошибку волнуйтесь конце главы рассмот рим механизма корректного использования несколькими процессами одного объекта ядра учет пользователей объектов ядра объекты ядра принадлежат ядру процессу иначе говоря ваш процесс зывает функцию создающую объект ядра затем завершается объект ядра разрушен большинстве случаев объект разрушается создан ный вами объект ядра используется другим процессом ядро запретит разрушение объекта тех пор пока откажется процесс ядру известно сколько процессов использует конкретный объект ядра посколь ку каждом объекте счетчик числа пользователей счетчик   элементов данных общих типов объектов ядра момент создания объекта счетчику присваивается 1 существующему объекту ядра обращается процесс счетчик увеличивается 1 процесс завершается счетчи ки используемых объектов ядра автоматически уменьшаются 1 толь ко счетчик какоголибо объекта обнуляется ядро уничтожает объект защита объекты ядра защитить дескриптором защиты secur descriptor который описывает создал объект имеет права доступ нему дескрипторы защи обычно используют написании серверных приложений создавая клиентское приложение можете игнорировать это свойство объектов ядра window 98 дескрипторы защиты отсутствуют предназначе выполнения серверных приложений менее должны знать тонкостях связанных защитой реализовать соответствующие механизмы ваше приложение корректно работало window 2000 функции создающие объекты ядра принимают указатель структуру securityattribut аргумент например handl createfilemap handl hfile psecurityattribut psa dword flprotect dword dwmaximumsizehigh dword dwmaximumsizelow pctstr pszname 29 часть i материалы обязательного чтения большинство приложений вместо аргумента передает null создает объект защитой умолчанию такая защита подразумевает создатель объекта лю бой член группы администраторов получают нему полный доступ прочие объекту допускаются однако можете создать инициализировать структуру securityattribut затем передать адрес выглядит typedef struct securityattribut dword nlength lpvoid lpsecuritydescriptor bool binherithandl securityattribut хотя структура называется securityattribut лишь элемент имеет отношение защите   lpsecuritydescriptor ограничить доступ созданно му вами объекту ядра создайте дескриптор защиты инициализируйте структуру securityattribut следующим образом securityattribut sa sanlength sizeofsa используется выяснения версий salpsecuritydescriptor psd адрес инициализированной sd sabinherithandl fals позже handl hfilemap createfilemappinginvalidhandlevalu sa pagereadwrit 0 1024 myfilemap m рассмотрение элемента binherithandl отложу раздела наследовании элемент имеет общего защитой желая получить доступ существующему объекту ядра вместо созда вать новый укажите какие операции намерены проводить объектом напри мер захотел считывать данные существующей проекции файла выз вал функцию openfilemap таким образом handl hfilemap openfilemappingfilemapread fals myfilemap передавая filemapread первым параметром функцию openfilemap сооб щаю предоставят доступ проекции файла буду считывать данные функция openfilemap прежде вернуть действительный описатель проверяет тип защиты объекта зарегистрировавшегося пользователя допускают существующему объекту ядра  проекция файла  openfilemap возвра щает действительный описатель отказывают доступе openfilemap возвращает null вызов getlasterror дает код ошибки 5 erroraccessd nie основной массе приложений защиту используют поэтому буду задерживаться теме хотя большинстве приложений нужды беспокоиться защите многие функции window требуют передавали информацию нужном уровне защиты некоторые приложения написанные window 98 win dow 2000 толком работают реализации уделено должного внимания защите представьте запуске приложение считывает данные какого раздела реестра делать это корректно оно должно вызывать функцию regopenkeyex передавая значение keyqueryvalu которое разрешает операцию чтения указанном разделе 30 глава 3 объекты ядра однако многие приложения window 98 создавались учета специ фики window 2000 поскольку window 98 защищает свой реестр разра ботчики часто вызывали regopenkeyex значением keyallaccess проще ломать голову уровень доступа требуется самом деле проблема раздел реестра доступен чтения блокирован записи window 2000 вызов regopenkeyex зна чением keyallaccess заканчивается неудачно соответствующего кон троля ошибок приложение повести совершенно непредсказуемо разработчик немного подумал защите поменял значение keyallaccess keyqueryvalu продукт мог работать обеих операционных системах пренебрежение флагами определяющими уровень доступа   одна са мых крупных ошибок совершаемых разработчиками правильное исполь зование позволило легко перенести многие приложения window 98 window 2000 кроме объектов ядра ваша программа использовать объекты других ти пов   меню окна курсоры мыши кисти шрифты относятся объектам user gdi новичок программировании window запутаться пытаясь личить объекты user gdi объектов ядра узнать например чьим объек   user ядра   является данный значок выяснить принадлежит объект ядру проще проанализировать функцию создающую объект практически функций создающих объекты ядра параметр позволяющий указать атри буты защиты   createfilemap время функций создающих объекты user gdi параметра типа psecurityattribut пример тому   функция createicon hicon createicon hinstanc hinst int nwidth int nheight byte cplane byte cbitspixel const byte pbandbit const byte pbxorbit таблица описателей объектов ядра инициализации процесса система создает нем таблицу описателей используе мую объектов ядра сведения структуре таблицы управлении ею незадокументированы вообще воздерживаюсь рассмотрения недокументиро ванных частей операционных систем данном случае стоит сделать исключе ние   квалифицированный windowsпрограммист взгляд должен понимать устроена таблица описателей процессе поскольку информация таблице опи сателей незадокументирована ручаюсь стопроцентную достоверность тому эта таблица разному реализуется window 2000 window 98 win dow ce таким образом следующие разделы помогут понять представляет бой таблица описателей система действительно делает   воп рос оставляю открытым 31 часть i материалы обязательного чтения таблице 31 показано выглядит таблица описателей принадлежащая цессу видите это просто массив структур данных каждая структура содержит указатель объект ядра маску доступа некоторые флаги указатель блок маска доступа dword флаги dword набором индекс памяти объекта ядра набором битовых флагов битовых флагов 1 0x 0x 0x 2 0x 0x 0x         таблица 31 структура таблицы описателей принадлежащей процессу создание объекта ядра процесс инициализируется первый таблица описателей пуста стоит одному потоков вызвать функцию создающую объект ядра например createfilemap ядро выделяет объекта блок памяти инициализи рует далее ядро просматривает таблицу описателей принадлежащую данному процессу отыскивает свободную запись поскольку таблица пуста ядро обна руживает структуру индексом 1 инициализирует указатель устанавливается внутренний адрес структуры данных объекта маска доступа   доступ ограни чений определяется последний компонент   флаги флагах пого ворим позже разделе наследовании некоторые функции создающие объекты ядра список коей мере пол ноту претендует handl createthread psecurityattribut psa dword dwstacksiz pthreadstartroutin pfnstartaddr pvoid pvparam dword dwcreationflag pdword pdwthreadid handl createfil pctstr pszfilenam dword dwdesiredaccess dword dwsharemod psecurityattribut psa dword dwcreationdistribut dword dwflagsandattribut handl htemplatefil handl createfilemap handl hfile psecurityattribut psa dword flprotect dword dwmaximumsizehigh dword dwmaximumsizelow pctstr pszname handl createsemaphor psecurityattribut psa 32 глава 3 объекты ядра long linitialcount long lmaximumcount pctstr pszname функции создающие объекты ядра возвращают описатели которые привяза ны конкретному процессу могут использованы любом потоке данного процесса значение описателя представляет собой индекс таблице описателей надлежащей процессу таким образом идентифицирует место хранится инфор мация связанная объектом ядра поэтому отладке своего приложения просмотре фактического значения описателя объекта ядра видите такие малые величины 1 2 т д помните физическое содержимое описателей задоку ментировано изменено кстати window 2000 это значение опреде ляет сути индекс скорее байтовое смещение нужной записи начала таб лицы описателей всякий вызываете функцию принимающую описатель объекта ядра аргумент передаете значение возвращенное одной createфункций функция смотрит таблицу описателей принадлежащую вашему процессу считывает адрес нужного объекта ядра передаете неверный индекс описатель функция завершается ошиб кой getlasterror возвращает 6 errorinvalidhandl это связано самом деле описатели представляют собой индексы таблице значения привяза ны конкретному процессу недействительны других процессах вызов функции создающей объект ядра оказывается неудачен обычно возвращается 0 null такая ситуация возможна острой нехватке памяти наличии проблем защитой сожалению отдельные функции возвращают таких случаях 0  1 invalidhandlevalu например createfil сможет открыть указанный файл вернет именно invalidhandlevalu будь те очень осторожны проверке значения возвращаемого функцией которая здает объект ядра createmutex проверка invalidhandlevalu бессмыс ленна handl hmutex createmutex if hmutex invalidhandlevalu код выполнен ошибке createmutex возвращает null точно бессмыслен следующий код handl hfile createfil if hfile null код выполнен ошибке createfil возвращает invalidhandlevalu 1 закрытие объекта ядра независимо именно создали объект ядра окончании работы нужно закрыть вызовом closehandl bool closehandlehandl hobj эта функция сначала проверяет таблицу описателей принадлежащую вызываю щему процессу убедиться идентифицирует переданный индекс описа 33 часть i материалы обязательного чтения тель объект которому процесс действительно имеет доступ переданный индекс правилен система получает адрес структуры данных объекта уменьшает структуре счетчик числа пользователей счетчик обнулится ядро уда лит объект памяти описатель неверен происходит одно двух нормальном режиме полнения процесса closehandl возвращает fals getlasterror   код errorinva lidhandl выполнении процесса режиме отладки система просто уведом ляет отладчик ошибке самым возвратом управления closehandl удаляет соответствующую запись таблицы описателей данный описатель недействителен вашем процессе использовать запись удаляется независимо разрушен объект ядра вызова closehandl получите доступ это му объекту ядра счетчик обнулен объект остается памяти нормально это означает лишь объект используется другим процессом процессами остальные процессы завершат работу этим объектом вызвав closehandl разрушен забыли вызвать closehandl   утечка памяти утеч ка ресурсов тех объектов ядра вполне вероятна пока процесс исполняется однако завершении процесса операционная система гарантированно освобожда ет ресурсы принадлежавшие этому процессу случае объектов ядра действует момент завершения процесса просматривает таблицу описателей закры вает любые открытые описатели совместное использование объектов ядра несколькими процессами время времени возникает необходимость разделении объектов ядра токами исполняемыми разных процессах причин тому несколько 쐽 объекты  проекции файлов  позволяют двум процессам исполняемым од ной машине совместно использовать одни те блоки данных 쐽 почтовые ящики именованные каналы дают возможность программам обме ниваться данными процессами исполняемыми других машинах сети 쐽 мьютексы семафоры события позволяют синхронизировать потоки испол няемые разных процессах одно приложение могло уведомить другое окончании той иной операции поскольку описатели объектов ядра имеют смысл конкретном цессе разделение объектов ядра несколькими процессами   задача весьма непростая microsoft несколько веских причин сделать описатели  процесс зависимыми  самая главная   устойчивость операционной системы сбоям описатели объектов ядра общесистемными процесс мог запросто получить описатель объекта используемого другим процессом устроить нем процессе настоящий хаос другая причина   защита объекты ядра щищены процесс прежде оперировать ними должен запрашивать разреше ние доступ механизма позволяющие процессам совместно использовать одни те объекты ядра рассмотрим следующем разделе 34 глава 3 объекты ядра наследование описателя объекта наследование применимо процессы связаны  родственными  отно шениями родительскийдочерний например родительскому процессу доступен несколько описателей объектов ядра решает породив дочерний процесс передать наследству доступ своим объектам ядра сценарий наследования сработал родительский процесс должен выполнить сколько операций первых создании объекта ядра процесс должен сообщить систе ме нужен наследуемый описатель данного объекта имейте виду описате объектов ядра наследуются сами объекты ядра   создать наследуемый описатель родительский процесс выделяет иници ализирует структуру securityattribut затем передает адрес требуемой createфункции следующий код создает объектмьютекс возвращает описатель securityattribut sa sanlength sizeofsa salpsecuritydescriptor null sabinherithandl true делаем возвращаемый описатель наследуемым handl hmutex createmutexsa fals null m код инициализирует структуру securityattribut указывая объект следует создать защитой умолчанию window 98 это игнорируется воз вращаемый описатель должен наследуемым хотя window 98 полностью поддерживает защиту поддержива ет наследование поэтому корректно обрабатывает элемент binherithandl перейдем флагам которые хранятся таблице описателей принадле жащей процессу каждой записи присутствует битовый флаг сообщающий явля ется данный описатель наследуемым создавая объект ядра переда дите параметре типа psecurityattribut значение null получите ненасле дуемый описатель флаг нулевым элемент binherithandl равен true флагу присваивается 1 допустим какому процессу принадлежит таблица описателей таблице 32 указатель блок маска доступа dword флаги dword набором индекс памяти объекта ядра набором битовых флагов битовых флагов 1 0xf0000000 0x 0x00000000 2 0x00000000 неприменим неприменим 3 0xf0000010 0x 0x00000001 таблица 32 таблица описателей двумя действительными записями эта таблица свидетельствует данный процесс имеет доступ двум объектам ядра описатель 1 ненаследуемый 3 наследуемый следующий этап   родительский процесс порождает дочерний это делается помощью функции createprocess 35 часть i материалы обязательного чтения bool createprocess pctstr pszapplicationnam ptstr pszcommandlin psecurityattribut psaprocess psecurityattribut psathread bool binherithandl dword fdwcreat pvoid pvenviron pctstr pszcurdir pstartupinfo psistartinfo pprocessinform ppiprocinfo подробно рассмотрим функцию следующей главе хочу лишь обратить ваше внимание параметр binherithandl создавая процесс обычно передаете параметре fals самым сообщая системе дочерний цесс должен наследовать наследуемые описатели зафиксированные таблице родительского процесса передаете true дочерний процесс наследует описатели родительского операционная система создает дочерний процесс дает немедленно начать работу сформировав нем обычно новую пустую таблицу описателей считывает таблицу родительского процесса ко пирует действительные записи таблицу дочернего   причем те пози ции последний факт чрезвычайно важен означает описатели будут иден тичны обоих процессах родительском дочернем помимо копирования записей таблицы описателей система увеличивает зна чения счетчиков соответствующих объектов ядра поскольку объекты ис пользуются обоими процессами уничтожить объект ядра описа тель должны закрыть вызовом closehandl оба процесса кстати сразу возврата управления функцией createprocess родительский процесс закрыть свой опи сатель объекта это никак отразится способности дочернего процесса мани пулировать этим объектом таблице 33 показано состояние таблицы описателей дочернем процессе   самым началом исполнения видите записи 1 2 инициализирова ны поэтому данные описатели неприменимы дочернем процессе однако ин декс 3 действительно идентифицирует объект ядра тому родительс ком адресу 0xf0000010 маска доступа флаги родительском дочер нем процессах идентичны дочерний процесс очередь родит новый  внука  отношению исходному родительскому  внук  унаследует данный описатель объекта ядра теми значением правами доступа флагами счетчик числа пользователей объекта ядра вновь увеличится 1 указатель блок маска доступа dword флаги dword набором индекс памяти объекта ядра набором битовых флагов битовых флагов 1 0x00000000 неприменим неприменим 2 0x00000000 неприменим неприменим 3 0xf0000010 0x 0x00000001 таблица 33 таблица описателей дочернем процессе унаследовал родительского наследуемый описатель наследуются описатели объектов существующие момент создания чернего процесса родительский процесс создаст новые объекты 36 глава 3 объекты ядра ядра наследуемыми описателями описатели будут недоступны дочерне му процессу наследования описателей объектов характерно одно очень странное свойство дочерний процесс имеет малейшего понятия унаследовал какие опи сатели поэтому наследование описателей объектов ядра полезно черний процесс сообщает создании родительским процессом ожида ет доступа какому объекту ядра заметить обычно родительс кое дочернее приложения пишутся одной фирмой принципе дочернее ложение написать сторонняя фирма программе задокументиро вано именно ждет родительского процесса дочерний процесс обычно передают значение ожидаемого описа теля объекта ядра аргумент командной строке инициализирующий код дочер процесса анализирует командную строку чаще вызовом sscanf извлекает значение описателя дочерний процесс получает неограниченный доступ объекту механизм наследования срабатывает значение описателя общего объекта ядра родительском дочернем процессах одинаково   именно причине родительский процесс передать значение описа теля аргумент командной строке наследственной передачи описателя объекта ядра родительского процесса дочернему годятся другие формы межпроцессной связи емов заключается родительский процесс дожидается окончания инициа лизации дочернего функцию waitforinputidl рассматриваемую главе 9 затем посылает синхронно асинхронно сообщение окну созданному потоком дочернего процесса прием родительский процесс добавляет свой блок переменных окру жения новую переменную должна  узнаваема  дочерним процессом держать значение наследуемого описателя объекта ядра далее родительский процесс создает дочерний наследует переменные окружения родительского процесса вызвав getenvironmentvari получает нужный описатель прием особенно хорош дочерний процесс порождает процессы   переменные окружения вновь наследуются изменение флагов описателя встречаются ситуации которых родительский процесс создает объект ядра наследуемым описателем затем порождает дочерних процесса наследуе мый описатель нужен одному иначе говоря время времени возни кает необходимость контролировать дочерних процессов наследует описа тели объектов ядра модифицируйте флаг наследования связанный опи сателем вызовом sethandleinform bool sethandleinform handl hobject dword dwmask dword dwflag видите эта функция принимает параметра первый hobject идентифи цирует допустимый описатель второй dwmask сообщает функции флаг флаги хотите изменить сегодняшний день каждым описателем связано флага defin handleflaginherit 0x00000001 defin handleflagprotectfromclos 0x00000002 37 часть i материалы обязательного чтения изменить сразу флаги объекта нужно объединить побитовой опе рацией or третий параметр функции sethandleinform   dwflag   указыва ет какое именно состояние следует перевести флаги например установить флаг наследования описателя объекта ядра sethandleinformationhobj handleflaginherit handleflaginherit сбросить флаг sethandleinformationhobj handleflaginherit 0 флаг handleflagprotectfromclos сообщает системе данный опи сатель закрывать sethandleinformationhobj handleflagprotectfromclos handleflagprotectfromclos closehandlehobj генерируется исключение поток попытается закрыть защищенный описатель closehandl приведет исключению необходимость защите возникает очень редко од нако флаг весьма полезен процесс порождает дочерний оче редь   процесс родительский процесс ожидать  внук  унаследует определенный описатель объекта переданный дочернему вполне возможно дочерний процесс прежде породить новый процесс зак рывает нужный описатель родительский процесс теряет связь  внуком  скольку унаследовал требуемый объект ядра защитив описатель закрытия исправите ситуацию  внук  унаследует предназначенный объект подхода недостаток дочерний процесс вызвав sethandleinformationhobj handleflagprotectfromclos 0 closehandlehobj сбросить флаг handleflagprotectfromclos закрыть затем соответ ствующий описатель родительский процесс ставит дочерний исполнит код одновременно ставит дочерний процесс породит  внука  поэтому целом ставки слишком рискованны полноты картины стоит пожалуй упомянуть функцию gethandleinform bool gethandleinform handl hobj pdword pdwflag эта функция возвращает текущие флаги заданного описателя переменной типа dword которую указывает pdwflag проверить является описа тель наследуемым сделайте dword dwflag gethandleinformationhobj dwflag bool fhandleisinherit 0 dwflag handleflaginherit именованные объекты второй способ позволяющий нескольким процессам совместно использовать одни те объекты ядра связан именованием этих объектов именование допускают многие объекты ядра например следующие функции создают именован ные объекты ядра 38 глава 3 объекты ядра handl createmutex psecurityattribut psa bool binitialown pctstr pszname handl createev psecurityattribut psa bool bmanualreset bool binitialst pctstr pszname handl createsemaphor psecurityattribut psa long linitialcount long lmaximumcount pctstr pszname handl createwaitabletim psecurityattribut psa bool bmanualreset pctstr pszname handl createfilemap handl hfile psecurityattribut psa dword flprotect dword dwmaximumsizehigh dword dwmaximumsizelow pctstr pszname handl createjobobject psecurityattribut psa pctstr pszname последний параметр pszname этих функций одинаков передавая нем null создаете безымянный анонимный объект ядра случае можете разделять объект процессами либо наследование см предыдущий дел либо помощью duplicatehandl см следующий раздел разделять объект имени должны присвоить какое имя вместо null параметре pszname нужно передать адрес строки именем завершаемой нулевым символом имя длиной maxpath знаков это значение определено 260 сожалению microsoft сообщает правилах именования объек тов ядра например создавая объект именем jeffobj никак застрахованы системе объекта ядра таким именем хуже объек делят единое пространство имен следующий вызов createsemaphor возвращать null handl hmutex createmutexnul fals jeffobj handl hsem createsemaphorenul 1 1 jeffobj dword dwerrorcod getlasterror выполнения фрагмента значение dwerrorcod равно 6 errorin validhandl полученный код ошибки слишком вразумителен другого дано 39 часть i материалы обязательного чтения научились именовать объекты рассмотрим разделять меж ду процессами именам допустим запуска процесса a вызывается функция handl hmutexprocessa createmutexnul fals jeffmutex вызов заставляет систему создать новенький иголочки объект ядра  мьютекс  присвоить имя jeffmutex заметьте описатель hmutexprocessa процессе a является наследуемым   должен таковым простом именовании объектов спустя какое время некий процесс порождает процесс b необязательно последний дочерним процесса a порожден explor любым другим приложением кстати состоит преимущество механизма именования объектов наследованием процесс b приступает работе исполняется код handl hmutexprocessb createmutexnul fals jeffmutex вызове система сначала проверяет существует объект ядра таким именем ядро проверяет тип объекта поскольку пытаемся создать мьютекс имя jeffmutex система проверяет права доступа вызыва ющего процесса этому объекту права таблице описателей принадлежащей процессу b создается новая запись указывающая существующий объект ядра вызывающий процесс имеет полных прав доступ объек ту типы двух объектов одинаковыми именами совпадают вызов creat mutex заканчивается неудачно возвращается null однако хотя процесс b успешно вызвал createmutex новый объектмьютекс создал вместо получил свой описатель существующего объектамьютекса счетчик объекта увеличился 1 объект разрушится пока описатели закроют оба процесса   a b заметьте значения описа телей объекта обоих процессах скорее разные должно каждый процесс оперировать данным объектом ядра используя свой описатель разделяя объекты ядра именам помните одной крайне важной вещи вызывая createmutex процесс b передает атрибуты защиты второй пара метр параметры игнорируются объект указанным именем существует приложение определить оно делает создает новый объект ядра просто открывает существующий   вызвав getlasterror сразу вызова одной createфункций handl hmutex createmutexsa fals jeffobj if getlasterror erroralreadyexist открыт описатель существующего объекта salpsecuritydescriptor второй параметр fals игнорируются els создан совершенно новый объект salpsecuritydescriptor второй параметр fals используются создании объекта способ разделения объектов именам вместо вызова createфун кции процесс обратиться одной следующих openфункций 40 глава 3 объекты ядра handl openmutex dword dwdesiredaccess bool binherithandl pctstr pszname handl openev dword dwdesiredaccess bool binherithandl pctstr pszname handl opensemaphor dword dwdesiredaccess bool binherithandl pctstr pszname handl openwaitabletim dword dwdesiredaccess bool binherithandl pctstr pszname handl openfilemap dword dwdesiredaccess bool binherithandl pctstr pszname handl openjobobject dword dwdesiredaccess bool binherithandl pctstr pszname заметьте функции имеют прототип последний параметр pszname определяет имя объекта ядра нем передать null   адрес строки нулевым символом конце функции просматривают единое пространство имен объектов ядра пытаясь найти совпадение объекта ядра указанным именем функции возвращают null getlasterror   код 2 errorfilenotfound объект ядра заданным именем существует тип идентичен тому указали система проверяет разрешен данному объекту доступ запрошенно го вида параметр dwdesiredaccess вид доступа разрешен таблица описателей вызывающем процессе обновляется счетчик числа пользователей объекта возрастает 1 присвоили параметру binherithandl значение true получите наследуемый описатель главное отличие вызовом creat openфункций отсутствии указанного объекта createфункция создает openфункция просто уведомляет ошибке microsoft сообщает правилах именования объек тов ядра представьте пользователь запускает две программы разных компаний каждая программа пытается создать объект именем  myobject  хорошего выйдет избежать ситуации посоветовал здавать guid использовать строковое представление имя объекта именованные объекты часто применяются допустить запуска нескольких экземпляров одного приложения просто вызываете одну createфункций своей функции main winmain создаете некий именованный 41 часть i материалы обязательного чтения объект именно   имеет малейшего значения сразу createфунк ции должны вызвать getlasterror вернет erroralreadyexist зна чит экземпляр вашего приложения выполняется новый экземпляр закрыть фрагмент кода иллюстрирующий прием int winapi winmainhinst hinstex hinstanc pstr pszcmdline int ncmdshow handl h createmutexnul fals fa531cc1049711d3a18000105a276c3 if getlasterror erroralreadyexist экземпляр приложения выполняется return0 запущен первый экземпляр данного приложения m выходом закрываем объект closehandleh return0 пространства имен termin server termin server несколько меняет описанный выше сценарий машине termin server существует множество пространств имен объектов ядра объекты которые должны доступны всем клиентам используют одно глобальное пространство имен такие объекты правило связаны сервисами предоставляемыми клиент ским программам каждом клиентском сеансе формируется свое пространство имен исключить конфликты несколькими сеансами которых запус кается одно приложение какого сеанса получить доступ объек другого сеанса объектов идентичные имена именованные объекты ядра относящиеся какомулибо сервису находят ся глобальном пространстве имен аналогичный объект связанный приложени ем termin server умолчанию помещает пространство имен клиентского сеан са однако перевести глобальное пространство имен поставив именем объекта префикс  global  примере ниже handl h createeventnul fals fals globalmynam хотите явно указать объект ядра должен находиться пространстве имен клиентского сеанса используйте префикс  local  handl h createeventnul fals fals localmynam microsoft рассматривает префиксы global local зарезервированные ключе вые слова которые должны встречаться самих именах объектов числу таких слов microsoft относит session хотя сегодняшний день оно связано ка кой функциональностью также обратите внимание две вещи ключевые слова чувствительны регистру букв игнорируются компьютер работает termin server дублирование описателей объектов последний механизм совместного использования объектов ядра несколькими процес сами требует функции duplicatehandl 42 глава 3 объекты ядра bool duplicatehandl handl hsourceprocesshandl handl hsourcehandl handl htargetprocesshandl phandl phtargethandl dword dwdesiredaccess bool binherithandl dword dwoption говоря простому эта функция берет запись таблице описателей одного цесса создает копию таблице другого duplicatehandl принимает несколько параметров самом деле весьма незамысловата обычно применение требует наличия системе трех разных процессов первый третий параметры функции duplicatehandl представляют собой опи сатели объектов ядра специфичные вызывающего процесса кроме па раметры должны идентифицировать именно процессы   функция завершится ошибкой передадите описатели объекты ядра любого другого типа робнее объекты ядра  процессы  обсудим главе 4 достаточно знать одно объект ядра  процесс  создается каждой инициации системе вого процесса второй параметр hsourcehandl   описатель объекта ядра любого типа однако значение специфично процесса вызывающего duplicatehandl который указывает описатель hsourceprocesshandl параметр phtargethandl   это адрес переменной типа handl которой возвращается индекс записи копией описателя процессаисточника значение возвращаемого описателя специфично процесса определяемого параметром htargetprocesshandl предпоследние параметра duplicatehandl позволяют задать маску доступа флаг наследования устанавливаемые данного описателя процессеприемнике параметр dwoption 0 любой комбинацией двух флагов duplicatesameaccess duplicateclosesourc первый флаг подсказывает duplicatehandl описателя получаемого процессом приемником должна та маска доступа описателя процессеисточ нике флаг заставляет duplicatehandl игнорировать параметр dwdesiredaccess второй флаг приводит закрытию описателя процессеисточнике позволя ет процессам обмениваться объектом ядра эстафетной палочкой счет чик объекта меняется попробуем проиллюстрировать работу функции duplicatehandl примере s   это процессисточник имеющий доступ какому объекту ядра t   это процессприемник который получит доступ тому объекту ядра c   процесс катализатор вызывающий функцию duplicatehandl таблица описателей процессе c см таблицу 34 содержит индекса   1 2 описатель первым значением идентифицирует объект ядра  процесс s  описатель вторым значением   объект ядра  процесс t  указатель блок маска доступа dword флаги dword набором индекс памяти объекта ядра набором битовых флагов битовых флагов 1 0xf0000000 объект ядра процесса s 0x 0x00000000 2 0xf0000010 объект ядра процесса t 0x 0x00000000 таблица 34 таблица описателей процессе c 43 часть i материалы обязательного чтения таблица 35 иллюстрирует таблицу описателей процессе s содержащую един ственную запись значением описателя равным 2 описатель иденти фицировать объект ядра любого типа  процесс  указатель блок маска доступа dword флаги dword набором индекс памяти объекта ядра набором битовых флагов битовых флагов 1 0x00000000 неприменим неприменим 2 0xf0000020 объект ядра любого типа 0x 0x00000000 таблица 35 таблица описателей процессе s таблице 36 показано именно содержит таблица описателей процессе t вызовом процессом c функции duplicatehandl видите одна запись значением описателя равным 2 запись индексом 1 пока пуста указатель блок маска доступа dword флаги dword набором индекс памяти объекта ядра набором битовых флагов битовых флагов 1 0x00000000 неприменим неприменим 2 0xf0000030 объект ядра любого типа 0x 0x00000000 таблица 36 таблица описателей процессе t вызовом duplicatehandl процесс c вызовет duplicatehandl duplicatehandle1 2 2 hobj 0 true duplicatesameaccess вызова изменится таблица описателей процессе t см таблицу 37 указатель блок маска доступа dword флаги dword набором индекс памяти объекта ядра набором битовых флагов битовых флагов 1 0xf0000020 0x 0x00000001 2 0xf0000030 объект ядра любого типа 0x 0x00000000 таблица 37 таблица описателей процессе t вызова duplicatehandl вторая строка таблицы описателей процессе s скопирована первую строку таблицы описателей процессе t функция duplicatehandl присвоила также перемен ной hobj процесса c значение 1   индекс той строки таблицы процессе t кото рую занесен новый описатель поскольку функции duplicatehandl передан флаг duplicatesameaccess мас ка доступа описателя процессе t идентична маске доступа процессе s кроме данный флаг заставляет duplicatehandl проигнорировать параметр dwde siredaccess заметьте также система установила битовый флаг наследования параметре binherithandl функции duplicatehandl передали true очевидно станете передавать duplicatehandl жестко зашитые значения это сделал просто демонстрируя работу функции реальных граммах значения описателей хранятся переменных именно переменные передаются функциям механизм наследования функция duplicatehandl обладает одной странностью процессприемник никак уведомляется получил дос туп новому объекту ядра поэтому процесс c должен каким образом сообщить 44 глава 3 объекты ядра процессу t имеет доступ новому объекту нужно восполь зоваться одной форм межпроцессной связи передать процесс t значение опи сателя переменной hobj ясное дело данном случае годится командная стро ка изменение переменных окружения процесса t поскольку процесс выполняется придется послать сообщение окну задействовать будь механизм межпроцессной связи рассказал функции duplicatehandl самом общем виде надеюсь уви дели насколько гибка эта функция редко используется ситуациях требую щих участия трех разных процессов обычно вызывают применительно двум процессам представьте процесс имеет доступ объекту которому хочет обратиться процесс процесс хочет предоставить другому дос туп  своему  объекту ядра например процесс s имеет доступ объекту ядра нужно этому объекту мог обращаться процесс t используйте duplic handl весь приведенный ниже код исполняется процессом s создаем объектмьютекс доступный процессу s handl hobjprocesss createmutexnul fals null открываем описатель объекта ядра процесс t handl hprocesst openprocessprocessallaccess fals dwprocessidt handl hobjprocesst неинициализированный описатель связанный процессом t предоставляем процессу t доступ объектумьютексу duplicatehandlegetcurrentprocess hobjprocesss hprocesst hobjprocesst 0 fals duplicatesameaccess используем какую форму межпроцессной связи передать значение описателя hobjprocesss процесс t m связь процессом t нужна closehandlehprocesst m процессу s нужен объектмьютекс должен закрыть closehandlehobjprocesss вызов getcurrentprocess возвращает псевдоописатель который идентифи цирует вызывающий процесс данном случае   процесс s функция duplicatehandl возвращает управление hobjprocesst становится описателем связан ным процессом t идентифицирующим объект описатель hobjprocesss ссылается код процесса s процесс s коем случае должен исполнять следующий код процесс s должен пытаться исполнять код закрывающий продублированный описатель closehandlehobjprocesst 45 часть i материалы обязательного чтения процесс s выполнит код вызов дать дать ошибку успешен процесса s случайно окажется описатель значени ем hobjprocesst процесс s закроет неизвестно объект   остается гадать другом способе применения duplicatehandl допустим некий процесс имеет полный доступ чтения записи объекту  проекция файла  процесса вызывается функция которая должна обратиться проекции файла счи тать какие данные хотим повысить отказоустойчивость приложения могли помощью duplicatehandl создать новый описатель суще ствующего объекта разрешить доступ чтения передали описатель функции та смогла случайно записать проекцию файла взгляните код который иллюстрирует пример int winapi winmainhinst hinstex hinstanc pstr pszcmdline int ncmdshow создаем объект проекция файла описатель разрешает доступ чтения записи handl hfilemaprw createfilemappinginvalidhandlevalu null pagereadwrit 0 10240 null создаем описатель объект описатель разрешает доступ чтения handl hfilemapro duplicatehandlegetcurrentprocess hfilemaprw getcurrentprocess hfilemapro filemapread fals 0 вызываем функцию которая должна записывать проекцию файла readfromthefilemappinghfilemapro закрываем объект проекция файла доступный чтения closehandlehfilemapro проекция файла нам прежнему полностью доступна hfilemaprw m проекция файла нужна основному коду закрываем closehandlehfilemaprw 46 ч сть ii начинаем работать г л 4 процессы э та глава система управляет выполняемыми приложениями сначала оп ределю понятие  процесс  объясню система создает объект ядра  процесс  затем покажу управлять процессом используя сопоставленный объект ядра далее обсудим атрибуты свойства процесса поговорим несколь ких функциях позволяющих обращаться этим свойствам изменять расскажу также функциях которые создают порождают системе дополнительные процес сы описание процессов неполным рассмотрел механизм завершения  кэй приступим процесс обычно определяют экземпляр выполняемой программы состо ит двух компонентов 쐽 объекта ядра который операционная система управляет процессом хранится статистическая информация процессе 쐽 адресного пространства котором содержится код данные exe dll модулей именно нем находятся области памяти динамически распределяе стеков потоков других нужд поток поток поток поток поток поток цпу поток поток поток поток поток поток рис 41 операционная система выделяет потокам кванты времени принципу карусели процессы инертны процесс выполнил нем нужно создать поток именно потоки отвечают исполнение кода содержащегося адресном странстве процесса принципе процесс владеть несколькими потока ми  одновременно  исполняют код адресном пространстве процесса 48 г л 4 процессы каждый поток должен располагать собственным набором регистров цессора собственным стеком каждом процессе минимум поток процесса одного потока нечего делать свете система автоматически уничтожила вместе выделенным адресным странством потоки работали операционная система отводит каждому определенное процессорное время выделяя потокам отрезки времени называемые квантами принципу карусели создает самым иллюзию одновременного выполнения потоков рис 41 иллюстрирует распределение процессорного времени потоками машине одним процессором машине установлено одного процессора алгоритм работы операционной системы значительно усложняет ся случае система стремится сбалансировать нагрузку процессорами создании процесса первый точнее первичный поток создается системой автоматически далее поток породить другие потоки те очередь   новые т д window 2000 полной мере использует возможности машин несколькими процессорами например книгу писал сидя машиной двумя процес сорами window 2000 способна закрепить каждый поток отдельным цессором потока исполняются действительно одновременно ядро window 2000 полностью поддерживает распределение процессорного време потоками управление ими таких системах придется делать особенного своем коде задействовать преимущества многопроцессорной машины window 98 работает одним процессором компьютера несколько процессоров управлением window 98 действует лишь   остальные простаивают ваше первое windowsприложение window поддерживает типа приложений основанные графическом интерфей се graphic user interfac gui консольные consol user interfac cui приложе ний первого типа внешний интерфейс чисто графический guiприложения создают окна имеют меню взаимодействуют пользователем диалоговые окна вооб ще пользуются всей стандартной  windows овской  начинкой стандартные программы window   notepad calcul wordpad др   являются guiприложе ниями приложения консольного типа работают текстовом режиме форми руют окна обрабатывают сообщения требуют gui хотя консольные ложения экране размещаются окне нем содержится текст коман дные процессоры вроде cmdex window 2000 commandcom window 98   типичные образцы подобных приложений вместе граница двумя типами приложений весьма условна например создать консольное приложение способное отображать диалоговые окна скажем командном процессоре вполне специальная команда открыва ющая графическое диалоговое окно списком команд вроде мелочь   избавляет запоминания лишней информации время создать guiприложе ние выводящее текстовые строки консольное окно часто писал такие 49 ч т ь ii начинаем работать граммы создав консольное окно пересылал отладочную информацию свя занную исполняемым приложением графический интерфейс предпоч тительнее старомодный текстовый показывает опыт приложения основе gui  дружественнее  пользователю значит популярны создаете проект приложения microsoft visual c устанавливает такие ключи компоновщика исполняемом файле указан соответствующий тип подсистемы cuiпрограмм используется ключ subsystemconsol guiприложений   subsystemwindow пользователь запускает приложе ние загрузчик операционной системы проверяет номер подсистемы хранящийся заголовке образа исполняемого файла определяет это программа   gui cui номер указывает приложение последнего типа загрузчик автоматичес ки создает текстовое консольное окно номер свидетельствует противопо ложном   просто загружает программу память приложение начи нает работать операционная система интересуется какому типу оно относится windowsприложениях должна входная функция реализацию которой отвечаете существует четыре такие функции int winapi winmain hinstanc hinstex hinstanc pstr pszcmdline int ncmdshow int winapi wwinmain hinstanc hinstex hinstanc pwstr pszcmdline int ncmdshow int cdecl main int argc char argv char envp int cdecl wmain int argc wchart argv wchart envp самом деле входная функция операционной системой вызывается вместо происходит обращение стартовой функции библиотеки cc ини циализирует библиотеку cc вызывать такие функции malloc free также обеспечивает корректное создание любых объявленных вами глобальных статических cобъектов начнется выполнение вашего кода следующей таблице показано каких случаях реализуются те иные вход ные функции 50 г л 4 процессы стартовая функция встраиваемая тип приложения входная функция ваш исполняемый файл guiприложение работающее winmain winmaincrtstartup ansiсимволами строками guiприложение работающее wwinmain wwinmaincrtstartup unicodeсимволами строками cuiприложение работающее main maincrtstartup ansiсимволами строками cuiприложение работающее wmain wmaincrtstartup unicodeсимволами строками нужную стартовую функцию библиотеке cc выбирает компоновщик сборке исполняемого файла указан ключ subsystemwindow компоновщик ищет вашем коде функцию winmain wwinmain одной сообщает ошибке  unresolv extern symbol   неразрешенный внешний символ  ином случае   выбирает winmaincrtstartup wwinmaincrtstartup соответственно аналогичным образом задан ключ subsystemconsol компоновщик ищет коде функцию main wmain выбирает соответственно maincrtstartup wmaincrtstartup коде main wmain сообщается той ошибке    unresolv extern symbol  многие знают проекте вообще указывать ключ subsystem компоновщика сделаете компоновщик определять подсис тему вашего приложения компоновке проверит четырех функ ций winmain wwinmain main wmain присутствует вашем коде основа нии выберет подсистему стартовую функцию библиотеки cc одна частых ошибок допускаемых теми лишь начинает работать vi sual c   выбор неверного типа проекта например разработчик хочет создать проект win32 applic включает код функцию main сборке получает сообщение ошибке проекта win32 applic командной строке компоновщика автоматически указывается ключ subsystemwindow ко торый требует присутствия коде функции winmain wwinmain момент работчик выбрать четырех вариантов дальнейших действий 쐽 заменить main winmain правило это лучший вариант поскольку разработчик скорее хотел создать консольное приложение 쐽 открыть новый проект   win32 consol applic перенести модули кода вариант весьма утомителен возникает ощущение начинаешь заново 쐽 открыть вкладку link диалоговом окне project set заменить ключ subsystemwindow subsystemconsol некоторые думают это единственный вариант 쐽 открыть вкладку link диалоговом окне project set вообще убрать ключ subsystemwindow предпочитаю именно способ самый гибкий компоновщик сделает зависимости вход ной функции которую реализуете своем коде никак пойму почему это предлагается умолчанию создании нового проекта win32 appli cation win32 consol applic 51 ч т ь ii начинаем работать стартовые функции библиотеки cc делают практически одно разница лишь какие строки обрабатывают ansi unicod какую входную функцию вызывают инициализации библиотеки кстати visual c поставляется исходный код библиотеки стартовые функции находятся фай ле crt0c рассмотрим какие операции выполняют 쐽 считывают указатель полную командную строку нового процесса 쐽 считывают указатель переменные окружения нового процесса 쐽 инициализируют глобальные переменные библиотеки cc доступ ко торым вашего кода обеспечивается включением файла stdlibh список этих переменных приведен таблице 41 쐽 инициализируют кучу динамически распределяемую область памяти исполь зуемую cфункциями выделения памяти т е malloc calloc другими цедурами низкоуровневого вводавывода 쐽 вызывают конструкторы глобальных статических объектов cклассов закончив операции стартовая функция обращается входной функции вашей программе написали виде wwinmain вызывается getstartupinfostartupinfo int nmainretv wwinmaingetmodulehandlenul null pszcommandlineunicod startupinfodwflag startfuseshowwindow startupinfowshowwindow swshowdefault предпочли winmain getstartupinfostartupinfo int nmainretv winmaingetmodulehandlenul null pszcommandlineansi startupinfodwflag startfuseshowwindow startupinfowshowwindow swshowdefault самое функций wmain main int nmainretv wmainargc wargv wenviron int nmainretv mainargc argv environ ваша входная функция возвращает управление стартовая обращается функции exit библиотеки cc передает значение nmainretv функция exit выполняет следующие операции 쐽 вызывает функции зарегистрированные вызовами функции onexit 쐽 вызывает деструкторы глобальных статических объектов cклассов 쐽 вызывает windowsфункцию exitprocess передавая значение nmainretv это заставляет операционную систему уничтожить ваш процесс установить код завершения имя переменной тип описание osver unsign int версия сборки операционной системы например window 2000 beta 3 номер 2031 соответственно osver равна 2031 winmajor unsign int основной номер версии window шестнадцатерич ной форме window 2000 это значение равно 5 таблица 41 глобальные переменные библиотеки cc доступные вашим программам 52 г л 4 процессы продолжение имя переменной тип описание winminor unsign int дополнительный номер версии window шестнадца теричной форме window 2000 это значение равно 0 winver unsign int вычисляется winmajor 8 winminor argc unsign int количество аргументов переданных командной строке argv char массив размером argc указателями ansi wargv wchart unicodeстроки каждый элемент массива указывает аргументов командной строки environ char массив указателей ansi unicodeстроки wenviron wchart каждый элемент массива указывает строку   переменную окружения pgmptr char полный путь имя ansi unicod wpgmptr wchart запускаемой программы описатель экземпляра процесса любому exe dllмодулю загружаемому адресное пространство процесса сваивается уникальный описатель экземпляра описатель экземпляра вашего exe файла передается первый параметр функции wwinmain   hinstex это значе ние обычно требуется вызовах функций загружающих те иные ресурсы пример загрузить образа exeфайла ресурс значок вызвать hicon loadicon hinstanc hinst pctstr pszicon первый параметр loadicon указывает каком файле exe dll содержится интересующий ресурс многие приложения сохраняют параметр hinstex функ ции wwinmain глобальной переменной благодаря чему доступен любой части кода exeфайла документации platform sdk утверждается некоторые windowsфункции требуют параметр типа hmodul пример   функция getmodulefilenam dword getmodulefilenam hmodul hinstmodul ptstr pszpath dword cchpath оказалось hmodul hinstanc   это одно встретив доку ментации указание передать функции hmodul смело передавайте hinstanc наоборот существуют таком виде лишь 16 разрядной window идентифицировали совершенно разные вещи истинное значение параметра hinstex функции wwinmain   базовый адрес памяти определяющий ту область адресном пространстве процесса заг ружен образ данного exeфайла например система открывает исполняемый файл загружает содержимое адресу 0x00400000 hinstex функции wwin main получает значение 0x00400000 53 ч т ь ii начинаем работать базовый адрес которому загружается приложение определяется компоновщи ком разные компоновщики выбирают разные умолчанию базовые адреса ком поновщик visual c использует умолчанию базовый адрес 0x00400000   самый нижний window 98 начиная которого допускается загрузка образа испол няемого файла указав параметр base адрес случае компоновщика microsoft изменить базовый адрес которому загружаться приложение попытке загрузить исполняемый файл window 98 базовому адресу ниже 0x00400000 загрузчик переместит адрес это увеличит время загрузки приложения оно крайней мере выполнено разрабатываете граммы window 98 window 2000 сделайте приложение заг ружалось базовому адресу ниже 0x00400000 функция getmodulehandl hmodul getmodulehandl pctstr pszmodul возвращает описательбазовый адрес указывающий именно адресном странстве процесса загружается exe dllфайл вызове функции имя нужного exe dllфайла передается строка нулевым символом конце система находит указанный файл getmodulehandl возвращает базовый адрес которому располагается образ данного файла файл системой найден функция возвращает null кроме вызвать функцию передав null вместо параметра pszmodul   узнаете базовый адрес exeфайла именно это делает стартовый код библиотеки cc вызове wwinmain вашей программы две важные вещи касающиеся getmodulehandl первых прове ряет адресное пространство процесса который вызвал цесс использует никаких функций связанных стандартными диалоговыми ок нами вызвав getmodulehandl передав аргумент  comdlg32  получите null   пусть модуль comdlg32dll загружен адресное пространство какого другого процесса вторых вызов функции передача null дает результате базовый адрес exeфайла адресном пространстве процесса зывая функцию виде getmodulehandlenul   кода dll   получаете базовый адрес exe dllфайла описатель предыдущего экземпляра процесса стартовый код библиотеки cc передает функцию wwinmain параметр hinstexeprev null параметр предусмотрен исключи тельно совместимости 16разрядными версиями window имеет никакого смысла windowsприложений поэтому пишу заголовок wwinmain int winapi winmain hinstanc hinstex hinstanc pstr pszcmdline int ncmdshow поскольку второго параметра имени компилятор выдает предупрежде ние  paramet not referenced    ссылки параметр  54 г л 4 процессы командная строка процесса создании новому процессу передается командная строка которая никог бывает пустой   минимум содержит имя исполняемого файла исполь зованного создании процесса однако увидите ниже обсужде нии функции createprocess возможны случаи процесс получает командную строку состоящую единственного символа   нуля завершающего строку момент запуска приложения стартовый код библиотеки cc считывает командную строку процесса пропускает имя исполняемого файла заносит параметр pszcmdline функции wwinmain указатель оставшуюся часть командной строки параметр pszcmdline указывает ansiстроку заменив winmain wwinmain получите доступ unicodeверсии командной строки своего цесса программа анализировать интерпретировать командную строку угод поскольку pszcmdline относится типу pstr pcstr стесняйтесь запи сывайте строку прямо буфер который указывает параметр каких условиях переступайте границу буфера лично рассматриваю буфер   чтения  командную строку нужно внести изменения снача ла копирую буфер содержащий командную строку локальный буфер своей грамме который затем модифицирую указатель полную командную строку процесса получить вызовом функции getcommandlin ptstr getcommandlin возвращает указатель буфер содержащий полную командную строку вклю чая полное имя вместе путем исполняемого файла многих приложениях безусловно удобнее использовать командную строку предварительно разбитую отдельные компоненты доступ которым приложение получить глобальные переменные argc argv wargv функ ция commandlinetoargvw расщепляет unicodeстроку отдельные компоненты pwstr commandlinetoargvw pwstr pszcmdline int pnumarg буква w конце имени функции намекает  широкие  wide символы подсказывает функция существует unicodeверсии параметр pszcmdline указывает командную строку обычно получают предварительным вызовом getcommandlinew параметр pnumarg   это адрес целочисленной переменной которой задается количество аргументов командной строке функция command linetoargvw возвращает адрес массива указателей unicodeстроки commandlinetoargvw выделяет нужную память автоматически большинство ложений освобождает память полагаясь операционную систему которая проводит очистку ресурсов завершении процесса подход вполне прием лем хотите сами освободить память сделайте int pnumarg pwstr ppargv commandlinetoargvwgetcommandlinew pnumarg см след стр 55 ч т ь ii начинаем работать используйте аргументы if ppargv1 lx m освободите блок памяти heapfreegetprocessheap 0 ppargv переменные окружения любым процессом связан блок переменных окружения   область памяти выделен ная адресном пространстве процесса каждый блок содержит группу строк такого вида varname1varvalue10 varname2varvalue20 varname3varvalue30 m varnamexvarvaluex0 0 первая часть каждой строки   имя переменной окружения следует знак равенства значение присваиваемое переменной строки блоке переменных ок ружения должны отсортированы алфавитном порядке именам переменных знак равенства разделяет имя переменной значение ис пользовать символ имени переменной важную роль играют пробелы напри мер объявив две переменные xyz window обратите внимание пробел знаком равенства abcwindow сравнив значения переменных xyz abc увидите система различает   учитывает любой пробел поставленный знаком равенства записать скажем xyz home обратите внимание пробел знаком равенства xyzwork получите первую переменную именем  xyz  содержащую строку  home  вторую переменную  xyz  содержащую строку  work  конец блока переменных окружения помечается дополнительным нулевым сим волом создать исходный набор переменных окружения window 98 модифицировать файл autoexecbat поместив группу строк set виде set varnamevarvalu перезагрузке система учтет новое содержимое файла autoexecbat любые заданные вами переменные окружения станут доступны всем процессам инициируемым сеансе работы window 98 56 г л 4 процессы регистрации пользователя входе window 2000 система создает цессоболочку связывая группу строк   переменных окружения систе ма получает начальные значения этих строк анализируя раздела реест ре первом hkeylocalmachinesystemcurrentcontrolsetcontrol sessionmanagerenviron содержится список переменных окружения относящихся системе втором hkeycurrentuserenviron находится список переменных окружения относящихся пользователю ко торый настоящее время зарегистрирован системе пользователь добавлять удалять изменять любые переменные апплет system control panel апплете открыть вкладку advanc щелкнуть кнопку environ variabl   экране появит ся следующее диалоговое окно модифицировать переменные списка system variabl разрешается толь ко пользователю правами администратора кроме модификации записей реестре ваша программа обращаться windowsфункциям позволяющим манипулировать реестром однако изменения вступили силу пользователь должен выйти си стемы вновь войти некоторые приложения типа explor task manag control panel могут обновлять свои блоки переменных окружения базе новых значений реестре главные окна получают сообщение wmset tingchang например изменив реестр хотите какие приложения соответственно обновили свои блоки переменных окружения вызовите sendmessagehwndbroadcast wmsettingchang 0 lparam textenviron обычно дочерний процесс наследует набор переменных окружения родитель ского однако последний способен управлять какие переменные окружения следуются дочерним процессом какие   расскажу зай 57 ч т ь ii начинаем работать мемся функцией createprocess наследованием имею виду дочерний цесс получает копию блока переменных окружения родительского дочерний родительский процессы совместно используют блок дочерний процесс добавлять удалять модифицировать перемен ные своем блоке изменения затронут блок принадлежащий родительско му процессу переменные окружения обычно применяются тонкой настройки приложения пользователь создает инициализирует переменную окружения затем запускает приложение оно обнаружив переменную проверяет значение соответству ющим образом настраивается увы многим пользователям силу разобраться переменных окружения значит трудно указать правильные значения знать синтаксис переменных понимать стоит теми иными значениями стороны приложения основан ные gui дают возможность тонкой настройки диалоговые окна ход естественно нагляднее проще пропало желание манипулировать переменными ок ружения поговорим предназначенных цели функциях getenviron variabl позволяет выявлять присутствие той иной переменной окружения оп ределять значение dword getenvironmentvari pctstr pszname ptstr pszvalu dword cchvalu вызове getenvironmentvari параметр pszname должен указывать имя интересующей переменной pszvalu   буфер который помещено зна чение переменной cchvalu следует сообщить размер буфера символах функ ция возвращает либо количество символов скопированных буфер либо 0 удалось обнаружить переменную окружения таким именем кстати реестре многие строки содержат подставляемые части например userprofilemi document часть заключенная знаки процента является подставляемой данном случае строку должно подставлено значение переменной окружения userprofil моей машине эта переменная выглядит cdocument and settingsadministr подстановки переменной строку реестра получим cdocument and settingsadministratormi document поскольку такие подстановки делаются очень часто window функция expandenvironmentstr dword expandenvironmentstr pcтstr pszsrc pтstr pszdst dword nsize параметр pszsrc принимает адрес строки содержащей подставляемые части параметр pszdst   адрес буфера который записывается развернутая строка пара метр nsize определяет максимальный размер буфера символах 58 г л 4 процессы функция setenvironmentvari позволяет добавлять удалять модифи цировать значение переменной dword setenvironmentvari pctstr pszname pctstr pszvalu устанавливает ту переменную чье имя указывает параметр pszname присваивает значение заданное параметром pszvalu такая переменная существует функция модифицирует значение pszvalu содержится null переменная удаляется блока манипуляций блоком переменных окружения используйте именно функции строки блоке переменных нужно отсортировать ал фавитном порядке именам переменных getenvironmentvari быстрее находит нужные переменные setenvironmentvari следит порядком расположения переменных привязка процессорам обычно потоки внутри процесса могут выполняться любом процессоре компью тера однако закрепить определенным подмножеством процессоров числа имеющихся компьютере это свойство называется привязкой процессорам processor affin подробно обсуждается главе 7 дочерние процессы наследуют привязку процессорам родительских режим обработки ошибок каждым процессом связан набор флагов сообщающих системе каким образом цесс должен реагировать серьезные ошибки повреждения дисковых носителей необрабатываемые исключения ошибки операций поиска файлов неверное вырав нивание данных процесс указать системе обрабатывать каждую этих ошибок функцию seterrormod uint seterrormodeuint fuerrormod параметр fuerrormod   это набор флагов комбинируемых побитовой операцией or флаг описание semfailcriticalerror система выводит окно сообщением обра ботчика критических ошибок возвращает ошибку вызывающий процесс semnogpfaulterrorbox система выводит окно сообщением наруше нии общей защиты этим флагом манипулируют отладчики самостоятельно обрабатывающие нарушения общей защиты помощью обработчика исключений semnoopenfileerrorbox система выводит окно сообщением отсут ствии искомого файла semnoalignmentfaultexcept система автоматически исправляет нарушения равнивании данных становятся невидимы ложению флаг действует процессорах x86 умолчанию дочерний процесс наследует родительского флаги указываю щие режим обработки ошибок иначе говоря процесса данный момент установлен флаг semnogpfaulterrorbox порождает процесс 59 ч т ь ii начинаем работать флаг установлен дочернего процесса однако  наследник  уве домляется вообще рассчитан обработку ошибок такого типа данном случае   нарушений общей защиты результате одном пото ков дочернего процесса таки произойдет подобная ошибка процесс завершиться сообщив пользователю родительский процесс способен предотвратить наследование дочерним процессом своего режима обработки ошибок указав вызове функции createprocess флаг createdefaulterrormod createprocess позже текущие диск каталог процесса текущий каталог текущего диска   место windowsфункции ищут файлы подкаталоги полные пути соответствующих параметрах указаны например поток процессе вызывает функцию createfil открыть файл полный путь задан система просматривает список файлов текущем ката логе текущего диска каталог отслеживается самой системой поскольку такая информация относится ко всему процессу смена текущего диска каталога одним потоков распространяется остальные потоки данном процессе поток получать устанавливать текущие каталог диск процесса помощью двух функций dword getcurrentdirectori dword cchcurdir ptstr pszcurdir bool setcurrentdirectorypctstr pszcurdir текущие каталоги процесса система отслеживает текущие диск каталог процесса текущие каталоги каждом диске однако операционной системе предусмотрен кое сервис манипуляций текущими каталогами разных дисках реализуется пере менные окружения конкретного процесса например ccutilitybin ddprogram file переменные указывают текущим каталогом диске c является util bin диске d   program file вызываете функцию передавая путь именем диска отличного текущего система сначала просматривает блок переменных окружения пытается найти переменную связанную именем указанного диска таковая система выбирает текущий каталог заданном диске соответствии значением   текущим каталогом считается корневой скажем текущий каталог процесса   cutilitybin вызываете фун кцию createfil открыть файл dreadmetxt система ищет переменную d поскольку переменная d существует система пытается открыть файл readmetxt каталоге dprogram file таковой переменной система искала файл readmetxt корневом каталоге диска d кстати файловые windowsфункции добавляют изменяют переменные окружения связанные именами дисков лишь считывают значения 60 г л 4 процессы смены текущего каталога вместо windowsфункции setcurrentdirectori использовать функцию chdir библиотеки c внутренне обращается setcurrentdirectori кроме способна добавлять мо дифицировать переменные окружения позволяет запоминать програм ме текущие каталоги различных дисках родительский процесс создает блок переменных окружения хочет пере дать дочернему процессу наследует текущие каталоги родительского цесса автоматически вместо дочернего процесса текущими дисках становятся корневые каталоги дочерний процесс унаследовал текущие ката логи родительского последний должен создать соответствующие переменные окру жения сделать это порождения другого процесса родительский процесс мо жет узнать какие каталоги являются текущими вызвав getfullpathnam dword getfullpathnam pctstr pszfile dword cchpath ptstr pszpath ptstr ppszfilepart например получить текущий каталог диске c функцию вызывают tchar szcurdirmaxpath dword getfullpathnametextc maxpath szcurdir null забывайте переменные окружения процесса должны храниться алфавитном порядке поэтому переменные связанные дисками обычно приходит ся размещать самом начале блока определение версии системы весьма часто приложению требуется определять версии window оно выпол няется причин тому несколько например программа использовать функции защиты заложенные window api полной мере функции реализованы лишь window 2000 насколько помню функция getvers api версий window dword getvers простой функцией связана целая история сначала разработали 16 разрядной window должна старшем слове возвращать номер версии msdos младшем   номер версии window соответственно каждом слове старший байт сообщал основной номер версии младший   дополнительный мер версии увы программист писавший код слегка ошибся получилось номера версии window поменялись местами старший байт попадал дополнительный мер младший   основной поскольку многие программисты начали пользо ваться функцией microsoft пришлось оставить изменить доку ментацию учетом ошибки всей неразберихи вокруг getvers window api включили новую функцию   getversionex bool getversionexposversioninfo pversioninform 61 ч т ь ii начинаем работать обращением getversionex программа должна создать структуру osver sioninfoex показанную ниже передать адрес функции typedef struct dword dwosversioninfos dword dwmajorvers dword dwminorvers dword dwbuildnumb dword dwplatformid tchar szcsdversion128 word wservicepackmajor word wservicepackminor word wsuitemask byte wproducttyp byte wreserv osversioninfoex posversioninfoex эта структура   новинка window 2000 остальных версиях window использу ется структура osversioninfo которой последних пяти элементов присутству ющих структуре osversioninfoex обратите внимание каждому компоненту номера версии операционной сис темы соответствует свой элемент структуры это сделано специально   граммисты возились выборкой данных всяких старшихмладших байтов слов путались программе гораздо проще сравнивать ожидаемый номер версии операционной системы действительным назначение каждого элемен та структуры osversioninfoex описано таблице 42 элемент описание dwosversioninfos размер структуры обращением функции getversionex дол жен заполнен вызовом sizeofosversioninfo sizeofosversioninfoex dwmajorvers основной номер версии операционной системы dwminorvers дополнительный номер версии операционной системы dwbuildnumb версия сборки данной системы dwplatformid идентификатор платформы поддерживаемой данной системой возможные значения verplatformwin32 win32 verplatformwin32window window 9598 verplatformwin32nt window nt window 2000 verplatformwin32cehh window ce szcsdversion элемент содержит текст   дополнительную информацию установленной операционной системе wservicepackmajor основной номер версии последнего установленного пакета исправ лений servic pack wservicepackminor дополнительный номер версии последнего установленного пакета исправлений таблица 42 элементы структуры osversioninfoex 62 г л 4 процессы продолжение элемент описание wsuitemask сообщает какие программные пакеты suit доступны системе возможные значения versuitesmallbusi versuiteenterpris versuitebackoffic versuitecommun versuitetermin versuitesmallbusinessrestrict versuiteembeddednt versuitedatacent wproducttyp сообщает именно вариант операционной системы установ лен возможные значения verntworkst verntserv verntdomaincontrol wreserv зарезервирован будущее window 2000 появилась новая функция verifyversioninfo которая сравнивает версию установленной операционной системы требует ваше приложение bool verifyversioninfo posversioninfoex pversioninform dword dwtypemask dwordlong dwlconditionmask использовать функцию создайте структуру osversioninfoex запи шите элемент dwosversioninfos размер структуры инициализируйте любые другие элементы важные вашей программы вызове verifyversioninfo параметр dwtypemask указывает какие элементы структуры инициализировали параметр принимает любые комбинации следующих флагов verminorver  sion vermajorvers verbuildnumb verplatformid verservicepack minor verservicepackmajor versuitenam verproducttyp последний параметр dwlconditionmask является 64разрядным значением которое управляет именно функция сравнивает информацию версии системы нужными дан ными параметр dwlconditionmask устанавливает правила сравнения сложный бор битовых комбинаций создания требуемой комбинации используйте макрос versetcondit versetcondit dwordlong dwlconditionmask ulong dwtypebitmask ulong dwconditionmask первый параметр dwlconditionmask идентифицирует переменную битами кото рой манипулируете передаете адрес переменной verset condit   макрос функция параметр dwtypebitmask указывает элемент структуре osversioninfoex который хотите сравнить своими данными сравнения нескольких элементов придется обращаться versetcondit сколько подряд флаги передаваемые параметре идентичны передавае мым параметре dwtypemask функции verifyversioninfo 63 ч т ь ii начинаем работать последний параметр макроса versetcondit dwconditionmask сообщает хотите проводить сравнение принимает одно следующих значений verequ vergreat vergreaterequ verless verlessequ можете использовать значения сравнениях verproducttyp например значение verntworkst меньше verntserv сравнениях versuitenam вместо этих значений применяется verand должны установ лены программные пакеты veror должен установлен хотя программных пакетов подготовив набор условий вызываете verifyversioninfo получаете ненулевое значение система отвечает требованиям вашего приложения 0 удовлетворяет этим требованиям неправильно вызвали функцию определить почему verifyversioninfo вернула 0 вызовите getlasterror та вернет erroroldwinvers значит правильно вызвали функцию verifi versioninfo система соответствует предъявленным требованиям проверить установлена window 2000 готовим структуру osversioninfoex сообщая нам нужна window 2000 osversioninfoex osver 0 osverdwosversioninfos sizeofosv osverdwmajorvers 5 osverdwminorvers 0 osverdwplatformid verplatformwin32nt формируем маску условий dwordlong dwlconditionmask 0 инициализируйте элемент versetconditiondwlconditionmask vermajorvers verequ versetconditiondwlconditionmask verminorvers verequ versetconditiondwlconditionmask verplatformid verequ проверяем версию if verifyversioninfoosv vermajorvers verminorvers verplatformid dwlconditionmask хостсистема точно соответствует window 2000 els хостсистема является window 2000 функция createprocess процесс создается вызове вашим приложением функции createprocess bool createprocess pctstr pszapplicationnam ptstr pszcommandlin psecurityattribut psaprocess psecurityattribut psathread bool binherithandl dword fdwcreat pvoid pvenviron pctstr pszcurdir pstartupinfo psistartinfo pprocessinform ppiprocinfo 64 г л 4 процессы поток приложении вызывает createprocess система создает объект ядра  процесс  начальным значением счетчика числа пользователей равным 1 объект   процесс компактная структура данных которую операци онная система управляет процессом объект ядра  процесс  следует рассматривать структуру данных статистической информацией процессе затем система создает нового процесса виртуальное адресное пространство загружает код данные исполняемого файла любых dll таковые требу ются далее система формирует объект ядра  поток  счетчиком равным 1 пер вичного потока нового процесса первом случае объект ядра  поток    это компактная структура данных которую система управляет потоком первичный поток начинает исполнения стартового кода библиотеки cc который ко нечном счете вызывает функцию winmain wwinmain main wmain вашей грамме системе удастся создать новый процесс первичный поток creat process вернет true createprocess возвращает true окончательной инициализации процесса это означает данном этапе загрузчик операционной системы искал необходимые dll сможет найти хотя одну dll корректно провести инициализацию процесс завершится поскольку creat process вернула true родительский процесс узнает этих блемах закончим общее описание перейдем подробному рассмотрению параметров функции createprocess параметры pszapplicationnam pszcommandlin параметры определяют имя исполняемого файла которым пользоваться новый процесс командную строку передаваемую этому процессу начнем pszcom mandlin обратите внимание тип параметра pszcommandlin ptstr означает createprocess ожидает передачи адреса строки которая является констан той дело createprocess процессе своего выполнения модифици рует переданную командную строку возвратом управления восста навливает это очень важно командная строка содержится той части образа вашего файла которая предназначена чтения возникнет ошибка доступа например следующий код приведет ошибке visual c 60 поместит строку  notepad  память чтения startupinfo si sizeofsi processinform pi createprocessnul textnotepad null null fals 0 null null si pi createprocess попытается модифицировать строку произойдет ошиб ка доступа прежних версиях visual c эта строка размещена памяти чтения записи вызовы createprocess приводили ошиб кам доступа см след стр 65 ч т ь ii начинаем работать лучший способ решения проблемы   вызовом createprocess ко пировать константную строку временный буфер startupinfo si sizeofsi processinform pi tchar szcommandlin textnotepad createprocessnul szcommandlin null null fals 0 null null si pi возможно заинтересуют ключи gf gf компилятора visual c ко торые исключают дублирование строк запрещают размещение области чтения также обратите внимание ключ zi который позволяет задействовать отладочную функцию edit continu поддерживаемую visual studio подразумевает активизацию ключа gf общем лучшее може те сделать   использовать ключ gf создать временный буфер microsoft исправит функцию createprocess та морочила нам голову надеюсь следующей версии window кстати вызове ansiверсии createprocess window 2000 таких блем поскольку версии функции командная строка копируется временный буфер см главу 2 параметр pszcommandlin позволяет указать полную командную строку исполь зуемую функцией createprocess создании нового процесса разбирая строку функция полагает первый компонент представляет собой имя исполняе мого файла который хотите запустить имени файла указано рас ширение считает exe далее функция приступает поиску заданного файла делает это следующем порядке 1 каталог содержащий exeфайл вызывающего процесса 2 текущий каталог вызывающего процесса 3 системный каталог window 4 основной каталог window 5 каталоги перечисленные переменной окружения path имени файла указан полный путь доступа система сразу обраща ется туда просматривает каталоги найдя нужный исполняемый файл создает новый процесс проецирует код данные исполняемого файла адресное пространство процесса затем обращается процедурам стартового кода библиотеки cc очередь говорилось анализирует командную строку процесса передает wwinmain адрес первого именем исполняемого фай ла аргумента pszcmdline произойдет параметр pszapplicationnam равен null бывает 99 случаев вместо null передать адрес строки име нем исполняемого файла который запустить однако придется указать имя расширение поскольку случае имя дополняется рас ширением exe автоматически createprocess предполагает файл находится те кущем каталоге полный путь задан текущем каталоге файла функция станет искать других каталогах закончится указанном pszapplicationnam имени файла createprocess равно передает новому процессу содержимое параметра pszcommandlin командную строку допустим вызвали createprocess 66 г л 4 процессы размещаем строку пути области памяти чтения записи tchar szpath textwordpad readmetxt порождаем новый процесс createprocesstextcwinntsystem32notepadex szpath система запускает notepad командной строке видим  wordpad readmetxt  странно работает эта функция createprocess упо мянутая возможность которую обеспечивает параметр pszapplicationnam самом деле введена createprocess поддержки подсистемы posix window 2000 параметры psaprocess psathread binherithandl создать новый процесс система должна сначала создать объекты ядра   цесс   поток  первичного потока процесса поскольку это объекты ядра ро дительский процесс получает возможность связать ними атрибуты защиты пара метры psaprocess psathread позволяют определить нужные атрибуты защиты объектов  процесс   поток  соответственно параметры занести null система закрепит данными объектами дескрипторы защиты умолчанию качестве альтернативы объявить инициализировать две структуры secu rityattribut самым создадите присвоите объектам  процесс    ток  свои атрибуты защиты структуры securityattribut параметров psaprocess psathread исполь зуются либо этих двух объектов получил статус наследуе мого любым дочерним процессом теории которой построено наследование описателей объектов ядра рассказывал главе 3 короткая программа рис 42 демонстрирует наследуются описатели объек тов ядра будем считать процесс a порождает процесс b заносит параметр psaprocess адрес структуры securityattribut которой элемент binherithandl установлен true одновременно параметр psathread указывает другую струк туру securityattribut которой значение элемента binherithandl   fals создавая процесс b система формирует объекты ядра  процесс   поток    структуре которую указывает параметр ppiprocinfo нем поговорим поз   возвращает описатели процессу a момента манипули ровать созданными объектами  процесс   поток  предположим процесс a собирается вторично вызвать функцию creat process породить процесс c сначала нужно определить стоит предос тавлять процессу c доступ своим объектам ядра используется параметр binherithandl приравнен true система передает процессу c наследуе мые описатели случае наследуется описатель объекта ядра  процесс  цесса b описатель объекта  первичный поток  процесса b наследуется каком значении binherithandl кроме процесс a вызывает creat process передавая параметр binherithandl значение fals процесс c насле дует никаких описателей используемых данный момент процессом a 67 ч т ь ii начинаем работать inheritc модуль inheritc автор copyright c 2000 джеффри рихтер jeffrey richter includ windowsh int winapi winmainhinst hinstex hinstanc pstr pszcmdline int ncmdshow готовим структуру startupinfo создания процессов startupinfo si sizeofsi securityattribut saprocess sathread processinform piprocessb piprocessc tchar szpathmaxpath готовимся созданию процесса b процесса a описатель идентифицирующий новый объект процесс должен наследуемым saprocessnlength sizeofsaprocess saprocesslpsecuritydescriptor null saprocessbinherithandl true описатель идентифицирующий новый объект поток должен наследуемым sathreadnlength sizeofsathread sathreadlpsecuritydescriptor null sathreadbinherithandl fals порождаем процесс b lstrcpyszpath textprocessb createprocessnul szpath saprocess sathread fals 0 null null si piprocessb структура pi содержит описателя относящиеся процессу a hprocess который идентифицирует объект процесс процесса b является наследуемым hthread который идентифицирует объект первичный поток процесса b является наследуемым готовимся создать процесс c процесса a psaprocess psathread передаются null описатели объектов процесс первичный поток процесса c считаются ненаследуемыми умолчанию процесс a создаст процесс унаследует описатели объектов процесс первичный поток процесса c поскольку параметре binherithandl передается true процесс c унаследует описатель идентифицирующий объект процесс процесса b описатель идентифицирующий объект рис 42 пример иллюстрирующий наследование описателей объектов ядра 68 г л 4 процессы рис 42 продолжение первичный поток процесса lstrcpyszpath textprocessc createprocessnul szpath null null true 0 null null si piprocessc return0 параметр fdwcreat параметр fdwcreat определяет флаги влияющие именно создается новый процесс флаги комбинируются булевым оператором or 쐽 флаг debugprocess дает возможность родительскому процессу проводить отладку дочернего также процессов которые последним могут порождены флаг установлен система уведомляет родительский цесс получает статус отладчика возникновении определенных событий любом дочерних процессов получают статус отлаживае мых 쐽 флаг debugonlythisprocess аналогичен флагу debugprocess исключением заставляет систему уведомлять родительский процесс воз никновении специфических событий одном дочернем процессе   прямом потомке дочерний процесс создаст ряд дополнительных отладчик уведомляется событиях  происходящих  쐽 флаг createsuspend позволяет создать процесс время приоста новить первичный поток это позволяет родительскому процессу модифи цировать содержимое памяти адресном пространстве дочернего изменять приоритет первичного потока включать процесс задание job получит шанс выполнение внеся нужные изменения черний процесс родительский разрешает выполнение кода вызовом фун кции resumethread см главу 7 쐽 флаг detachedprocess блокирует доступ процессу инициированному кон сольной программой созданному родительским процессом консольному окну сообщает системе вывод следует перенаправить новое окно cui процесс создаваемый другим cuiпроцессом умолчанию использует кон сольное окно родительского процесса очевидно заметили пуске компилятора c командного процессора новое консольное окно создается весь вывод  подписывается  нижнюю часть существующего консольного окна таким образом флаг заставляет новый процесс пере направлять свой вывод новое консольное окно 쐽 флаг createnewconsol приводит созданию нового консольного окна нового процесса имейте виду одновременная установка флагов createnewconsol detachedprocess недопустима 쐽 флаг createnowindow дает создавать никаких консольных окон данного приложения самым позволяет исполнять пользователь ского интерфейса 69 ч т ь ii начинаем работать 쐽 флаг createnewprocessgroup служит модификации списка процес сов уведомляемых нажатии клавиш ctrlc ctrlbreak системе од новременно исполняется несколько cuiпроцессов нажатии одной упомянутых комбинаций клавиш система уведомляет процес сы включенные группу указав флаг создании нового cuiпроцес са создаете новую группу 쐽 флаг createdefaulterrormod сообщает системе новый процесс должен наследовать режимы обработки ошибок установленные родитель ском см раздел рассказывал функции seterrormod 쐽 флаг createseparatewowvdm полезен запуске 16разрядно го windowsприложения window 2000 установлен система созда ет отдельную виртуальную dosмашину virtual dosmachin vdm запус кает 16разрядное windowsприложение именно умолчанию 16 разрядные windowsприложения выполняются одной общей vdm выпол нение приложения отдельной vdm дает большое преимущество  рухнув  приложение уничтожит лишь vdm программы выполняемые других vdm продолжат нормальную работу кроме 16разрядные window ложения выполняемые раздельных vdm имеют раздельные очереди вво это значит одно приложение  зависнет  приложения других vdm продолжат прием ввода единственный недостаток работы нес колькими vdm каждая требует значительных объемов физи ческой памяти window 98 выполняет 16разрядные windowsприложения одной vdm изменить 쐽 флаг createsharedwowvdm полезен запуске 16разрядного windowsприложения window 2000 умолчанию 16разрядные windowsприложения выполняются одной vdm указан флаг createseparatewowvdm однако стандартное поведение window 2000 изменить присвоив значение  yes  параметру defaultseparatevdm разделе hkeylocalmachinesystemcurrentcontrolsetcontrolwow пос ле модификации параметра систему перезагрузить установив зна чение  yes  указав флаг createsharedwowvdm вновь заставите window 2000 выполнять 16разрядные windowsприложения одной vdm 쐽 флаг createunicodeenviron сообщает системе блок перемен ных окружения дочернего процесса должен содержать unicodeсимволы умолчанию блок формируется основе ansiсимволов 쐽 флаг createforcedo заставляет систему выполнять программу msdos встроенную 16разрядное приложение os2 쐽 флаг createbreakawayfromjob позволяет процессу включенному дание создать новый процесс отделенный задания см главу 5 параметр fdwcreat разрешает задать класс приоритета процесса однако это необязательно правило рекомендуется система присваивает новому процессу класс приоритета умолчанию возможные классы приоритета перечис лены следующей таблице 70 г л 4 процессы класс приоритета флаговый идентификатор idl простаивающий idlepriorityclass below normal ниже обычного belownormalpriorityclass normal обычный normalpriorityclass abov normal выше обычного abovenormalpriorityclass high высокий highpriorityclass realtim реального времени realtimepriorityclass классы приоритета влияют распределение процессорного времени цессами потоками подробнее тему см главу 7 классы приоритета belownormalpriorityclass abovenorm priorityclass введены лишь window 2000 поддерживаются win dow nt 40 window 95 window 98 параметр pvenviron параметр pvenviron указывает блок памяти хранящий строки переменных окружения которыми пользоваться новый процесс обычно вместо па раметра передается null результате дочерний процесс наследует строки пе ременных окружения родительского процесса качестве альтернативы вызвать функцию getenvironmentstr pvoid getenvironmentstr позволяет узнать адрес блока памяти строками переменных окружения используемых вызывающим процессом полученный адрес занести параметр pvenviron функции createprocess именно это делает createprocess передаете null вместо pvenviron блок памяти жен освободите вызвав функцию freeenvironmentstr bool freeenvironmentstringsptstr pszenvironmentblock параметр pszcurdir позволяет родительскому процессу установить текущие диск каталог дочер процесса значение   null рабочий каталог нового процесса приложения породившего отличен null должен ука зывать строку нулевым символом конце содержащую нужный диск каталог заметьте путь включать букву диска параметр psistartinfo параметр указывает структуру startupinfo typedef struct startupinfo dword cb pstr lpreserv pstr lpdesktop pstr lptitl dword dwx dword dwi см след стр 71 ч т ь ii начинаем работать dword dwxsize dword dwysiz dword dwxcountchar dword dwycountchar dword dwfillattribut dword dwflag word wshowwindow word cbreserved2 pbyte lpreserved2 handl hstdinput handl hstdoutput handl hstderror startupinfo lpstartupinfo элементы структуры startupinfo используются windowsфункциями созда нии нового процесса большинство приложений порождает процес сы атрибутами умолчанию случае должны инициализировать элементы структуры startupinfo хотя нулевыми значениями элемент cb   заносить размер структуры startupinfo si sizeofsi createprocess si сожалению разработчики приложений часто забывают необходимости ини циализации структуры обнулите элементы содержать ся мусор оставшийся стеке вызывающего потока функция createprocess получив такую структуру данных либо создаст новый процесс либо   зависит именно окажется мусоре понадобится изменить какие элементы структуры делайте это пе ред вызовом createprocess элементы структуры подробно рассматриваются таблице 43 заметьте некоторые элементы имеют смысл чернее приложение создает перекрываемое overlap окно другие   это приложение осуществляет вводвывод консоль элемент окно консоль описание cb другое содержит количество байтов занимаемых структу рой startupinfo служит контроля версий   случай microsoft расширит структуру будущем программа должна инициализировать cb sizeofstartupinfo lpreserv другое зарезервирован инициализируйте null lpdesktop другое идентифицирует имя рабочего стола котором пускается приложение указанный рабочий стол существует новый процесс сразу связывается ином случае система сначала создает рабочий стол атрибутами умолчанию присваивает имя указанное данном элементе структуры свя зывает новым процессом lpdesktop равен null чаще бывает процесс связывается текущим рабочим столом lptitl консоль определяет заголовок консольного окна lptitl   null заголовок выводится имя исполняе мого файла таблица 43 элементы структуры startupinfo 72 г л 4 процессы продолжение элемент окно консоль описание dwx другое указывают x yкоординаты пикселах окна dwi приложения координаты используются дочерний процесс создает свое первое перекры ваемое окно идентификатором cwusedefault параметре x функции createwindow приложениях создающих консольные окна данные элементы опре деляют верхний левый угол консольного окна dwxsize другое определяют ширину высоту пикселах окна dwysiz приложения значения используются дочерний процесс создает свое первое перекрывае мое окно идентификатором cwusedefault па раметре nwidth функции createwindow приложени ях создающих консольные окна данные элементы определяют ширину высоту консольного окна dwxcountchar консоль определяют ширину высоту символах dwycountchar консольных окон дочернего процесса dwfillattribut консоль задает цвет текста фона консольных окнах дочернего процесса dwflag другое см ниже следующую таблицу wshowwindow окно определяет именно должно выглядеть первое пе рекрываемое окно дочернего процесса прило жение первом вызове функции showwindow пе редает параметре ncmdshow идентификатор swshowdefault элемент записать любой идентификаторов типа sw обычно ис пользуемых вызове showwindow cbreserved2 другое зарезервирован инициализируйте 0 lpreserved2 другое зарезервирован инициализируйте null hstdinput консоль определяют описатели буферов консольного hstdoutput вводавывода умолчанию hstdinput идентифи hstderror цирует буфер клавиатуры hstdoutput hstderror   буфер консольного окна обещал обсудим элемент dwflag содержит набор флагов зволяющих управлять созданием дочернего процесса бо льшая часть флагов просто сообщает функции createprocess содержат прочие элементы структуры start upinfo полезную информацию некоторые игнорировать список допустимых флагов приведен следующей таблице флаг описание startfuses заставляет использовать элементы dwxsize dwysiz startfuseshowwindow заставляет использовать элемент wshowwindow startfuseposit заставляет использовать элементы dwx dwi startfusecountchar заставляет использовать элементы dwxcountchar dwycountchar startfusefillattribut заставляет использовать элемент dwfillattribut startfusestdhandl заставляет использовать элементы hstdinput hstdoutput hstderror см след стр 73 ч т ь ii начинаем работать продолжение флаг описание startfrunfullscreen приводит тому консольное приложение компью тере процессором типа x86 запускается полноэкран ном режиме дополнительных флага   startfforceonfeedback startfforceoff feedback   позволяют контролировать форму курсора мыши момент запуска вого процесса поскольку window поддерживает истинную вытесняющую многоза дачность запустить одно приложение пока оно инициализируется пора ботать программой визуальной обратной связи пользователем функ ция createprocess временно изменяет форму системного курсора мыши курсор формы подсказывает либо подождать случится либо продолжить работу системе укажете флаг startf forceofffeedback createprocess станет добавлять  песочные часы  стандарт ной стрелке флаг startfforceonfeedback заставляет createprocess отслеживать инициали зацию нового процесса зависимости результата проверки изменять форму кур сора функция createprocess вызывается этим флагом курсор преобразуется  песочные часы  спустя две секунды нового процесса поступает gui зов восстанавливает исходную форму курсора течение двух секунд процесс делает guiвызов createprocess ждет приложение откроет свое окно это должно произойти течение пяти секунд guiвызова окно появилось createprocess восстанавливает курсор появилось   сохраняет виде  песочных часов  пять секунд приложение вызовет функцию getmessag сообщая самым оно закончило инициализацию createprocess немедленно сменит курсор стандартный прекра тит мониторинг нового процесса заключение раздела   несколько слов элементе wshowwindow структуры startupinfo элемент инициализируется значением которое передаете wwinmain последний параметр ncmdshow позволяет указать каком виде должно появиться главное окно вашего приложения качестве значения ис пользуется идентификаторов обычно передаваемых showwindow чаще swshownorm swshowminnoact swshow default запуска программы explor функция wwinmain вызывается swshownorm параметре ncmdshow создаете ярлык можете указать свойствах каком виде должно появляться главное окно рис 43 показано окно свойств ярлыка notepad обратите внимание список run котором выбирается начальное состояние окна notepad активизируете ярлык explor последний создает инициали зирует структуру startupinfo затем вызывает createprocess это приводит запус ку notepad функция wwinmain получает swshowminnoact параметре ncmdshow таким образом пользователь легко выбирать каком окне запускать грамму   нормальном свернутом развернутом 74 г л 4 процессы рис 43 окно свойств ярлыка notepad получить копию структуры startupinfo инициализированной родительским процессом приложение вызвать void getstartupinfopstartupinfo pstartupinfo анализируя структуру дочерний процесс изменять свое поведение зависимости значений элементов хотя документации window четко сказано вызовом getstartupinfo нужно инициализировать элемент cb структуры startupinfo startupinfo si sizeofsi getstartupinfosi m параметр ppiprocinfo параметр ppiprocinfo указывает структуру processinform которую должны предварительно создать элементы инициализируются самой функцией createprocess структура представляет собой следующее typedef struct processinform handl hprocess handl hthread dword dwprocessid dword dwthreadid processinform создание нового процесса влечет собой создание объектов ядра  процесс   поток  момент создания система присваивает счетчику каждого объекта начальное значение   единицу далее функция createprocess самым возвратом управления открывает объекты  процесс   поток  заносит описа тели специфичные данного процесса элементы hprocess hthread структуры processinform createprocess открывает объекты счетчики каждого увеличиваются 2 75 ч т ь ii начинаем работать это означает система сможет высвободить памяти объект  процесс  процесс должен завершен счетчик уменьшен 1 родительский процесс обязан вызвать функцию closehandl самым обнулить счетчик самое относится объекту  поток  поток должен завершен родительский процесс должен закрыть описатель объекта  поток  подробнее освобождении объектов  поток  см раздел  дочерние процессы  главе забывайте закрывать описатели дочернего процесса первичного тока иначе пока закроете свое приложение происходить утечка ресурсов система высвободит ресурсы завершения вашего процесса написанная программа должна сама закрывать описатели дочернего процесса первичного потока необхо димость отпадает пропуск операции   одна самых частых ошибок почему многие разработчики считают закрытие описателя цесса потока заставляет систему уничтожить процесс поток это абсолютно неправильно закрывая описатель просто сообщаете системе статистические данные процесса потока ин тересуют процесс поток продолжает исполняться системой тех пор пока завершит созданному объекту ядра  процесс  присваивается уникальный идентификатор каких других объектов типа системе одинаковых иденти фикаторов это касается объектов ядра  поток  причем идентификаторы цесса потока разные значения бывают нулевыми завершая работу createprocess заносит значения идентификаторов элементы dwprocessid dwthreadid структуры processinform идентификаторы просто облег чают определение процессов потоков системе используют правило лишь специализированные утилиты вроде task manag подчеркну чрезвычайно важный момент система способна повторно использовать идентификаторы процессов потоков например создании цесса система формирует объект  процесс  присваивая идентификатор зна чением допустим 122 создавая новый объект  процесс  система присвоит данный идентификатор выгрузки памяти первого объекта следу ющему создаваемому объекту  процесс  присвоен идентифика тор   122 особенность нужно учитывать написании кода избегая ссылок невер ный объект  процесс   поток  действительно затребовать сохранить иден тификатор процесса несложно задумайтесь получится следующий момент процесс завершен новый получит идентификатор сохра ненный ранее идентификатор связан другим процессом программе приходится определять свой родительский процесс однако родственные связи процессами существуют лишь стадии создания дочер процесса непосредственно началом исполнения кода дочернем процес се window перестает учитывать родственные связи предыдущих версиях win dow функций которые позволяли программе обращаться запросом родительскому процессу toolhelpфункции появившиеся современных вер сиях window сделали это возможным целью должны использовать струк туру processentry32 элемент th32parentprocessid возвращает идентификатор  родителя  данного процесса менее вашей программе нужно взаимодей 76 г л 4 процессы ствовать родительским процессом идентификаторов отказаться почему   определения родительского процесса существуют надежные механизмы объекты ядра описатели окон т д единственный способ добиться идентификатор процесса потока использовался повторно   допускать разрушения объекта ядра  процесс   поток  создали новый процесс поток можете просто закрывать описатели объекты   окончании операций иден тификатором вызовите функцию closehandl освободите соответствующие объек ядра однако дочернего процесса способ годится унаследовал описатели объектов ядра родительского процесса завершение процесса процесс завершить четырьмя способами 쐽 входная функция первичного потока возвращает управление рекомендуемый способ 쐽 потоков процесса вызывает функцию exitprocess нежелательный спо соб 쐽 поток другого процесса вызывает функцию terminateprocess нежелательно 쐽 потоки процесса умирают своей воле большая редкость разделе обсудим перечисленные способы завершения цесса также рассмотрим самом деле происходит момент окончания возврат управления входной функцией первичного потока приложение следует проектировать процесс завершался возврата управления входной функцией первичного потока это единственный спо соб гарантирующий корректную очистку ресурсов принадлежавших первично му потоку 쐽 любые cобъекты созданные данным потоком уничтожаются соответству ющими деструкторами 쐽 система освобождает память которую занимал стек потока 쐽 система устанавливает код завершения процесса поддерживаемый объектом ядра  процесс    возвращает ваша входная функция 쐽 счетчик пользователей данного объекта ядра  процесс  уменьшается 1 функция exitprocess процесс завершается потоков вызывает exitprocess void exitprocessuint fuexitcod эта функция завершает процесс заносит параметр fuexitcod код завершения процесса возвращаемого значения exitprocess результат действия   завершение процесса вызовом функции программе присутствует ка кой код исполняется входная функция winmain wwinmain main wmain вашей програм ме возвращает управление оно передается стартовому коду библиотеки cc проводит очистку ресурсов выделенных процессу затем обращается 77 ч т ь ii начинаем работать exitprocess передавая значение возвращенное входной функцией почему воз врат управления входной функцией первичного потока приводит завершению го процесса обратите внимание завершении процесса прекращается выпол нение других потоков кстати документации platform sdk утверждается процесс завершает ся тех пор пока завершится выполнение потоков это верно одна тонкость стартовый код библиотеки cc обеспечивает завер шение процесса вызывая exitprocess первичный поток вашего прило жения возвращается входной функции однако вызвав функцию exitthread вместо вызвать exitprocess просто вернуть управление заверши те первичный поток процесс   нем выполняется дру гой поток потоки заметьте вызов exitprocess exitthread приводит уничтожению процесса потока выполнение функции завершилось касается операционной системы порядке корректно очистит ресурсы выделенные процессу потоку приложении написанном cc следует избегать вызова этих функций библиотеке cc скорее удастся провести должную очистку взгляните код includ windowsh includ stdioh class csomeobj public csomeobj printfconstructorrn csomeobj printfdestructorrn csomeobj gglobalobj void main csomeobj localobj exitprocess0 должно конце функции компилятор автоматически вставил код вызова деструктора localobj exitprocess дает выполнить выполнении увидите constructor constructor код конструирует объекта глобальный локальный увиди те строку destructor cобъекты разрушаются должным образом exitprocess форсирует уничтожение процесса библиотека cc получает шанса очистку вызывайте exitprocess явном виде уберу предыдущего примера вызов exitprocess программа выведет такие строки constructor constructor destructor destructor 78 г л 4 процессы простой возврат управления входной функции первичного потока позволил библиотеке cc провести нужную очистку корректно разрушить cобъекты кстати рассказал относится объектам ко многим дру гим вещам которые библиотека cc делает вашего процесса явные вызовы exitprocess exitthread   распространенная ошибка которая мешает правильной очистке ресурсов случае exitthread процесс продолжа ет работать весьма вероятна утечка памяти других ресурсов функция terminateprocess вызов функции terminateprocess завершает процесс bool terminateprocess handl hprocess uint fuexitcod главное отличие функции exitprocess вызвать любой поток завершить любой процесс параметр hprocess идентифицирует описатель завершаемого процесса параметре fuexitcod возвращается код завершения цесса пользуйтесь terminateprocess лишь случае иным способом завершить процесс удается процесс получает абсолютно никаких уведомлений завершается приложение выполнить очистку предотвратить свое неожиданное завершение оно использует механизмы защиты теряются данные которые процесс успел переписать памяти диск процесс действительно имеет малейшего шанса самому провести очистку операционная система высвобождает принадлежавшие ресурсы возвраща ет выделенную память закрывает любые открытые файлы уменьшает счет чики соответствующих объектов ядра разрушает user gdiобъекты завершении процесса важно каким способом система гарантирует останется   намеков выполнялся завер шенный процесс оставляет собой никаких следов надеюсь ясно terminateprocess   функция асинхронная т е сообщает системе хотите завершить процесс тому времени вернет управление процесс уничтожен нужно точно знать момент завершения процесса используйте waitforsingleobject см главу 9 аналогичную функцию передав описатель процесса потоки процесса уходят ситуации возникнуть потоки вызвали exitthread закрыли вызовом terminatethread операционная система считает нуж ным  содержать  адресное пространство данного процесса обнаружив процес се исполняется поток немедленно завершает код вершения процесса приравнивается коду завершения последнего потока 79 ч т ь ii начинаем работать происходит завершении процесса происходит 1 выполнение потоков процессе прекращается 2 user gdiобъекты созданные процессом уничтожаются объекты ядра закрываются использует процесс 3 код завершения процесса меняется значения stillact код передан ный exitprocess terminateprocess 4 объект ядра  процесс  переходит свободное незанятое signal состо яние подробнее тему см главу 9 прочие потоки системе могут остановить свое выполнение вплоть завершения данного процесса 5 счетчик объекта ядра  процесс  уменьшается 1 связанный завершаемым процессом объект ядра высвобождается пока будут закрыты ссылки других процессов момент завершения процесса система автоматически уменьшает счетчик пользователей объекта 1 объект разрушается счетчик обнуляется кроме закрытие процесса приводит автоматическому завершению порожденных процессов завершении процесса код выделенные ресурсы удаляются памяти однако область памяти выделенная системой объекта ядра  процесс  осво бождается пока счетчик числа пользователей достигнет нуля это произой дет прочие процессы создавшие открывшие описатели ныне койного процесса уведомят систему вызовом closehandl ссылки процесс нужны описатели завершенного процессса мало пригодны роди тельский процесс вызвав функцию getexitcodeprocess проверить завершен процесс идентифицируемый параметром hprocess определить код завер шения bool getexitcodeprocess handl hprocess pdword pdwexitcod код завершения возвращается значение типа dword которое указывает pdwexitcod момент вызова getexitcodeprocess процесс завершился dword заносится идентификатор stillact определенный 0x103 уничтожен функция возвращает реальный код завершения вероятно подумали написать код который периодически вызы вая функцию getexitcodeprocess проверяя возвращаемое ею значение определял момент завершения процесса принципе код мог сработать многих ситуациях неэффективен правильно решить задачу расскажу следующем разделе дочерние процессы разработке приложения часто бывает нужно какую операцию выпол нял блок кода поэтому   хочешь хочешь   приходится постоянно вызы вать функции подпрограммы вызов функции приводит приостановке полнения основного кода вашей программы возврата вызванной функции аль тернативный способ   передать выполнение операции другому потоку пределах данного процесса поток разумеется нужно сначала создать это позво 80 г л 4 процессы лит основному коду программы продолжить работу время дополнительный поток выполнять другую операцию прием весьма удобный основно му потоку потребуется узнать результаты работы другого потока избежать проблем связанных синхронизацией прием ваш процесс порождает дочерний возлагает полнение части операций будем считать операции очень сложны допустим реализации просто создаете новый поток внутри процесса пишете иной код тестируете получаете некорректный результат   ошиблись алгоритме запутались ссылках случайно перезаписали какие важные данные адресном пространстве своего процесса способов защитить адресное пространство основного процесса подобных оши бок состоит передать часть работы отдельному процессу далее подождать пока завершится продолжить работу параллельно сожалению дочернему процессу видимому придется оперировать данны ми содержащимися адресном пространстве родительского процесса плохо работал исключительно своем адресном пространстве  ва шем    просто считывал нужные данные сможет испортить адресном пространстве родительского процесса window предусмотрено несколько способов обмена данными процессами dde dynam data exchang ole каналы pipe почтовые ящики mailslot т д самых удобных способов обеспечивающих совместный доступ данным   использование файлов проециру емых память memorymap file подробнее тему см главу 17 хотите создать новый процесс заставить выполнить какиелибо опе рации дождаться результатов напишите примерно код processinform pi dword dwexitcod порождаем дочерний процесс bool fsuccess createprocess pi if fsuccess закрывайте описатель потока необходимость нем отпадает closehandlepihthread приостанавливаем выполнение родительского процесса пока завершится дочерний процесс waitforsingleobjectpihprocess infinit дочерний процесс завершился получаем код завершения getexitcodeprocesspihprocess dwexitcod закрывайте описатель процесса необходимость нем отпадает closehandlepihprocess фрагменте кода создали новый процесс это прошло успешно вызвали функцию waitforsingleobject dword waitforsingleobjecthandl hobject dword dwtimeout подробное рассмотрение данной функции отложим главы 9 ог раничимся одним соображением функция задерживает выполнение кода тех пор 81 ч т ь ii начинаем работать пока объект определяемый параметром hobject перейдет свободное незанятое состояние объект  процесс  переходит такое состояние завершении этому вызов waitforsingleobject приостанавливает выполнение потока родительского процесса завершения порожденного процесса waitforsingleobject вернет управление узнаете код завершения дочернего процесса функцию get exitcodeprocess обращение closehandl приведенном выше фрагменте кода заставляет систе му уменьшить значения счетчиков объектов  поток   процесс  нуля самым освободить память занимаемую этими объектами наверное заметили фрагменте закрыл описатель объекта ядра  первичный поток  принадлежащий дочернему процессу сразу возврата createprocess это приводит завершению первичного потока дочернего процес са   просто уменьшает счетчик связанный упомянутым объектом почему это делается   кстати рекомендуется делать   именно станет ясно стого примера допустим первичный поток дочернего процесса порождает поток завершается момент система высвободить объект  первичный поток  дочернего процесса памяти родительского цесса описателя данного объекта родительский процесс располагает таким описателем система сможет удалить объект памяти тех пор пока родительский процесс закроет описатель запуск обособленных дочерних процессов говори чаще приложение таки создает другие процессы обособ ленные detach process это значит создания запуска нового процесса родительскому процессу нужды взаимодействовать ждать пока закончит работу именно действует explor запускает пользователя новые процессы дальше волнует ними происходит обрубить пуповины связывающие explor дочерним процессом нужно вызовом closehandl закрыть свои описатели связанные новым процессом первичным потоком приведенный ниже фрагмент кода демонстрирует создав процесс сделать обособленным processinform pi bool fsuccess createprocess pi if fsuccess разрешаем системе уничтожить объекты ядра процесс поток сразу завершения дочернего процесса closehandlepihthread closehandlepihprocess перечисление процессов выполняемых системе многие разработчики программного обеспечения пытаются создавать инструмен тальные средства утилиты window требующие перечисления процессов выполняемых системе изначально window api функций которые зволяли это делать однако window nt ведется постоянно обновляемая база данных perform data содержится тонна информации доступ ной функции реестра вроде regqueryvalueex которой указать корне 82 г л 4 процессы вой раздел hkeyperformancedata мало программистов знает базе данных причины тому кроются взгляд следующем 쐽 предусмотрено никаких специфических функций нужно исполь зовать обычные функции реестра 쐽 window 95 window 98 쐽 структура информации базе данных очень сложна многие просто бегают ею пользоваться другим советуют упростить работу базой данных microsoft создала набор функций общим названием perform data helper содержащийся pdhdll интересует подробная информация библиотеке pdhdll ищите раздел функциям perform data helper документации platform sdk упоминал window 95 window 98 базы данных вместо предусмотрен набор функций позволяющих перечислять процессы вклю чены toolhelp api информацией вновь отсылаю документации platform sdk   ищите разделы функциям process32first process32next самое смешное разработчики window nt которым toolhelpфункции явно нравятся включили window nt перечисления процессов создали свой набор функций общим названием process status содержащийся psapidl ищите документации platform sdk раздел функции enum process microsoft которая сих пор похоже старалась усложнить разработчи кам инструментальных средств утилит включила toolhelpфункции win dow 2000 разработчики смогут унифицировать свой код хотя window 95 window 98 window 2000 программапример processinfo эта программа  04 processinfoexe  см листинг рис 46 демонстрирует здать очень полезную утилиту основе toolhelpфункций файлы исходного кода ресурсов программы находятся каталоге 04processinfo компактдиске прилага емом книге запуска processinfo открывается окно показанное рис 44 processinfo сначала перечисляет процессы выполняемые системе затем выводит верхний раскрывающийся список имена идентификаторы каждого цесса далее выбирается первый процесс информация нем показывается боль шом текстовом поле доступном чтения видите текущего процес са сообщается идентификатор вместе идентификатором родительского процес са класс приоритета количество потоков выполняемых настоящий момент контексте процесса объяснение большей части информации выходит рамки данной главы рассматриваться последующих главах просмотре списка процессов становится доступен элемент меню vmmap отключается переключаетесь просмотр информации модулях выб рав элемент меню vmmap запускаете программупример vmmap см главу 14 эта программа  проходит  адресному пространству выбранного процесса информацию модулях входит список модулей exe dllфайлов спро ецированных адресное пространство текущего процесса фиксированным моду лем fix modul считается который неявно загружен инициализации процесса явно загруженных dll показываются счетчики числа пользователей этих dll втором столбце выводится базовый адрес памяти который спроеци 83 ч т ь ii начинаем работать рован модуль модуль размещен заданному базовому адресу скобках появляется адрес третьем столбце сообщается размер модуля бай тах последнем   полное вместе путем имя файла модуля внизу показывается информация потоках выполняемых данный момент контек сте текущего процесса отображается идентификатор потока thread id tid приоритет рис 44 processinfo действии дополнение информации процессах можете выбрать элемент меню modu les это заставит processinfo перечислить модули загруженные системе поме стить имена верхний раскрывающийся список далее processinfo выбирает пер вый модуль выводит информацию нем рис 45 режиме утилита processinfo позволяет легко определить каких процес сах задействован данный модуль видите полное имя модуля появляется верх части текстового поля разделе process inform перечисляются процес сы содержащие модуль показываются идентификаторы имена процес сов которые загружен модуль базовые адреса этих процессах информацию утилита processinfo получает основном различных toolhelpфункций чуточку упростить работу toolhelpфункциями создал cкласс ctoolhelp содержащийся файле toolhelph инкапсулирует связано получением  моментального снимка  состояния системы немного облег чает вызов других toolhelpфункций особый интерес представляет функция getmodulepreferredbaseaddr файле pro cessinfocpp pvoid getmodulepreferredbaseaddr dword dwprocessid pvoid pvmoduleremot 84 г л 4 процессы рис 45 processinfo перечисляет процессы адресные пространства которых загружен модуль user32dl принимая идентификатор процесса адрес модуля процессе просмат ривает адресное пространство находит модуль считывает информацию заго ловка модуля определить базовый адрес предпочтителен мо дуль должен загружаться именно этому адресу иначе приложения исполь зующие данный модуль потребуют памяти будут инициализироваться мед леннее поскольку такая ситуация крайне нежелательна утилита сообщает слу чаях модуль загружен предпочтительному базовому адресу темы поговорим главе 20 разделе  модификация базовых адресов модулей  processinfocpp модуль processinfocpp автор copyright c 2000 джеффри рихтер jeffrey richter includ cmnhdrh см приложение a includ windowsxh includ tlhelp32h includ tcharh includ stdargh includ stdioh includ toolhelph includ resourceh рис 46 программапример processinfo см след стр 85 ч т ь ii начинаем работать рис 46 продолжение добавляем строку текстовое поле void addtexthwnd hwnd pctstr pszformat valist arglist vastartarglist pszformat tchar sz20 1024 editgettexthwnd sz chdimofsz vstprintftcschrsz 0 pszformat arglist editsettexthwnd sz vaendarglist void dlgpopulateprocesslisthwnd hwnd hwnd hwndlist getdlgitemhwnd idcprocessmodulelist setwindowredrawhwndlist fals comboboxresetcontenthwndlist ctoolhelp thprocessesth32cssnapprocess processentry32 pe sizeofp bool fok thprocessesprocessfirstp for fok fok thprocessesprocessnextp tchar sz1024 помещаем список имя процесса пути идентификатор pctstr pszexefil tcsrchrpeszexefil text if pszexefil null pszexefil peszexefil els pszexefil пропускаем наклонную черту слэш wsprintfsz text 0x08x pszexefil peth32processid int n comboboxaddstringhwndlist sz сопоставляем идентификатор процесса добавленным элементом comboboxsetitemdatahwndlist n peth32processid comboboxsetcurselhwndlist 0 выбираем первый элемент имитируем выбор пользователем первого элемента текстовом поле появилось интересное forwardwmcommandhwnd idcprocessmodulelist hwndlist cbnselchang sendmessag setwindowredrawhwndlist true invalidaterecthwndlist null fals 86 г л 4 процессы рис 46 продолжение void dlgpopulatemodulelisthwnd hwnd hwnd hwndmodulehelp getdlgitemhwnd idcmodulehelp listboxresetcontenthwndmodulehelp ctoolhelp thprocessesth32cssnapprocess processentry32 pe sizeofp bool fok thprocessesprocessfirstp for fok fok thprocessesprocessnextp ctoolhelp thmodulesth32cssnapmodul peth32processid moduleentry32 me sizeofm bool fok thmodulesmodulefirstm for fok fok thmodulesmodulenextm int n listboxfindstringexacthwndmodulehelp 1 meszexepath if n lberr модуль добавлен listboxaddstringhwndmodulehelp meszexepath hwnd hwndlist getdlgitemhwnd idcprocessmodulelist setwindowredrawhwndlist fals comboboxresetcontenthwndlist int nnummodul listboxgetcounthwndmodulehelp for int i 0 i nnummodul i tchar sz1024 listboxgettexthwndmodulehelp i sz помещаем список имя модуля пути int nindex comboboxaddstringhwndlist tcsrchrsz text 1 сопоставляем индекс полного пути добавленным элементом comboboxsetitemdatahwndlist nindex i comboboxsetcurselhwndlist 0 выбираем первый элемент имитируем выбор пользователем первого элемента текстовом поле появилось интересное forwardwmcommandhwnd idcprocessmodulelist hwndlist cbnselchang sendmessag setwindowredrawhwndlist true invalidaterecthwndlist null fals pvoid getmodulepreferredbaseaddrdword dwprocessid pvoid pvmoduleremot pvoid pvmodulepreferredbaseaddr null см след стр 87 ч т ь ii начинаем работать рис 46 продолжение imagedoshead idh imagenthead inth считываем dosзаголовок удаленного модуля toolhelp32readprocessmemorydwprocessid pvmoduleremot idh sizeofidh null проверяем dosзаголовок образа if idhemag imagedossignatur считываем ntзаголовок удаленного модуля toolhelp32readprocessmemorydwprocessid pbyte pvmoduleremot idhelfanew inth sizeofinth null проверяем ntзаголовок образа if inthsignatur imagentsignatur ntзаголовок корректен получаем предпочтительный базовый адрес данного образа pvmodulepreferredbaseaddr pvoid inthoptionalheaderimagebas returnpvmodulepreferredbaseaddr void showprocessinfohwnd hwnd dword dwprocessid setwindowtexthwnd text очищаем поле вывода ctoolhelp thth32cssnapal dwprocessid показываем подробную информацию процессе processentry32 pe sizeofp bool fok thprocessfirstp for fok fok thprocessnextp if peth32processid dwprocessid addtexthwnd textfilenam srn peszexefil addtexthwnd text pid08x parentpid08x textpriorityclassd threadsd heapsdrn peth32processid peth32parentprocessid pepcpriclassbas pecntthread thhowmanyheap break продолжать цикл нужно показываем модули процессе подсчитываем количество символов вывода адреса const int cchaddress sizeofpvoid 2 addtexthwnd textrnmodul informationrn text usag ss 8s modulern cchaddress textbaseaddr 88 г л 4 процессы рис 46 продолжение cchaddress textimagaddr textsiz moduleentry32 me sizeofm fok thmodulefirstm for fok fok thmodulenextm if meproccntusag 65535 модуль загружен неявно выгрузить addtexthwnd text fix els addtexthwnd text 5d meproccntusag pvoid pvpreferredbaseaddr getmodulepreferredbaseaddrpeth32processid memodbaseaddr if memodbaseaddr pvpreferredbaseaddr addtexthwnd text p s 8u srn memodbaseaddr cchaddress text memodbases meszexepath els addtexthwnd text pp 8u srn memodbaseaddr pvpreferredbaseaddr memodbases meszexepath показываем потоки процессе addtexthwnd textrnthread informationrn text tid priorityrn threadentry32 te sizeoft fok ththreadfirstt for fok fok ththreadnextt if teth32ownerprocessid dwprocessid int nprioriti tetpbasepri tetpdeltapri if tetpbasepri 16 nprioriti 15 nprioriti 15 if tetpbasepri 15 nprioriti 31 nprioriti 31 if tetpbasepri 16 nprioriti 1 nprioriti 1 if tetpbasepri 15 nprioriti 16 nprioriti 16 addtexthwnd text 08x 2drn teth32threadid nprioriti void showmoduleinfohwnd hwnd lpctstr pszmodulepath setwindowtexthwnd text очищаем поле вывода ctoolhelp thprocessesth32cssnapprocess processentry32 pe sizeofp bool fok thprocessesprocessfirstp см след стр 89 ч т ь ii начинаем работать рис 46 продолжение addtexthwnd textpathnam srnrn pszmodulepath addtexthwnd textprocess informationrn addtexthwnd text pid baseaddr processrn for fok fok thprocessesprocessnextp ctoolhelp thmodulesth32cssnapmodul peth32processid moduleentry32 me sizeofm bool fok thmodulesmodulefirstm for fok fok thmodulesmodulenextm if tcscmpmeszexepath pszmodulepath 0 addtexthwnd text 08x p srn peth32processid memodbaseaddr peszexefil bool dlgoninitdialoghwnd hwnd hwnd hwndfocus lparam lparam chsetdlgiconshwnd idiprocessinfo убираем окно списка модулей showwindowgetdlgitemhwnd idcmodulehelp swhide пусть окне результатов используется фиксированный шрифт setwindowfontgetdlgitemhwnd idcresult getstockfontansifixedfont fals умолчанию показываем список выполняемых процессов dlgpopulateprocesslisthwnd returntru bool dlgonsizehwnd hwnd uint state int cx int cy rect rc int n lowordgetdialogbaseunit hwnd hwndctl getdlgitemhwnd idcprocessmodulelist getclientrecthwndctl rc setwindowposhwndctl null n n cx n n rcbottom swpnozord hwndctl getdlgitemhwnd idcresult setwindowposhwndctl null n n rcbottom n cx n n cy n rcbottom n n swpnozord return0 90 г л 4 процессы рис 46 продолжение void dlgoncommandhwnd hwnd int id hwnd hwndctl uint codenotifi static bool sfprocess true switch id case idcancel enddialoghwnd id break case idprocess sfprocess true enablemenuitemgetmenuhwnd idvmmap mfbycommand mfenabl drawmenubarhwnd dlgpopulateprocesslisthwnd break case idmodul enablemenuitemgetmenuhwnd idvmmap mfbycommand mfgray drawmenubarhwnd sfprocess fals dlgpopulatemodulelisthwnd break case idcprocessmodulelist if codenotifi cbnselchang dword dw comboboxgetcurselhwndctl if sfprocess dw dword comboboxgetitemdatahwndctl dw id процесса showprocessinfogetdlgitemhwnd idcresult dw els индекс окне вспомогательного списка dw dword comboboxgetitemdatahwndctl dw tchar szmodulepath1024 listboxgettextgetdlgitemhwnd idcmodulehelp dw szmodulepath showmoduleinfogetdlgitemhwnd idcresult szmodulepath break case idvmmap startupinfo si sizeofsi processinform pi tchar szcmdline1024 hwnd hwndcb getdlgitemhwnd idcprocessmodulelist dword dwprocessid dword comboboxgetitemdatahwndcb comboboxgetcurselhwndcb wsprintfszcmdlin text14 vmmap d dwprocessid bool fok createprocessnul szcmdline null null fals 0 null null si pi см след стр 91 ч т ь ii начинаем работать рис 46 продолжение if fok closehandlepihprocess closehandlepihthread els chmbfail to execut vmmapex break intptr winapi dlgprochwnd hwnd uint umsg wparam wparam lparam lparam switch umsg chhandledlgmsghwnd wminitdialog dlgoninitdialog chhandledlgmsghwnd wmsize dlgonsiz chhandledlgmsghwnd wmcommand dlgoncommand returnfals int winapi twinmainhinst hinstex hinstanc ptstr pszcmdline int ctoolhelpenabledebugprivilegetru dialogboxhinstex makeintresourceiddprocessinfo null dlgproc ctoolhelpenabledebugprivilegefals return0 конец файла toolhelph модуль toolhelph автор copyright c 2000 джеффри рихтер jeffrey richter includ cmnhdrh см приложение a includ tlhelp32h includ tcharh class ctoolhelp privat handl mhsnapshot 92 г л 4 процессы рис 46 продолжение public ctoolhelpdword dwflag 0 dword dwprocessid 0 ctoolhelp bool createsnapshotdword dwflag dword dwprocessid 0 bool processfirstpprocessentry32 ppe const bool processnextpprocessentry32 ppe const bool processfinddword dwprocessid pprocessentry32 ppe const bool modulefirstpmoduleentry32 pme const bool modulenextpmoduleentry32 pme const bool modulefindpvoid pvbaseaddr pmoduleentry32 pme const bool modulefindptstr pszmodnam pmoduleentry32 pme const bool threadfirstpthreadentry32 pte const bool threadnextpthreadentry32 pte const bool heaplistfirstpheaplist32 phl const bool heaplistnextpheaplist32 phl const int howmanyheap const примечание функции оперирующие блоками памяти куче ссылаются снимок просто каждый самого начала просматривают кучу процесса исследуемый процесс изменит кучу любая этих функций перечислять блоки куче возможно вхождение бесконечный цикл bool heapfirstpheapentry32 phe dword dwprocessid uintptr dwheapid const bool heapnextpheapentry32 phe const int howmanyblocksinheapdword dwprocessid dword dwheapid const bool isaheaphandl hprocess pvoid pvblock pdword pdwflag const public static bool enabledebugprivilegebool fenabl true static bool readprocessmemorydword dwprocessid lpcvoid pvbaseaddress pvoid pvbuffer dword cbread pdword pdwnumberofbytesread null inlin ctoolhelpctoolhelpdword dwflag dword dwprocessid mhsnapshot invalidhandlevalu createsnapshotdwflag dwprocessid inlin ctoolhelpctoolhelp см след стр 93 ч т ь ii начинаем работать рис 46 продолжение if mhsnapshot invalidhandlevalu closehandlemhsnapshot inlin ctoolhelpcreatesnapshotdword dwflag dword dwprocessid if mhsnapshot invalidhandlevalu closehandlemhsnapshot if dwflag 0 mhsnapshot invalidhandlevalu els mhsnapshot createtoolhelp32snapshotdwflag dwprocessid returnmhsnapshot invalidhandlevalu inlin bool ctoolhelpenabledebugprivilegebool fenabl передавая приложению полномочия отладчика разрешаем видеть информацию сервисных приложениях bool fok fals предполагаем худшее handl htoken пытаемся открыть маркер доступа access token процесса if openprocesstokengetcurrentprocess tokenadjustprivileg htoken tokenprivileg tp tpprivilegecount 1 lookupprivilegevaluenul sedebugnam tpprivileges0luid tpprivileges0attribut fenabl seprivilegeen 0 adjusttokenprivilegeshtoken fals tp sizeoftp null null fok getlasterror errorsuccess closehandlehtoken returnfok inlin bool ctoolhelpreadprocessmemorydword dwprocessid lpcvoid pvbaseaddress pvoid pvbuffer dword cbread pdword pdwnumberofbytesread returntoolhelp32readprocessmemorydwprocessid pvbaseaddress pvbuffer cbread pdwnumberofbytesread 94 г л 4 процессы рис 46 продолжение inlin bool ctoolhelpprocessfirstpprocessentry32 ppe const bool fok process32firstmhsnapshot ppe if fok ppeth32processid 0 fok processnextpp удаляем system process pid 0 returnfok inlin bool ctoolhelpprocessnextpprocessentry32 ppe const bool fok process32nextmhsnapshot ppe if fok ppeth32processid 0 fok processnextpp удаляем system process pid 0 returnfok inlin bool ctoolhelpprocessfinddword dwprocessid pprocessentry32 ppe const bool ffound fals for bool fok processfirstpp fok fok processnextpp ffound ppeth32processid dwprocessid if ffound break returnffound inlin bool ctoolhelpmodulefirstpmoduleentry32 pme const returnmodule32firstmhsnapshot pme inlin bool ctoolhelpmodulenextpmoduleentry32 pme const returnmodule32nextmhsnapshot pme inlin bool ctoolhelpmodulefindpvoid pvbaseaddr pmoduleentry32 pme const bool ffound fals for bool fok modulefirstpm fok fok modulenextpm ffound pmemodbaseaddr pvbaseaddr if ffound break returnffound см след стр 95 ч т ь ii начинаем работать рис 46 продолжение inlin bool ctoolhelpmodulefindptstr pszmodnam pmoduleentry32 pme const bool ffound fals for bool fok modulefirstpm fok fok modulenextpm ffound lstrcmpipmeszmodul pszmodnam 0 lstrcmpipmeszexepath pszmodnam 0 if ffound break returnffound inlin bool ctoolhelpthreadfirstpthreadentry32 pte const returnthread32firstmhsnapshot pte inlin bool ctoolhelpthreadnextpthreadentry32 pte const returnthread32nextmhsnapshot pte inlin int ctoolhelphowmanyheap const int nhowmanyheap 0 heaplist32 hl sizeofhl for bool fok heaplistfirsthl fok fok heaplistnexthl nhowmanyheap returnnhowmanyheap inlin int ctoolhelphowmanyblocksinheapdword dwprocessid dword dwheapid const int nhowmanyblocksinheap 0 heapentry32 he sizeofh bool fok heapfirsth dwprocessid dwheapid for fok fok heapnexth nhowmanyblocksinheap returnnhowmanyblocksinheap inlin bool ctoolhelpheaplistfirstpheaplist32 phl const returnheap32listfirstmhsnapshot phl inlin bool ctoolhelpheaplistnextpheaplist32 phl const 96 г л 4 процессы рис 46 продолжение returnheap32listnextmhsnapshot phl inlin bool ctoolhelpheapfirstpheapentry32 phe dword dwprocessid uintptr dwheapid const returnheap32firstph dwprocessid dwheapid inlin bool ctoolhelpheapnextpheapentry32 phe const returnheap32nextph inlin bool ctoolhelpisaheaphandl hprocess pvoid pvblock pdword pdwflag const heaplist32 hl sizeofhl for bool fokhl heaplistfirsthl fokhl fokhl heaplistnexthl heapentry32 he sizeofh bool fokh heapfirsth hlth32processid hlth32heapid for fokh fokh heapnexth memorybasicinform mbi virtualqueryexhprocess pvoid hedwaddress mbi sizeofmbi if chinrangembiallocationbas pvblock pbyte mbiallocationbas mbiregions pdwflag hldwflag returntru returnfals конец файла 97 г л 5 задания группу процессов зачастую нужно рассматривать единую сущность например командуете microsoft develop studio собрать проект порождает цесс clex очередь создать другие процессы скажем допол нительных проходов компилятора пожелаете прервать сборку develop studio должен каким образом завершить clex дочерние процессы ре шение простой распространенной проблемы window весьма затруд нительно поскольку отслеживает родственные связи процессами ча стности выполнение дочерних процессов продолжается завершения ро дительского разработке сервера бывает полезно группировать процессы допустим клиентская программа просит сервер выполнить приложение которое создает ряд дочерних процессов сообщить результаты поскольку серверу обратиться сразу несколько клиентов неплохо умел ограничивать ресурсы выделяемые каждому клиенту самым давал одному клиенту мо нопольно использовать серверные ресурсы ограничения могли подпадать такие ресурсы процессорное время выделяемое обработку клиентского зап роса размеры рабочего набора work set кроме клиентской программы должно возможности завершить работу сервера т д window 2000 введен новый объект ядра   задание job позволяет группи ровать процессы помещать нечто вроде песочницы которая определенным образом ограничивает действия относитесь этому объекту контейнеру процессов кстати очень полезно создавать задание одним процессом   это зволяет налагать процесс ограничения которые иначе указать взгляните мою функцию startrestrictedprocess рис 51 включает процесс задание которое ограничивает возможность выполнения определенных операций window 98 поддерживает задания void startrestrictedprocess создаем объект ядра задание handl hjob createjobobjectnul null вводим ограничения процессов задании сначала определяем некоторые базовые ограничения jobobjectbasiclimitinform jobli 0 рис 51 функция startrestrictedprocess 98 г л 5 задания рис 51 продолжение процесс выполняется классом приоритета idl joblipriorityclass idlepriorityclass задание использовать одной секунды процессорного времени jobliperjobusertimelimitquadpart 10000000 1 секунда выраженная 100наносекундных интервалах ограничения которые налагаю задание процесс joblilimitflag jobobjectlimitpriorityclass jobobjectlimitjobtim setinformationjobobjecthjob jobobjectbasiclimitinform jobli sizeofjobl вводим некоторые ограничения пользовательскому интерфейсу jobobjectbasicuirestrict jobuir jobuiruirestrictionsclass jobobjectuilimitnon замысловатый нуль процесс имеет права останавливать систему jobuiruirestrictionsclass jobobjectuilimitexitwindow процесс имеет права обращаться userобъектам системе например другим окнам jobuiruirestrictionsclass jobobjectuilimithandl setinformationjobobjecthjob jobobjectbasicuirestrict jobuir sizeofjobuir порождаем процесс который размещен задании примечание процесс нужно сначала создать поместить задание это значит поток процесса должен создан приостановлен смог выполнить код введения ограничений startupinfo si sizeofsi processinform pi createprocessnul cmd null null fals createsuspend null null si pi включаем процесс задание примечание дочерние процессы порождаемые этим процессом автоматически становятся частью задания assignprocesstojobobjecthjob pihprocess потоки дочерних процессов могут выполнять код resumethreadpihthread closehandlepihthread ждем процесс завершится исчерпан лимит процессорного времени указанный задания handl h2 h0 pihprocess h1 hjob см след стр 99 ч т ь ii начинаем работать рис 51 продолжение dword dw waitformultipleobjects2 h fals infinit switch dw   waitobject0 case 0 процесс завершился break case 1 лимит процессорного времени исчерпан break проводим очистку closehandlepihprocess closehandlehjob объясню работает startrestrictedprocess сначала создаю новый объект ядра  задание  вызывая handl createjobobject psecurityattribut psa pctstr pszname любая функция создающая объекты ядра createjobobject принимает пер вом параметре информацию защите сообщает системе должна вернуть наследуемый описатель параметр pszname позволяет присвоить заданию имя нему могли обращаться другие процессы функцию openjobobject handl openjobobject dword dwdesiredaccess bool binherithandl pctstr pszname закончив работу объектомзаданием закройте описатель вызвав closehandl именно делаю конце своей функции startrestrictedprocess имейте виду закрытие объектазадания приводит автоматическому завершению процессов самом деле объект просто помечается подлежащий разрушению система уничтожает завершения включенных процессов заметьте закрытия описателя объектзадание становится недоступным процессов несмотря объект существует факт иллю стрирует следующий код создаем именованный объектзадание handl hjob createjobobjectnul textjeff включаем наш процесс assignprocesstojobobjecthjob getcurrentprocess закрытие объектазадания убивает наш процесс само задание присвоенное имя jeff моментально удаляется closehandlehjob пробуем открыть существующее задание hjob openjobobjectjobobjectallaccess fals textjeff openjobobject терпит неудачу возвращает null поскольку имя jeff 100 г л 5 задания указывает объектзадание вызова closehandl получить описатель объекта определение ограничений налагаемых процессы задании создав задание обычно строите  песочницу  набор ограничений включае мых процессов ограничения бывают нескольких видов 쐽 базовые расширенные базовые ограничения   дают процессам задании монопольно захватывать системные ресурсы 쐽 базовые ограничения пользовательскому интерфейсу ui   блокируют возможность изменения 쐽 ограничения связанные защитой   перекрывают процессам задании дос туп защищенным ресурсам файлам подразделам реестра т д ограничения задание вводятся вызовом bool setinformationjobobject handl hjob jobobjectinfoclass jobobjectinformationclass pvoid pjobobjectinform dword cbjobobjectinformationlength первый параметр определяет нужное задание второй параметр перечисли мого типа   вид ограничений третий   адрес структуры данных содержащей робную информацию задаваемых ограничениях четвертый   размер струк туры используется указания версии следующая таблица показывает уста навливаются ограничения структура указываемая вид ограничений значение второго параметра третьем параметре базовые ограничения jobobjectbasiclimitinform jobobjectbas limitinform расширенные базовые jobobjectextendedlimitinform jobobjectextend ограничения limitinform базовые ограничения jobobjectbasicuirestrict jobobjectbas пользовательскому uirestrict интерфейсу ограничения jobobjectsecuritylimitinform jobobjectsecur связанные защитой limitinform функции startrestrictedprocess устанавливаю задания лишь несколько базо вых ограничений создаю структуру jobobjectbasiclimitinfor mation инициализирую вызываю функцию setinformationjobobject данная струк тура выглядит typedef struct jobobjectbasiclimitinform largeinteg perprocessusertimelimit largeinteg perjobusertimelimit dword limitflag dword minimumworkingsets см след стр 101 ч т ь ii начинаем работать dword maximumworkingsets dword activeprocesslimit dwordptr affin dword priorityclass dword schedulingclass jobobjectbasiclimitinform pjobobjectbasiclimitinform элементы структуры кратко описаны таблице 51 элементы описание примечание perprocessus максимальное время пользова система автоматически завершает timelimit тельском режиме выделяемое любой процесс который пытается каждому процессу порциях использовать отведенного 100 нс времени это ограничение вводится флагом jobobjectlimit processtim limitflag perjobus максимальное время пользова умолчанию система автомати timelimit тельском режиме чески завершает процессы процессов данном задании заканчивается это время данное порциях 100 нс значение изменять процес се выполнения задания это ограни чение вводится флагом jobobjectlimitjobtim limitflag limitflag виды ограничений задания см раздел таблицы minimumwork верхний нижний предел обычно рабочий набор процесса setsiz рабочего набора каждого расширяться стандартный maximumwork процесса процессов предел указав maximumwork setsiz задании setsiz введете жесткое ограни чение размер рабочего набо ра какоголибо процесса достигнет заданного предела процесс начнет сбрасывать свои страницы диск вызовы функции setprocesswork setsiz этим процессом будут игно рироваться обра щается очис тить свой рабочий набор это огра ничение вводится флагом jobobjectlimitworkingset limitflag activeprocesslimit максимальное количество процес любая попытка обойти такое огра сов одновременно выполняемых ничение приведет завершению задании нового процесса ошибкой  not enough quota   превышение квоты  это ограничение вводится флагом jobobjectlimitact process limitflag affin подмножество процессоров индивидуальных процессов это которых выполнять ограничение процессы задания детализировать вводится флагом jobobjectlimitaffin limitflag таблица 51 элементы структуры jobobjectbasiclimitinform 102 г л 5 задания продолжение элементы описание примечание priorityclass класс приоритета вызванная процессом функция процессов задании setpriorityclass сообщает успехе случае самом деле выполнила задачу getpriorityclass возвращает класс приоритета каковой пытался уста новить процесс хотя реальности класс другим кроме setthreadprior поднять приоритет потоков выше normal позволяет понижать это ограничение вводится флагом jobobjectlimit priorityclass limitflag schedulingclass относительная продолжительность элемент принимать кванта времени выделяемого всем значения 0 9 умолчанию потокам задании устанавливается 5 подробнее назначении см ниже это ограниче ние вводится флагом jobobject limitschedulingclass limitflag хочу пояснить некоторые вещи связанные структурой которые моему довольно туманно изложены документации platform sdk указывая ограничения задания устанавливаете те иные биты элементе limitflag например startrestrictedprocess использовал флаги jobobjectlimitpriorityclass job objectlimitjobtim т е определил ограничения выполнении задание ведет учет нескольким показателям   например сколько процессорного времени использовали процессы всякий устанавливаете базовые ограничения помощью флага jobobjectlimitjob time общего процессорного времени израсходованного всеми процессами читается которое использовали завершившиеся процессы показатель сооб щает сколько процессорного времени израсходовали активные данный момент процессы понадобится изменить ограничения доступ подмно жеству процессоров сбрасывая учетную информацию процессорно му времени должны ввести новое базовое ограничение флагом jobob jectlimitaffin отказаться флага jobobjectlimitjobtim получится снимаете ограничения процессорное время хотели другого ограничить доступ подмножеству процессоров сохранив существующее ограничение процессорное время вычитать время израсхо дованное завершенными процессами общего времени решить пробле му используйте специальный флаг jobobjectlimitpreservejobtim флаг jobobjectlimitjobtim являются взаимоисключающими флаг jobob jectlimitpreservejobtim указывает системе изменить ограничения вычи тая процессорное время использованное завершенными процессами обсудим также элемент schedulingclass структуры jobobjectbasiclimitinfor mation представьте двух заданий определен класс приоритета normal priorityclass хотите процессы одного задания получали цессорного времени процессы другого элемент schedulingclass позволя ет изменять распределение процессорного времени заданиями одинаковым 103 ч т ь ii начинаем работать классом приоритета можете присвоить любое значение пределах 0 9 умолчанию равен 5 увеличивая значение заставляете window 2000 делять потокам процессах конкретного задания длительный квант времени снижая   напротив уменьшаете квант допустим задания обычным normal классом приоритета каждом задании   одному процессу каждом процессе   одному потоку обычным приоритетом нормальной ситуации потока обрабатыва лись процессором принципу карусели получали равные кванты процес сорного времени запишу элемент schedulingclass первого задания значение 3 система выделять потокам короткий квант процессорно го времени потокам второго задания используя schedulingclass избегайте слишком больших значений иначе замедлите общую реакцию других заданий процессов потоков какиелибо бытия системе кроме учтите сказанное относится window 2000 будущих версиях window планировщик потоков предполагается существенно изменить операционная система могла гибко планировать потоки заданиях процессах последнее ограничение которое заслуживает отдельного упоминания связано флагом jobobjectlimitdieonunhandledexcept отключает процессов задании вывод диалогового окна сообщением необработанном исключении система реагирует флаг вызовом seterrormod флагом semnog pfaulterrorbox каждого процессов задании процесс котором возник необрабатываемое исключение немедленно завершается уведомления пользователя флаг полезен сервисных других пакетных заданиях сутствие процессов задании мог вызвать исключение завершиться впустую расходуя системные ресурсы помимо базовых ограничений можете устанавливать расширенные применяется структура jobobjectextendedlimitinform typedef struct jobobjectextendedlimitinform jobobjectbasiclimitinform basiclimitinform iocount ioinfo sizet processmemorylimit sizet jobmemorylimit sizet peakprocessmemoryus sizet peakjobmemoryus jobobjectextendedlimitinform pjobobjectextendedlimitinform видите включает структуру jobobjectbasiclimitinform яв ляясь фактически надстройкой это несколько странная структура элементы имеющие никакого отношения определению ограничений задания первых элемент ioinfo зарезервирован коем случае дол жны обращаться нему узнать значение счетчика вводавывода расска жу позже кроме элементы peakprocessmemoryus peakjobmemoryus пред назначены чтения сообщают максимальном объеме памяти передан ной соответственно одному процессов всем процессам задании остальные элемента processmemorylimit jobmemorylimit ограничивают ответственно объем переданной памяти который использован одним процессов всеми процессами задании задать любое этих ограниче ний укажите элементе limitflag флаг jobobjectlimitjobmemori jobob jectlimitprocessmemori 104 г л 5 задания вернемся прочим ограничениям которые налагать задания структура jobobjectbasicuirestrict выглядит typedef struct jobobjectbasicuirestrict dword uirestrictionsclass jobobjectbasicuirestrict pjobobjectbasicuirestrict структуре элемент uirestrictionsclass который содержит набор битовых флагов кратко описанных таблице 52 флаг описание jobobjectuilimitexitwindow запрещает выдачу команд процессов выход системы завершение работы перезагрузку выключение компьютера функцию exitwindowsex jobobjectuilimitreadclipboard запрещает процессам чтение буфера обмена jobobjectuilimitwriteclipboard запрещает процессам стирание буфера обмена jobobjectuilimitsystemparamet запрещает процессам изменение системных параметров systemparametersinfo jobobjectuilimitdisplayset запрещает процессам изменение параметров экрана changedisplayset jobobjectuilimitglobalatom предоставляет заданию отдельную глобаль ную таблицу атомарного доступа global atom tabl разрешает процессам пользоваться таблицей jobobjectuilimitdesktop запрещает процессам создание новых рабо чих столов переключение ними функции createdesktop switchdesktop jobobjectuilimithandl запрещает процессам задании использо вать userобъекты например hwnd зданные внешними отношению этому заданию процессами таблица 52 битовые флаги базовых ограничений пользовательскому интерфейсу объектазадания последний флаг jobobjectuilimithandl представляет особый интерес запрещает процессам задании обращаться userобъектам созданным внешними отношению этому заданию процессами запустив утилиту microsoft spi задания обнаружите никаких окон кроме тех которые создаст сама spi рис 52 показано окно microsoft spi двумя открытыми дочерними mdiокнами заметьте левой секции thread 1 содержится список потоков системе ка жется лишь одного 000006ac spyxx дочерние окна дело запустил microsoft spi задания ограничил права использова ние описателей userобъектов окне сообщается потоках msdev explo rer никаких упоминаний созданных ими окнах уверяю потоки наверняка создали какие окна   просто spi лишена возможности ви деть правой секции window 3 утилита spi должна показывать иерархию окон рабочем столе кроме одного элемента   00000000 это настоящий элемент spi обязана поместить сюда 105 ч т ь ii начинаем работать обратите внимание такие ограничения односторонни т е внешние процес сы равно видят userобъекты которые созданы процессами включенными дание например запустить notepad задании spi   вне последняя увидит окно notepad задания указан флаг jobobjectuilimithand les кроме spi запущенная отдельном задании равно увидит это окно notepad задания установлен флаг jobobjectuilimithan dles рис 52 microsoft spi работает задании которому ограничен доступ описателям userобъектов ограничение доступа описателям userобъектов   вещь изумительная хотите создать настоящему безопасную песочницу которой будут  копаться  процессы вашего задания однако часто бывает нужно процесс задании взаимодействовал внешними процессами одно самых простых решений   использовать оконные сообщения процессам задании доступ описате лям пользовательского интерфейса запрещен сможет послать общение синхронно асинхронно окну созданному внешним процессом сча стью функция которая поможет решить проблему bool userhandlegrantaccess handl huserobj handl hjob bool fgrant параметр huserobj идентифицирует конкретный userобъект доступ которому хотите предоставить запретить процессам задании это опи сатель окна userобъектом например рабочий стол программная ловушка ярлык меню последние параметра hjob fgrant указывают зада ние вид ограничения обратите внимание функция сработает выз вать процесса задании которое указывает hjob   процесс имеет права предоставлять доступ объекту последний вид ограничений устанавливаемых задания относится защи те введя действие такие ограничения сможете отменить структура jobobjectsecuritylimitinform выглядит 106 г л 5 задания typedef struct jobobjectsecuritylimitinform dword securitylimitflag handl jobtoken ptokengroup sidstodis ptokenprivileg privilegestodelet ptokengroup restrictedsid jobobjectsecuritylimitinform pjobobjectsecuritylimitinform элементы описаны следующей таблице элемент описание securitylimitflag набор флагов которые закрывают доступ администратору запре щают маркер неограниченного доступа принудительно назначают заданный маркер доступа блокируют доступ какимлибо иден тификаторам защиты secur id sid отменяют указанные вилегии jobtoken маркер доступа связываемый всеми процессами задании sidstodis указывает каким sid разрешается доступ privilegestodelet определяет привилегии которые снимаются маркера доступа restrictedsid задает набор sid которым запрещается доступ любому защи щенному объекту denyon sid набор добавляется марке ру доступа естественно налагаете ограничения наверное понадобится информация вызовите bool queryinformationjobobject handl hjob jobobjectinfoclass jobobjectinformationclass pvoid pvjobobjectinform dword cbjobobjectinformationlength pdword pdwreturnlength функцию setinformationjobobject передается описатель задания пе ременная перечислимого типа jobobjectinfoclass сообщает информацию ограничениях адрес размер структуры данных инициализируемой функцией пос ледний параметр pdwreturnlength заполняется самой функцией указывает сколь ко байтов помещено буфер сведения интересуют обычно бывает передавайте параметре null процесс получить информацию своем задании передав вызове queryinformationjobobject вместо описателя задания значение null это позво лит выяснить установленные ограничения однако аналогичный вызов setinformationjobobject даст ошибку процесс имеет права са мостоятельно изменять заданные ограничения включение процесса задание  кэй ограничениями закончим вернемся startrestrictedprocess устано вив ограничения задания вызываю createprocess создаю процесс который помещаю это задание использую флаг createsuspend приводит тому процесс порождается код пока выполняет поскольку startrestrict process вызывается процесса внешнего отношению заданию дочерний 107 ч т ь ii начинаем работать процесс входит это задание разрешил дочернему процессу медленно начать выполнение кода проигнорировал мою песочницу всеми ограничениями поэтому сразу создания дочернего процесса нача лом работы должен явно включить процесс сформированное задание вызвав bool assignprocesstojobobject handl hjob handl hprocess эта функция заставляет систему рассматривать процесс идентифицируемый па раметром hprocess часть существующего задания которое указывает hjob ратите внимание assignprocesstojobobject позволяет включить задание процесс который относится одному заданию процесс стал частью какого задания переместить другое задание отпус тить волю кроме процесс включенный задание порождает новый процесс последний автоматически помещается задание однако поря док изменить 쐽 включая limitflag структуры jobobjectbasiclimitinform флаг jobobjectbreakawayok сообщаете системе новый процесс мо жет выполняться вне задания должны вызвать createprocess новым флагом createbreakawayfromjob сделаете это флага jobobjectbreakawayok limitflag функция createprocess завершится ошибкой механизм пригодится случай новый процесс управляет заданиями 쐽 включая limitflag структуры jobobjectbasiclimitinform флаг jobobjectsilentbreakawayok сообщаете системе новый процесс является частью задания указывать createprocess какиелибо флаги потребуется данный механизм полезен процессов которым известно объектахзаданиях касается startrestrictedprocess вызова assignprocesstojobobject новый процесс становится частью задания далее вызываю resumethread поток нового процесса начал выполняться рамках ограничений установленных зада ния момент также закрываю описатель потока поскольку нужен завершение процессов задании уверен именно это будете делать чаще начале главы упомянул непросто остановить сборку develop studio должны известны процессы которые успел создать самый первый процесс это очень каверзная задача develop studio справляется объяснял своей колонке  вопросы ответы win32  июньском выпуске microsoft system journal 1998 год подозреваю следующие версии develop studio будут использовать механизм заданий решать задачу которой вами говорили станет гораздо легче уничтожить процессы задании просто вызываете bool terminatejobobject handl hjob uint uexitcod 108 г л 5 задания вызов функции похож вызов terminateprocess каждого процесса дании присвоение всем кодам завершения одного значения   uexitcod получение статистической информации задании обсудили помощью queryinformationjobobject получить информацию текущих ограничениях установленных задания функцией пользо ваться получения статистической информации например выяснить ба зовые учетные сведения вызовите передав jobobjectbasicaccountinginform втором параметре адрес структуры jobobjectbasicaccountinginform typedef struct jobobjectbasicaccountinginform largeinteg totalusertim largeinteg totalkerneltim largeinteg thisperiodtotalusertim largeinteg thisperiodtotalkerneltim dword totalpagefaultcount dword totalprocess dword activeprocess dword totalterminatedprocess jobobjectbasicaccountinginform pjobobjectbasicaccountinginform элементы структуры кратко описаны таблице 53 элемент описание totalusertim процессорное время израсходованное процессами задания пользовательском режиме totalkerneltim процессорное время израсходованное процессами задания режиме ядра thisperiodtotalusertim totalusertim обнуляется базовые огра ничения изменяются вызовом setinformationjobobject флаг jobobjectlimitpreservejobtim используется thisperiodtotalkerneltim thisperiodtotalusertim относится процессор ному времени израсходованному режиме ядра totalpagefaultcount общее количество ошибок страниц вызванных процессами задания totalprocess общее число процессов либо выполнявшихся задании activeprocess текущее количество процессов задании totalterminatedprocess количество процессов завершенных превышения ими отведенного лимита процессорного времени таблица 53 элементы структуры jobobjectbasicaccountinginform можете извлечь те сведения вместе учетной информацией вводувыво ду передав jobobjectbasicandioaccountinginform втором параметре адрес структуры jobobjectbasicandioaccountinginform typedef struct jobobjectbasicandioaccountinginform jobobjectbasicaccountinginform basicinfo iocount ioinfo jobobjectbasicandioaccountinginform видите просто возвращает jobobjectbasicaccountinginforma tion iocount последняя структура показана следующей странице 109 ч т ь ii начинаем работать typedef struct iocount ulonglong readoperationcount ulonglong writeoperationcount ulonglong otheroperationcount ulonglong readtransfercount ulonglong writetransfercount ulonglong othertransfercount iocount сообщает числе операций чтения записи перемещения также коли честве байтов переданных выполнении этих операций данные относятся ко всем процессам задании кстати новая функция getprocessiocount позволяет лучить ту информацию процессах входящих какие задания bool getprocessiocount handl hprocess piocount piocount queryinformationjobobject также возвращает набор идентификаторов текущих цессов задании этим должны прикинуть сколько выделить соответствующий блок памяти поместятся массив идентификаторов структура jobobjectbasicprocessidlist typedef struct jobobjectbasicprocessidlist dword numberofassignedprocess dword numberofprocessidsinlist dword processidlist1 jobobjectbasicprocessidlist pjobobjectbasicprocessidlist итоге получить набор идентификаторов текущих процессов задании нужно написать примерно код void enumprocessidsinjobhandl hjob исхожу количество процессов задании превысит 10 defin maxprocessid 10 определяем размер блока памяти байтах хранения идентификаторов структуры dword cb sizeofjobobjectbasicprocessidlist maxprocessid 1 sizeofdword выделяем блок памяти pjobobjectbasicprocessidlist pjobpil allocacb сообщаем функции какое максимальное число процессов рассчитана выделенная нами память pjobpilnumberofassignedprocess maxprocessid запрашиваем текущий список идентификаторов процессов queryinformationjobobjecthjob jobobjectbasicprocessidlist pjobpil cb cb перечисляем идентификаторы процессов for int x 0 x pjobpilnumberofprocessidsinlist x 110 г л 5 задания используем pjobpilprocessidlistx выделения памяти вызывали alloca освобождать память нам потребуется удастся получить функции хотя самом деле опе рационная система знает заданиях гораздо информацию которая хра нится специальных счетчиках извлечь помощью функций библиотеки perform data helper pdhdll модуль perform monitor подключае мый microsoft manag consol mmc рис 53 иллюстрирует некоторые доступных системе счетчиков заданий job object counter рис 54   счетчики относящиеся отдельным параметрам заданий job object detail counter заметьте задании jeff содержится четыре процесса calc cmd notepad wordpad рис 53 mmc perform monitor счетчики задания рис 54 mmc perform monitor счетчики относящиеся отдельным параметрам задания 111 ч т ь ii начинаем работать извлечь сведения этих счетчиков сможете тех заданий которым присвоены имена вызове createjobobject причине наверное луч ше именовать задания собираетесь ссылаться именам других процессов уведомления заданий итак базовые сведения объектахзаданиях изложил единственное осталось рассмотреть   уведомления допустим нужно знать завершаются цессы задании заканчивается отпущенное процессорное время либо выяснить задании порождается уничтожается очередной процесс такие уведомления интересуют многих приложениях нужны работать заданиями очень легко   сложнее рассказывал понадобятся придется копнуть поглубже информацию выделенное процессорное время исчерпано получить нетрудно объектызадания переходят свободное состояние тех пор пока процессы израсходуют отведенное процессорное время оно заканчи вается система уничтожает процессы задании переводит объект свобод ное состояние signal state это событие легко перехватить помощью waitfor singleobject похожей функции кстати можете вернуть объектзада ние состояние  занято  nonsign state вызвав setinformationjobobject выделив дополнительное процессорное время начинал разбираться заданиями казалось объектзада ние должен переходить свободное состояние завершения процес сов конце концов прекращая работу объекты процессов потоков освобож даются самое вроде должно происходить заданиями microsoft пред почла сделать другому объектзадание переходит свободное состояние исчерпает выделенное время поскольку большинство заданий начина ет работу одним процессом который существует пока завершатся дочерние процессы нужно просто следить описателем родительского процес са   освободится завершится задание функция startrestrict process демонстрирует данный прием это лишь простейшие уведомления    продвинутые  например создании разрушении процесса получать гораздо сложнее частности придется создать объект ядра  порт завершения вводавывода  связать объект объекты  задание  нужно перевести пото ков режим ожидания порта завершения создав порт завершения вводавывода сопоставляете задание вызывая setinformationjobobject следующим образом jobobjectassociatecompletionport joacp joacpcompletionkey 1 любое значение уникально идентифицирующее это задание joacpcompletionport hiocp описатель порта завершения принимающего уведомления setinformationjobobjecthjob jobobjectassociatecompletionportinform joacp sizeofjoacp выполнения кода система начнет отслеживать задание возник новении событий передавать порту завершения кстати можете вызывать queryinformationjobobject получать ключ завершения описатель порта вряд 112 г л 5 задания это понадобится потоки следят портом завершения ввода вода вызывая getqueuedcompletionstatus bool getqueuedcompletionstatus handl hiocp pdword pnumbytestransf pulongptr pcompletionkey poverlap poverlap dword dwmillisecond эта функция возвращает уведомление событии задания pcompletionkey содержит значение ключа завершения заданное вызове setinformationjobobject связывания задания портом завершения нему узнаете каком заданий возникло событие значение pnumbytestransf указывает какое именно собы тие произошло таблица 54 зависимости конкретного события poverlap возвращаться идентификатор процесса событие описание jobobjectmsgact задании работающих процессов processzero jobobjectmsgendof процессорное время выделенное процессу исчерпано processtim процесс завершается сообщается идентификатор jobobjectmsgact попытка превысить ограничение число активных processlimit процессов задании jobobjectmsgprocess попытка превысить ограничение объем памяти memorylimit которая передана процессу сообщается идентификатор процесса jobobjectmsgjob попытка превысить ограничение объем памяти memorylimit которая передана заданию сообщается идентификатор процесса jobobjectmsgnew задание добавлен процесс сообщается идентификатор process процесса jobobjectmsgexit процесс завершен сообщается идентификатор процесса process jobobjectmsg процесс завершен необработанного исключения abnormalexitprocess сообщается идентификатор процесса jobobjectmsgend процессорное время выделенное заданию исчерпано ofjobtim процессы завершаются можете либо возобновить работу задав новый лимит времени либо самостоя тельно завершить процессы вызвав terminatejobobject таблица 54 уведомления событиях задания посылаемые системой связанному этим заданием порту завершения последнее замечание умолчанию объектзадание настраивается системой автоматическое завершение процессов истечении выделенного цессорного времени уведомление jobobjectmsgendofjobtim посы лается хотите объектзадание уничтожал свои процессы просто сообщал превышении лимита процессорное время придется написать мерно код создаем структуру jobobjectendofjobtimeinform инициализируем единственный элемент см след стр 113 ч т ь ii начинаем работать jobobjectendofjobtimeinform joeojti joeojtiendofjobtimeact jobobjectpostatendofjob сообщаем заданию нужно делать истечении времени setinformationjobobjecthjob jobobjectendofjobtimeinform joeojti sizeofjoeojti можете указать другое значение jobobjectterminateatendofjob оно задается умолчанию создании задания программапример joblab эта программа  05 joblabexe  см листинг рис 56 позволяет легко эксперимен тировать заданиями файлы исходного кода ресурсов находятся каталоге 05joblab компактдиске прилагаемом книге запуска joblab открывается окно показанное рис 55 рис 55 программапример joblab процесс инициализируется создает объект  задание  присваиваю имя joblab могли наблюдать помощью mmc perform monitor программа также создает порт завершения вводавывода связывает объ ектзадание это позволяет отслеживать уведомления задания отображать списке нижней части окна изначально задании процессов никаких ограничений уста новлено поля верхней части окна позволяют задавать базовые расширенные ог раничения требуется   ввести допустимые значения щелк нуть кнопку appli limit оставляете поле пустым соответствующие ограни чения вводятся кроме базовых расширенных можете задавать ограничения пользовательскому интерфейсу обратите внимание помечая флажок preserv job time when appli limit устанавливаете ограничение просто получаете возможность изменять ограничения сбрасывая значения элементов thisperiod 114 г л 5 задания totalusertim thisperiodtotalkerneltim запросе базовой учетной информации флажок становится недоступен наложении ограничений процессорное время отдельных заданий остальные кнопки позволяют управлять заданием другому кнопка termin process уничтожает процессы задании кнопка spawn cmd in job запускает командный процессор сопоставляемый заданием процесса запус кать дочерние процессы наблюдать ведут став частью задания пос ледняя кнопка put pid in job позволяет связать существующий свободный процесс заданием т е включить задание список нижней части окна отображает обновляемую каждые 10 секунд инфор мацию статусе задания базовые расширенные сведения статистику вводавыво также пиковые объемы памяти занимаемые процессом заданием кроме информации списке показываются уведомления поступающие задания порт завершения вводавывода кстати вся информация обновляется приеме уведомления одно измените исходный код будете создавать безымянный объект ядра  задание  сможете запускать несколько копий программы здавая самым объектовзаданий одной машине это расширит ваши возможности экспериментах заданиями касается исходного кода специально обсуждать смысла   нем достаточно комментариев замечу лишь файле jobh определил cкласс cjob инкапсулирующий объект  задание  операционной системы это избавило необходимости передавать тудасюда описатель задания позволило уменьшить число операций приведения типов которые обычно приходится выполнять зове функций queryinformationjobobject setinformationjobobject joblabcpp модуль joblabcpp автор copyright c 2000 джеффри рихтер jeffrey richter includ cmnhdrh includ windowsxh includ processh доступа beginthreadex includ tcharh includ stdioh includ resourceh includ jobh cjob gjob задание hwnd ghwnd описатель диалогового окна доступен всем потокам handl ghiocp порт завершения принимающий уведомления задания handl ghthreadiocp поток порта завершения рис 56 программапример joblab см след стр 115 ч т ь ii начинаем работать рис 56 продолжение ключи завершения относящиеся порту завершения defin compkeytermin uintptr 0 defin compkeystatus uintptr 1 defin compkeyjobobject uintptr 2 dword winapi jobnotifypvoid tchar sz2000 bool fdone fals while fdone dword dwbytesxf ulongptr compkey lpoverlap po getqueuedcompletionstatusghiocp dwbytesxf compkey po infinit приложение закрывается выходим потока fdone compkey compkeytermin hwnd hwndlb findwindownul textjob lab hwndlb getdlgitemhwndlb idcstatus if compkey compkeyjobobject lstrcpysz text notif lptstr psz sz lstrlensz switch dwbytesxf case jobobjectmsgendofjobtim wsprintfpsz textjob time limit reach break case jobobjectmsgendofprocesstim wsprintfpsz textjob process idd time limit reach po break case jobobjectmsgactiveprocesslimit wsprintfpsz texttoo mani activ process in job break case jobobjectmsgactiveprocesszero wsprintfpsz textjob contain no activ process break case jobobjectmsgnewprocess wsprintfpsz textnew process idd in job po break case jobobjectmsgexitprocess wsprintfpsz textprocess idd termin po break 116 г л 5 задания рис 56 продолжение case jobobjectmsgabnormalexitprocess wsprintfpsz textprocess idd termin abnorm po break case jobobjectmsgprocessmemorylimit wsprintfpsz textprocess idd exceed memori limit po break case jobobjectmsgjobmemorylimit wsprintfpsz textprocess idd exceed job memori limit po break default wsprintfpsz textunknown notif d dwbytesxf break listboxsetcurselhwndlb listboxaddstringhwndlb sz compkey 1 принудительное обновление списка получении уведомления if compkey compkeystatus static int snstatuscount 0 stprintfsz text status updat u snstatuscount listboxsetcurselhwndlb listboxaddstringhwndlb sz выводим базовую учетную информацию jobobjectbasicandioaccountinginform jobai gjobquerybasicaccountinginfojobai stprintfsz texttot time useri64u kerneli64u textperiod time useri64u kerneli64u jobaibasicinfototalusertimequadpart jobaibasicinfototalkerneltimequadpart jobaibasicinfothisperiodtotalusertimequadpart jobaibasicinfothisperiodtotalkerneltimequadpart listboxsetcurselhwndlb listboxaddstringhwndlb sz stprintfsz textpag faultsu total processesu textact processesu termin processesu jobaibasicinfototalpagefaultcount jobaibasicinfototalprocess jobaibasicinfoactiveprocess jobaibasicinfototalterminatedprocess listboxsetcurselhwndlb listboxaddstringhwndlb sz показываем учетную информацию вводувыводу stprintfsz textreadsi64u i64u byte textwritei64u i64u byte otheri64u i64u byte jobaiioinforeadoperationcount jobaiioinforeadtransfercount jobaiioinfowriteoperationcount jobaiioinfowritetransfercount см след стр 117 ч т ь ii начинаем работать рис 56 продолжение jobaiioinfootheroperationcount jobaiioinfoothertransfercount listboxsetcurselhwndlb listboxaddstringhwndlb sz сообщаем пиковые значения объема памяти использованные процессами заданиями jobobjectextendedlimitinform joeli gjobqueryextendedlimitinfojo stprintfsz textpeak memori use processi64u jobi64u int64 joelipeakprocessmemoryus int64 joelipeakjobmemoryus listboxsetcurselhwndlb listboxaddstringhwndlb sz выводим список идентификаторов процессов dword dwnumprocess 50 dwprocessidlist50 gjobquerybasicprocessidlistdwnumprocess dwprocessidlist dwnumprocess stprintfsz textpid s dwnumprocess 0 textnon text for dword x 0 x dwnumprocess x stprintftcschrsz 0 textd dwprocessidlistx listboxsetcurselhwndlb listboxaddstringhwndlb sz return0 bool dlgoninitdialoghwnd hwnd hwnd hwndfocus lparam lparam chsetdlgiconshwnd idijoblab сохраняем описатель нашего окна поток порта завершения мог нему обращаться ghwnd hwnd hwnd hwndpriorityclass getdlgitemhwnd idcpriorityclass comboboxaddstringhwndpriorityclass textno limit comboboxaddstringhwndpriorityclass textidl comboboxaddstringhwndpriorityclass textbelow normal comboboxaddstringhwndpriorityclass textnorm comboboxaddstringhwndpriorityclass textabov normal comboboxaddstringhwndpriorityclass texthigh comboboxaddstringhwndpriorityclass textrealtim comboboxsetcurselhwndpriorityclass 0 умолчанию   no limit hwnd hwndschedulingclass getdlgitemhwnd idcschedulingclass comboboxaddstringhwndschedulingclass textno limit for int n 0 n 9 n tchar szschedulingclass2 tchar text0 n 0 118 г л 5 задания рис 56 продолжение comboboxaddstringhwndschedulingclass szschedulingclass comboboxsetcurselhwndschedulingclass 0 умолчанию   no limit settimerhwnd 1 10000 null обновление каждые 10 секунд returntru void dlgapplylimitshwnd hwnd const int nnanosecondspersecond 100000000 const int nmillisecondspersecond 1000 const int nnanosecondspermillisecond nnanosecondspersecond nmillisecondspersecond bool f int64 q sizet s dword d устанавливаем базовые расширенные ограничения jobobjectextendedlimitinform joeli 0 joelibasiclimitinformationlimitflag 0 q getdlgiteminthwnd idcperprocessusertimelimit f fals if f joelibasiclimitinformationlimitflag jobobjectlimitprocesstim joelibasiclimitinformationperprocessusertimelimitquadpart q nnanosecondspermillisecond 100 q getdlgiteminthwnd idcperjobusertimelimit f fals if f joelibasiclimitinformationlimitflag jobobjectlimitjobtim joelibasiclimitinformationperjobusertimelimitquadpart q nnanosecondspermillisecond 100 s getdlgiteminthwnd idcminworkingsets f fals if f joelibasiclimitinformationlimitflag jobobjectlimitworkingset joelibasiclimitinformationminimumworkingsets s 1024 1024 s getdlgiteminthwnd idcmaxworkingsets f fals if f joelibasiclimitinformationmaximumworkingsets s 1024 1024 els joelibasiclimitinformationlimitflag jobobjectlimitworkingset chmbboth minimum and maximum work set size must be setn the work set limit will not be in effect см след стр 119 ч т ь ii начинаем работать рис 56 продолжение d getdlgiteminthwnd idcactiveprocesslimit f fals if f joelibasiclimitinformationlimitflag jobobjectlimitactiveprocess joelibasiclimitinformationactiveprocesslimit d s getdlgiteminthwnd idcaffinitymask f fals if f joelibasiclimitinformationlimitflag jobobjectlimitaffin joelibasiclimitinformationaffin s joelibasiclimitinformationlimitflag jobobjectlimitpriorityclass switch comboboxgetcurselgetdlgitemhwnd idcpriorityclass case 0 joelibasiclimitinformationlimitflag jobobjectlimitpriorityclass break case 1 joelibasiclimitinformationpriorityclass idlepriorityclass break case 2 joelibasiclimitinformationpriorityclass belownormalpriorityclass break case 3 joelibasiclimitinformationpriorityclass normalpriorityclass break case 4 joelibasiclimitinformationpriorityclass abovenormalpriorityclass break case 5 joelibasiclimitinformationpriorityclass highpriorityclass break case 6 joelibasiclimitinformationpriorityclass realtimepriorityclass break 120 г л 5 задания рис 56 продолжение int nschedulingclass comboboxgetcurselgetdlgitemhwnd idcschedulingclass if nschedulingclass 0 joelibasiclimitinformationlimitflag jobobjectlimitschedulingclass joelibasiclimitinformationschedulingclass nschedulingclass 1 s getdlgiteminthwnd idcmaxcommitperjob f fals if f joelibasiclimitinformationlimitflag jobobjectlimitjobmemori joelijobmemorylimit s 1024 1024 s getdlgiteminthwnd idcmaxcommitperprocess f fals if f joelibasiclimitinformationlimitflag jobobjectlimitprocessmemori joeliprocessmemorylimit s 1024 1024 if isdlgbuttoncheckedhwnd idcchildprocessescanbreakawayfromjob joelibasiclimitinformationlimitflag jobobjectlimitbreakawayok if isdlgbuttoncheckedhwnd idcchildprocessesdobreakawayfromjob joelibasiclimitinformationlimitflag jobobjectlimitsilentbreakawayok if isdlgbuttoncheckedhwnd idcterminateprocessonexcept joelibasiclimitinformationlimitflag jobobjectlimitdieonunhandledexcept f gjobsetextendedlimitinfojo joelibasiclimitinformationlimitflag jobobjectlimitjobtim 0 fals isdlgbuttoncheckedhwnd idcpreservejobtimewhenapplyinglimit chassertf устанавливаем ограничения связанные пользовательским интерфейсом dword jobuir jobobjectuilimitnon замысловатый нуль 0 if isdlgbuttoncheckedhwnd idcrestrictaccesstooutsideuserobject jobuir jobobjectuilimithandl if isdlgbuttoncheckedhwnd idcrestrictreadingclipboard jobuir jobobjectuilimitreadclipboard if isdlgbuttoncheckedhwnd idcrestrictwritingclipboard jobuir jobobjectuilimitwriteclipboard if isdlgbuttoncheckedhwnd idcrestrictexitwindow jobuir jobobjectuilimitexitwindow см след стр 121 ч т ь ii начинаем работать рис 56 продолжение if isdlgbuttoncheckedhwnd idcrestrictchangingsystemparamet jobuir jobobjectuilimitsystemparamet if isdlgbuttoncheckedhwnd idcrestrictdesktop jobuir jobobjectuilimitdesktop if isdlgbuttoncheckedhwnd idcrestrictdisplayset jobuir jobobjectuilimitdisplayset if isdlgbuttoncheckedhwnd idcrestrictglobalatom jobuir jobobjectuilimitglobalatom chverifygjobsetbasicuirestrictionsjobuir void dlgoncommandhwnd hwnd int id hwnd hwndctl uint codenotifi switch id case idcancel пользователь закрывает наше приложение   закрываем задание killtimerhwnd 1 gjobterminate0 enddialoghwnd id break case idcperjobusertimelimit устанавливая новое ограничение времени нужно сбросить ранее указанное время задания bool f getdlgiteminthwnd idcperjobusertimelimit f fals enablewindow getdlgitemhwnd idcpreservejobtimewhenapplyinglimit f break case idcapplylimit dlgapplylimitshwnd postqueuedcompletionstatusghiocp 0 compkeystatus null break case idctermin gjobterminate0 postqueuedcompletionstatusghiocp 0 compkeystatus null break case idcspawncmdinjob порождаем процесс командного процессора помещаем задание 122 г л 5 задания рис 56 продолжение startupinfo si sizeofsi processinform pi tchar sz textcmd createprocessnul sz null null fals createsuspend null null si pi gjobassignprocesspihprocess resumethreadpihthread closehandlepihprocess closehandlepihthread postqueuedcompletionstatusghiocp 0 compkeystatus null break case idcassignprocesstojob dword dwprocessid getdlgiteminthwnd idcprocessid null fals handl hprocess openprocess processsetquota processtermin fals dwprocessid if hprocess null chverifygjobassignprocesshprocess closehandlehprocess els chmbcould not assign process to job postqueuedcompletionstatusghiocp 0 compkeystatus null break void winapi dlgontimerhwnd hwnd uint id postqueuedcompletionstatusghiocp 0 compkeystatus null intptr winapi dlgprochwnd hwnd uint umsg wparam wparam lparam lparam switch umsg chhandledlgmsghwnd wminitdialog dlgoninitdialog chhandledlgmsghwnd wmtimer dlgontim chhandledlgmsghwnd wmcommand dlgoncommand returnfals см след стр 123 ч т ь ii начинаем работать рис 56 продолжение int winapi twinmainhinst hinstex hinstanc lptstr pszcmdline int создаем порт завершения который принимать уведомления задания ghiocp createiocompletionportinvalidhandlevalu null 0 0 создаем поток ждущий порт завершения ghthreadiocp chbeginthreadexnul 0 jobnotifi null 0 null создаем объектзадание gjobcreatenul textjoblab gjobsetendofjobinfojobobjectpostatendofjob gjobassociatecompletionportghiocp compkeyjobobject dialogboxhinstex makeintresourceiddjoblab null dlgproc передаем специальный ключ заставляющий поток порта завершения закончить работу postqueuedcompletionstatusghiocp 0 compkeytermin null ждем завершится поток waitforsingleobjectghthreadiocp infinit проводим должную очистку closehandleghiocp closehandleghthreadiocp примечание задание закрывается вызовом деструктора gjob return0 конец файла jobh модуль jobh автор copyright c 2000 джеффри рихтер jeffrey richter pragma onc includ malloch доступа alloca class cjob public cjobhandl hjob null cjob 124 г л 5 задания рис 56 продолжение oper handl const returnmhjob функции создающие открывающие объектзадание bool createlpsecurityattribut psa null lpctstr pszname null bool openlpctstr pszname dword dwdesiredaccess bool finherithandl fals функции манипулирующие объектомзаданием bool assignprocesshandl hprocess bool terminateuint uexitcod 0 функции налагающие ограничения задания bool setextendedlimitinfopjobobjectextendedlimitinform pjoeli bool fpreservejobtim fals bool setbasicuirestrictionsdword fdwlimit bool grantuserhandleaccesshandl huserobj bool fgrant true bool setsecuritylimitinfopjobobjectsecuritylimitinform pjosli функции запрашивающие сведения ограничениях bool queryextendedlimitinfopjobobjectextendedlimitinform pjoeli bool querybasicuirestrictionspdword pfdwrestrict bool querysecuritylimitinfopjobobjectsecuritylimitinform pjosli функции запрашивающие статусную информацию задании bool querybasicaccountinginfo pjobobjectbasicandioaccountinginform pjobai bool querybasicprocessidlistdword dwmaxprocess pdword pdwprocessidlist pdword pdwprocessesreturn null функции работающие уведомлениями задания bool associatecompletionporthandl hiocp ulongptr compkey bool queryassociatedcompletionport pjobobjectassociatecompletionport pjoacp bool setendofjobinfo dword fdwendofjobinfo jobobjectterminateatendofjob bool queryendofjobtimeinfopdword pfdwendofjobtimeinfo privat handl mhjob inlin cjobcjobhandl hjob mhjob hjob см след стр 125 ч т ь ii начинаем работать рис 56 продолжение inlin cjobcjob if mhjob null closehandlemhjob inlin bool cjobcreatepsecurityattribut psa pctstr pszname mhjob createjobobjectpsa pszname returnmhjob null inlin bool cjobopen pctstr pszname dword dwdesiredaccess bool finherithandl mhjob openjobobjectdwdesiredaccess finherithandl pszname returnmhjob null inlin bool cjobassignprocesshandl hprocess returnassignprocesstojobobjectmhjob hprocess inlin bool cjobassociatecompletionporthandl hiocp ulongptr compkey jobobjectassociatecompletionport joacp pvoid compkey hiocp returnsetinformationjobobjectmhjob jobobjectassociatecompletionportinform joacp sizeofjoacp inlin bool cjobsetextendedlimitinfo pjobobjectextendedlimitinform pjoeli bool fpreservejobtim if fpreservejobtim pjoelibasiclimitinformationlimitflag jobobjectlimitpreservejobtim хотите сохранить информацию времени задания флаг jobobjectlimitjobtim нужно убрать const dword fdwflagtest 126 г л 5 задания рис 56 продолжение jobobjectlimitpreservejobtim jobobjectlimitjobtim if pjoelibasiclimitinformationlimitflag fdwflagtest fdwflagtest ошибка указаны взаимоисключающих флага debugbreak returnsetinformationjobobjectmhjob jobobjectextendedlimitinform pjoeli sizeofpjo inlin bool cjobsetbasicuirestrictionsdword fdwlimit jobobjectbasicuirestrict jobuir fdwlimit returnsetinformationjobobjectmhjob jobobjectbasicuirestrict jobuir sizeofjobuir inlin bool cjobsetendofjobinfodword fdwendofjobinfo jobobjectendofjobtimeinform joeojti fdwendofjobinfo joeojtiendofjobtimeact fdwendofjobinfo returnsetinformationjobobjectmhjob jobobjectendofjobtimeinform joeojti sizeofjoeojti inlin bool cjobsetsecuritylimitinfo pjobobjectsecuritylimitinform pjosli returnsetinformationjobobjectmhjob jobobjectsecuritylimitinform pjosli sizeofpjosli inlin bool cjobqueryassociatedcompletionport pjobobjectassociatecompletionport pjoacp returnqueryinformationjobobjectmhjob jobobjectassociatecompletionportinform pjoacp sizeofpjoacp null см след стр 127 ч т ь ii начинаем работать рис 56 продолжение inlin bool cjobquerybasicaccountinginfo pjobobjectbasicandioaccountinginform pjobai returnqueryinformationjobobjectmhjob jobobjectbasicandioaccountinginform pjobai sizeofpjobai null inlin bool cjobqueryextendedlimitinfo pjobobjectextendedlimitinform pjoeli returnqueryinformationjobobjectmhjob jobobjectextendedlimitinform pjoeli sizeofpjo null inlin bool cjobquerybasicprocessidlistdword dwmaxprocess pdword pdwprocessidlist pdword pdwprocessesreturn определяем требуемый объем памяти байтах dword cb sizeofjobobjectbasicprocessidlist sizeofdword dwmaxprocess 1 выделяем байты стека pjobobjectbasicprocessidlist pjobpil pjobobjectbasicprocessidlist allocacb успешно прошла эта операция идем дальше bool fok pjobpil null if fok pjobpilnumberofprocessidsinlist dwmaxprocess fok queryinformationjobobjectmhjob jobobjectbasicprocessidlist pjobpil cb null if fok появилась информация возвращаем тому запрашивал if pdwprocessesreturn null pdwprocessesreturn pjobpilnumberofprocessidsinlist copymemorypdwprocessidlist pjobpilprocessidlist sizeofdword pjobpilnumberofprocessidsinlist returnfok 128 г л 5 задания рис 56 продолжение inlin bool cjobquerybasicuirestrictionspdword pfdwrestrict jobobjectbasicuirestrict jobuir bool fok queryinformationjobobjectmhjob jobobjectbasicuirestrict jobuir sizeofjobuir null if fok pfdwrestrict jobuiruirestrictionsclass returnfok inlin bool cjobqueryendofjobtimeinfopdword pfdwendofjobtimeinfo jobobjectendofjobtimeinform joeojti bool fok queryinformationjobobjectmhjob jobobjectbasicuirestrict joeojti sizeofjoeojti null if fok pfdwendofjobtimeinfo joeojtiendofjobtimeact returnfok inlin bool cjobquerysecuritylimitinfo pjobobjectsecuritylimitinform pjosli returnqueryinformationjobobjectmhjob jobobjectsecuritylimitinform pjosli sizeofpjosli null inlin bool cjobterminateuint uexitcod returnterminatejobobjectmhjob uexitcod inlin bool cjobgrantuserhandleaccesshandl huserobj bool fgrant returnuserhandlegrantaccesshuserobj mhjob fgrant конец файла 129 г л 6 базовые сведения потоках т ематика связанная потоками очень важна любом процессе должен хотя поток главе концепции потоков будут рассмотрены гораз подробнее частности объясню разница процессами потоками предназначены также расскажу система использует объек ядра  поток  управления потоками подобно процессам потоки обладают оп ределенными свойствами поэтому поговорим функциях позволяющих обра щаться этим свойствам необходимости модифицировать кроме узнаете функциях предназначенных создания порождения дополнительных потоков системе главе 4 процесс фактически состоит двух компонентов объекта ядра  процесс  адресного пространства любой поток состоит двух компонентов 쐽 объекта ядра который операционная система управляет потоком хранится статистическая информация потоке 쐽 стека потока который содержит параметры функций локальные пере менные необходимые потоку выполнения кода система управ ляет стеком потока расскажу главе 16 той главе 4 упомянул процессы инертны процесс исполня ет просто служит контейнером потоков потоки создаются контексте какоголибо процесса вся проходит границах практике это означает потоки исполняют код манипулируют данными адресном странстве процесса поэтому потоков выполняется контексте од ного процесса делят одно адресное пространство потоки могут исполнять код манипулировать одними теми данными также совместно использовать описатели объектов ядра поскольку таблица описателей создается отдельных потоках процессах видите процессы используют системных ресурсов потоки причина кроется адресном пространстве создание виртуального адресного странства процесса требует значительных системных ресурсов ведет ся масса всяческой статистики уходит немало памяти адресное простран ство загружаются exe dllфайлы значит нужны файловые ресурсы стороны потоку требуются лишь соответствующий объект ядра стек объем стати стических сведений потоке невелик памяти занимает потоки расходуют существенно меньше ресурсов процессы старай тесь решать свои задачи счет использования дополнительных потоков избегайте создания новых процессов принимайте совет жесткое правило   многие проекты реализовать основе множества процессов нужно просто помнить издержках соразмерять цель средства 130 глава 6 базовые сведения потоках прежде углубимся скучные крайне важные концепции давайте обсу дим правильно пользоваться потоками разрабатывая архитектуру приложения каких случаях потоки создаются поток thread определяет последовательность исполнения кода процессе инициализации процесса система создает первичный поток начинаясь стартового кода библиотеки cc который очередь вызывает входную функцию winmain wwinmain main wmain вашей программы живет момента входная функция возвращает управление стартовому коду вызывает функцию exitprocess большинство приложений обходится единственным первичным потоком однако процессы могут создавать дополнительные потоки позволяет эффективнее выполнять работу каждого компьютера чрезвычайно мощный ресурс   центральный процес сор абсолютно никаких причин тому процессор простаивал считая экономии электроэнергии процессор деле нагру жаете самыми разнообразными задачами несколько примеров 쐽 активизируете службу индексации данных content index servic win dow 2000 создает поток низким приоритетом который периодически пробуждаясь индексирует содержимое файлов дисковых устройствах ва шего компьютера найти либо файл открываете окно search result щелкнув кнопку start выбрав меню search команду for file or folder вводите поле contain text нужные критерии поиска это го начинается поиск индексу экране появляется список файлов удов летворяющих этим критериям служба индексации данных значительно уве личивает скорость поиска использовании требуется открывать сканировать закрывать каждый файл диске 쐽 запускаете программу дефрагментации дисков поставляемую win dow 2000 обычно утилиты такого рода предлагают массу настроек адми нистрирования которых средний пользователь совершенно разбирает ся   например часто проводить дефрагментацию благодаря токам низким приоритетом можете пользоваться программой фоновом режиме дефрагментировать диски те моменты других дел системы 쐽 нетрудно представить будущую версию компилятора способную автоматичес ки компилировать файлы исходного кода паузах возникающих наборе текста программы предупреждения сообщения ошибках появлялись практически режиме реального времени видели ошиблись самое интересное microsoft visual studio мере умеет это делать   обратите внимание секцию classview workspac 쐽 электронные таблицы пересчитывают данные фоновом режиме 쐽 текстовые процессоры разбивают текст страницы проверяют орфог рафические грамматические ошибки также печатают фоновом режиме 쐽 файлы копировать другие носители фоновом режиме 쐽 webбраузеры способны взаимодействовать серверами фоновом режиме благодаря этому пользователь перейти webузел дожида ясь будут получены результаты текущего webузла 131 ч т ь ii начинаем работать одна важная вещь которую должны обратить внимание этих примерах заключается поддержка многопоточности позволяет упростить пользовательский интерфейс приложения компилятор ведет сборку вашей граммы те моменты делаете паузы наборе текста отпадает необходи мость командах меню build самое относится командам check spell check grammar текстовых процессорах примере webбраузером выделение вводавывода сетевого файлового какого другого отдельный поток обеспечивает  отзывчивость  пользовательс кого интерфейса приложения интенсивной передаче данных вообразите приложение которое сортирует записи базе данных печатает документ копи рует файлы возложив любую этих задач иначе связанных вводомвыво дом отдельный поток пользователь прежнему работать интерфейсом приложения необходимости отменить операцию выполняемую фоновом режиме многопоточное приложение легче масштабируется увидите следующей главе каждый поток закрепить определенным процессором вашем компьютере имеется процессора приложении   потока оба процес сора будут деле фактически сможете выполнять две задачи одновременно каждом процессе хотя поток делая особенного приложении выигрываете оно выполняется многопо точной операционной системе например можете собирать программу одно временно пользоваться текстовым процессором довольно часто работаю компьютере установлено процессора сборка выполняется одном документ обрабатывается другом иначе говоря какоголибо падения изводительности наблюдается кроме компилятор той иной ошибки входит бесконечный цикл остальных процессах это никак отражает ся программах msdos 16разрядной window речь идет каких случаях потоки создаются сих пор пел одни дифирамбы многопоточным приложениям несмотря преимущества свои недостатки некоторые разработчики почему считают любую проблему решить разбив программу отдельные токи трудно совершить бо льшую ошибку потоки   вещь невероятно полезная ими пользуются умом увы решая старые проблемы создать новые допустим разрабатываете тексто вый процессор хотите выделить функциональный блок отвечающий распечат ку отдельный поток идея вроде неплоха пользователь отправив документ рас печатку сразу вернуться редактированию задумайтесь зна чит информация документе изменена распечатке документа видите вами совершенно новая проблема которой прежде сталкивать ся приходилось подумаешь стоит выделять печать отдельный ток искать лишних приключений давайте разрешим распечатке редак тирование любых документов кроме который печатается данный момент скопируем документ временный файл отправим печать именно пользователь пусть редактирует оригинал свое удовольствие распечатка вре менного файла закончится удалим   одно узкое место неправильное применение потоков привести появлению проблем   разработка пользовательского интерфейса приложении подавляющем большинстве программ компоненты пользовательского интерфей 132 глава 6 базовые сведения потоках са окна обрабатываются одним потоком дочерние окна любого окна определенно должен создавать поток создание разных окон разных потоках имеет смысл такие случаи действительно редки обычно приложении существует поток отвечающий поддержку пользо вательского интерфейса   создает окна содержит цикл getmessag любые другие потоки процессе являются рабочими т е отвечают вычисления ввод вывод другие операции создают никаких окон поток пользовательского ин терфейса правило имеет высокий приоритет рабочие потоки   это нужно быстро реагировал действия пользователя несколько потоков пользовательского интерфейса одном процессе наружить таких приложениях window explor создает отдельный поток каждого окна папки это позволяет копировать файлы одной папки другую попутно просматривать содержимое папки кроме ошибка explor приводит краху одного потоков прочие потоки остаются работоспособны можете пользоваться соответствующими окнами пока сде лаете такое рухнут подробнее потоках пользова тельском интерфейсе см главы 26 27 общем мораль вступления такова многопоточность следует использовать разумно создавайте несколько потоков это возможно многие полезные мощные программы прежнему строятся основе одного первично го потока принадлежащего процессу ваша первая функция потока каждый поток начинает выполнение некоей входной функции первичном пото ке таковой является main wmain winmain wwinmain хотите создать вто ричный поток нем должна входная функция которая выглядит пример dword winapi threadfuncpvoid pvparam dword dwresult 0 m returndwresult функция потока выполнять любые задачи рано поздно закончит работу вернет управление момент ваш поток остановится память веденная стек освобождена счетчик пользователей объекта ядра  поток  уменьшится 1 счетчик обнулится объект ядра разрушен объект ядра  процесс  жить гораздо дольше сопоставленный поток поговорим самых важных вещах касающихся функций потоков 쐽 отличие входной функции первичного потока которой должно одно четырех имен main wmain winmain wwinmain   функцию пото ка назвать угодно однако программе несколько функций потоков должны присвоить разные имена иначе компилятор компоновщик решит создаете несколько реализаций единственной функции 쐽 поскольку входным функциям первичного потока передаются строковые пара метры существуют ansi unicodeверсиях main   wmain winmain   133 ч т ь ii начинаем работать wwinmain функциям потоков передается единственный параметр смысл которого определяется вами операционной системой поэтому проблем ansiunicod 쐽 функция потока должна возвращать значение которое использоваться код завершения потока полная аналогия библиотекой cc код завершения первичного потока становится кодом завершения процесса 쐽 функции потоков ваши функции должны мере возможности ходиться своими параметрами локальными переменными стати ческой глобальной переменной могут одновременно обратиться несколь ко потоков риск повредить содержимое однако параметры локаль ные переменные создаются стеке потока поэтому гораздо меньшей степени подвержены влиянию другого потока узнали должна реализована функция потока рассмот рим заставить операционную систему создать поток который выполнит фун кцию функция createthread говорили вызове функции createprocess появляется свет первич ный поток процесса хотите создать дополнительные потоки нужно вызвать первичного потока функцию createthread handl createthread psecurityattribut psa dword cbstack pthreadstartroutin pfnstartaddr pvoid pvparam dword fdwcreat pdword pdwthreadid каждом вызове функции система создает объект ядра  поток  это поток компактная структура данных которая используется операционной систе управления потоком хранит статистическую информацию потоке объект ядра  поток    полный аналог объекта ядра  процесс  система выделяет память стек потока адресного пространства процесса новый поток выполняется контексте процесса родительский поток поэтому получает доступ ко всем описателям объектов ядра всей памяти стекам потоков процессе счет потоки рамках одного процесса могут легко взаимодействовать друг другом createthread   это windowsфункция создающая поток зывайте пишете код cc вместо должны использо вать функцию beginthreadex библиотеки visual c работаете другим компилятором должен поддерживать свой эквивалент функции createthread именно делает beginthreadex почему это важно объясню  кэй общее представление функции createthread получили давайте рас смотрим параметры 134 глава 6 базовые сведения потоках параметр psa параметр psa является указателем структуру securityattribut хо тите объекту ядра  поток  присвоены атрибуты защиты умолчанию чаще бывает передайте параметре null дочерние цессы смогли наследовать описатель объекта определите структуру securi tyattribut инициализируйте элемент binherithandl значением true см главу 3 параметр cbstack параметр определяет какую часть адресного пространства поток сможет исполь зовать свой стек каждому потоку выделяется отдельный стек функция creat process запуская приложение вызывает createthread та инициализирует первич ный поток процесса createprocess заносит параметр cbstack значение хранящееся самом исполняемом файле управлять этим значением позволяет ключ stack компоновщика stackreserv commit аргумент reserv определяет объем адресного пространства который система должна зарезервировать стек потока умолчанию   1 мб аргумент commit задает объем физической памяти который изначально передается области зарезер вированной стек умолчанию   1 страница мере исполнения кода токе весьма вероятно понадобится отвести стек одной страницы памяти переполнении стека возникнет исключение стеке потока исключе ниях связанных переполнением см главу 16 общих принципах обработ ки исключений   главу 23 перехватив это исключение система передаст зарезер вированному пространству одну страницу столько сколько указано аргу менте commit механизм позволяет динамически увеличивать размер стека лишь необходимости обращаясь createthread передаете параметре cbstack ненулевое зна чение функция резервирует указанную вами память объем определяется либо значением параметра cbstack либо значением заданным ключе stack компонов щика выбирается большее передается стеку лишь объем памяти ко торый соответствует значению cbstack передаете параметре cbstack нулевое значение createthread создает стек нового потока используя информа цию встроенную компоновщиком exeфайл значение аргумента reserv устанавливает верхний предел стека это огра ничение позволяет прекращать деятельность функций бесконечной рекурсией пустим пишете функцию которая рекурсивно вызывает сама предположим также функции  жучок  приводящий бесконечной рекурсии всякий функция вызывает сама стеке создается новый стековый фрейм система позволяла ограничивать максимальный размер стека рекурсивная функ ция вызывала сама бесконечности стек поглотил адресное пространство процесса задавая определенный предел первых предотвра щаете разрастание стека гигантских объемов вторых гораздо быстрее узна ете наличии ошибки своей программе программапример summat главе 16 продемонстрирует перехватывать обрабатывать переполнение стека прило жениях 135 ч т ь ii начинаем работать параметры pfnstartaddr pvparam параметр pfnstartaddr определяет адрес функции потока которой должен начать работу создаваемый поток параметр pvparam идентичен параметру pvparam функции потока createthread лишь передает параметр эстафете той функ ции которой начинается выполнение создаваемого потока таким образом данный параметр позволяет передавать функции потока какоелибо инициализирующее зна чение оно просто числовым значением указателем структу ру данных дополнительной информацией вполне допустимо полезно создавать несколько потоков которых ка честве входной точки используется адрес одной той функции например мож реализовать webсервер который обрабатывает каждый клиентский запрос дельном потоке создании каждому потоку передается свое значение pvparam учтите window   операционная система вытесняющей многозадачностью следовательно новый поток поток вызвавший createthread могут выполняться одновременно связи этим возможны проблемы остерегайтесь например такого кода dword winapi firstthreadpvoid pvparam инициализируем переменную которая содержится стеке int x 0 dword dwthreadid создаем новый поток handl hthread createthreadnul 0 secondthread pvoid x 0 dwthreadid ссылаемся новый поток поэтому закрываем свой описатель потока closehandlehthread наш поток закончил работу ошибка стек разрушен secondthread попытаться обратиться нему return0 dword winapi secondthreadpvoid pvparam выполняется длительная обработка m пытаемся обратиться переменной стеке firstthread примечание это привести ошибке общей защиты   нарушению доступа int pvparam 5 m return0 исключено приведенном коде firstthread закончит работу secondthread присвоит значение 5 переменной x firstthread secondthread узнает firstthread существует попытается изменить содержимое какого участка памяти недействительным адресом это избежно вызовет нарушение доступа стек первого потока уничтожен завершении 136 глава 6 базовые сведения потоках firstthread делать объявить x статической переменной компиля тор отведет память хранения переменной x стеке разделе данных прило жения application  data section функция станет нереентерабельной ина че говоря случае смогли создать потока выполняющих одну ту функцию оба потока совместно использовали статическую перемен ную другое решение проблемы сложные варианты базируется методах синхронизации потоков речь которых пойдет главах 8 9 10 параметр fdwcreat параметр определяет дополнительные флаги управляющие созданием потока принимает одно двух значений 0 исполнение потока начинается немедлен createsuspend последнем случае система создает поток инициали зирует приостанавливает последующих указаний флаг createsuspend позволяет программе изменить какиелибо свойства потока начнет выполнять код правда необходимость воз никает довольно редко одно применений флага демонстрирует програм мапример joblab главы 5 параметр pdwthreadid последний параметр функции createthread   это адрес переменной типа dword которой функция возвращает идентификатор приписанный системой новому пото ку идентификаторы процессов потоков рассматривались главе 4 window 2000 window nt 4 параметре передавать null обычно делается самым сообщаете функции инте ресует идентификатор потока window 9598 это приведет ошибке функция попытается записать идентификатор потока нулевому адресу недопустимо поток создан такое несоответствие операционными системами создать разработчикам приложений массу проблем допустим пишете тестируе те программу window 2000 которая создает поток передаете null pdwthreadid запускаете приложение window 98 фун кция createthread естественно дает ошибку вывод тщательно тестируй те свое приложение операционных системах которых оно работать завершение потока поток завершить четырьмя способами 쐽 функция потока возвращает управление рекомендуемый способ 쐽 поток самоуничтожается вызовом функции exitthread нежелательный способ 쐽 потоков данного стороннего процесса вызывает функцию termi natethread нежелательный способ 쐽 завершается процесс содержащий данный поток нежелательно разделе обсудим перечисленные способы завершения потока также рассмотрим самом деле происходит момент окончания 137 ч т ь ii начинаем работать возврат управления функцией потока функцию потока следует проектировать поток завершался возвращает управление это единственный способ гарантирующий кор ректную очистку ресурсов принадлежавших вашему потоку 쐽 любые cобъекты созданные данным потоком уничтожаются соответству ющими деструкторами 쐽 система корректно освобождает память которую занимал стек потока 쐽 система устанавливает код завершения данного потока поддерживаемый объ ектом ядра  поток    возвращает ваша функция потока 쐽 счетчик пользователей данного объекта ядра  поток  уменьшается 1 функция exitthread поток завершить принудительно вызвав void exitthreaddword dwexitcod освобождаются ресурсы операционной системы выделенные дан ному потоку ccресурсы например объекты созданные cклассов очищаются именно поэтому возвращать управление функции потока самому вызывать функцию exitthread подробнее тему см раздел  функция exitprocess  главе 4 параметр dwexitcod помещаете значение которое система рассматривает код завершения потока возвращаемого значения функции вызова поток перестает существовать exitthread   это windowsфункция которая уничтожает поток зывайте пишете код cc вместо должны использовать функцию endthreadex библиотеки visual c работаете другим компилятором должен поддерживать свой эквивалент функции exitthread именно делает endthreadex почему это важно объясню функция terminatethread вызов функции также завершает поток bool terminatethread handl hthread dword dwexitcod отличие exitthread которая уничтожает вызывающий поток эта фун кция завершает поток указанный параметре hthread параметр dwexitcod помещаете значение которое система рассматривает код завершения потока поток уничтожен счетчик пользователей объекта ядра   ток  уменьшится 1 terminatethread   функция асинхронная т е сообщает системе хотите завершить поток тому времени вернет управление поток уничтожен нужно точно знать момент завершения потока используйте waitforsingleobject см главу 9 аналогичную функцию передав описатель потока 138 глава 6 базовые сведения потоках корректно написанное приложение должно вызывать функцию поскольку поток получает никакого уведомления завершении полнить должную очистку ресурсов уничтожение потока вызове exitthread возврате управления функ ции потока приводит разрушению стека завершен функцией terminatethread система уничтожает стек пока завершится процесс которому принадлежал поток сделано другие потоки могут использовать указатели ссылающиеся данные стеке завершенного потока обратились несуществующему стеку произошло рушение доступа кроме завершении потока система уведомляет dll подключенные процессу   владельцу завершенного потока вызове terminatethread такого происходит процесс завершен некор ректно подробнее тему см главу 20 завершается процесс функции exitprocess terminateprocess рассмотренные главе 4 завершают потоки единственное отличие прекращают выполнение потоков принадлежавших завершенному процессу гарантируется высвобождение любых выделенных процессу ресурсов числе стеков потоков однако две функции уничтожают потоки принудительно   каждого вызы вается функция terminatethread это означает очистка проводится некоррект деструкторы cобъектов вызываются данные диск сбрасываются т д происходит завершении потока происходит 쐽 освобождаются описатели userобъектов принадлежавших потоку win dow большинство объектов принадлежит процессу содержащему поток которого созданы поток владеет двумя userобъектами окнами ловушками hook поток создавший такие объекты заверша ется система уничтожает автоматически прочие объекты разрушаются завершается владевший ими процесс 쐽 код завершения потока меняется stillact код переданный функ цию exitthread terminatethread 쐽 объект ядра  поток  переводится свободное состояние 쐽 данный поток является последним активным потоком процессе завер шается процесс 쐽 счетчик пользователей объекта ядра  поток  уменьшается 1 завершении потока сопоставленный объект ядра  поток  освобож дается тех пор пока будут закрыты внешние ссылки объект поток завершился толку описателя другим потокам системе щем немного единственное могут сделать   вызвать функцию getexitcod thread проверить завершен поток идентифицируемый описателем hthread определить код завершения 139 ч т ь ii начинаем работать bool getexitcodethread handl hthread pdword pdwexitcod код завершения возвращается переменной типа dword которую указывает pdwexitcod поток завершен момент вызова getexitcodethread функция записывает переменную идентификатор stillact 0x103 успешном вызове функция возвращает true использованию описателя определения фак та завершения потока вернемся главе 9 кое внутреннем устройстве потока объяснил реализовать функцию потока заставить систему создать поток который выполнит функцию попробуем разобраться сис тема справляется данной задачей рис 61 показано именно должна сделать система создать ини циализировать поток давайте приглядимся схеме повнимательнее вызов createthread заставляет систему создать объект ядра  поток  счетчику чис ла пользователей присваивается начальное значение равное 2 объект ядра   ток  уничтожается прекращается выполнение потока закры вается описатель возвращенный функцией createthread также инициализируются другие свойства объекта счетчик числа простоев suspens count получает значение 1 код завершения   значение stillact 0x103 объект переводится состояние  занято  создав объект ядра  поток  система выделяет стеку потока память адресного пространства процесса записывает самую верхнюю часть значения сте ки потоков строятся старших адресов памяти младшим первое является значением параметра pvparam переданного вами функции createthread второе   это содержимое параметра pfnstartaddr который передаете creat thread объект ядра  поток  стек потока pvparam старшие адреса context pfnstartaddr sp ip другие регистры процессора младшие адреса прочие свойства статистическая информация счетчик числа пользователей 2 kernel32dl счетчик числа простоев 1 void basethreadstart код завершения stillact signal  свободен  fals рис 61 создается инициализируется поток каждого потока собственный набор регистров процессора называемый контек стом потока контекст отражает состояние регистров процессора момент днего исполнения потока записывается структуру context определена заголовочном файле winnth эта структура содержится объекте ядра  поток  140 глава 6 базовые сведения потоках указатель команд ip указатель стека sp   самых важных регистра кон тексте потока вспомните потоки выполняются контексте процесса соответствен регистры указывают адреса памяти адресном пространстве цесса система инициализирует объект ядра  поток  указателю стека струк туре context присваивается адрес которому стек потока записано зна чение pfnstartaddr указателю команд   адрес недокументированной неэкспор тируемой функции basethreadstart эта функция содержится модуле kernel32dl кстати реализована функция createthread главное делает basethreadstart void basethreadstartpthreadstartroutin pfnstartaddr pvoid pvparam tri exitthreadpfnstartaddrpvparam exceptunhandledexceptionfiltergetexceptioninform exitprocessgetexceptioncod примечание попадем сюда инициализации потока система проверяет передан функции creat thread флаг createsuspend система обнуляет счетчик числа стоев потоку выделено процессорное время далее система загружает регистры процессора значения сохраненные контексте потока момента поток выполнять код манипулировать данными адресном пространстве своего процесса поскольку указатель команд нового потока установлен basethreadstart имен функции начнется выполнение потока глядя прототип думать basethreadstart передаются параметра значит вызывается функции это новый поток просто начинает работу basethreadstart получает доступ двум параметрам которые появляются операционная система записывает соответствующие значения стек тока параметры передаются функциям правда некоторых аппаратных платформах параметры передаются стек использованием определенных регистров процессора поэтому таких аппаратных платформах система   прежде разрешить потоку выполнение функции basethreadstart   инициализирует нужные регистры процессора новый поток выполняет basethreadstart происходит следующее 쐽 ваша функция потока включается фрейм структурной обработки исключе ний далее краткости   sehфрейм благодаря чему любое исключение оно происходит момент выполнения вашего потока получает ка кую обработку предлагаемую системой умолчанию подробнее струк турной обработке исключений см главы 23 24 25 쐽 система обращается вашей функции потока передавая параметр pvparam который ранее передали функции createthread 쐽 ваша функция потока возвращает управление basethreadstart вызывает exitthread передавая значение возвращенное вашей функцией счетчик числа пользователей объекта ядра  поток  уменьшается 1 выполнение потока прекращается 141 ч т ь ii начинаем работать 쐽 ваш поток вызывает необрабатываемое исключение обрабатыва ет sehфрейм построенный функцией basethreadstart обычно результате появляется окно каким сообщением пользователь зак рывает basethreadstart вызывает exitprocess завершает весь процесс поток котором произошло исключение обратите внимание basethreadstart поток вызывает либо exitthread либо exitprocess это означает поток выходит данной функции гда уничтожается внутри почему basethreadstart возвращаемого значе ния   просто возвращает кстати именно благодаря basethreadstart ваша функция потока получает возмож ность вернуть управление окончании своей работы basethreadstart вызывая фун кцию потока заталкивает стек свой адрес возврата самым сообщает вернуться сама basethreadstart возвращает управление иначе возникло нарушение доступа стеке потока адреса возврата инициализации первичного потока указатель команд устанавливается другую недокументированную функцию   baseprocessstart идентична basethreadstart выглядит примерно void baseprocessstartpprocessstartroutin pfnstartaddr tri exitthreadpfnstartaddr exceptunhandledexceptionfiltergetexceptioninform exitprocessgetexceptioncod примечание попадем сюда единственное различие этими функциями отсутствии ссылки параметр pvparam функция baseprocessstart обращается стартовому коду библиотеки cc который выполняет необходимую инициализацию затем вызывает вашу входную функцию main wmain winmain wwinmain входная функция возвращает управление стартовый код библиотеки cc вызывает exitprocess поэтому первич ный поток приложения написанного cc возвращается base processstart некоторые соображения библиотеке cc microsoft поставляет visual c шесть библиотек cc краткое описание пред ставлено следующей таблице имя библиотеки описание libclib статически подключаемая библиотека однопоточных приложений используется умолчанию создании нового проекта libcdlib отладочная версия статически подключаемой библиотеки однопо точных приложений libcmtlib статически подключаемая библиотека многопоточных приложений libcmtdlib отладочная версия статически подключаемой библиотеки поточных приложений msvcrtlib библиотека импорта динамического подключения рабочей версии msvcrtdll поддерживает одно многопоточные приложения 142 глава 6 базовые сведения потоках продолжение имя библиотеки описание msvcrtdlib библиотека импорта динамического подключения отладочной версии msvcrtddll поддерживает одно многопоточные приложения реализации любого проекта нужно знать библиотекой следует связать конкретную библиотеку выбрать диалоговом окне project set вкладке cc списке categori укажите code generat списке use runtim librari   одну шести библиотек наверное хочется спросить   отдельные библиотеки од нопоточных многопоточных программ  отвечаю стандартная библиотека c разработана 1970 году   задолго появления самого понятия многопоточ ности авторы библиотеки само собой задумывались проблемах связан ных многопоточными приложениями возьмем примеру глобальную переменную errno стандартной библиотеки c некоторые функции происходит ошибка записывают пере менную соответствующий код допустим фрагмент кода bool ffailur systemnotepadex readmetxt 1 if ffailur switch errno case e2big список аргументов размер окружения слишком велик break case enoent командный интерпретатор найден break case enoexec неверный формат командного интерпретатора break case enomem недостаточно памяти выполнения команды break представим поток выполняющий показанный выше код прерван вызова функции system оператора if допустим также поток прерван выпол 143 ч т ь ii начинаем работать нения другого потока процессе который обращается одной функций библиотеки c та заносит какое значение глобальную переменную errno смотрите получается процессор вернется выполнению первого потока переменной errno окажется вовсе значение которое записано функци system поэтому решения проблемы нужно закрепить каждым потоком переменную errno кроме понадобится механизм который позво лит каждому потоку ссылаться переменную errno трогать чужую это лишь пример стандартная библиотека cc рассчитана многопоточные приложения кроме errno целый ряд переменных функций которыми возможны проблемы многопоточной среде doserrno strtok wcstok strerror strerror tmpnam tmpfile asctim wasctim gmtime ecvt fcvt   спи сок продолжить многопоточные программы использующие библиотеку cc работали корректно требуется создать специальную структуру данных связать каждым потоком которого вызываются библиотечные функции должны знать обращаетесь нужно просматривать блок данных вызывающем потоке повредить данные каком другом потоке откуда система знает создании нового потока создать блок данных ответ очень прост знает знать хочет вся ответственность   исключительно пользуетесь небезопасными многопоточной среде функциями должны создавать потоки библиотечной функцией beginthreadex windowsфункцией createthread unsign long beginthreadex void secur unsign stacksiz unsign startaddressvoid void arglist unsign initflag unsign thrdaddr функции beginthreadex список параметров createthread имена типы несколько отличаются группа которая отвечает microsoft разра ботку поддержку библиотеки cc считает библиотечные функции долж ны зависеть типов данных window createthread функция beginthreadex возвращает описатель созданного потока поэтому раньше поль зовались функцией createthread вызовы исходном коде несложно заменить вызовы beginthreadex однако некоторого расхождения типах данных придется позаботиться приведении которые нужны функции begin threadex компилятор счастлив лично создал небольшой макрос chbeginthreadex который делает работу исходном коде typedef unsign stdcall pthreadstart void defin chbeginthreadexpsa cbstack pfnstartaddr pvparam fdwcreat pdwthreadid handl beginthreadex void psa unsign cbstack pthreadstart pfnstartaddr void pvparam unsign fdwcreat unsign pdwthreadid 144 глава 6 базовые сведения потоках заметьте функция beginthreadex существует многопоточных верси ях библиотеки cc связав проект однопоточной библиотекой получите компоновщика сообщение ошибке  unresolv extern symbol  это сде лано специально однопоточная библиотека корректно рабо тать многопоточном приложении также обратите внимание созда нии нового проекта visual studio умолчанию выбирает однопоточную библиоте ку вариант самый безопасный многопоточных приложений долж ны сами выбрать одну многопоточных версий библиотеки cc поскольку microsoft поставляет исходный код библиотеки cc несложно разоб раться такого делает beginthreadex делает createthread дистри бутивном компактдиске visual studio исходный код содержится файле threadexc перепечатывать весь код решил дать версию псевдокоде выде лив самые интересные места unsign long cdecl beginthreadex void psa unsign cbstack unsign stdcall pfnstartaddr void void pvparam unsign fdwcreat unsign pdwthreadid ptiddata ptd указатель блок данных потока unsign long thdl описатель потока выделяется блок данных нового потока if ptd calloccrt1 sizeofstruct tiddata null goto errorreturn инициализация блока данных initptdptd запоминается нужная функция потока параметр который хотим поместить блок данных ptdinitaddr void pfnstartaddr ptdinitarg pvparam создание нового потока thdl unsign long createthreadpsa cbstack threadstartex pvoid ptd fdwcreat pdwthreadid if thdl null создать поток удалось проводится очистка сообщается ошибке goto errorreturn поток успешно создан возвращается описатель returnthdl errorreturn ошибка удалось создать блок данных поток freecrtptd returnunsign long0l 145 ч т ь ii начинаем работать несколько важных моментов связанных beginthreadex 쐽 каждый поток получает свой блок памяти tiddata выделяемый кучи кото рая принадлежит библиотеке cc структура tiddata определена файле mtdllh довольно любопытна привел рис 62 쐽 адрес функции потока переданный beginthreadex запоминается блоке па мяти tiddata сохраняется параметр который должен передан функции 쐽 функция beginthreadex вызывает createthread лишь помощью операционная система создать новый поток 쐽 вызове createthread сообщается должна начать выполнение вого потока функции threadstartex адреса который указыва ет pfnstartaddr кроме функции потока передается параметр pvparam адрес структуры tiddata 쐽 проходит успешно beginthreadex createthread возвращает описатель потока ином случае возвращается null struct tiddata unsign long tid идентификатор потока unsign long thandl описатель потока int terrno значение errno unsign long tdoserrno значение doserrno unsign int fpds сегмент данных float point unsign long holdrand зародышевое значение rand char token указатель ptr метку strtok ifdef win32 wchart wtoken ptr метку wcstok endif win32 unsign char mtoken ptr метку mbstok следующие указатели обрабатываются функцией malloc период выполнения char errmsg ptr буфер strerrorstrerror char namebuf0 ptr буфер tmpnam ifdef win32 wchart wnamebuf0 ptr буфер wtmpnam endif win32 char namebuf1 ptr буфер tmpfile ifdef win32 wchart wnamebuf1 ptr буфер wtmpfile endif win32 char asctimebuf ptr буфер asctim ifdef win32 wchart wasctimebuf ptr буфер wasctim endif win32 void gmtimebuf ptr структуру gmtime char cvtbuf ptr буфер ecvtfcvt следующие поля используются кодом beginthread void initaddr начальный адрес пользовательского потока void initarg начальный аргумент пользовательского потока рис 62 локальная структура tiddata потока определенная библиотеке cc 146 глава 6 базовые сведения потоках рис 62 продолжение следующие поля нужны поддержки функции signal обработки ошибок возникающих период выполнения void pxcptacttab ptr таблицу исключениедействие void tpxcptinfoptr ptr указатели информации исключении int tfpecod код исключения операций числами плавающей точкой следующее поле нужно подпрограммам nlg unsign long nlgdwcode данные отдельного потока используемые обработке исключений c void termin подпрограмма termin void unexpect подпрограмма unexpect void translat транслятор se void curexcept текущее исключение void curcontext контекст текущего исключения if defin mmrx000 void pframeinfochain void punwindcontext void pexitcontext int mipsptddelta int mipsptdepsilon elif defin mppc void pexitcontext void punwindcontext void pframeinfochain int frameinfo6 endif defin mppc typedef struct tiddata ptiddata выяснив создается инициализируется структура tiddata нового потока посмотрим сопоставляется этим потоком взгляните исходный код фун кции threadstartex который содержится файле threadexc библиотеки cc версия функции псевдокоде static unsign long winapi threadstartex void ptd примечание ptd   это адрес блока tiddata данного потока блок tiddata сопоставляется данным потоком tlssetvaluetlsindex ptd идентификатор потока записывается tiddata ptiddata ptdtid getcurrentthreadid инициализируется поддержка операций числами плавающей точкой код показан см след стр 147 ч т ь ii начинаем работать пользовательская функция потока включается sehфрейм обработки ошибок периода выполнения поддержки signal tri вызывается функция потока которой передается нужный параметр код завершения потока передается endthreadex endthreadex unsign winapi void ptiddataptdinitaddr ptiddataptdinitarg exceptxcptfiltergetexceptioncod getexceptioninform обработчик исключений библиотеки c даст нам попасть сюда exitgetexceptioncod будем функции поток умирает return0l несколько важных моментов связанных threadstartex 쐽 новый поток начинает выполнение basethreadstart kernel32dl затем переходит threadstartex 쐽 качестве единственного параметра функции threadstartex передается адрес блока tiddata нового потока 쐽 windowsфункция tlssetvalu сопоставляет вызывающим потоком значение которое называется локальной памятью потока thread local storag tls расскажу главе 21 threadstartex сопоставляет блок tiddata новым потоком 쐽 функция потока заключается sehфрейм предназначен обработки ошибок периода выполнения например перехваченных исключений c поддержки библиотечной функции signal др момент кстати очень ва жен создали поток помощью createthread вызвали биб лиотечную функцию signal работала некорректно 쐽 далее вызывается функция потока которой передается нужный параметр ад рес функции параметр сохранены блоке tiddata функцией beginthreadex 쐽 значение возвращаемое функцией потока считается кодом завершения это го потока обратите внимание threadstartex возвращается basethreadstart иначе уничтожения потока блок tiddata остался памяти это привело утечке памяти вашем приложении избежать threadstartex вызывает другую библиотечную функцию endthreadex пере дает код завершения последняя функция которую нам нужно рассмотреть   это endthreadex ис ходный код содержится файле threadexc выглядит моей вер сии псевдокоде void cdecl endthreadex unsign retcod ptiddata ptd указатель блок данных потока проводится очистка ресурсов выделенных поддержки операций числами плавающей точкой код показан 148 глава 6 базовые сведения потоках определение адреса блока tiddata данного потока ptd getptd высвобождение блока tiddata freeptdptd завершение потока exitthreadretcod несколько важных моментов связанных endthreadex 쐽 библиотечная функция getptd обращается windowsфункции tlsgetvalu которая сообщает адрес блока памяти tiddata вызывающего потока 쐽 блок освобождается вызовом exitthread поток разрушается передается корректный код завершения начале главы прямого обращения функции exitthread следует избегать это правда отказываюсь своих слов это приводит уничтожению вызывающего потока позволяет вернуться выполняемой данный момент функции поскольку возвращает управление любые созданные вами cобъекты разрушаются одна причина вызывать exitthread дает освободить блок памяти tiddata потока вашем приложении наблюдаться утечка памяти завершения разработчики microsoft visual c прекрасно понимают многие равно будут пользоваться функцией exitthread поэтому кое сделали свести минимуму вероятность утечки памяти действительно хотите самостоятельно уничтожить свой поток можете вызвать endthreadex вмес exitthread самым освободить блок tiddata рекомендую должны понимать библиотечным функциям нужен отдель ный блок данных каждого порождаемого потока каким образом вызова beginthreadex происходит создание инициализация блока данных также связывание созданным потоком кроме должны разби раться функция endthreadex освобождает блок завершении потока блок данных инициализирован сопоставлен конкретным потоком любая библиотечная функция которой обращается поток легко узнать ад рес блока таким образом получить доступ данным принадлежащим этому потоку ладно функциями ясно попробуем проследить происходит глобальными переменными вроде errno заголовочных файлах c эта переменная определена if definedmt defineddl extern int cdecl errnovoid defin errno errno els ndef mt ndef dll extern int errno endif mt dll создавая многопоточное приложение указывать командной строке ком пилятора ключей mt многопоточное приложение md многопоточ 149 ч т ь ii начинаем работать ная dll компилятор определит идентификатор mt ссылаясь errno будете самом деле вызывать внутреннюю функцию errno библиотеки cc возвращает адрес элемента данных errno блоке сопоставленном зывающим потоком кстати макрос errno составлен позволяет получать держимое памяти этому адресу сделано это писать например код int p errno if p enomem m внутренняя функция errno просто возвращала значение errno код удалось скомпилировать многопоточная версия библиотеки cc кроме  обертывает  некоторые функции синхронизирующими примитивами потока одновремен вызывали функцию malloc куча могла повреждена поэтому многопо точной версии библиотеки потоки могут одновременно выделять память кучи второй поток заставляет ждать тех пор пока первый выйдет функции malloc лишь второй поток получает доступ malloc подробнее синхрони зации потоков поговорим главах 8 9 10 дополнительные операции могли отразиться быстро действии многопоточной версии библиотеки поэтому microsoft кроме многопоточ ной поставляет однопоточную версию статически подключаемой библиотеки cc динамически подключаемая версия библиотеки cc вполне универсальна могут использовать любые выполняемые приложения dll которые обращаются библиотечным функциям причине данная библиотека существует лишь многопоточной версии поскольку поставляется виде dll код нужно вклю чать непосредственно exe dllмодули существенно уменьшает размер кроме microsoft исправляет какую ошибку библиотеке программы построенные основе автоматически избавляются ошибки наверное предполагали стартовый код библиотеки cc создает инициализирует блок данных первичного потока приложения это позволяет всяких опасений вызывать первичного потока любые библиотечные функции первичный поток заканчивает выполнение своей входной функции блок дан ных завершаемого потока освобождается самой библиотекой стартовый код делает необходимое структурной обработки исключений благодаря чему первичного потока спокойно обращаться библиотечной функции signal ой вместо beginthreadex ошибке вызвал createthread наверное интересует случится создать поток библиотечной функ цией beginthreadex windowsфункцией createthread поток вызовет какую библиотечную функцию которая манипулирует структурой tiddata произойдет следующее большинство библиотечных функций реентерабельно требует структуры сначала эта функция попытается выяснить адрес блока дан ных потока вызовом tlsgetvalu получив null вместо адреса tiddata узнает вызывающий поток сопоставлен таким блоком библиотечная функция 150 глава 6 базовые сведения потоках создаст инициализирует блок tiddata вызывающего потока далее блок сопоставлен потоком tlssetvalu останется нем тех пор пока выполнение потока прекратится момента данная функция любая другая библиотеки cc сможет пользоваться блоком tiddata потока это фантастично ваш поток работать глюков хотя некоторые проблемы появятся первых поток воспользуется биб лиотечной функцией signal весь процесс завершится sehфрейм подго товлен вторых поток завершится вызвав endthreadex блок данных высвободится произойдет утечка памяти интересно вызовет end threadex потока созданного помощью createthread связываете свой модуль многопоточной dllверсией библиотеки cc завершении потока высвобождении блока tiddata создан библиотека получает уведомление dllthreaddetach смотря это предотвращает утечку памяти связанную блоком tiddata настоятельно советую создавать потоки beginthreadex помощью createthread библиотечные функции которые вызывать библиотеке cc содержится две функции unsign long beginthread void cdecl startaddressvoid unsign stacksiz void arglist void endthreadvoid первоначально созданы занимаются новые функ ции beginthreadex endthreadex видите beginthread параметров меньше следовательно возможности ограничены сравнении полнофункциональной beginthreadex например работая beginthread создать поток атрибутами защиты отличными присваиваемых умолчанию создать поток задержать   получить идентификатор потока функцией endthread та история принимает никаких параметров это значит оконча нии работы потока код завершения равен 0 однако функцией endthread дело обстоит хуже вызо вом exitthread обращается closehandl передает описатель нового потока разобраться проблема взгляните следующий код dword dwexitcod handl hthread beginthread getexitcodethreadhthread dwexitcod closehandlehthread весьма вероятно созданный поток отработает завершится первый поток успеет вызвать функцию getexitcodethread случится значе ние hthread окажется недействительным endthread закрыла опи сатель нового потока естественно вызов closehandl даст ошибку 151 ч т ь ii начинаем работать новая функция endthreadex закрывает описатель потока поэтому фрагмент кода приведенный выше нормально работать заменим зов beginthread вызов beginthreadex заключение напомню толь ко функция потока возвращает управление beginthreadex самостоятельно вызывает endthreadex beginthread обращается endthread узнать потоки часто обращаются windowsфункциям которые меняют среду выполнения например потоку понадобиться изменить свой приоритет приоритет процесса приоритеты рассматриваются главе 7 поскольку это редкость поток модифицирует среду собственную процесса window предусмот рены функции позволяющие легко ссылаться объекты ядра текущего процесса потока handl getcurrentprocess handl getcurrentthread обе функции возвращают псевдоописатель объекта ядра  процесс    ток  создают новые описатели таблице описателей которая принадлежит вызывающему процессу влияют счетчики числа пользователей объектов ядра  процесс   поток  поэтому вызвать closehandl передать псевдоописа тель проигнорирует вызов просто вернет fals псевдоописатели использовать вызове функций которым нужен опи сатель процесса поток запросить временные показатели своего цесса вызвав getprocesstim filetim ftcreationtim ftexittim ftkerneltim ftusertim getprocesstimesgetcurrentprocess ftcreationtim ftexittim ftkerneltim ftusertim аналогичным образом поток выяснить собственные временные показате вызвав getthreadtim filetim ftcreationtim ftexittim ftkerneltim ftusertim getthreadtimesgetcurrentthread ftcreationtim ftexittim ftkerneltim ftusertim некоторые windowsфункции позволяют указывать конкретный процесс ток уникальному рамках всей системы идентификатору функции мощью которых поток выяснить идентификатор   собственный своего процесса dword getcurrentprocessid dword getcurrentthreadid сравнению функциями которые возвращают псевдоописатели функции правило столь полезны могут пригодиться преобразование псевдоописателя настоящий описатель бывает нужно выяснить настоящий псевдоописатель потока  насто ящим  подразумеваю описатель который однозначно идентифицирует уникальный поток вдумайтесь фрагмент кода 152 глава 6 базовые сведения потоках dword winapi parentthreadpvoid pvparam handl hthreadpar getcurrentthread createthreadnul 0 childthread pvoid hthreadpar 0 null далее следует код dword winapi childthreadpvoid pvparam handl hthreadpar handl pvparam filetim ftcreationtim ftexittim ftkerneltim ftusertim getthreadtimeshthreadpar ftcreationtim ftexittim ftkerneltim ftusertim далее следует код заметили ладно идея родительский поток передавал дочернему свой описатель передает псевдо настоящий описа тель начиная выполнение дочерний поток передает псевдоописатель функции getthreadtim вследствие возвращает временные показатели своего   вовсе родительского   потока происходит псевдоописатель яв ляется описателем текущего потока т е который вызывает функцию исправить приведенный выше фрагмент кода превратим псевдоописатель настоящий функцию duplicatehandl рассказывал главе 3 bool duplicatehandl handl hsourceprocess handl hsourc handl htargetprocess phandl phtarget dword fdwaccess bool binherithandl dword fdwoption обычно используется создания нового  процессозависимого  описателя описателя объекта ядра значение которого увязано другим процессом вос пользуемся duplicatehandl назначению скорректируем помощью наш фрагмент кода dword winapi parentthreadpvoid pvparam handl hthreadpar duplicatehandl getcurrentprocess описатель процесса которому относится псевдоописатель потока getcurrentthread псевдоописатель родительского потока getcurrentprocess описатель процесса которому относится новый настоящий описатель потока hthreadpar даст новый настоящий описатель идентифицирующий родительский поток 0 игнорируется duplicatesameaccess fals новый описатель потока ненаследуемый duplicatesameaccess новому описателю потока присваиваются те атрибуты защиты псевдоописателю см след стр 153 ч т ь ii начинаем работать createthreadnul 0 childthread pvoid hthreadpar 0 null далее следует код dword winapi childthreadpvoid pvparam handl hthreadpar handl pvparam filetim ftcreationtim ftexittim ftkerneltim ftusertim getthreadtimeshthreadpar ftcreationtim ftexittim ftkerneltim ftusertim closehandlehthreadpar далее следует код родительский поток преобразует свой  двусмысленный  псевдоописатель настоящий описатель однозначно определяющий родительский поток передает createthread дочерний поток начинает выполнение параметр pvparam содержит настоящий описатель потока итоге вызов либо функции этим описателем влияет дочерний родительский поток поскольку duplicatehandl увеличивает счетчик пользователей указанного объек та ядра закончив работу продублированным описателем объекта очень важно забыть уменьшить счетчик сразу обращения getthreadtim дочерний поток вызывает closehandl уменьшая самым счетчик пользователей объекта  ро дительский поток  1 фрагменте кода исходил дочерний ток вызывает других функций передачей описателя выз вать какие функции передачей описателя родительского потока естествен closehandl следует обращаться необходимость описателе дочернего потока отпадет заметить duplicatehandl позволяет преобразовать псевдоописатель процесса это сделать handl hprocess duplicatehandl getcurrentprocess описатель процесса которому относится псевдоописатель getcurrentprocess псевдоописатель процесса getcurrentprocess описатель процесса которому относится новый настоящий описатель hprocess даст новый настоящий описатель идентифицирующий процесс 0 игнорируется duplicatesameaccess fals новый описатель процесса ненаследуемый duplicatesameaccess новому описателю процесса присваиваются те атрибуты защиты псевдоописателю 154 г л 7 планирование потоков приоритет привязка процессорам операционная система вытесняющей многозадачностью должна использовать иной алгоритм позволяющий распределять процессорное время пото ками рассмотрим алгоритмы применяемые window 98 window 2000 главе 6 обсудили структуру context поддерживаемую объекте ядра  поток  выяснили отражает состояние регистров процессора момент последнего выполнения потока процессором каждые 20 мс около window просматривает существующие объекты ядра  поток  отмечает те кото рые могут получать процессорное время далее выбирает таких объек тов загружает регистры процессора значения контекста эта операция зывается переключением контекста context switch каждому потоку window ведет учет сколько подключался процессору показатель сообща ют специальные утилиты вроде microsoft spi например иллюстрации ниже показан список свойств одного потоков обратите внимание поток ключался процессору 37379 поток выполняет код манипулирует данными адресном пространстве своего процесса примерно 20 мс window сохранит значения регистров процессора контексте потока приостановит выполнение далее система просмотрит ос тальные объекты ядра  поток  подлежащие выполнению выберет заг рузит контекст регистры процессора повторится цикл операций   выбор потока загрузка контекста выполнение сохранение контекста   начи нается момента запуска системы продолжается выключения 155 ч т ь ii начинаем работать таков вкратце механизм планирования работы множества потоков детали обсудим позже главное показал очень просто window называется системой вытесняющей многозадачностью любой момент приостановить любой поток вместо запустить увидите этим механизмом управлять правда крайне ограниченно помните состоянии гарантировать ваш поток выполняться непрерывно ника кой поток получит доступ процессору т д часто спрашивают сделать поток гарантированно запус кался течение определенного времени какого события   пример позднее миллисекунду приема данных последо вательного порта ответ прост никак такие требования предъявлять операционным системам реального времени window относит ся лишь операционная система реального времени имеет полное представле ние характеристиках аппаратных средств которых работает ин тервалах запаздывания контроллеров жестких дисков клавиатуры т д создавая window microsoft ставила другую цель обеспечить поддержку мак симально широкого спектра оборудования   различных процессоров диско вых устройств сетей др короче говоря window является операционной системой реального времени хочу особо подчеркнуть система планирует выполнение тех потоков которые могут получать процессорное время большинство потоков системе таковым относится некоторых объектовпотоков значение счетчика просто ев suspend count 0 значит соответствующие потоки приостановлены получают процессорное время можете создать приостановленный поток вызовом createprocess createthread флагом createsuspend следующем разделе расскажу таких функциях suspendthread resumethread кроме приостановленных существуют другие потоки участвующие распре делении процессорного времени   ожидают какихлибо событий например запускаете notepad работаете нем текстом поток бездействует система выделяет процессорное время кому нечего делать стоит лишь сместить окно прокрутить нем текст ввести система автомати чески включит поток notepad число планируемых это вовсе означает ток notepad начнет выполняться просто система учтет планировании потоков выделит время   возможности ближайшем будущем приостановка возобновление потоков объекте ядра  поток  имеется переменная   счетчик числа простоев данного тока вызове createprocess createthread инициализируется значением рав ным 1 которое запрещает системе выделять новому потоку процессорное время та кая схема весьма разумна сразу создания поток готов выполнению нужно время инициализации поток полностью инициализирован createprocess createthread проверяет передан флаг createsuspend возвращает управ ление оставив поток приостановленном состоянии ином случае счетчик простоев обнуляется поток включается число планируемых   ждет ка кого события например ввода клавиатуры 156 г л 7 планирование потоков приоритет привязка процессорам создав поток приостановленном состоянии можете настроить некоторые свойства например приоритет котором поговорим позже закончив настройку должны разрешить выполнение потока вызовите resumethread пере дайте описатель потока возвращенный функцией createthread описатель взять структуры которую указывает параметр ppiprocinfo передаваемый createprocess dword resumethreadhandl hthread вызов resumethread прошел успешно возвращает предыдущее значение счетчика простоев данного потока ином случае   0xffffffff выполнение отдельного потока приостанавливать несколько поток приостановлен 3 раза возобновлен должен 3 раза   лишь система выделит процессорное время выполнение потока приос тановить создании флагом createsuspend вызовом suspendthread dword suspendthreadhandl hthread любой поток вызвать функцию приостановить выполнение другого потока описатель известен нигде говорится равно скажу приостановить свое выполнение поток способен зобновить посторонней помощи   resumethread функция sus pendthread возвращает предыдущее значение счетчика простоев данного потока поток приостанавливать maximumsuspendcount файле winnth это значение определено 127 обратите внимание suspend thread режиме ядра работает асинхронно пользовательском режиме выпол няется пока поток остается приостановленном состоянии создавая реальное приложение будьте осторожны вызовами suspendthread заранее заниматься поток момент приостановки например пытается выделить память кучи поэтому заблокировал дос туп другим потокам которым нужна динамическая память придется ждать возобновления suspendthread безопасна случае точно знаете делает делать поток предусматриваете меры исклю чения вероятных проблем взаимной блокировки потоков взаимной блокировке других проблемах синхронизации потоков расскажу главах 8 9 10 приостановка возобновление процессов window понятия  приостановка   возобновление  неприменимы процессам участвуют распределении процессорного времени однако спрашивали одним махом приостановить потоки определенного процесса это сделать другого процесса причем должен отладчиком ча стности вызывать функции вроде waitfordebugev continuedebugev других способов приостановки потоков процесса window програм ма выполняющая такую операцию  потерять  новые потоки система должна приостанавливать период существующие вновь здаваемые потоки microsoft предпочла встроить функциональность системный механизм отладки удастся написать идеальную функцию suspendprocess вполне силам добиться удовлетворительной работы многих ситуациях ва риант функции suspendprocess 157 ч т ь ii начинаем работать void suspendprocessdword dwprocessid bool fsuspend получаем список потоков системе handl hsnapshot createtoolhelp32snapshot th32cssnapthread dwprocessid if hsnapshot invalidhandlevalu просматриваем список потоков threadentry32 te sizeoft bool fok thread32firsthsnapshot te for fok fok thread32nexthsnapshot te относится данный поток нужному процессу if teth32ownerprocessid dwprocessid пытаемся получить описатель потока идентификатору handl hthread openthreadthreadsuspendresum fals teth32threadid if hthread null приостанавливаем возобновляем поток if fsuspend suspendthreadhthread els resumethreadhthread closehandlehthread closehandlehsnapshot перечисления списка потоков использую toolhelpфункции рассмат ривались главе 4 определив потоки нужного процесса вызываю openthread handl openthread dword dwdesiredaccess bool binherithandl dword dwthreadid это новая функция которая появилась window 2000 находит объект ядра  поток  идентификатору указанному dwthreadid увеличивает счетчик поль зователей 1 возвращает описатель объекта получив описатель могу передать suspendthread resumethread openthread имеется window 2000 поэтому функция suspendprocess работать window 9598 window nt 40 вероятно догадались почему suspendprocess срабатывать случаях перечислении могут создаваться новые уничтожаться существующие потоки вызова createtoolhelp32snapshot процессе появиться новый поток который функция увидит значит приостановит впослед ствии попытаюсь возобновить потоки вновь вызвав suspendprocess 158 г л 7 планирование потоков приоритет привязка процессорам зобновит поток который собственно приостанавливался хуже перечислении текущий поток уничтожается создается новый идентификатором функция приостановит неизвестно поток непонятно каком процессе ситуации крайне маловероятны точно представляе те делает интересующий процесс никаких проблем общем ис пользуйте мою функцию свой страх риск функция sleep поток сообщить системе выделять процессорное время определен ный период вызвав void sleepdword dwmillisecond эта функция приостанавливает поток dwmillisecond миллисекунд отметим несколько важных моментов связанных функцией sleep 쐽 вызывая sleep поток добровольно отказывается остатка выделенного кванта времени 쐽 система прекращает выделять потоку процессорное время период пример равный заданному верно укажете остановить поток 100 мс приблизительно столько  заснет  хотя исключено сон длится несколько секунд минут вспомните window является системой реального времени ваш поток возобновиться данный момент это зависит ситуация сложится системе тому времени 쐽 можете вызвать sleep передать dwmillisecond значение infinit вооб ще запретив планировать поток это очень практично   корректно завершить поток освободив стек объект ядра 쐽 можете вызвать sleep передать dwmillisecond нулевое значение откажетесь остатка своего кванта времени заставите систему подклю чить процессору поток однако система снова запустить ваш поток других планируемых потоков приоритетом переключение потоков функция switchtothread позволяет подключить процессору поток bool switchtothread вызываете функцию система проверяет поток которому хватает процессорного времени switchtothread немедленно возвращает управление планировщик отдает дополнительный квант времени оритет потока ниже вызывающего истечении кван та планировщик возвращается обычный режим работы switchtothread позволяет потоку которому хватает процессорного времени отнять ресурс потока низким приоритетом возвращает fals момент вызова системе одного потока готового исполнению ином случае   ненулевое значение 159 ч т ь ii начинаем работать вызов switchtothread аналогичен вызову sleep передачей dwmillisecond нуле вого значения разница лишь switchtothread дает возможность выполнять потоки низким приоритетом которым хватает процессорного времени sleep действует оглядки  голодающие  потоки window 98 функция switchtothread лишь определена реализована определение периодов выполнения потока нужно знать сколько времени затрачивает поток выполнение той иной операции многие таких случаях пишут вроде получаем стартовое время dword dwstarttim gettickcount выполняем сложный алгоритм вычитаем стартовое время текущего dword dwelapsedtim gettickcount dwstarttim код основан простом допущении прерван операци онной системе вытесняющей многозадачностью никто знает поток полу чит процессорное время результат сильно искажен нам нужно это функция которая сообщает время затраченное процессором обработку дан ного потока счастью window такая функция bool getthreadtim handl hthread pfiletim pftcreationtim pfiletim pftexittim pfiletim pftkerneltim pfiletim pftusertim getthreadtim возвращает четыре временных параметра показатель времени описание время создания creation time абсолютная величина выраженная интервалах 100 нс отсчитывается полуночи 1 января 1601 года гринвичу момента создания потока время завершения exit time абсолютная величина выраженная интервалах 100 нс отсчитывается полуночи 1 января 1601 года гринвичу момента завершения потока поток выполняется показатель имеет неопределенное значение время выполнения ядра kernel time относительная величина выраженная интерва лах 100 нс сообщает время затраченное этим потоком выполнение кода операцион ной системы время выполнения user user time относительная величина выраженная интерва лах 100 нс сообщает время затраченное током выполнение кода приложения 160 г л 7 планирование потоков приоритет привязка процессорам помощью функции определить время необходимое выполне ния сложного алгоритма int64 filetimetoquadwordpfiletim pft returnint64shllmod32pftdwhighdatetim 32 pftdwlowdatetim void performlongoper filetim ftkerneltimestart ftkerneltimeend filetim ftusertimestart ftusertimeend filetim ftdummi int64 qwkerneltimeelaps qwusertimeelaps qwtotaltimeelaps получаем начальные показатели времени getthreadtimesgetcurrentthread ftdummi ftdummi ftkerneltimestart ftusertimestart выполняем сложный алгоритм получаем конечные показатели времени getthreadtimesgetcurrentthread ftdummi ftdummi ftkerneltimeend ftusertimeend получаем значения времени затраченного выполнение ядра user преобразуя начальные конечные показатели времени filetim учетверенные слова затем вычитая начальные показатели конечных qwkerneltimeelaps filetimetoquadwordftkerneltimeend filetimetoquadwordftkerneltimestart qwusertimeelaps filetimetoquadwordftusertimeend filetimetoquadwordftusertimestart получаем общее время складывая время выполнения ядра user qwtotaltimeelaps qwkerneltimeelaps qwusertimeelaps общее время хранится qwtotaltimeelaps заметим существует одна функция аналогичная getthreadtim менимая ко всем потокам процессе bool getprocesstim handl hprocess pfiletim pftcreationtim pfiletim pftexittim pfiletim pftkerneltim pfiletim pftusertim getprocesstim возвращает временные параметры суммированные всем пото кам завершенным указанном процессе время выполнения ядра бу дет суммой периодов времени затраченного всеми потоками процесса выполне ние кода операционной системы 161 ч т ь ii начинаем работать сожалению window 98 функции getthreadtim getprocesstim опре делены реализованы window 98 надежного механизма помощью которого определить сколько процессорного вре мени выделяется потоку процессу getthreadtim годится высокоточного измерения временных интервалов   window предусмотрено две специальные функции bool queryperformancefrequencylargeinteg plifrequ bool queryperformancecounterlargeinteg plicount построены допущении поток вытесняется поскольку высоко точные измерения проводятся правило очень быстро выполняемых блоках кода слегка упростить работу этими функциями создал следующий cкласс class cstopwatch public cstopwatch queryperformancefrequencymliperffreq start void start queryperformancecountermliperfstart int64 now const возвращает число миллисекунд вызова start largeinteg liperfnow queryperformancecounterliperfnow returnliperfnowquadpart mliperfstartquadpart 1000 mliperffreqquadpart privat largeinteg mliperffreq количество отсчетов секунду largeinteg mliperfstart начальный отсчет применяю класс создаю секундомер начинающий отсчет текущего момента времени cstopwatch stopwatch помещаю код время выполнения которого нужно измерить определяю сколько времени прошло int64 qwelapsedtim stopwatchnow qwelapsedtim сообщает длительность выполнения миллисекундах структура context этому моменту должны понимать какую важную роль играет структура context планировании потоков система сохраняет состояние потока самым отключением процессора благодаря чему выполнение возобновляется места прервано наверное удивитесь документации platform sdk структуре context отведен буквально абзац 162 г л 7 планирование потоков приоритет привязка процессорам   структуре context хранятся данные состоянии регистров учетом специ фики конкретного процессора используется системой выполнения различ ных внутренних операций настоящее время такие структуры определены цессоров intel mip alpha powerpc соответствующие определения см заголовоч ном файле winnth  документации слова элементах структуры набор которых зави сит типа процессора фактически context   единственная структур window специфичная конкретного процессора состоит структура context давайте посмотрим элементы чет ко соответствуют регистрам процессора например процессоров x86 число элементов входят eax ebx ecx edx т д процессоров alpha   intv0 intt0 intt1 ints0 intra intzero др структура context процессоров x86 выглядит typedef struct context флаги управляющие содержимым записи context запись контекста используется входной параметр раздел управляемый флагом установлен считается содержащим действительные значения запись контекста используется модификации контекста потока изменяются те разделы которых флаг установлен запись контекста используется входной выходной параметр захвата контекста потока возвращаются те разделы контекста которых установлены соответствующие флаги запись контекста используется выходной параметр dword contextflag раздел определяетсявозвращается contextflag установлен флаг contextdebugregist заметьте contextdebugregist включаются contextful dword dr0 dword dr1 dword dr2 dword dr3 dword dr6 dword dr7 раздел определяетсявозвращается contextflag установлен флаг contextfloatingpoint floatingsavearea floatsav см след стр 163 ч т ь ii начинаем работать раздел определяетсявозвращается contextflag установлен флаг contextseg dword segg dword segf dword sege dword segd раздел определяетсявозвращается contextflag установлен флаг contextinteg dword edi dword esi dword ebx dword edx dword ecx dword eax раздел определяетсявозвращается contextflag установлен флаг contextcontrol dword ebp dword eip dword segc следует очистить dword eflag следует очистить dword esp dword segss раздел определяетсявозвращается contextflag установлен флаг contextextendedregist формат смысл значений зависят типа процессора byte extendedregistersmaximumsupportedextens context эта структура разбита несколько разделов раздел contextcontrol содер жит управляющие регистры процессора указатель команд указатель стека флаги адрес возврата функции отличие x86 который вызове функции помещает адрес возврата стек процессор alpha сохраняет адрес возврата одном регист ров раздел contextinteg соответствует целочисленным регистрам процессо ра contextfloatingpoint   регистрам плавающей точкой contextseg ment   сегментным регистрам x86 contextdebugregist   регистрам предназначенным отладки x86 contextexten dedregist   дополнительным регистрам x86 164 г л 7 планирование потоков приоритет привязка процессорам window фактически позволяет заглянуть внутрь объекта ядра  поток  получить сведения текущем состоянии регистров процессора предназначена фун кция bool getthreadcontext handl hthread pcontext pcontext создайте экземпляр структуры context инициализируйте нужные флаги эле менте contextflag передайте функции getthreadcontext адрес структуры функция поместит значения элементы сведения которых запросили прежде обращаться getthreadcontext приостановите поток вызовом sus pendthread иначе поток подключен процессору значения регистров существенно изменятся самом деле потока контекста пользовательско го режима режима ядра getthreadcontext возвращает лишь первый вызываете suspendthread поток выполняет код операционной системы пользо вательский контекст считать достоверным несмотря поток остановлен равно выполнит одной команды пользовательского кода последующего возобновления единственный элемент структуры context которому соответствует либо регистр процессора   contextflag присутствуя вариантах струк туры независимо типа процессора подсказывает функции getthreadcontext значения каких регистров хотите узнать например получить значения управляющих регистров потока напишите вроде создаем экземпляр структуры context context context сообщаем системе интересуют сведения управляющих регистрах contextcontextflag contextcontrol требуем системы информацию состоянии регистров процессора данного потока getthreadcontexththread context действительные значения содержат элементы структуры context соответствующие управляющим регистрам остальные значения определены вызовом getthreadcontext инициализировать элемент contextflag получить значения управляющих целочисленных регистров иници ализируйте сообщаем системе интересуют управляющие целочисленные регистры contextcontextflag contextcontrol contextinteg идентификатор позволяющий узнать значения важнейших регис тров т е используемых мнению microsoft чаще сообщаем системе интересуют значимые регистры contextcontextflag contextful contextful определен файле winnth показано таблице 165 ч т ь ii начинаем работать тип процессора определение contextful x86 contextcontrol contextinteg contextseg alpha contextcontrol contextfloatingpoint contextinteg возврата getthreadcontext легко проверите значения любых регист ров потока помните код зависит типа процессора следующей таблице перечислены элементы структуры context соответствующие указателям команд стека разных типов процессоров тип процессора указатель команд указатель стека x86 contexteip contextesp alpha contextfir contextintsp удивительно мощный инструмент дает window руки разработчи ка вещь которой придете полный восторг значения элементов context изменять передавать объекту ядра  поток  помощью функции setthreadcontext bool setthreadcontext handl hthread const context pcontext операцией поток нужно приостановить иначе результаты могут непредсказуемыми прежде обращаться setthreadcontext инициализируйте элемент contextflag показано ниже context context приостанавливаем поток suspendthreadhthread получаем регистры контекста потока contextcontextflag contextcontrol getthreadcontexththread context устанавливаем указатель команд своему выбору нашем примере присваиваем значение 0x00010000 if definedalpha contextfir 0x00010000 elif definedx86 contexteip 0x00010000 els error modul contain cpuspecif code modifi and recompil endif вносим изменения регистры потока contextflag инициализировать это сделано contextcontrolflag contextcontrol setthreadcontexththread context возобновляем выполнение потока оно начнется адреса 0x00010000 resumethreadhthread 166 г л 7 планирование потоков приоритет привязка процессорам код вероятно приведет ошибке защиты нарушению доступа удаленном потоке система сообщит необработанном исключении удаленный процесс бу дет закрыт верно   ваш удаленный благополучно обрушили процесс оставив свой целости сохранности функции getthreadcontext setthreadcontext наделяют огромной властью потоками пользоваться ею нужно осторожностью вызывают лишь считан ные приложения функции предназначены отладчиков других инструмен тальных средств хотя обращаться любых программ подробнее структуре context поговорим главе 24 приоритеты потоков начале главы поток получает доступ процессору 20 мс планировщик переключает процессор выполнение другого потока происхо дит потоков приоритет самом деле системе суще ствуют потоки разными приоритетами это меняет порядок распределения цессорного времени каждому потоку присваивается уровень приоритета   0 самый низкий 31 самый высокий решая какому потоку выделить процессорное время система сна чала рассматривает потоки приоритетом 31 подключает процессору принципу карусели поток приоритетом 31 исключен планирования немедленно получает квант времени истечении которого система проверяет поток получает свой квант процессорного времени пока системе имеются планируемые потоки приоритетом 31 поток низким приоритетом процессорного времени получает такая ситуация зывается  голоданием  starvat наблюдается потоки высоким приоритетом интенсивно используют процессорное время остальные прак тически работают вероятность ситуации намного ниже многопроцессор ных системах потоки приоритетами 31 30 могут выполняться одновременно система старается процессоры загружены работой проста ивают отсутствие планируемых потоков первый взгляд системе организованной таким образом потоков низким приоритетом единого шанса исполнение зачастую потоки нужно выполнять например первичный поток вашего цесса вызывает getmessag система видит никаких сообщений пока приостанавливает выполнение отнимает остаток неиспользованного времени подключает процессору ожидающий поток пока системе явятся сообщения потока вашего процесса простаивать   система станет тратить процессорное время очереди потока появля ется сообщение система сразу подключает процессору момент выполняется поток высоким приоритетом обратите внимание момент потоки высоким оритетом вытесняют потоки низким приоритетом независимо исполняются последние допустим процессор исполняет поток приорите 5 система обнаруживает поток высоким приоритетом готов выполнению система остановит поток низким приоритетом   истек отведенный квант процессорного времени   подключит процессору поток высоким приоритетом прочим выдаст пол ный квант времени 167 ч т ь ii начинаем работать кстати загрузке системы создается особый поток   поток обнуления стра ниц zero page thread которому присваивается нулевой уровень приоритета поток кроме иметь нулевой уровень приоритета обнуляет сво бодные страницы оперативной памяти отсутствии других потоков требующих внимания стороны системы абстрагирование приоритетов создавая планировщик потоков разработчики microsoft прекрасно понимали подойдет случаи жизни также осознавали временем  назна чение  компьютера измениться например момент выпуска window nt здание приложений поддержкой ole начиналось такие прило жения   обычное дело кроме значительно расширилось применение игрово го программного обеспечения интернета алгоритм планирования потоков существенно влияет выполнение приложений самого начала разработчики microsoft понимали придется изменять мере будут расширяться сферы применения компьютеров microsoft гарантирует наши программы будут работать следующих версиях window уда ется изменять внутреннее устройство системы нарушая работоспособность наших программ ответ 쐽 планировщик документируется полностью 쐽 microsoft разрешает полной мере использовать особенности плани ровщика 쐽 microsoft предупреждает алгоритм работы планировщика постоянно ме няется рекомендует писать программы расчете текущий алгоритм window api предоставляет слой абстрагирования конкретного алгоритма ра боты планировщика запрещая прямое обращение планировщику вместо вызываете функции window которые  интерпретируют  ваши параметры зависи мости версии системы буду рассказывать именно слое абстрагирования проектируя свое приложение должны учитывать возможность параллельного выполнения других программ следовательно обязаны выбирать класс приорите та исходя насколько  отзывчивой  должна ваша программа согласен такая формулировка довольно туманна задумано microsoft желает обе щать такого могло нарушить работу вашего кода будущем window поддерживает шесть классов приоритета idl простаивающий below normal ниже обычного normal обычный abov normal выше обычного high сокий realtim реального времени самый распространенный класс приоритета естественно   normal использует 99 приложений классы приоритета показа ны следующей таблице класс приоритета описание realtim потоки процессе обязаны немедленно реагировать события обеспечивая выполнение критических времени задач такие потоки вытесняют компоненты операционной системы будьте крайне осторожны этим классом high потоки процессе должны немедленно реагировать бытия обеспечивая выполнение критических времени задач класс присвоен например task manag дает возможность пользо вателю закрывать неконтролируемые процессы 168 г л 7 планирование потоков приоритет привязка процессорам продолжение класс приоритета описание abov normal класс приоритета промежуточный normal high это новый класс введенный window 2000 normal потоки процессе предъявляют особых требований выделе нию процессорного времени below normal класс приоритета промежуточный normal idl это новый класс введенный window 2000 idl потоки процессе выполняются система занята работой класс приоритета обычно используется утилит ра ботающих фоновом режиме экранных заставок приложений бирающих статистическую информацию приоритет idl идеален программ выполняемых системе боль ше нечего делать примеры таких программ   экранные заставки средства мони торинга компьютер используемый интерактивном режиме занят другими задачами действуя скажем качестве файлового сервера потокам незачем конкурировать экранной заставкой доступ процессору средства мо ниторинга собирающие статистическую информацию системе должны мешать выполнению важных задач класс приоритета high следует использовать лишь крайней необходимости знаете explor выполняется высоким приоритетом бо ль шую часть времени потоки простаивают готовые пробудиться пользо ватель нажмет какую клавишу щелкнет кнопку мыши пока потоки explor простаивают система выделяет процессорное время позволяет выполнять потоки низким приоритетом пользователь нажал скажем ctrlesc система пробуждает поток explor комбинация клавиш ctrlesc попутно открыва ет меню start данный момент исполняются потоки низким приори тетом немедленно вытесняются начинает работать поток explor microsoft разработала explor именно любой пользователь   независимо текущей ситуации системе   ожидает мгновенной реакции оболочки свои ко манды сущности окна explor открывать потоки низким приоритетом зависают бесконечных циклах обладая высоким оритетом потоки explor вытесняют поток исполняющий бесконечный цикл дают возможность закрыть зависший процесс отметить высокую степень продуманности explor основную часть време просто  спит  требуя процессорного времени будь это вся система работала гораздо медленнее многие приложения просто отзывались действия пользователя классом приоритета realtim стоит пользоваться самом деле ранних бетаверсиях window nt 31 присвоение класса приоритета прило жениям предусматривалось хотя операционная система поддерживала возможность realtim   чрезвычайно высокий приоритет поскольку большин ство потоков системе включая управляющие самой системой имеет низкий приоритет процесс таким классом окажет сильное влияние потоки реального времени могут заблокировать необходимые операции дискового сетевого вводавывода привести несвоевременной обработке ввода мыши клавиату ры   пользователь подумать система зависла должна очень веская причина применения класса realtim   например программе требуется 169 ч т ь ii начинаем работать реагировать события аппаратных средствах минимальной задержкой полнять быстротечную операцию которую прерывать каких обстоя тельствах процесс классом приоритета realtim запустить пользователь имеет привилегии increas schedul prioriti умолчанию привилеги обладает администратор пользователь расширенными полномочиями большинство процессов имеет обычный класс приоритета window 2000 появилось новых промежуточных класса   below normal abov normal microsoft добавила поскольку некоторые компании жаловались существующий набор классов приоритетов дает должной гибкости выбрав класс приоритета забудьте ваша программа выполняться совместно другими приложениями сосредоточьтесь потоках window держивает семь относительных приоритетов потоков idl простаивающий lowest низший below normal ниже обычного normal обычный abov normal выше обычного highest высший timecrit критичный времени приорите относительны классу приоритета процесса обычно большинство потоков использует обычный приоритет относительные приоритеты потоков описаны сле дующей таблице относительный приоритет потока описание timecrit поток выполняется приоритетом 31 классе realtim приоритетом 15 других классах highest поток выполняется приоритетом уровня выше обычного данного класса abov normal поток выполняется приоритетом уровень выше обычного данного класса normal поток выполняется обычным приоритетом процесса данного класса below normal поток выполняется приоритетом уровень ниже обычного данного класса lowest поток выполняется приоритетом уровня ниже обычного данного класса idl поток выполняется приоритетом 16 классе realtim приоритетом 1 других классах итак присваиваете процессу некий класс приоритета можете изменять носительные приоритеты потоков пределах процесса заметьте слова уровнях приоритетов 0 31 разработчики приложений имеют ними дела уровень приоритета формируется самой системой исходя класса приоритета цесса относительного приоритета потока механизм формирования   microsoft хочет ограничивать действительно механизм ется практически каждой версии системы следующей таблице показано формируется уровень приоритета win dow 2000 забывайте window nt window 9598 механизм действует несколько иначе учтите также будущих версиях window вновь изменится например обычный поток обычном процессе получает уровень приоритета 8 поскольку большинство процессов имеет класс normal большинство потоков   170 г л 7 планирование потоков приоритет привязка процессорам относительный приоритет normal основной части потоков системе уровень оритета равен 8 обычный поток процессе классом приоритета high получает уровень приори тета 13 изменив класс приоритета процесса idl снизите уровень приоритета потока 4 вспомните приоритет потока относителен классу приоритета процесса изменение класса приоритета процесса влияет носительные приоритеты потоков сказывается уровне приоритета класс приоритета процесса относительный below abov приоритет потока idl normal normal normal high realtim timecrit критичный времени 15 15 15 15 15 31 highest высший 6 8 10 12 15 26 abov normal выше обычного 5 7 9 11 14 25 normal обычный 4 6 8 10 13 24 below normal ниже обычного 3 5 7 9 12 23 lowest низший 2 4 6 8 11 22 idl простаивающий 1 1 1 1 1 16 обратите внимание таблице показано задать уровень приоритета 0 это связано нулевой приоритет зарезервирован потока обнуления стра ниц никакой поток иметь приоритет кроме уровни 17 21 27 30 обычном приложении недоступны можете пользоваться ими пишете драйвер устройства работающий режиме ядра одно уровень приоритета потока процессе классом realtim опускаться ниже 16 потока процессе любым другим классом   подниматься выше 15 концепция класса приоритета вводит некоторых заблуждение делают отсюда вывод процессы участвуют распределении процессорного вре мени процессы получают процессорное время   оно деляется лишь потокам класс приоритета процесса   сугубо абстрактная кон цепция введенная microsoft единственной целью скрыть разработчика внутреннее устройство планировщика общем случае поток высоким уровнем приоритета должен активен меньше времени появлении либо работы получает процессорное время выполнив минимальное количество команд должен снова вернуться ждущий режим стороны поток низ ким уровнем приоритета оставаться активным занимать процессор довольно долго следуя этим правилам сохраните должную отзывчивость операционной системы действия пользователя программирование приоритетов процесс получает класс приоритета очень просто вызывая createprocess можете указать параметре fdwcreat нужный класс приоритета идентифика торы этих классов приведены следующей таблице 171 ч т ь ii начинаем работать класс приоритета идентификатор realtim realtimepriorityclass high highpriorityclass abov normal abovenormalpriorityclass normal normalpriorityclass below normal belownormalpriorityclass idl idlepriorityclass показаться странным создавая дочерний процесс родительский устанавливает класс приоритета примером далеко ходить   возь мем explor запуске какого приложения новый цесс создается обычным приоритетом explor знает делает процесс часто потокам выделять процессорное время поэтому сис теме предусмотрена возможность изменения класса приоритета самим выполняемым процессом   вызовом функции setpriorityclass bool setpriorityclass handl hprocess dword fdwprioriti эта функция меняет класс приоритета процесса определяемого описателем hpro cess соответствии значением параметра fdwprioriti последний должен содержать одно значений указанных таблице выше поскольку setpriorityclass принимает описатель процесса можете изменить приоритет любого процесса выполняемо го системе   описатель известен соответствующие права дос тупа обычно процесс пытается изменить свой класс приоритета процесс мо жет установить класс приоритета idl bool setpriorityclassgetcurrentprocess idlepriorityclass парная функция getpriorityclass позволяет узнать класс приоритета любого процесса dword getpriorityclasshandl hprocess возвращает догадываетесь ранее перечисленных флагов запуске оболочки командного процессора начальный приоритет програм обычный однако запуская командой start указать ключ опреде ляющий начальный приоритет следующая команда введенная оболочке коман дного процессора заставит систему запустить приложение calcul присвоить приоритет idl cstart low calcex команда start допускает также ключи belownorm normal abovenorm high realtim позволяющие начать выполнение программы соответствующим классом приоритета разумеется запуска программа вызвать setprior class установить класс приоритета window 98 команда start поддерживает этих ключей обо лочки командного процессора window 98 процессы запускаются классом приоритета normal 172 г л 7 планирование потоков приоритет привязка процессорам task manag window 2000 дает возможность изменять класс приоритета цесса рисунке ниже показана вкладка process окне task manag списком выполняемых данный момент процессов колонке base pri сообщается класс приоритета каждого процесса можете изменить выбрав процесс указав класс подменю set prioriti контекстного меню созданный поток получает относительный приоритет normal почему createthread позволяет задать относительный приоритет   остает ся загадкой такая операция осуществляется вызовом функции bool setthreadprior handl hthread int nprioriti разумеется параметр hthread указывает поток чей приоритет хотите менить nprioriti передается идентификаторов см таблицу ниже относительный приоритет потока идентификатор timecrit threadprioritytimecrit highest threadpriorityhighest abov normal threadpriorityabovenorm normal threadprioritynorm below normal threadprioritybelownorm lowest threadprioritylowest idl threadpriorityidl функция getthreadprior парная setthreadprior позволяет узнать относитель ный приоритет потока int getthreadpriorityhandl hthread возвращает идентификаторов показанных таблице выше 173 ч т ь ii начинаем работать создать поток относительным приоритетом idl сделайте например dword dwthreadid handl hthread createthreadnul 0 threadfunc null createsuspend dwthreadid setthreadpriorityhthread threadpriorityidl resumethreadhthread closehandlehthread заметьте createthread создает поток относительным приоритетом normal присвоить потоку относительный приоритет idl создайте приоста новленный поток передав createthread флаг createsuspend вызови те setthreadprior установите нужный приоритет далее вызвать resum thread поток включен число планируемых заранее поток получит процессорное время планировщик учитывает новый оритет выполнив операции можете закрыть описатель потока соот ветствующий объект ядра уничтожен завершении данного потока одна windowsфункция возвращает уровень приоритета потока такая ситуация создана преднамеренно вспомните microsoft любой момент изменить алгоритм распределения процессорного времени поэтому разработке приложений стоит опираться какие нюансы алгоритма используйте классы приоритетов процессов относительные оритеты потоков ваши приложения будут нормально работать нынеш следующих версиях window динамическое изменение уровня приоритета потока уровень приоритета получаемый комбинацией относительного приоритета потока класса приоритета процесса которому принадлежит данный поток называют ба зовым уровнем приоритета потока система изменяет уровень приоритета потока обычно это происходит ответ некоторые события связанные вводом выводом например появление оконных сообщений чтение диска поток относительным приоритетом normal выполняемый процессе клас сом приоритета high имеет базовый приоритет 13 пользователь нажимает ка кую клавишу система помещает очередь потока сообщение wmkeydown поскольку очереди потока появилось сообщение поток становится планируемым драйвер клавиатуры заставить систему временно поднять уровень приоритета потока 13 15 действительное значение отличаться ту другую сторону процессор исполняет поток течение отведенного отрезка времени истечении система снижает приоритет потока 1 уровня 14 далее потоку вновь выделяется квант процессорного времени окончании которого система снижает уровень приоритета потока 1 приоритет потока снова соответ ствует базовому уровню текущий уровень приоритета ниже базового кроме драйвер устройства  разбудивший  поток устанавливает величину повышения приори тета microsoft документирует насколько повышаются значения кон кретными драйверами таким образом получает возможность тонко настраивать динамическое изменение приоритетов потоков операционной системе та максимально быстро реагировала действия пользователя 174 г л 7 планирование потоков приоритет привязка процессорам система повышает приоритет тех потоков базовый уровень которых ходится пределах 1 15 именно поэтому данный диапазон называется  областью динамического приоритета  dynam prioriti rang система допускает динами ческого повышения приоритета потока уровней реального времени 15 поскольку потоки такими уровнями обслуживают системные функции это ограни чение дает приложению нарушить работу операционной системы кстати сис тема меняет приоритет потоков уровнями реального времени 16 31 некоторые разработчики жаловались динамическое изменение приоритета системой отрицательно сказывается производительности приложений поэто му microsoft добавила две функции позволяющие отключать механизм bool setprocesspriorityboost handl hprocess bool disablepriorityboost bool setthreadpriorityboost handl hthread bool disablepriorityboost setprocesspriorityboost заставляет систему включить отключить изменение оритетов потоков указанном процессе setthreadpriorityboost действует менительно отдельным потокам функции имеют свои аналоги позволяющие определять разрешено запрещено изменение приоритетов bool getprocesspriorityboost handl hprocess pbool pdisablepriorityboost bool getthreadpriorityboost handl hthread pbool pdisablepriorityboost каждой этих двух функций передаете описатель нужного процесса потока адрес переменной типа bool которой возвращается результат window 98 четыре функции определены реализованы вызове любой возвращается fals последующий вызов getlasterror дает errorcallnotimpl одна ситуация которой система динамически повышает приоритет потока представьте поток приоритетом 4 готов выполнению получить доступ процессору постоянно занимают потоки оритетом 8 это типичный случай  голодания  потока низким приоритетом обнаружив поток выполняемый протяжении трех четырех се кунд система поднимает приоритет 15 выделяет двойную порцию вре мени истечении потоку немедленно возвращается базовый приоритет подстройка планировщика активного процесса пользователь работает окнами какого процесса последний считается ак тивным foreground process остальные процессы   фоновыми background proce ses естественно пользователь заинтересован повышенной отзывчивости активно го процесса сравнению фоновыми window подстраивает алгоритм планирования потоков активного процесса window 2000 процесс становит 175 ч т ь ii начинаем работать ся активным система выделяет потокам длительные кванты времени такая регулировка применяется процессам классом приоритета normal window 2000 позволяет модифицировать работу механизма подстройки щелкнув кнопку perform option вкладке advanc диалогового окна system properti открываете следующее окно переключатель applic включает подстройку планировщика активного процесса переключатель background servic   выключает случае оптими зируется выполнение фоновых сервисов window 2000 profession умолчанию выбирается переключатель applic остальных версиях window 2000   пе реключатель background servic серверы редко используются интерактив ном режиме window 98 позволяет подстраивать распределение процессорного време потоков активного процесса классом приоритета normal процесс класса становится активным система повышает 1 приоритет потоков исходные приоритеты lowest below normal normal abov normal highest приоритет потоков idl timecrit меняется поэтому поток относительным приоритетом normal активном процессе классом приоритета normal имеет уро вень приоритета 9 8 процесс вновь становится фоновым приоритеты потоков автоматически возвращаются исходным уровням window 98 предусматривает возможности настройки механизма рассчитана работу качестве выделенного сервера причина таких изменений активных процессов очень проста система дает возможность быстрее реагировать пользовательский ввод приоритеты потоков менялись обычный процесс фоновой печати обычный актив ный процесс принимающий пользовательский ввод   оба одинаково конкурирова процессорное время пользователь набирая текст активном ложении заметил текст появляется экране какими рывками благо даря тому система повышает уровни приоритета потоков активного процесса получают преимущество потоками обычных фоновых процессов программапример schedul lab эта программа  07 schedlabexe  см листинг рис 71 позволяет эксперименти ровать классами приоритетов процессов относительными приоритетами потоков 176 г л 7 планирование потоков приоритет привязка процессорам исследовать влияние общую производительность системы файлы исходного кода ресурсов программы находятся каталоге 07schedlab компактдиске прилагаемом книге запуска schedlab открывается окно показанное ниже изначально первичный поток работает очень активно степень использования процессора подскакивает 100 занимается   постоянно увеличивает исходное значение 1 выводит текущее значение крайнее справа окно списка числа несут никакой смысловой информации появление просто демон стрирует поток занят прочувствовать повлияет изме нение приоритета запустите крайней мере экземпляра программы можете также открыть task manag понаблюдать нагрузкой процессор создаваемой каждым экземпляром начале теста процессор загружен 100 увидите экземп ляры schedlab получают примерно равные кванты процессорного времени task manag должен показать практически одинаковые процентные доли эк земпляров поднимете класс приоритета одного экземпляров abov normal high львиную долю процессорного времени начнет получать имен экземпляр аналогичные показатели других экземпляров резко упадут однако опустятся нуля   это действует механизм динамического повышения приоритета  голодающих  процессов можете самостоятельно поиграть изменением классов приоритетов процессов относительных приорите тов потоков возможность установки класса приоритета realtim исключил наме ренно нарушить работу операционной системы хотите поэкспериментировать этим приоритетом придется модифицировать исход ный текст моей программы используя поле sleep приостановить первичный поток заданное число миллисекунд диапазоне 0 9999 попробуйте приостанавливать хотя 1 мс посмотрите сколько процессорного времени это позволит сэкономить своем ноутбуке процессором pentium ii 300 мгц выиграл аж 99   впечатляет кнопка suspend заставляет первичный поток создать дочерний поток который приостанавливает родительский выводит следующее окно пока это окно открыто первичный поток полностью отключается процессо ра дочерний требует процессорного времени ждет пользовате ля дальнейших действий можете свободно перемещать это окно пределах экра убрать сторону основного окна программы поскольку первичный поток остановлен основное окно принимает оконных сообщений числе 177 ч т ь ii начинаем работать wmpaint это доказывает поток задержан закрыв окно сообщением возобновите первичный поток нагрузка процессор снова возрастет 100 проведите эксперимент откройте диалоговое окно perform option нем предыдущем разделе выберите переключатель back ground servic наоборот applic запустите несколько экземпляров моей программы классом приоритета normal выберите сделав активным процессом сможете наглядно убедиться переключатели влия ют активные фоновые процессы schedlabcpp модуль schedlabcpp автор copyright c 2000 джеффри рихтер jeffrey richter includ cmnhdrh см приложение includ windowsxh includ tcharh includ processh доступа beginthreadex includ resourceh dword winapi threadfuncpvoid pvparam handl hthreadprimari handl pvparam suspendthreadhthreadprimari chmb the primari thread is suspendedn it no longer respond to input and produc no outputn press ok to resum the primari thread exit this secondari threadn resumethreadhthreadprimari closehandlehthreadprimari избежание взаимной блокировки resumethread вызываем enablewindow enablewindow getdlgitemfindwindownul textschedul lab idcsuspend true return0 bool dlgoninitdialog hwnd hwnd hwnd hwndfocus lparam lparam chsetdlgiconshwnd idischedlab инициализируем классы приоритетов процесса hwnd hwndctl getdlgitemhwnd idcprocesspriorityclass рис 71 программапример schedlab 178 г л 7 планирование потоков приоритет привязка процессорам рис 71 продолжение int n comboboxaddstringhwndctl texthigh comboboxsetitemdatahwndctl n highpriorityclass запоминаем текущий класс приоритета своего процесса dword dwpc getpriorityclassgetcurrentprocess if setpriorityclassgetcurrentprocess belownormalpriorityclass эта система поддерживает класс приоритета below normal восстанавливаем исходный класс приоритета setpriorityclassgetcurrentprocess dwpc добавляем класс abov normal n comboboxaddstringhwndctl textabov normal comboboxsetitemdatahwndctl n abovenormalpriorityclass dwpc 0 данная система поддерживает класс below normal int nnormal n comboboxaddstringhwndctl textnorm comboboxsetitemdatahwndctl n normalpriorityclass if dwpc 0 эта система поддерживает класс приоритета below normal добавляем класс below normal n comboboxaddstringhwndctl textbelow normal comboboxsetitemdatahwndctl n belownormalpriorityclass n comboboxaddstringhwndctl textidl comboboxsetitemdatahwndctl n idlepriorityclass comboboxsetcurselhwndctl nnormal инициализируем относительные приоритеты потоков hwndctl getdlgitemhwnd idcthreadrelativeprior n comboboxaddstringhwndctl texttim critic comboboxsetitemdatahwndctl n threadprioritytimecrit n comboboxaddstringhwndctl texthighest comboboxsetitemdatahwndctl n threadpriorityhighest n comboboxaddstringhwndctl textabov normal comboboxsetitemdatahwndctl n threadpriorityabovenorm см след стр 179
